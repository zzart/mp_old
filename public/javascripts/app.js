(function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var t={},i={},n=function(e,t){return{}.hasOwnProperty.call(e,t)},r=function(e,t){var i,n,r=[];i=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var s=0,o=i.length;o>s;s++)n=i[s],".."===n?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},o=function(t){return function(i){var n=s(t),o=r(n,i);return e.require(o,t)}},a=function(e,t){var n={id:e,exports:{}};return i[e]=n,t(n.exports,o(e),n),n.exports},l=function(e,s){var o=r(e,".");if(null==s&&(s="/"),n(i,o))return i[o].exports;if(n(t,o))return a(o,t[o]);var l=r(o,"./index");if(n(i,l))return i[l].exports;if(n(t,l))return a(l,t[l]);throw Error('Cannot find module "'+e+'" from '+'"'+s+'"')},u=function(e,i){if("object"==typeof e)for(var r in e)n(e,r)&&(t[r]=e[r]);else t[e]=i},h=function(){var e=[];for(var i in t)n(t,i)&&e.push(i);return e};e.require=l,e.require.define=u,e.require.register=u,e.require.list=h,e.require.brunch=!0}})(),function(e){for(var t,i=function(){},n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(",");t=n.pop();)e[t]=e[t]||i}(window.console=window.console||{}),function(e,t){function i(e){var t=e.length,i=ht.type(e);return ht.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e){var t=Ct[e]={};return ht.each(e.match(pt)||[],function(e,i){t[i]=!0}),t}function r(e,i,n,r){if(ht.acceptData(e)){var s,o,a=ht.expando,l=e.nodeType,u=l?ht.cache:e,h=l?e[a]:e[a]&&a;if(h&&u[h]&&(r||u[h].data)||n!==t||"string"!=typeof i)return h||(h=l?e[a]=tt.pop()||ht.guid++:a),u[h]||(u[h]=l?{}:{toJSON:ht.noop}),("object"==typeof i||"function"==typeof i)&&(r?u[h]=ht.extend(u[h],i):u[h].data=ht.extend(u[h].data,i)),o=u[h],r||(o.data||(o.data={}),o=o.data),n!==t&&(o[ht.camelCase(i)]=n),"string"==typeof i?(s=o[i],null==s&&(s=o[ht.camelCase(i)])):s=o,s}}function s(e,t,i){if(ht.acceptData(e)){var n,r,s=e.nodeType,o=s?ht.cache:e,l=s?e[ht.expando]:ht.expando;if(o[l]){if(t&&(n=i?o[l]:o[l].data)){ht.isArray(t)?t=t.concat(ht.map(t,ht.camelCase)):t in n?t=[t]:(t=ht.camelCase(t),t=t in n?[t]:t.split(" ")),r=t.length;for(;r--;)delete n[t[r]];if(i?!a(n):!ht.isEmptyObject(n))return}(i||(delete o[l].data,a(o[l])))&&(s?ht.cleanData([e],!0):ht.support.deleteExpando||o!=o.window?delete o[l]:o[l]=null)}}}function o(e,i,n){if(n===t&&1===e.nodeType){var r="data-"+i.replace(St,"-$1").toLowerCase();if(n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Et.test(n)?ht.parseJSON(n):n}catch(s){}ht.data(e,i,n)}else n=t}return n}function a(e){var t;for(t in e)if(("data"!==t||!ht.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function u(){return!1}function h(){try{return Y.activeElement}catch(e){}}function c(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function p(e,t,i){if(ht.isFunction(t))return ht.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ht.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(Ut.test(t))return ht.filter(t,e,i);t=ht.filter(t,e)}return ht.grep(e,function(e){return ht.inArray(e,t)>=0!==i})}function d(e){var t=Wt.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function f(e,t){return ht.nodeName(e,"table")&&ht.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function m(e){return e.type=(null!==ht.find.attr(e,"type"))+"/"+e.type,e}function g(e){var t=ri.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function y(e,t){for(var i,n=0;null!=(i=e[n]);n++)ht._data(i,"globalEval",!t||ht._data(t[n],"globalEval"))}function v(e,t){if(1===t.nodeType&&ht.hasData(e)){var i,n,r,s=ht._data(e),o=ht._data(t,s),a=s.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,r=a[i].length;r>n;n++)ht.event.add(t,i,a[i][n])}o.data&&(o.data=ht.extend({},o.data))}}function b(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ht.support.noCloneEvent&&t[ht.expando]){r=ht._data(t);for(n in r.events)ht.removeEvent(t,n,r.handle);t.removeAttribute(ht.expando)}"script"===i&&t.text!==e.text?(m(t).text=e.text,g(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ht.support.html5Clone&&e.innerHTML&&!ht.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&ti.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function _(e,i){var n,r,s=0,o=typeof e.getElementsByTagName!==X?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==X?e.querySelectorAll(i||"*"):t;if(!o)for(o=[],n=e.childNodes||e;null!=(r=n[s]);s++)!i||ht.nodeName(r,i)?o.push(r):ht.merge(o,_(r,i));return i===t||i&&ht.nodeName(e,i)?ht.merge([e],o):o}function w(e){ti.test(e.type)&&(e.defaultChecked=e.checked)}function x(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=Oi.length;r--;)if(t=Oi[r]+i,t in e)return t;return n}function L(e,t){return e=t||e,"none"===ht.css(e,"display")||!ht.contains(e.ownerDocument,e)}function O(e,t){for(var i,n,r,s=[],o=0,a=e.length;a>o;o++)n=e[o],n.style&&(s[o]=ht._data(n,"olddisplay"),i=n.style.display,t?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&L(n)&&(s[o]=ht._data(n,"olddisplay",k(n.nodeName)))):s[o]||(r=L(n),(i&&"none"!==i||!r)&&ht._data(n,"olddisplay",r?i:ht.css(n,"display"))));for(o=0;a>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?s[o]||"":"none"));return e}function C(e,t,i){var n=yi.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function E(e,t,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=ht.css(e,i+Li[s],!0,r)),n?("content"===i&&(o-=ht.css(e,"padding"+Li[s],!0,r)),"margin"!==i&&(o-=ht.css(e,"border"+Li[s]+"Width",!0,r))):(o+=ht.css(e,"padding"+Li[s],!0,r),"padding"!==i&&(o+=ht.css(e,"border"+Li[s]+"Width",!0,r)));return o}function S(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,s=hi(e),o=ht.support.boxSizing&&"border-box"===ht.css(e,"boxSizing",!1,s);if(0>=r||null==r){if(r=ci(e,t,s),(0>r||null==r)&&(r=e.style[t]),vi.test(r))return r;n=o&&(ht.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+E(e,t,i||(o?"border":"content"),n,s)+"px"}function k(e){var t=Y,i=_i[e];return i||(i=T(e,t),"none"!==i&&i||(ui=(ui||ht("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ui[0].contentWindow||ui[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=T(e,t),ui.detach()),_i[e]=i),i}function T(e,t){var i=ht(t.createElement(e)).appendTo(t.body),n=ht.css(i[0],"display");return i.remove(),n}function P(e,t,i,n){var r;if(ht.isArray(t))ht.each(t,function(t,r){i||Ei.test(e)?n(e,r):P(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==ht.type(t))n(e,t);else for(r in t)P(e+"["+r+"]",t[r],i,n)}function q(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,s=t.toLowerCase().match(pt)||[];if(ht.isFunction(i))for(;n=s[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function N(e,i,n,r){function s(l){var u;return o[l]=!0,ht.each(e[l]||[],function(e,l){var h=l(i,n,r);return"string"!=typeof h||a||o[h]?a?!(u=h):t:(i.dataTypes.unshift(h),s(h),!1)}),u}var o={},a=e===Hi;return s(i.dataTypes[0])||!o["*"]&&s("*")}function F(e,i){var n,r,s=ht.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((s[r]?e:n||(n={}))[r]=i[r]);return n&&ht.extend(!0,e,n),e}function I(e,i,n){for(var r,s,o,a,l=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),s===t&&(s=e.mimeType||i.getResponseHeader("Content-Type"));if(s)for(a in l)if(l[a]&&l[a].test(s)){u.unshift(a);break}if(u[0]in n)o=u[0];else{for(a in n){if(!u[0]||e.converters[a+" "+u[0]]){o=a;break}r||(r=a)}o=o||r}return o?(o!==u[0]&&u.unshift(o),n[o]):t}function A(e,t,i,n){var r,s,o,a,l,u={},h=e.dataTypes.slice();if(h[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(s=h.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=h.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(o=u[l+" "+s]||u["* "+s],!o)for(r in u)if(a=r.split(" "),a[1]===s&&(o=u[l+" "+a[0]]||u["* "+a[0]])){o===!0?o=u[r]:u[r]!==!0&&(s=a[0],h.unshift(a[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}function D(){try{return new e.XMLHttpRequest}catch(t){}}function M(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function R(){return setTimeout(function(){Ji=t}),Ji=ht.now()}function z(e,t,i){for(var n,r=(sn[t]||[]).concat(sn["*"]),s=0,o=r.length;o>s;s++)if(n=r[s].call(i,t,e))return n}function B(e,t,i){var n,r,s=0,o=rn.length,a=ht.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Ji||R(),i=Math.max(0,u.startTime+u.duration-t),n=i/u.duration||0,s=1-n,o=0,l=u.tweens.length;l>o;o++)u.tweens[o].run(s);return a.notifyWith(e,[u,s,i]),1>s&&l?i:(a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:ht.extend({},t),opts:ht.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Ji||R(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ht.Tween(e,u.opts,t,i,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(n),n},stop:function(t){var i=0,n=t?u.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)u.tweens[i].run(1);return t?a.resolveWith(e,[u,t]):a.rejectWith(e,[u,t]),this}}),h=u.props;for(j(h,u.opts.specialEasing);o>s;s++)if(n=rn[s].call(u,e,h,u.opts))return n;return ht.map(h,z,u),ht.isFunction(u.opts.start)&&u.opts.start.call(e,u),ht.fx.timer(ht.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function j(e,t){var i,n,r,s,o;for(i in e)if(n=ht.camelCase(i),r=t[n],s=e[i],ht.isArray(s)&&(r=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),o=ht.cssHooks[n],o&&"expand"in o){s=o.expand(s),delete e[n];for(i in s)i in e||(e[i]=s[i],t[i]=r)}else t[n]=r}function U(e,t,i){var n,r,s,o,a,l,u=this,h={},c=e.style,p=e.nodeType&&L(e),d=ht._data(e,"fxshow");i.queue||(a=ht._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,ht.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===ht.css(e,"display")&&"none"===ht.css(e,"float")&&(ht.support.inlineBlockNeedsLayout&&"inline"!==k(e.nodeName)?c.zoom=1:c.display="inline-block")),i.overflow&&(c.overflow="hidden",ht.support.shrinkWrapBlocks||u.always(function(){c.overflow=i.overflow[0],c.overflowX=i.overflow[1],c.overflowY=i.overflow[2]}));for(n in t)if(r=t[n],en.exec(r)){if(delete t[n],s=s||"toggle"===r,r===(p?"hide":"show"))continue;h[n]=d&&d[n]||ht.style(e,n)}if(!ht.isEmptyObject(h)){d?"hidden"in d&&(p=d.hidden):d=ht._data(e,"fxshow",{}),s&&(d.hidden=!p),p?ht(e).show():u.done(function(){ht(e).hide()}),u.done(function(){var t;ht._removeData(e,"fxshow");for(t in h)ht.style(e,t,h[t])});for(n in h)o=z(p?d[n]:0,n,u),n in d||(d[n]=o.start,p&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function H(e,t,i,n,r){return new H.prototype.init(e,t,i,n,r)}function $(e,t){var i,n={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)i=Li[r],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function G(e){return ht.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var W,V,X=typeof t,Z=e.location,Y=e.document,K=Y.documentElement,J=e.jQuery,Q=e.$,et={},tt=[],it="1.10.2",nt=tt.concat,rt=tt.push,st=tt.slice,ot=tt.indexOf,at=et.toString,lt=et.hasOwnProperty,ut=it.trim,ht=function(e,t){return new ht.fn.init(e,t,V)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,pt=/\S+/g,dt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ft=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,mt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,gt=/^[\],:{}\s]*$/,yt=/(?:^|:|,)(?:\s*\[)+/g,vt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,_t=/^-ms-/,wt=/-([\da-z])/gi,xt=function(e,t){return t.toUpperCase()},Lt=function(e){(Y.addEventListener||"load"===e.type||"complete"===Y.readyState)&&(Ot(),ht.ready())},Ot=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",Lt,!1),e.removeEventListener("load",Lt,!1)):(Y.detachEvent("onreadystatechange",Lt),e.detachEvent("onload",Lt))};ht.fn=ht.prototype={jquery:it,constructor:ht,init:function(e,i,n){var r,s;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ft.exec(e),!r||!r[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(r[1]){if(i=i instanceof ht?i[0]:i,ht.merge(this,ht.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),mt.test(r[1])&&ht.isPlainObject(i))for(r in i)ht.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}if(s=Y.getElementById(r[2]),s&&s.parentNode){if(s.id!==r[2])return n.find(e);this.length=1,this[0]=s}return this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ht.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ht.makeArray(e,this))},selector:"",length:0,toArray:function(){return st.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ht.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ht.each(this,e,t)},ready:function(e){return ht.ready.promise().done(e),this},slice:function(){return this.pushStack(st.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(ht.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:rt,sort:[].sort,splice:[].splice},ht.fn.init.prototype=ht.fn,ht.extend=ht.fn.extend=function(){var e,i,n,r,s,o,a=arguments[0]||{},l=1,u=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[1]||{},l=2),"object"==typeof a||ht.isFunction(a)||(a={}),u===l&&(a=this,--l);u>l;l++)if(null!=(s=arguments[l]))for(r in s)e=a[r],n=s[r],a!==n&&(h&&n&&(ht.isPlainObject(n)||(i=ht.isArray(n)))?(i?(i=!1,o=e&&ht.isArray(e)?e:[]):o=e&&ht.isPlainObject(e)?e:{},a[r]=ht.extend(h,o,n)):n!==t&&(a[r]=n));return a},ht.extend({expando:"jQuery"+(it+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ht&&(e.$=Q),t&&e.jQuery===ht&&(e.jQuery=J),ht},isReady:!1,readyWait:1,holdReady:function(e){e?ht.readyWait++:ht.ready(!0)},ready:function(e){if(e===!0?!--ht.readyWait:!ht.isReady){if(!Y.body)return setTimeout(ht.ready);ht.isReady=!0,e!==!0&&--ht.readyWait>0||(W.resolveWith(Y,[ht]),ht.fn.trigger&&ht(Y).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ht.type(e)},isArray:Array.isArray||function(e){return"array"===ht.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?et[at.call(e)]||"object":typeof e},isPlainObject:function(e){var i;if(!e||"object"!==ht.type(e)||e.nodeType||ht.isWindow(e))return!1;try{if(e.constructor&&!lt.call(e,"constructor")&&!lt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(ht.support.ownLast)for(i in e)return lt.call(e,i);for(i in e);return i===t||lt.call(e,i)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Y;var n=mt.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=ht.buildFragment([e],t,r),r&&ht(r).remove(),ht.merge([],n.childNodes))},parseJSON:function(i){return e.JSON&&e.JSON.parse?e.JSON.parse(i):null===i?i:"string"==typeof i&&(i=ht.trim(i),i&&gt.test(i.replace(vt,"@").replace(bt,"]").replace(yt,"")))?Function("return "+i)():(ht.error("Invalid JSON: "+i),t)},parseXML:function(i){var n,r;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(s){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||ht.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&ht.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(_t,"ms-").replace(wt,xt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,s=0,o=e.length,a=i(e);if(n){if(a)for(;o>s&&(r=t.apply(e[s],n),r!==!1);s++);else for(s in e)if(r=t.apply(e[s],n),r===!1)break}else if(a)for(;o>s&&(r=t.call(e[s],s,e[s]),r!==!1);s++);else for(s in e)if(r=t.call(e[s],s,e[s]),r===!1)break;return e},trim:ut&&!ut.call("﻿ ")?function(e){return null==e?"":ut.call(e)}:function(e){return null==e?"":(e+"").replace(dt,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?ht.merge(n,"string"==typeof e?[e]:e):rt.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(ot)return ot.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,r=e.length,s=0;if("number"==typeof n)for(;n>s;s++)e[r++]=i[s];else for(;i[s]!==t;)e[r++]=i[s++];return e.length=r,e},grep:function(e,t,i){var n,r=[],s=0,o=e.length;for(i=!!i;o>s;s++)n=!!t(e[s],s),i!==n&&r.push(e[s]);return r},map:function(e,t,n){var r,s=0,o=e.length,a=i(e),l=[];if(a)for(;o>s;s++)r=t(e[s],s,n),null!=r&&(l[l.length]=r);else for(s in e)r=t(e[s],s,n),null!=r&&(l[l.length]=r);return nt.apply([],l)},guid:1,proxy:function(e,i){var n,r,s;return"string"==typeof i&&(s=e[i],i=e,e=s),ht.isFunction(e)?(n=st.call(arguments,2),r=function(){return e.apply(i||this,n.concat(st.call(arguments)))},r.guid=e.guid=e.guid||ht.guid++,r):t},access:function(e,i,n,r,s,o,a){var l=0,u=e.length,h=null==n;if("object"===ht.type(n)){s=!0;for(l in n)ht.access(e,i,l,n[l],!0,o,a)}else if(r!==t&&(s=!0,ht.isFunction(r)||(a=!0),h&&(a?(i.call(e,r),i=null):(h=i,i=function(e,t,i){return h.call(ht(e),i)})),i))for(;u>l;l++)i(e[l],n,a?r:r.call(e[l],l,i(e[l],n)));return s?e:h?i.call(e):u?i(e[0],n):o},now:function(){return(new Date).getTime()},swap:function(e,t,i,n){var r,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];r=i.apply(e,n||[]);for(s in t)e.style[s]=o[s];return r}}),ht.ready.promise=function(t){if(!W)if(W=ht.Deferred(),"complete"===Y.readyState)setTimeout(ht.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",Lt,!1),e.addEventListener("load",Lt,!1);else{Y.attachEvent("onreadystatechange",Lt),e.attachEvent("onload",Lt);var i=!1;try{i=null==e.frameElement&&Y.documentElement}catch(n){}i&&i.doScroll&&function r(){if(!ht.isReady){try{i.doScroll("left")}catch(e){return setTimeout(r,50)}Ot(),ht.ready()}}()}return W.promise(t)},ht.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){et["[object "+t+"]"]=t.toLowerCase()}),V=ht(Y),function(e,t){function i(e,t,i,n){var r,s,o,a,l,u,h,c,f,m;if((t?t.ownerDocument||t:B)!==N&&q(t),t=t||N,i=i||[],!e||"string"!=typeof e)return i;if(1!==(a=t.nodeType)&&9!==a)return[];if(I&&!n){if(r=bt.exec(e))if(o=r[1]){if(9===a){if(s=t.getElementById(o),!s||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&R(t,s)&&s.id===o)return i.push(s),i}else{if(r[2])return et.apply(i,t.getElementsByTagName(e)),i;if((o=r[3])&&L.getElementsByClassName&&t.getElementsByClassName)return et.apply(i,t.getElementsByClassName(o)),i}if(L.qsa&&(!A||!A.test(e))){if(c=h=z,f=t,m=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(u=p(e),(h=t.getAttribute("id"))?c=h.replace(xt,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",l=u.length;l--;)u[l]=c+d(u[l]);f=dt.test(e)&&t.parentNode||t,m=u.join(",")}if(m)try{return et.apply(i,f.querySelectorAll(m)),i}catch(g){}finally{h||t.removeAttribute("id")}}}return w(e.replace(ut,"$1"),t,i,n)}function n(){function e(i,n){return t.push(i+=" ")>C.cacheLength&&delete e[t.shift()],e[i]=n}var t=[];return e}function r(e){return e[z]=!0,e}function s(e){var t=N.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=e.length;n--;)C.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Z)-(~e.sourceIndex||Z);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function u(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function h(e){return r(function(t){return t=+t,r(function(i,n){for(var r,s=e([],i.length,t),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))})})}function c(){}function p(e,t){var n,r,s,o,a,l,u,h=$[e+" "];if(h)return t?0:h.slice(0);for(a=e,l=[],u=C.preFilter;a;){(!n||(r=ct.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(s=[])),n=!1,(r=pt.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(ut," ")}),a=a.slice(n.length));for(o in C.filter)!(r=yt[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?i.error(e):$(e,l).slice(0)}function d(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function f(e,t,i){var n=t.dir,r=i&&"parentNode"===n,s=U++;return t.first?function(t,i,s){for(;t=t[n];)if(1===t.nodeType||r)return e(t,i,s)}:function(t,i,o){var a,l,u,h=j+" "+s;if(o){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,i,o))return!0}else for(;t=t[n];)if(1===t.nodeType||r)if(u=t[z]||(t[z]={}),(l=u[n])&&l[0]===h){if((a=l[1])===!0||a===O)return a===!0}else if(l=u[n]=[h],l[1]=e(t,i,o)||O,l[1]===!0)return!0}}function m(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function g(e,t,i,n,r){for(var s,o=[],a=0,l=e.length,u=null!=t;l>a;a++)(s=e[a])&&(!i||i(s,n,r))&&(o.push(s),u&&t.push(a));return o}function y(e,t,i,n,s,o){return n&&!n[z]&&(n=y(n)),s&&!s[z]&&(s=y(s,o)),r(function(r,o,a,l){var u,h,c,p=[],d=[],f=o.length,m=r||_(t||"*",a.nodeType?[a]:a,[]),y=!e||!r&&t?m:g(m,p,e,a,l),v=i?s||(r?e:f||n)?[]:o:y;if(i&&i(y,v,a,l),n)for(u=g(v,d),n(u,[],a,l),h=u.length;h--;)(c=u[h])&&(v[d[h]]=!(y[d[h]]=c));if(r){if(s||e){if(s){for(u=[],h=v.length;h--;)(c=v[h])&&u.push(y[h]=c);s(null,v=[],u,l)}for(h=v.length;h--;)(c=v[h])&&(u=s?it.call(r,c):p[h])>-1&&(r[u]=!(o[u]=c))}}else v=g(v===o?v.splice(f,v.length):v),s?s(null,o,v,l):et.apply(o,v)})}function v(e){for(var t,i,n,r=e.length,s=C.relative[e[0].type],o=s||C.relative[" "],a=s?1:0,l=f(function(e){return e===t},o,!0),u=f(function(e){return it.call(t,e)>-1},o,!0),h=[function(e,i,n){return!s&&(n||i!==T)||((t=i).nodeType?l(e,i,n):u(e,i,n))}];r>a;a++)if(i=C.relative[e[a].type])h=[f(m(h),i)];else{if(i=C.filter[e[a].type].apply(null,e[a].matches),i[z]){for(n=++a;r>n&&!C.relative[e[n].type];n++);return y(a>1&&m(h),a>1&&d(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ut,"$1"),i,n>a&&v(e.slice(a,n)),r>n&&v(e=e.slice(n)),r>n&&d(e))}h.push(i)}return m(h)}function b(e,t){var n=0,s=t.length>0,o=e.length>0,a=function(r,a,l,u,h){var c,p,d,f=[],m=0,y="0",v=r&&[],b=null!=h,_=T,w=r||o&&C.find.TAG("*",h&&a.parentNode||a),x=j+=null==_?1:Math.random()||.1;for(b&&(T=a!==N&&a,O=n);null!=(c=w[y]);y++){if(o&&c){for(p=0;d=e[p++];)if(d(c,a,l)){u.push(c);break}b&&(j=x,O=++n)}s&&((c=!d&&c)&&m--,r&&v.push(c))}if(m+=y,s&&y!==m){for(p=0;d=t[p++];)d(v,f,a,l);if(r){if(m>0)for(;y--;)v[y]||f[y]||(f[y]=J.call(u));f=g(f)}et.apply(u,f),b&&!r&&f.length>0&&m+t.length>1&&i.uniqueSort(u)}return b&&(j=x,T=_),v};return s?r(a):a}function _(e,t,n){for(var r=0,s=t.length;s>r;r++)i(e,t[r],n);return n}function w(e,t,i,n){var r,s,o,a,l,u=p(e);if(!n&&1===u.length){if(s=u[0]=u[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&L.getById&&9===t.nodeType&&I&&C.relative[s[1].type]){if(t=(C.find.ID(o.matches[0].replace(Lt,Ot),t)||[])[0],!t)return i;e=e.slice(s.shift().value.length)}for(r=yt.needsContext.test(e)?0:s.length;r--&&(o=s[r],!C.relative[a=o.type]);)if((l=C.find[a])&&(n=l(o.matches[0].replace(Lt,Ot),dt.test(s[0].type)&&t.parentNode||t))){if(s.splice(r,1),e=n.length&&d(s),!e)return et.apply(i,n),i;break}}return k(e,u)(n,t,!I,i,dt.test(e)),i}var x,L,O,C,E,S,k,T,P,q,N,F,I,A,D,M,R,z="sizzle"+-new Date,B=e.document,j=0,U=0,H=n(),$=n(),G=n(),W=!1,V=function(e,t){return e===t?(W=!0,0):0},X=typeof t,Z=1<<31,Y={}.hasOwnProperty,K=[],J=K.pop,Q=K.push,et=K.push,tt=K.slice,it=K.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},nt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",rt="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=st.replace("w","w#"),at="\\["+rt+"*("+st+")"+rt+"*(?:([*^$|!~]?=)"+rt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ot+")|)|)"+rt+"*\\]",lt=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+at.replace(3,8)+")*)|.*)\\)|)",ut=RegExp("^"+rt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+rt+"+$","g"),ct=RegExp("^"+rt+"*,"+rt+"*"),pt=RegExp("^"+rt+"*([>+~]|"+rt+")"+rt+"*"),dt=RegExp(rt+"*[+~]"),ft=RegExp("="+rt+"*([^\\]'\"]*)"+rt+"*\\]","g"),mt=RegExp(lt),gt=RegExp("^"+ot+"$"),yt={ID:RegExp("^#("+st+")"),CLASS:RegExp("^\\.("+st+")"),TAG:RegExp("^("+st.replace("w","w*")+")"),ATTR:RegExp("^"+at),PSEUDO:RegExp("^"+lt),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+rt+"*(even|odd|(([+-]|)(\\d*)n|)"+rt+"*(?:([+-]|)"+rt+"*(\\d+)|))"+rt+"*\\)|)","i"),bool:RegExp("^(?:"+nt+")$","i"),needsContext:RegExp("^"+rt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+rt+"*((?:-\\d)?\\d*)"+rt+"*\\)|)(?=[^-]|$)","i")},vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_t=/^(?:input|select|textarea|button)$/i,wt=/^h\d$/i,xt=/'|\\/g,Lt=RegExp("\\\\([\\da-f]{1,6}"+rt+"?|("+rt+")|.)","ig"),Ot=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{et.apply(K=tt.call(B.childNodes),B.childNodes),K[B.childNodes.length].nodeType}catch(Ct){et={apply:K.length?function(e,t){Q.apply(e,tt.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}S=i.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},L=i.support={},q=i.setDocument=function(e){var i=e?e.ownerDocument||e:B,n=i.defaultView;return i!==N&&9===i.nodeType&&i.documentElement?(N=i,F=i.documentElement,I=!S(i),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){q()}),L.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),L.getElementsByTagName=s(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),L.getElementsByClassName=s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),L.getById=s(function(e){return F.appendChild(e).id=z,!i.getElementsByName||!i.getElementsByName(z).length}),L.getById?(C.find.ID=function(e,t){if(typeof t.getElementById!==X&&I){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(Lt,Ot);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(Lt,Ot);return function(e){var i=typeof e.getAttributeNode!==X&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=L.getElementsByTagName?function(e,i){return typeof i.getElementsByTagName!==X?i.getElementsByTagName(e):t}:function(e,t){var i,n=[],r=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},C.find.CLASS=L.getElementsByClassName&&function(e,i){return typeof i.getElementsByClassName!==X&&I?i.getElementsByClassName(e):t},D=[],A=[],(L.qsa=vt.test(i.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||A.push("\\["+rt+"*(?:value|"+nt+")"),e.querySelectorAll(":checked").length||A.push(":checked")}),s(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&A.push("[*^$]="+rt+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||A.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),A.push(",.*:")})),(L.matchesSelector=vt.test(M=F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&s(function(e){L.disconnectedMatch=M.call(e,"div"),M.call(e,"[s!='']:x"),D.push("!=",lt)}),A=A.length&&RegExp(A.join("|")),D=D.length&&RegExp(D.join("|")),R=vt.test(F.contains)||F.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=F.compareDocumentPosition?function(e,t){if(e===t)return W=!0,0;var n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return n?1&n||!L.sortDetached&&t.compareDocumentPosition(e)===n?e===i||R(B,e)?-1:t===i||R(B,t)?1:P?it.call(P,e)-it.call(P,t):0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var n,r=0,s=e.parentNode,o=t.parentNode,l=[e],u=[t];if(e===t)return W=!0,0;if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:P?it.call(P,e)-it.call(P,t):0;if(s===o)return a(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;l[r]===u[r];)r++;return r?a(l[r],u[r]):l[r]===B?-1:u[r]===B?1:0},i):N},i.matches=function(e,t){return i(e,null,null,t)},i.matchesSelector=function(e,t){if((e.ownerDocument||e)!==N&&q(e),t=t.replace(ft,"='$1']"),!(!L.matchesSelector||!I||D&&D.test(t)||A&&A.test(t)))try{var n=M.call(e,t);if(n||L.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return i(t,N,null,[e]).length>0},i.contains=function(e,t){return(e.ownerDocument||e)!==N&&q(e),R(e,t)},i.attr=function(e,i){(e.ownerDocument||e)!==N&&q(e);var n=C.attrHandle[i.toLowerCase()],r=n&&Y.call(C.attrHandle,i.toLowerCase())?n(e,i,!I):t;return r===t?L.attributes||!I?e.getAttribute(i):(r=e.getAttributeNode(i))&&r.specified?r.value:null:r},i.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},i.uniqueSort=function(e){var t,i=[],n=0,r=0;if(W=!L.detectDuplicates,P=!L.sortStable&&e.slice(0),e.sort(V),W){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return e},E=i.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=E(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n];n++)i+=E(t);return i},C=i.selectors={cacheLength:50,createPseudo:r,match:yt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Lt,Ot),e[3]=(e[4]||e[5]||"").replace(Lt,Ot),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)
},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||i.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&i.error(e[0]),e},PSEUDO:function(e){var i,n=!e[5]&&e[2];return yt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:n&&mt.test(n)&&(i=p(n,!0))&&(i=n.indexOf(")",n.length-i)-n.length)&&(e[0]=e[0].slice(0,i),e[2]=n.slice(0,i)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Lt,Ot).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=RegExp("(^|"+rt+")"+e+"("+rt+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==X&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var s=i.attr(r,e);return null==s?"!="===t:t?(s+="","="===t?s===n:"!="===t?s!==n:"^="===t?n&&0===s.indexOf(n):"*="===t?n&&s.indexOf(n)>-1:"$="===t?n&&s.slice(-n.length)===n:"~="===t?(" "+s+" ").indexOf(n)>-1:"|="===t?s===n||s.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,r){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){var u,h,c,p,d,f,m=s!==o?"nextSibling":"previousSibling",g=t.parentNode,y=a&&t.nodeName.toLowerCase(),v=!l&&!a;if(g){if(s){for(;m;){for(c=t;c=c[m];)if(a?c.nodeName.toLowerCase()===y:1===c.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&v){for(h=g[z]||(g[z]={}),u=h[e]||[],d=u[0]===j&&u[1],p=u[0]===j&&u[2],c=d&&g.childNodes[d];c=++d&&c&&c[m]||(p=d=0)||f.pop();)if(1===c.nodeType&&++p&&c===t){h[e]=[j,d,p];break}}else if(v&&(u=(t[z]||(t[z]={}))[e])&&u[0]===j)p=u[1];else for(;(c=++d&&c&&c[m]||(p=d=0)||f.pop())&&((a?c.nodeName.toLowerCase()!==y:1!==c.nodeType)||!++p||(v&&((c[z]||(c[z]={}))[e]=[j,p]),c!==t)););return p-=r,p===n||0===p%n&&p/n>=0}}},PSEUDO:function(e,t){var n,s=C.pseudos[e]||C.setFilters[e.toLowerCase()]||i.error("unsupported pseudo: "+e);return s[z]?s(t):s.length>1?(n=[e,e,"",t],C.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,i){for(var n,r=s(e,t),o=r.length;o--;)n=it.call(e,r[o]),e[n]=!(i[n]=r[o])}):function(e){return s(e,0,n)}):s}},pseudos:{not:r(function(e){var t=[],i=[],n=k(e.replace(ut,"$1"));return n[z]?r(function(e,t,i,r){for(var s,o=n(e,null,r,[]),a=e.length;a--;)(s=o[a])&&(e[a]=!(t[a]=s))}):function(e,r,s){return t[0]=e,n(t,null,s,i),!i.pop()}}),has:r(function(e){return function(t){return i(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||E(t)).indexOf(e)>-1}}),lang:r(function(e){return gt.test(e||"")||i.error("unsupported lang: "+e),e=e.replace(Lt,Ot).toLowerCase(),function(t){var i;do if(i=I?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===F},focus:function(e){return e===N.activeElement&&(!N.hasFocus||N.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return wt.test(e.nodeName)},input:function(e){return _t.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:h(function(){return[0]}),last:h(function(e,t){return[t-1]}),eq:h(function(e,t,i){return[0>i?i+t:i]}),even:h(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:h(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:h(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:h(function(e,t,i){for(var n=0>i?i+t:i;t>++n;)e.push(n);return e})}},C.pseudos.nth=C.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[x]=l(x);for(x in{submit:!0,reset:!0})C.pseudos[x]=u(x);c.prototype=C.filters=C.pseudos,C.setFilters=new c,k=i.compile=function(e,t){var i,n=[],r=[],s=G[e+" "];if(!s){for(t||(t=p(e)),i=t.length;i--;)s=v(t[i]),s[z]?n.push(s):r.push(s);s=G(e,b(r,n))}return s},L.sortStable=z.split("").sort(V).join("")===z,L.detectDuplicates=W,q(),L.sortDetached=s(function(e){return 1&e.compareDocumentPosition(N.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,i,n){return n?t:e.getAttribute(i,"type"===i.toLowerCase()?1:2)}),L.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,i,n){return n||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(nt,function(e,i,n){var r;return n?t:(r=e.getAttributeNode(i))&&r.specified?r.value:e[i]===!0?i.toLowerCase():null}),ht.find=i,ht.expr=i.selectors,ht.expr[":"]=ht.expr.pseudos,ht.unique=i.uniqueSort,ht.text=i.getText,ht.isXMLDoc=i.isXML,ht.contains=i.contains}(e);var Ct={};ht.Callbacks=function(e){e="string"==typeof e?Ct[e]||n(e):ht.extend({},e);var i,r,s,o,a,l,u=[],h=!e.once&&[],c=function(t){for(r=e.memory&&t,s=!0,a=l||0,l=0,o=u.length,i=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}i=!1,u&&(h?h.length&&c(h.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function n(t){ht.each(t,function(t,i){var r=ht.type(i);"function"===r?e.unique&&p.has(i)||u.push(i):i&&i.length&&"string"!==r&&n(i)})})(arguments),i?o=u.length:r&&(l=t,c(r))}return this},remove:function(){return u&&ht.each(arguments,function(e,t){for(var n;(n=ht.inArray(t,u,n))>-1;)u.splice(n,1),i&&(o>=n&&o--,a>=n&&a--)}),this},has:function(e){return e?ht.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],o=0,this},disable:function(){return u=h=r=t,this},disabled:function(){return!u},lock:function(){return h=t,r||p.disable(),this},locked:function(){return!h},fireWith:function(e,t){return!u||s&&!h||(t=t||[],t=[e,t.slice?t.slice():t],i?h.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!s}};return p},ht.extend({Deferred:function(e){var t=[["resolve","done",ht.Callbacks("once memory"),"resolved"],["reject","fail",ht.Callbacks("once memory"),"rejected"],["notify","progress",ht.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ht.Deferred(function(i){ht.each(t,function(t,s){var o=s[0],a=ht.isFunction(e[t])&&e[t];r[s[1]](function(){var e=a&&a.apply(this,arguments);e&&ht.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ht.extend(e,n):n}},r={};return n.pipe=n.then,ht.each(t,function(e,s){var o=s[2],a=s[3];n[s[1]]=o.add,a&&o.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),r[s[0]]=function(){return r[s[0]+"With"](this===r?n:this,arguments),this},r[s[0]+"With"]=o.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,i,n,r=0,s=st.call(arguments),o=s.length,a=1!==o||e&&ht.isFunction(e.promise)?o:0,l=1===a?e:ht.Deferred(),u=function(e,i,n){return function(r){i[e]=this,n[e]=arguments.length>1?st.call(arguments):r,n===t?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(t=Array(o),i=Array(o),n=Array(o);o>r;r++)s[r]&&ht.isFunction(s[r].promise)?s[r].promise().done(u(r,n,s)).fail(l.reject).progress(u(r,i,t)):--a;return a||l.resolveWith(n,s),l.promise()}}),ht.support=function(t){var i,n,r,s,o,a,l,u,h,c=Y.createElement("div");if(c.setAttribute("className","t"),c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=c.getElementsByTagName("*")||[],n=c.getElementsByTagName("a")[0],!n||!n.style||!i.length)return t;s=Y.createElement("select"),a=s.appendChild(Y.createElement("option")),r=c.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==c.className,t.leadingWhitespace=3===c.firstChild.nodeType,t.tbody=!c.getElementsByTagName("tbody").length,t.htmlSerialize=!!c.getElementsByTagName("link").length,t.style=/top/.test(n.getAttribute("style")),t.hrefNormalized="/a"===n.getAttribute("href"),t.opacity=/^0.5/.test(n.style.opacity),t.cssFloat=!!n.style.cssFloat,t.checkOn=!!r.value,t.optSelected=a.selected,t.enctype=!!Y.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,r.checked=!0,t.noCloneChecked=r.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled;try{delete c.test}catch(p){t.deleteExpando=!1}r=Y.createElement("input"),r.setAttribute("value",""),t.input=""===r.getAttribute("value"),r.value="t",r.setAttribute("type","radio"),t.radioValue="t"===r.value,r.setAttribute("checked","t"),r.setAttribute("name","t"),o=Y.createDocumentFragment(),o.appendChild(r),t.appendChecked=r.checked,t.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,c.attachEvent&&(c.attachEvent("onclick",function(){t.noCloneEvent=!1}),c.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})c.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||c.attributes[l].expando===!1;c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===c.style.backgroundClip;for(h in ht(t))break;return t.ownLast="0"!==h,ht(function(){var i,n,r,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=Y.getElementsByTagName("body")[0];o&&(i=Y.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(c),c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=c.getElementsByTagName("td"),r[0].style.cssText="padding:0;margin:0;border:0;display:none",u=0===r[0].offsetHeight,r[0].style.display="",r[1].style.display="none",t.reliableHiddenOffsets=u&&0===r[0].offsetHeight,c.innerHTML="",c.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ht.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===c.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(c,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(c,null)||{width:"4px"}).width,n=c.appendChild(Y.createElement("div")),n.style.cssText=c.style.cssText=s,n.style.marginRight=n.style.width="0",c.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof c.style.zoom!==X&&(c.innerHTML="",c.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===c.offsetWidth,c.style.display="block",c.innerHTML="<div></div>",c.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==c.offsetWidth,t.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(i),i=c=r=n=null)}),i=s=o=a=n=r=null,t}({});var Et=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,St=/([A-Z])/g;ht.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ht.cache[e[ht.expando]]:e[ht.expando],!!e&&!a(e)},data:function(e,t,i){return r(e,t,i)},removeData:function(e,t){return s(e,t)},_data:function(e,t,i){return r(e,t,i,!0)},_removeData:function(e,t){return s(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ht.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ht.fn.extend({data:function(e,i){var n,r,s=null,a=0,l=this[0];if(e===t){if(this.length&&(s=ht.data(l),1===l.nodeType&&!ht._data(l,"parsedAttrs"))){for(n=l.attributes;n.length>a;a++)r=n[a].name,0===r.indexOf("data-")&&(r=ht.camelCase(r.slice(5)),o(l,r,s[r]));ht._data(l,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){ht.data(this,e)}):arguments.length>1?this.each(function(){ht.data(this,e,i)}):l?o(l,e,ht.data(l,e)):null},removeData:function(e){return this.each(function(){ht.removeData(this,e)})}}),ht.extend({queue:function(e,i,n){var r;return e?(i=(i||"fx")+"queue",r=ht._data(e,i),n&&(!r||ht.isArray(n)?r=ht._data(e,i,ht.makeArray(n)):r.push(n)),r||[]):t},dequeue:function(e,t){t=t||"fx";var i=ht.queue(e,t),n=i.length,r=i.shift(),s=ht._queueHooks(e,t),o=function(){ht.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete s.stop,r.call(e,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ht._data(e,i)||ht._data(e,i,{empty:ht.Callbacks("once memory").add(function(){ht._removeData(e,t+"queue"),ht._removeData(e,i)})})}}),ht.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),n>arguments.length?ht.queue(this[0],e):i===t?this:this.each(function(){var t=ht.queue(this,e,i);ht._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ht.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ht.dequeue(this,e)})},delay:function(e,t){return e=ht.fx?ht.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,r=1,s=ht.Deferred(),o=this,a=this.length,l=function(){--r||s.resolveWith(o,[o])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";a--;)n=ht._data(o[a],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(l));return l(),s.promise(i)}});var kt,Tt,Pt=/[\t\r\n\f]/g,qt=/\r/g,Nt=/^(?:input|select|textarea|button|object)$/i,Ft=/^(?:a|area)$/i,It=/^(?:checked|selected)$/i,At=ht.support.getSetAttribute,Dt=ht.support.input;ht.fn.extend({attr:function(e,t){return ht.access(this,ht.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ht.removeAttr(this,e)})},prop:function(e,t){return ht.access(this,ht.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ht.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,r,s,o=0,a=this.length,l="string"==typeof e&&e;if(ht.isFunction(e))return this.each(function(t){ht(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(pt)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Pt," "):" ")){for(s=0;r=t[s++];)0>n.indexOf(" "+r+" ")&&(n+=r+" ");i.className=ht.trim(n)}return this},removeClass:function(e){var t,i,n,r,s,o=0,a=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ht.isFunction(e))return this.each(function(t){ht(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(pt)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Pt," "):"")){for(s=0;r=t[s++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=e?ht.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ht.isFunction(e)?this.each(function(i){ht(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,n=0,r=ht(this),s=e.match(pt)||[];t=s[n++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(i===X||"boolean"===i)&&(this.className&&ht._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ht._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Pt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,r,s=this[0];return arguments.length?(r=ht.isFunction(e),this.each(function(i){var s;1===this.nodeType&&(s=r?e.call(this,i,ht(this).val()):e,null==s?s="":"number"==typeof s?s+="":ht.isArray(s)&&(s=ht.map(s,function(e){return null==e?"":e+""})),n=ht.valHooks[this.type]||ht.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,s,"value")!==t||(this.value=s))})):s?(n=ht.valHooks[s.type]||ht.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(s,"value"))!==t?i:(i=s.value,"string"==typeof i?i.replace(qt,""):null==i?"":i)):void 0}}),ht.extend({valHooks:{option:{get:function(e){var t=ht.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,s="select-one"===e.type||0>r,o=s?null:[],a=s?r+1:n.length,l=0>r?a:s?r:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==r||(ht.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ht.nodeName(i.parentNode,"optgroup"))){if(t=ht(i).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var i,n,r=e.options,s=ht.makeArray(t),o=r.length;o--;)n=r[o],(n.selected=ht.inArray(ht(n).val(),s)>=0)&&(i=!0);return i||(e.selectedIndex=-1),s}}},attr:function(e,i,n){var r,s,o=e.nodeType;return e&&3!==o&&8!==o&&2!==o?typeof e.getAttribute===X?ht.prop(e,i,n):(1===o&&ht.isXMLDoc(e)||(i=i.toLowerCase(),r=ht.attrHooks[i]||(ht.expr.match.bool.test(i)?Tt:kt)),n===t?r&&"get"in r&&null!==(s=r.get(e,i))?s:(s=ht.find.attr(e,i),null==s?t:s):null!==n?r&&"set"in r&&(s=r.set(e,n,i))!==t?s:(e.setAttribute(i,n+""),n):(ht.removeAttr(e,i),t)):void 0},removeAttr:function(e,t){var i,n,r=0,s=t&&t.match(pt);if(s&&1===e.nodeType)for(;i=s[r++];)n=ht.propFix[i]||i,ht.expr.match.bool.test(i)?Dt&&At||!It.test(i)?e[n]=!1:e[ht.camelCase("default-"+i)]=e[n]=!1:ht.attr(e,i,""),e.removeAttribute(At?i:n)},attrHooks:{type:{set:function(e,t){if(!ht.support.radioValue&&"radio"===t&&ht.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,n){var r,s,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(o=1!==a||!ht.isXMLDoc(e),o&&(i=ht.propFix[i]||i,s=ht.propHooks[i]),n!==t?s&&"set"in s&&(r=s.set(e,n,i))!==t?r:e[i]=n:s&&"get"in s&&null!==(r=s.get(e,i))?r:e[i]):void 0},propHooks:{tabIndex:{get:function(e){var t=ht.find.attr(e,"tabindex");return t?parseInt(t,10):Nt.test(e.nodeName)||Ft.test(e.nodeName)&&e.href?0:-1}}}}),Tt={set:function(e,t,i){return t===!1?ht.removeAttr(e,i):Dt&&At||!It.test(i)?e.setAttribute(!At&&ht.propFix[i]||i,i):e[ht.camelCase("default-"+i)]=e[i]=!0,i}},ht.each(ht.expr.match.bool.source.match(/\w+/g),function(e,i){var n=ht.expr.attrHandle[i]||ht.find.attr;ht.expr.attrHandle[i]=Dt&&At||!It.test(i)?function(e,i,r){var s=ht.expr.attrHandle[i],o=r?t:(ht.expr.attrHandle[i]=t)!=n(e,i,r)?i.toLowerCase():null;return ht.expr.attrHandle[i]=s,o}:function(e,i,n){return n?t:e[ht.camelCase("default-"+i)]?i.toLowerCase():null}}),Dt&&At||(ht.attrHooks.value={set:function(e,i,n){return ht.nodeName(e,"input")?(e.defaultValue=i,t):kt&&kt.set(e,i,n)}}),At||(kt={set:function(e,i,n){var r=e.getAttributeNode(n);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},ht.expr.attrHandle.id=ht.expr.attrHandle.name=ht.expr.attrHandle.coords=function(e,i,n){var r;return n?t:(r=e.getAttributeNode(i))&&""!==r.value?r.value:null},ht.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&n.specified?n.value:t},set:kt.set},ht.attrHooks.contenteditable={set:function(e,t,i){kt.set(e,""===t?!1:t,i)}},ht.each(["width","height"],function(e,i){ht.attrHooks[i]={set:function(e,n){return""===n?(e.setAttribute(i,"auto"),n):t}}})),ht.support.hrefNormalized||ht.each(["href","src"],function(e,t){ht.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ht.support.style||(ht.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),ht.support.optSelected||(ht.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ht.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ht.propFix[this.toLowerCase()]=this}),ht.support.enctype||(ht.propFix.enctype="encoding"),ht.each(["radio","checkbox"],function(){ht.valHooks[this]={set:function(e,i){return ht.isArray(i)?e.checked=ht.inArray(ht(e).val(),i)>=0:t}},ht.support.checkOn||(ht.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Mt=/^(?:input|select|textarea)$/i,Rt=/^key/,zt=/^(?:mouse|contextmenu)|click/,Bt=/^(?:focusinfocus|focusoutblur)$/,jt=/^([^.]*)(?:\.(.+)|)$/;ht.event={global:{},add:function(e,i,n,r,s){var o,a,l,u,h,c,p,d,f,m,g,y=ht._data(e);if(y){for(n.handler&&(u=n,n=u.handler,s=u.selector),n.guid||(n.guid=ht.guid++),(a=y.events)||(a=y.events={}),(c=y.handle)||(c=y.handle=function(e){return typeof ht===X||e&&ht.event.triggered===e.type?t:ht.event.dispatch.apply(c.elem,arguments)},c.elem=e),i=(i||"").match(pt)||[""],l=i.length;l--;)o=jt.exec(i[l])||[],f=g=o[1],m=(o[2]||"").split(".").sort(),f&&(h=ht.event.special[f]||{},f=(s?h.delegateType:h.bindType)||f,h=ht.event.special[f]||{},p=ht.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:s,needsContext:s&&ht.expr.match.needsContext.test(s),namespace:m.join(".")},u),(d=a[f])||(d=a[f]=[],d.delegateCount=0,h.setup&&h.setup.call(e,r,m,c)!==!1||(e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c))),h.add&&(h.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),s?d.splice(d.delegateCount++,0,p):d.push(p),ht.event.global[f]=!0);e=null}},remove:function(e,t,i,n,r){var s,o,a,l,u,h,c,p,d,f,m,g=ht.hasData(e)&&ht._data(e);if(g&&(h=g.events)){for(t=(t||"").match(pt)||[""],u=t.length;u--;)if(a=jt.exec(t[u])||[],d=m=a[1],f=(a[2]||"").split(".").sort(),d){for(c=ht.event.special[d]||{},d=(n?c.delegateType:c.bindType)||d,p=h[d]||[],a=a[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=p.length;s--;)o=p[s],!r&&m!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(p.splice(s,1),o.selector&&p.delegateCount--,c.remove&&c.remove.call(e,o));l&&!p.length&&(c.teardown&&c.teardown.call(e,f,g.handle)!==!1||ht.removeEvent(e,d,g.handle),delete h[d])}else for(d in h)ht.event.remove(e,d+t[u],i,n,!0);ht.isEmptyObject(h)&&(delete g.handle,ht._removeData(e,"events"))}},trigger:function(i,n,r,s){var o,a,l,u,h,c,p,d=[r||Y],f=lt.call(i,"type")?i.type:i,m=lt.call(i,"namespace")?i.namespace.split("."):[];if(l=c=r=r||Y,3!==r.nodeType&&8!==r.nodeType&&!Bt.test(f+ht.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),a=0>f.indexOf(":")&&"on"+f,i=i[ht.expando]?i:new ht.Event(f,"object"==typeof i&&i),i.isTrigger=s?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=r),n=null==n?[i]:ht.makeArray(n,[i]),h=ht.event.special[f]||{},s||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!s&&!h.noBubble&&!ht.isWindow(r)){for(u=h.delegateType||f,Bt.test(u+f)||(l=l.parentNode);l;l=l.parentNode)d.push(l),c=l;c===(r.ownerDocument||Y)&&d.push(c.defaultView||c.parentWindow||e)}for(p=0;(l=d[p++])&&!i.isPropagationStopped();)i.type=p>1?u:h.bindType||f,o=(ht._data(l,"events")||{})[i.type]&&ht._data(l,"handle"),o&&o.apply(l,n),o=a&&l[a],o&&ht.acceptData(l)&&o.apply&&o.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!s&&!i.isDefaultPrevented()&&(!h._default||h._default.apply(d.pop(),n)===!1)&&ht.acceptData(r)&&a&&r[f]&&!ht.isWindow(r)){c=r[a],c&&(r[a]=null),ht.event.triggered=f;try{r[f]()}catch(g){}ht.event.triggered=t,c&&(r[a]=c)}return i.result}},dispatch:function(e){e=ht.event.fix(e);var i,n,r,s,o,a=[],l=st.call(arguments),u=(ht._data(this,"events")||{})[e.type]||[],h=ht.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,e)!==!1){for(a=ht.event.handlers.call(this,e,u),i=0;(s=a[i++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,o=0;(r=s.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,n=((ht.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,r,s,o,a=[],l=i.delegateCount,u=e.target;if(l&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(s=[],o=0;l>o;o++)r=i[o],n=r.selector+" ",s[n]===t&&(s[n]=r.needsContext?ht(n,this).index(u)>=0:ht.find(n,this,null,[u]).length),s[n]&&s.push(r);s.length&&a.push({elem:u,handlers:s})}return i.length>l&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(e){if(e[ht.expando])return e;var t,i,n,r=e.type,s=e,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=zt.test(r)?this.mouseHooks:Rt.test(r)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new ht.Event(s),t=n.length;t--;)i=n[t],e[i]=s[i];return e.target||(e.target=s.srcElement||Y),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,r,s,o=i.button,a=i.fromElement;return null==e.pageX&&null!=i.clientX&&(r=e.target.ownerDocument||Y,s=r.documentElement,n=r.body,e.pageX=i.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?i.toElement:a),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return ht.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return ht.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=ht.extend(new ht.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ht.event.trigger(r,null,t):ht.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},ht.removeEvent=Y.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===X&&(e[n]=null),e.detachEvent(n,i))},ht.Event=function(e,i){return this instanceof ht.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:u):this.type=e,i&&ht.extend(this,i),this.timeStamp=e&&e.timeStamp||ht.now(),this[ht.expando]=!0,t):new ht.Event(e,i)},ht.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ht.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ht.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,s=e.handleObj;return(!r||r!==n&&!ht.contains(n,r))&&(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}}),ht.support.submitBubbles||(ht.event.special.submit={setup:function(){return ht.nodeName(this,"form")?!1:(ht.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=ht.nodeName(i,"input")||ht.nodeName(i,"button")?i.form:t;n&&!ht._data(n,"submitBubbles")&&(ht.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),ht._data(n,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ht.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ht.nodeName(this,"form")?!1:(ht.event.remove(this,"._submit"),t)}}),ht.support.changeBubbles||(ht.event.special.change={setup:function(){return Mt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ht.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ht.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ht.event.simulate("change",this,e,!0)})),!1):(ht.event.add(this,"beforeactivate._change",function(e){var t=e.target;Mt.test(t.nodeName)&&!ht._data(t,"changeBubbles")&&(ht.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ht.event.simulate("change",this.parentNode,e,!0)}),ht._data(t,"changeBubbles",!0))}),t)},handle:function(e){var i=e.target;return this!==i||e.isSimulated||e.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return ht.event.remove(this,"._change"),!Mt.test(this.nodeName)}}),ht.support.focusinBubbles||ht.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){ht.event.simulate(t,e.target,ht.event.fix(e),!0)};ht.event.special[t]={setup:function(){0===i++&&Y.addEventListener(e,n,!0)},teardown:function(){0===--i&&Y.removeEventListener(e,n,!0)}}}),ht.fn.extend({on:function(e,i,n,r,s){var o,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(o in e)this.on(o,i,n,e[o],s);return this}if(null==n&&null==r?(r=i,n=i=t):null==r&&("string"==typeof i?(r=n,n=t):(r=n,n=i,i=t)),r===!1)r=u;else if(!r)return this;return 1===s&&(a=r,r=function(e){return ht().off(e),a.apply(this,arguments)},r.guid=a.guid||(a.guid=ht.guid++)),this.each(function(){ht.event.add(this,e,r,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var r,s;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ht(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(s in e)this.off(s,i,e[s]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=u),this.each(function(){ht.event.remove(this,e,n,i)})},trigger:function(e,t){return this.each(function(){ht.event.trigger(e,t,this)})},triggerHandler:function(e,i){var n=this[0];return n?ht.event.trigger(e,i,n,!0):t}});var Ut=/^.[^:#\[\.,]*$/,Ht=/^(?:parents|prev(?:Until|All))/,$t=ht.expr.match.needsContext,Gt={children:!0,contents:!0,next:!0,prev:!0};ht.fn.extend({find:function(e){var t,i=[],n=this,r=n.length;if("string"!=typeof e)return this.pushStack(ht(e).filter(function(){for(t=0;r>t;t++)if(ht.contains(n[t],this))return!0}));for(t=0;r>t;t++)ht.find(e,n[t],i);return i=this.pushStack(r>1?ht.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i
},has:function(e){var t,i=ht(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(ht.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(p(this,e||[],!0))},filter:function(e){return this.pushStack(p(this,e||[],!1))},is:function(e){return!!p(this,"string"==typeof e&&$t.test(e)?ht(e):e||[],!1).length},closest:function(e,t){for(var i,n=0,r=this.length,s=[],o=$t.test(e)||"string"!=typeof e?ht(e,t||this.context):0;r>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(11>i.nodeType&&(o?o.index(i)>-1:1===i.nodeType&&ht.find.matchesSelector(i,e))){i=s.push(i);break}return this.pushStack(s.length>1?ht.unique(s):s)},index:function(e){return e?"string"==typeof e?ht.inArray(this[0],ht(e)):ht.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ht(e,t):ht.makeArray(e&&e.nodeType?[e]:e),n=ht.merge(this.get(),i);return this.pushStack(ht.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ht.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ht.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ht.dir(e,"parentNode",i)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return ht.dir(e,"nextSibling")},prevAll:function(e){return ht.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ht.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ht.dir(e,"previousSibling",i)},siblings:function(e){return ht.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ht.sibling(e.firstChild)},contents:function(e){return ht.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ht.merge([],e.childNodes)}},function(e,t){ht.fn[e]=function(i,n){var r=ht.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=ht.filter(n,r)),this.length>1&&(Gt[e]||(r=ht.unique(r)),Ht.test(e)&&(r=r.reverse())),this.pushStack(r)}}),ht.extend({filter:function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ht.find.matchesSelector(n,e)?[n]:[]:ht.find.matches(e,ht.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,i,n){for(var r=[],s=e[i];s&&9!==s.nodeType&&(n===t||1!==s.nodeType||!ht(s).is(n));)1===s.nodeType&&r.push(s),s=s[i];return r},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Wt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Vt=/ jQuery\d+="(?:null|\d+)"/g,Xt=RegExp("<(?:"+Wt+")[\\s/>]","i"),Zt=/^\s+/,Yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Kt=/<([\w:]+)/,Jt=/<tbody/i,Qt=/<|&#?\w+;/,ei=/<(?:script|style|link)/i,ti=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,ni=/^$|\/(?:java|ecma)script/i,ri=/^true\/(.*)/,si=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,oi={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ht.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ai=d(Y),li=ai.appendChild(Y.createElement("div"));oi.optgroup=oi.option,oi.tbody=oi.tfoot=oi.colgroup=oi.caption=oi.thead,oi.th=oi.td,ht.fn.extend({text:function(e){return ht.access(this,function(e){return e===t?ht.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?ht.filter(e,this):this,r=0;null!=(i=n[r]);r++)t||1!==i.nodeType||ht.cleanData(_(i)),i.parentNode&&(t&&ht.contains(i.ownerDocument,i)&&y(_(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ht.cleanData(_(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ht.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ht.clone(this,e,t)})},html:function(e){return ht.access(this,function(e){var i=this[0]||{},n=0,r=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Vt,""):t;if(!("string"!=typeof e||ei.test(e)||!ht.support.htmlSerialize&&Xt.test(e)||!ht.support.leadingWhitespace&&Zt.test(e)||oi[(Kt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Yt,"<$1></$2>");try{for(;r>n;n++)i=this[n]||{},1===i.nodeType&&(ht.cleanData(_(i,!1)),i.innerHTML=e);i=0}catch(s){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ht.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(i){var n=e[t++],r=e[t++];r&&(n&&n.parentNode!==r&&(n=this.nextSibling),ht(this).remove(),r.insertBefore(i,n))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,i){e=nt.apply([],e);var n,r,s,o,a,l,u=0,h=this.length,c=this,p=h-1,d=e[0],f=ht.isFunction(d);if(f||!(1>=h||"string"!=typeof d||ht.support.checkClone)&&ii.test(d))return this.each(function(n){var r=c.eq(n);f&&(e[0]=d.call(this,n,r.html())),r.domManip(e,t,i)});if(h&&(l=ht.buildFragment(e,this[0].ownerDocument,!1,!i&&this),n=l.firstChild,1===l.childNodes.length&&(l=n),n)){for(o=ht.map(_(l,"script"),m),s=o.length;h>u;u++)r=l,u!==p&&(r=ht.clone(r,!0,!0),s&&ht.merge(o,_(r,"script"))),t.call(this[u],r,u);if(s)for(a=o[o.length-1].ownerDocument,ht.map(o,g),u=0;s>u;u++)r=o[u],ni.test(r.type||"")&&!ht._data(r,"globalEval")&&ht.contains(a,r)&&(r.src?ht._evalUrl(r.src):ht.globalEval((r.text||r.textContent||r.innerHTML||"").replace(si,"")));l=n=null}return this}}),ht.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ht.fn[e]=function(e){for(var i,n=0,r=[],s=ht(e),o=s.length-1;o>=n;n++)i=n===o?this:this.clone(!0),ht(s[n])[t](i),rt.apply(r,i.get());return this.pushStack(r)}}),ht.extend({clone:function(e,t,i){var n,r,s,o,a,l=ht.contains(e.ownerDocument,e);if(ht.support.html5Clone||ht.isXMLDoc(e)||!Xt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(li.innerHTML=e.outerHTML,li.removeChild(s=li.firstChild)),!(ht.support.noCloneEvent&&ht.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ht.isXMLDoc(e)))for(n=_(s),a=_(e),o=0;null!=(r=a[o]);++o)n[o]&&b(r,n[o]);if(t)if(i)for(a=a||_(e),n=n||_(s),o=0;null!=(r=a[o]);o++)v(r,n[o]);else v(e,s);return n=_(s,"script"),n.length>0&&y(n,!l&&_(e,"script")),n=a=r=null,s},buildFragment:function(e,t,i,n){for(var r,s,o,a,l,u,h,c=e.length,p=d(t),f=[],m=0;c>m;m++)if(s=e[m],s||0===s)if("object"===ht.type(s))ht.merge(f,s.nodeType?[s]:s);else if(Qt.test(s)){for(a=a||p.appendChild(t.createElement("div")),l=(Kt.exec(s)||["",""])[1].toLowerCase(),h=oi[l]||oi._default,a.innerHTML=h[1]+s.replace(Yt,"<$1></$2>")+h[2],r=h[0];r--;)a=a.lastChild;if(!ht.support.leadingWhitespace&&Zt.test(s)&&f.push(t.createTextNode(Zt.exec(s)[0])),!ht.support.tbody)for(s="table"!==l||Jt.test(s)?"<table>"!==h[1]||Jt.test(s)?0:a:a.firstChild,r=s&&s.childNodes.length;r--;)ht.nodeName(u=s.childNodes[r],"tbody")&&!u.childNodes.length&&s.removeChild(u);for(ht.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=p.lastChild}else f.push(t.createTextNode(s));for(a&&p.removeChild(a),ht.support.appendChecked||ht.grep(_(f,"input"),w),m=0;s=f[m++];)if((!n||-1===ht.inArray(s,n))&&(o=ht.contains(s.ownerDocument,s),a=_(p.appendChild(s),"script"),o&&y(a),i))for(r=0;s=a[r++];)ni.test(s.type||"")&&i.push(s);return a=null,p},cleanData:function(e,t){for(var i,n,r,s,o=0,a=ht.expando,l=ht.cache,u=ht.support.deleteExpando,h=ht.event.special;null!=(i=e[o]);o++)if((t||ht.acceptData(i))&&(r=i[a],s=r&&l[r])){if(s.events)for(n in s.events)h[n]?ht.event.remove(i,n):ht.removeEvent(i,n,s.handle);l[r]&&(delete l[r],u?delete i[a]:typeof i.removeAttribute!==X?i.removeAttribute(a):i[a]=null,tt.push(r))}},_evalUrl:function(e){return ht.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ht.fn.extend({wrapAll:function(e){if(ht.isFunction(e))return this.each(function(t){ht(this).wrapAll(e.call(this,t))});if(this[0]){var t=ht(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ht.isFunction(e)?this.each(function(t){ht(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ht(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ht.isFunction(e);return this.each(function(i){ht(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ht.nodeName(this,"body")||ht(this).replaceWith(this.childNodes)}).end()}});var ui,hi,ci,pi=/alpha\([^)]*\)/i,di=/opacity\s*=\s*([^)]*)/,fi=/^(top|right|bottom|left)$/,mi=/^(none|table(?!-c[ea]).+)/,gi=/^margin/,yi=RegExp("^("+ct+")(.*)$","i"),vi=RegExp("^("+ct+")(?!px)[a-z%]+$","i"),bi=RegExp("^([+-])=("+ct+")","i"),_i={BODY:"block"},wi={position:"absolute",visibility:"hidden",display:"block"},xi={letterSpacing:0,fontWeight:400},Li=["Top","Right","Bottom","Left"],Oi=["Webkit","O","Moz","ms"];ht.fn.extend({css:function(e,i){return ht.access(this,function(e,i,n){var r,s,o={},a=0;if(ht.isArray(i)){for(s=hi(e),r=i.length;r>a;a++)o[i[a]]=ht.css(e,i[a],!1,s);return o}return n!==t?ht.style(e,i,n):ht.css(e,i)},e,i,arguments.length>1)},show:function(){return O(this,!0)},hide:function(){return O(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){L(this)?ht(this).show():ht(this).hide()})}}),ht.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ci(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ht.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,a,l=ht.camelCase(i),u=e.style;if(i=ht.cssProps[l]||(ht.cssProps[l]=x(u,l)),a=ht.cssHooks[i]||ht.cssHooks[l],n===t)return a&&"get"in a&&(s=a.get(e,!1,r))!==t?s:u[i];if(o=typeof n,"string"===o&&(s=bi.exec(n))&&(n=(s[1]+1)*s[2]+parseFloat(ht.css(e,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||ht.cssNumber[l]||(n+="px"),ht.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(u[i]="inherit"),a&&"set"in a&&(n=a.set(e,n,r))===t)))try{u[i]=n}catch(h){}}},css:function(e,i,n,r){var s,o,a,l=ht.camelCase(i);return i=ht.cssProps[l]||(ht.cssProps[l]=x(e.style,l)),a=ht.cssHooks[i]||ht.cssHooks[l],a&&"get"in a&&(o=a.get(e,!0,n)),o===t&&(o=ci(e,i,r)),"normal"===o&&i in xi&&(o=xi[i]),""===n||n?(s=parseFloat(o),n===!0||ht.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(hi=function(t){return e.getComputedStyle(t,null)},ci=function(e,i,n){var r,s,o,a=n||hi(e),l=a?a.getPropertyValue(i)||a[i]:t,u=e.style;return a&&(""!==l||ht.contains(e.ownerDocument,e)||(l=ht.style(e,i)),vi.test(l)&&gi.test(i)&&(r=u.width,s=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=a.width,u.width=r,u.minWidth=s,u.maxWidth=o)),l}):Y.documentElement.currentStyle&&(hi=function(e){return e.currentStyle},ci=function(e,i,n){var r,s,o,a=n||hi(e),l=a?a[i]:t,u=e.style;return null==l&&u&&u[i]&&(l=u[i]),vi.test(l)&&!fi.test(i)&&(r=u.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),u.left="fontSize"===i?"1em":l,l=u.pixelLeft+"px",u.left=r,o&&(s.left=o)),""===l?"auto":l}),ht.each(["height","width"],function(e,i){ht.cssHooks[i]={get:function(e,n,r){return n?0===e.offsetWidth&&mi.test(ht.css(e,"display"))?ht.swap(e,wi,function(){return S(e,i,r)}):S(e,i,r):t},set:function(e,t,n){var r=n&&hi(e);return C(e,t,n?E(e,i,n,ht.support.boxSizing&&"border-box"===ht.css(e,"boxSizing",!1,r),r):0)}}}),ht.support.opacity||(ht.cssHooks.opacity={get:function(e,t){return di.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=ht.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===ht.trim(s.replace(pi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=pi.test(s)?s.replace(pi,r):s+" "+r)}}),ht(function(){ht.support.reliableMarginRight||(ht.cssHooks.marginRight={get:function(e,i){return i?ht.swap(e,{display:"inline-block"},ci,[e,"marginRight"]):t}}),!ht.support.pixelPosition&&ht.fn.position&&ht.each(["top","left"],function(e,i){ht.cssHooks[i]={get:function(e,n){return n?(n=ci(e,i),vi.test(n)?ht(e).position()[i]+"px":n):t}}})}),ht.expr&&ht.expr.filters&&(ht.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!ht.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ht.css(e,"display"))},ht.expr.filters.visible=function(e){return!ht.expr.filters.hidden(e)}),ht.each({margin:"",padding:"",border:"Width"},function(e,t){ht.cssHooks[e+t]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];4>n;n++)r[e+Li[n]+t]=s[n]||s[n-2]||s[0];return r}},gi.test(e)||(ht.cssHooks[e+t].set=C)});var Ci=/%20/g,Ei=/\[\]$/,Si=/\r?\n/g,ki=/^(?:submit|button|image|reset|file)$/i,Ti=/^(?:input|select|textarea|keygen)/i;ht.fn.extend({serialize:function(){return ht.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ht.prop(this,"elements");return e?ht.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ht(this).is(":disabled")&&Ti.test(this.nodeName)&&!ki.test(e)&&(this.checked||!ti.test(e))}).map(function(e,t){var i=ht(this).val();return null==i?null:ht.isArray(i)?ht.map(i,function(e){return{name:t.name,value:e.replace(Si,"\r\n")}}):{name:t.name,value:i.replace(Si,"\r\n")}}).get()}}),ht.param=function(e,i){var n,r=[],s=function(e,t){t=ht.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ht.ajaxSettings&&ht.ajaxSettings.traditional),ht.isArray(e)||e.jquery&&!ht.isPlainObject(e))ht.each(e,function(){s(this.name,this.value)});else for(n in e)P(n,e[n],i,s);return r.join("&").replace(Ci,"+")},ht.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ht.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ht.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var Pi,qi,Ni=ht.now(),Fi=/\?/,Ii=/#.*$/,Ai=/([?&])_=[^&]*/,Di=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Mi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ri=/^(?:GET|HEAD)$/,zi=/^\/\//,Bi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ji=ht.fn.load,Ui={},Hi={},$i="*/".concat("*");try{qi=Z.href}catch(Gi){qi=Y.createElement("a"),qi.href="",qi=qi.href}Pi=Bi.exec(qi.toLowerCase())||[],ht.fn.load=function(e,i,n){if("string"!=typeof e&&ji)return ji.apply(this,arguments);var r,s,o,a=this,l=e.indexOf(" ");return l>=0&&(r=e.slice(l,e.length),e=e.slice(0,l)),ht.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(o="POST"),a.length>0&&ht.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){s=arguments,a.html(r?ht("<div>").append(ht.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){a.each(n,s||[e.responseText,t,e])}),this},ht.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ht.fn[t]=function(e){return this.on(t,e)}}),ht.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qi,type:"GET",isLocal:Mi.test(Pi[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$i,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ht.parseJSON,"text xml":ht.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?F(F(e,ht.ajaxSettings),t):F(ht.ajaxSettings,e)},ajaxPrefilter:q(Ui),ajaxTransport:q(Hi),ajax:function(e,i){function n(e,i,n,r){var s,c,v,b,w,L=i;2!==_&&(_=2,l&&clearTimeout(l),h=t,a=r||"",x.readyState=e>0?4:0,s=e>=200&&300>e||304===e,n&&(b=I(p,x,n)),b=A(p,b,x,s),s?(p.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(ht.lastModified[o]=w),w=x.getResponseHeader("etag"),w&&(ht.etag[o]=w)),204===e||"HEAD"===p.type?L="nocontent":304===e?L="notmodified":(L=b.state,c=b.data,v=b.error,s=!v)):(v=L,(e||!L)&&(L="error",0>e&&(e=0))),x.status=e,x.statusText=(i||L)+"",s?m.resolveWith(d,[c,L,x]):m.rejectWith(d,[x,L,v]),x.statusCode(y),y=t,u&&f.trigger(s?"ajaxSuccess":"ajaxError",[x,p,s?c:v]),g.fireWith(d,[x,L]),u&&(f.trigger("ajaxComplete",[x,p]),--ht.active||ht.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var r,s,o,a,l,u,h,c,p=ht.ajaxSetup({},i),d=p.context||p,f=p.context&&(d.nodeType||d.jquery)?ht(d):ht.event,m=ht.Deferred(),g=ht.Callbacks("once memory"),y=p.statusCode||{},v={},b={},_=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!c)for(c={};t=Di.exec(a);)c[t[1].toLowerCase()]=t[2];t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return _||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return _||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>_)for(t in e)y[t]=[y[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return h&&h.abort(t),n(0,t),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,p.url=((e||p.url||qi)+"").replace(Ii,"").replace(zi,Pi[1]+"//"),p.type=i.method||i.type||p.method||p.type,p.dataTypes=ht.trim(p.dataType||"*").toLowerCase().match(pt)||[""],null==p.crossDomain&&(r=Bi.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===Pi[1]&&r[2]===Pi[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(Pi[3]||("http:"===Pi[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=ht.param(p.data,p.traditional)),N(Ui,p,i,x),2===_)return x;u=p.global,u&&0===ht.active++&&ht.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ri.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(Fi.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=Ai.test(o)?o.replace(Ai,"$1_="+Ni++):o+(Fi.test(o)?"&":"?")+"_="+Ni++)),p.ifModified&&(ht.lastModified[o]&&x.setRequestHeader("If-Modified-Since",ht.lastModified[o]),ht.etag[o]&&x.setRequestHeader("If-None-Match",ht.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||i.contentType)&&x.setRequestHeader("Content-Type",p.contentType),x.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+$i+"; q=0.01":""):p.accepts["*"]);for(s in p.headers)x.setRequestHeader(s,p.headers[s]);if(p.beforeSend&&(p.beforeSend.call(d,x,p)===!1||2===_))return x.abort();w="abort";for(s in{success:1,error:1,complete:1})x[s](p[s]);if(h=N(Hi,p,i,x)){x.readyState=1,u&&f.trigger("ajaxSend",[x,p]),p.async&&p.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},p.timeout));try{_=1,h.send(v,n)}catch(L){if(!(2>_))throw L;n(-1,L)}}else n(-1,"No Transport");return x},getJSON:function(e,t,i){return ht.get(e,t,i,"json")},getScript:function(e,i){return ht.get(e,t,i,"script")}}),ht.each(["get","post"],function(e,i){ht[i]=function(e,n,r,s){return ht.isFunction(n)&&(s=s||r,r=n,n=t),ht.ajax({url:e,type:i,dataType:s,data:n,success:r})}}),ht.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ht.globalEval(e),e}}}),ht.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ht.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=Y.head||ht("head")[0]||Y.documentElement;return{send:function(t,r){i=Y.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||r(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Wi=[],Vi=/(=)\?(?=&|$)|\?\?/;ht.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wi.pop()||ht.expando+"_"+Ni++;return this[e]=!0,e}}),ht.ajaxPrefilter("json jsonp",function(i,n,r){var s,o,a,l=i.jsonp!==!1&&(Vi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(s=i.jsonpCallback=ht.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Vi,"$1"+s):i.jsonp!==!1&&(i.url+=(Fi.test(i.url)?"&":"?")+i.jsonp+"="+s),i.converters["script json"]=function(){return a||ht.error(s+" was not called"),a[0]},i.dataTypes[0]="json",o=e[s],e[s]=function(){a=arguments},r.always(function(){e[s]=o,i[s]&&(i.jsonpCallback=n.jsonpCallback,Wi.push(s)),a&&ht.isFunction(o)&&o(a[0]),a=o=t}),"script"):t});var Xi,Zi,Yi=0,Ki=e.ActiveXObject&&function(){var e;for(e in Xi)Xi[e](t,!0)};ht.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&D()||M()}:D,Zi=ht.ajaxSettings.xhr(),ht.support.cors=!!Zi&&"withCredentials"in Zi,Zi=ht.support.ajax=!!Zi,Zi&&ht.ajaxTransport(function(i){if(!i.crossDomain||ht.support.cors){var n;return{send:function(r,s){var o,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(a in r)l.setRequestHeader(a,r[a])}catch(u){}l.send(i.hasContent&&i.data||null),n=function(e,r){var a,u,h,c;try{if(n&&(r||4===l.readyState))if(n=t,o&&(l.onreadystatechange=ht.noop,Ki&&delete Xi[o]),r)4!==l.readyState&&l.abort();else{c={},a=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(c.text=l.responseText);try{h=l.statusText}catch(p){h=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=c.text?200:404}}catch(d){r||s(-1,d)}c&&s(a,h,c,u)},i.async?4===l.readyState?setTimeout(n):(o=++Yi,Ki&&(Xi||(Xi={},ht(e).unload(Ki)),Xi[o]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}}});var Ji,Qi,en=/^(?:toggle|show|hide)$/,tn=RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),nn=/queueHooks$/,rn=[U],sn={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),r=tn.exec(t),s=r&&r[3]||(ht.cssNumber[e]?"":"px"),o=(ht.cssNumber[e]||"px"!==s&&+n)&&tn.exec(ht.css(i.elem,e)),a=1,l=20;if(o&&o[3]!==s){s=s||o[3],r=r||[],o=+n||1;do a=a||".5",o/=a,ht.style(i.elem,e,o+s);while(a!==(a=i.cur()/n)&&1!==a&&--l)}return r&&(o=i.start=+o||+n||0,i.unit=s,i.end=r[1]?o+(r[1]+1)*r[2]:+r[2]),i}]};ht.Animation=ht.extend(B,{tweener:function(e,t){ht.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;r>n;n++)i=e[n],sn[i]=sn[i]||[],sn[i].unshift(t)},prefilter:function(e,t){t?rn.unshift(e):rn.push(e)}}),ht.Tween=H,H.prototype={constructor:H,init:function(e,t,i,n,r,s){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(ht.cssNumber[i]?"":"px")},cur:function(){var e=H.propHooks[this.prop];return e&&e.get?e.get(this):H.propHooks._default.get(this)},run:function(e){var t,i=H.propHooks[this.prop];return this.pos=t=this.options.duration?ht.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ht.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ht.fx.step[e.prop]?ht.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ht.cssProps[e.prop]]||ht.cssHooks[e.prop])?ht.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ht.each(["toggle","show","hide"],function(e,t){var i=ht.fn[t];ht.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate($(t,!0),e,n,r)}}),ht.fn.extend({fadeTo:function(e,t,i,n){return this.filter(L).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=ht.isEmptyObject(e),s=ht.speed(t,i,n),o=function(){var t=B(this,ht.extend({},e),s);(r||ht._data(this,"finish"))&&t.stop(!0)};return o.finish=o,r||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,i,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=ht.timers,o=ht._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&ht.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ht._data(this),n=i[e+"queue"],r=i[e+"queueHooks"],s=ht.timers,o=n?n.length:0;for(i.finish=!0,ht.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ht.each({slideDown:$("show"),slideUp:$("hide"),slideToggle:$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ht.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ht.speed=function(e,t,i){var n=e&&"object"==typeof e?ht.extend({},e):{complete:i||!i&&t||ht.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ht.isFunction(t)&&t};return n.duration=ht.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ht.fx.speeds?ht.fx.speeds[n.duration]:ht.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ht.isFunction(n.old)&&n.old.call(this),n.queue&&ht.dequeue(this,n.queue)},n},ht.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ht.timers=[],ht.fx=H.prototype.init,ht.fx.tick=function(){var e,i=ht.timers,n=0;for(Ji=ht.now();i.length>n;n++)e=i[n],e()||i[n]!==e||i.splice(n--,1);i.length||ht.fx.stop(),Ji=t},ht.fx.timer=function(e){e()&&ht.timers.push(e)&&ht.fx.start()},ht.fx.interval=13,ht.fx.start=function(){Qi||(Qi=setInterval(ht.fx.tick,ht.fx.interval))},ht.fx.stop=function(){clearInterval(Qi),Qi=null},ht.fx.speeds={slow:600,fast:200,_default:400},ht.fx.step={},ht.expr&&ht.expr.filters&&(ht.expr.filters.animated=function(e){return ht.grep(ht.timers,function(t){return e===t.elem}).length}),ht.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ht.offset.setOffset(this,e,t)});var i,n,r={top:0,left:0},s=this[0],o=s&&s.ownerDocument;return o?(i=o.documentElement,ht.contains(i,s)?(typeof s.getBoundingClientRect!==X&&(r=s.getBoundingClientRect()),n=G(o),{top:r.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:r.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):r):void 0},ht.offset={setOffset:function(e,t,i){var n=ht.css(e,"position");"static"===n&&(e.style.position="relative");var r,s,o=ht(e),a=o.offset(),l=ht.css(e,"top"),u=ht.css(e,"left"),h=("absolute"===n||"fixed"===n)&&ht.inArray("auto",[l,u])>-1,c={},p={};h?(p=o.position(),r=p.top,s=p.left):(r=parseFloat(l)||0,s=parseFloat(u)||0),ht.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(c.top=t.top-a.top+r),null!=t.left&&(c.left=t.left-a.left+s),"using"in t?t.using.call(e,c):o.css(c)}},ht.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===ht.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ht.nodeName(e[0],"html")||(i=e.offset()),i.top+=ht.css(e[0],"borderTopWidth",!0),i.left+=ht.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ht.css(n,"marginTop",!0),left:t.left-i.left-ht.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||K;e&&!ht.nodeName(e,"html")&&"static"===ht.css(e,"position");)e=e.offsetParent;return e||K})}}),ht.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);ht.fn[e]=function(r){return ht.access(this,function(e,r,s){var o=G(e);return s===t?o?i in o?o[i]:o.document.documentElement[r]:e[r]:(o?o.scrollTo(n?ht(o).scrollLeft():s,n?s:ht(o).scrollTop()):e[r]=s,t)},e,r,arguments.length,null)}}),ht.each({Height:"height",Width:"width"},function(e,i){ht.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,r){ht.fn[r]=function(r,s){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(r===!0||s===!0?"margin":"border");return ht.access(this,function(i,n,r){var s;return ht.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(s=i.documentElement,Math.max(i.body["scroll"+e],s["scroll"+e],i.body["offset"+e],s["offset"+e],s["client"+e])):r===t?ht.css(i,n,a):ht.style(i,n,r,a)},i,o?r:t,o,null)}})}),ht.fn.size=function(){return this.length},ht.fn.andSelf=ht.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ht:(e.jQuery=e.$=ht,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ht}))}(window),function(e,t){function i(t,i){var r,s,o,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,s=r.name,t.href&&s&&"map"===r.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&n(o)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))
}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var n,r,s=e(this[0]);s.length&&s[0]!==document;){if(n=s.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(s.css("zIndex"),10),!isNaN(r)&&0!==r))return r;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function r(t,i,n,r){return e.each(s,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var s="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(o,r(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(o,r(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,n){var r,s=e.ui[t].prototype;for(r in n)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([i,n[r]])},call:function(e,t,i){var n,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;r.length>n;n++)e.options[r[n][0]]&&r[n][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",r=!1;return t[n]>0?!0:(t[n]=1,r=t[n]>0,t[n]=0,r)}})}(jQuery),function(e,t){var i=0,n=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(s){}r(t)},e.widget=function(i,n,r){var s,o,a,l,u={},h=i.split(".")[0];i=i.split(".")[1],s=h+"-"+i,r||(r=n,n=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[h]=e[h]||{},o=e[h][i],a=e[h][i]=function(e,i){return this._createWidget?(arguments.length&&this._createWidget(e,i),t):new a(e,i)},e.extend(a,o,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),l=new n,l.options=e.widget.extend({},l.options),e.each(r,function(i,r){return e.isFunction(r)?(u[i]=function(){var e=function(){return n.prototype[i].apply(this,arguments)},t=function(e){return n.prototype[i].apply(this,e)};return function(){var i,n=this._super,s=this._superApply;return this._super=e,this._superApply=t,i=r.apply(this,arguments),this._super=n,this._superApply=s,i}}(),t):(u[i]=r,t)}),a.prototype=e.widget.extend(l,{widgetEventPrefix:o?l.widgetEventPrefix||i:i},u,{constructor:a,namespace:h,widgetName:i,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(i,a)},e.widget.extend=function(i){for(var r,s,o=n.call(arguments,1),a=0,l=o.length;l>a;a++)for(r in o[a])s=o[a][r],o[a].hasOwnProperty(r)&&s!==t&&(i[r]=e.isPlainObject(s)?e.isPlainObject(i[r])?e.widget.extend({},i[r],s):e.widget.extend({},s):s);return i},e.widget.bridge=function(i,r){var s=r.prototype.widgetFullName||i;e.fn[i]=function(o){var a="string"==typeof o,l=n.call(arguments,1),u=this;return o=!a&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,a?this.each(function(){var n,r=e.data(this,s);return r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,l),n!==r&&n!==t?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):t):e.error("no such method '"+o+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new r(o,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var r,s,o,a=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(a={},r=i.split("."),i=r.shift(),r.length){for(s=a[i]=e.widget.extend({},this.options[i]),o=0;r.length-1>o;o++)s[r[o]]=s[r[o]]||{},s=s[r[o]];if(i=r.pop(),1===arguments.length)return s[i]===t?null:s[i];s[i]=n}else{if(1===arguments.length)return this.options[i]===t?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,n,r){var s,o=this;"boolean"!=typeof i&&(r=n,n=i,i=!1),r?(n=s=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,s=this.widget()),e.each(r,function(r,a){function l(){return i||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):t}"string"!=typeof a&&(l.guid=a.guid=a.guid||l.guid||e.guid++);var u=r.match(/^(\w+)\s*(.*)$/),h=u[1]+o.eventNamespace,c=u[2];c?s.delegate(c,h,l):n.bind(h,l)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,s,o=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(r in s)r in i||(i[r]=s[r]);return this.element.trigger(i,n),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,s){"string"==typeof r&&(r={effect:r});var o,a=r?r===!0||"number"==typeof r?i:r.effect||i:t;r=r||{},"number"==typeof r&&(r={duration:r}),o=!e.isEmptyObject(r),r.complete=s,r.delay&&n.delay(r.delay),o&&e.effects&&e.effects.effect[a]?n[t](r):a!==t&&n[a]?n[a](r.duration,r.easing,s):n.queue(function(i){e(this)[t](),s&&s.call(n[0]),i()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,r=1===i.which,s="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return r&&!s&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function i(e,t,i){return[parseFloat(e[0])*(d.test(e[0])?t/100:1),parseFloat(e[1])*(d.test(e[1])?i/100:1)]}function n(t,i){return parseInt(e.css(t,i),10)||0}function r(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,o=Math.max,a=Math.abs,l=Math.round,u=/left|center|right/,h=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,d=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var i,n,r=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=r.children()[0];return e("body").append(r),i=o.offsetWidth,r.css("overflow","scroll"),n=o.offsetWidth,i===n&&(n=r[0].clientWidth),r.remove(),s=i-n},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),r="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,s="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]),r=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var s,d,m,g,y,v,b=e(t.of),_=e.position.getWithinInfo(t.within),w=e.position.getScrollInfo(_),x=(t.collision||"flip").split(" "),L={};return v=r(b),b[0].preventDefault&&(t.at="left top"),d=v.width,m=v.height,g=v.offset,y=e.extend({},g),e.each(["my","at"],function(){var e,i,n=(t[this]||"").split(" ");1===n.length&&(n=u.test(n[0])?n.concat(["center"]):h.test(n[0])?["center"].concat(n):["center","center"]),n[0]=u.test(n[0])?n[0]:"center",n[1]=h.test(n[1])?n[1]:"center",e=c.exec(n[0]),i=c.exec(n[1]),L[this]=[e?e[0]:0,i?i[0]:0],t[this]=[p.exec(n[0])[0],p.exec(n[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?y.left+=d:"center"===t.at[0]&&(y.left+=d/2),"bottom"===t.at[1]?y.top+=m:"center"===t.at[1]&&(y.top+=m/2),s=i(L.at,d,m),y.left+=s[0],y.top+=s[1],this.each(function(){var r,u,h=e(this),c=h.outerWidth(),p=h.outerHeight(),f=n(this,"marginLeft"),v=n(this,"marginTop"),O=c+f+n(this,"marginRight")+w.width,C=p+v+n(this,"marginBottom")+w.height,E=e.extend({},y),S=i(L.my,h.outerWidth(),h.outerHeight());"right"===t.my[0]?E.left-=c:"center"===t.my[0]&&(E.left-=c/2),"bottom"===t.my[1]?E.top-=p:"center"===t.my[1]&&(E.top-=p/2),E.left+=S[0],E.top+=S[1],e.support.offsetFractions||(E.left=l(E.left),E.top=l(E.top)),r={marginLeft:f,marginTop:v},e.each(["left","top"],function(i,n){e.ui.position[x[i]]&&e.ui.position[x[i]][n](E,{targetWidth:d,targetHeight:m,elemWidth:c,elemHeight:p,collisionPosition:r,collisionWidth:O,collisionHeight:C,offset:[s[0]+S[0],s[1]+S[1]],my:t.my,at:t.at,within:_,elem:h})}),t.using&&(u=function(e){var i=g.left-E.left,n=i+d-c,r=g.top-E.top,s=r+m-p,l={target:{element:b,left:g.left,top:g.top,width:d,height:m},element:{element:h,left:E.left,top:E.top,width:c,height:p},horizontal:0>n?"left":i>0?"right":"center",vertical:0>s?"top":r>0?"bottom":"middle"};c>d&&d>a(i+n)&&(l.horizontal="center"),p>m&&m>a(r+s)&&(l.vertical="middle"),l.important=o(a(i),a(n))>o(a(r),a(s))?"horizontal":"vertical",t.using.call(this,e,l)}),h.offset(e.extend(E,{using:u}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,r=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,a=e.left-t.collisionPosition.marginLeft,l=r-a,u=a+t.collisionWidth-s-r;t.collisionWidth>s?l>0&&0>=u?(i=e.left+l+t.collisionWidth-s-r,e.left+=l-i):e.left=u>0&&0>=l?r:l>u?r+s-t.collisionWidth:r:l>0?e.left+=l:u>0?e.left-=u:e.left=o(e.left-a,e.left)},top:function(e,t){var i,n=t.within,r=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,a=e.top-t.collisionPosition.marginTop,l=r-a,u=a+t.collisionHeight-s-r;t.collisionHeight>s?l>0&&0>=u?(i=e.top+l+t.collisionHeight-s-r,e.top+=l-i):e.top=u>0&&0>=l?r:l>u?r+s-t.collisionHeight:r:l>0?e.top+=l:u>0?e.top-=u:e.top=o(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,r=t.within,s=r.offset.left+r.scrollLeft,o=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,u=e.left-t.collisionPosition.marginLeft,h=u-l,c=u+t.collisionWidth-o-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,d="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>h?(i=e.left+p+d+f+t.collisionWidth-o-s,(0>i||a(h)>i)&&(e.left+=p+d+f)):c>0&&(n=e.left-t.collisionPosition.marginLeft+p+d+f-l,(n>0||c>a(n))&&(e.left+=p+d+f))},top:function(e,t){var i,n,r=t.within,s=r.offset.top+r.scrollTop,o=r.height,l=r.isWindow?r.scrollTop:r.offset.top,u=e.top-t.collisionPosition.marginTop,h=u-l,c=u+t.collisionHeight-o-l,p="top"===t.my[1],d=p?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>h?(n=e.top+d+f+m+t.collisionHeight-o-s,e.top+d+f+m>h&&(0>n||a(h)>n)&&(e.top+=d+f+m)):c>0&&(i=e.top-t.collisionPosition.marginTop+d+f+m-l,e.top+d+f+m>c&&(i>0||c>a(i))&&(e.top+=d+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,r,s,o=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(o?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in n)t.style[s]=n[s];t.appendChild(a),i=o||document.documentElement,i.insertBefore(t,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",r=e(a).offset().left,e.support.offsetFractions=r>10&&11>r,t.innerHTML="",i.removeChild(t)}()}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,r=this.options;return r.containment?"window"===r.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):"document"===r.containment?(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):r.containment.constructor===Array?(this.containment=r.containment,undefined):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),i=e(r.containment),n=i[0],n&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i),undefined):(this.containment=null,undefined)},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*n}},_generatePosition:function(t){var i,n,r,s,o=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,u=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(u=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(u=i[3]+this.offset.click.top)),o.grid&&(r=o.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,u=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-o.grid[1]:r+o.grid[1]:r,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var n=e(this).data("ui-draggable"),r=n.options,s=e.extend({},i,{item:n.element});n.sortables=[],e(r.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,s))})},stop:function(t,i){var n=e(this).data("ui-draggable"),r=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,i){var n=e(this).data("ui-draggable"),r=this;e.each(n.sortables,function(){var s=!1,o=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var n=e(i.helper),r=e(this).data("ui-draggable").options;n.css("opacity")&&(r._opacity=n.css("opacity")),n.css("opacity",r.opacity)
},stop:function(t,i){var n=e(this).data("ui-draggable").options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("ui-draggable"),n=i.options,r=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),n=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(t,i){var n,r,s,o,a,l,u,h,c,p,d=e(this).data("ui-draggable"),f=d.options,m=f.snapTolerance,g=i.offset.left,y=g+d.helperProportions.width,v=i.offset.top,b=v+d.helperProportions.height;for(c=d.snapElements.length-1;c>=0;c--)a=d.snapElements[c].left,l=a+d.snapElements[c].width,u=d.snapElements[c].top,h=u+d.snapElements[c].height,a-m>y||g>l+m||u-m>b||v>h+m||!e.contains(d.snapElements[c].item.ownerDocument,d.snapElements[c].item)?(d.snapElements[c].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,t,e.extend(d._uiHash(),{snapItem:d.snapElements[c].item})),d.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),r=m>=Math.abs(h-v),s=m>=Math.abs(a-y),o=m>=Math.abs(l-g),n&&(i.position.top=d._convertPositionTo("relative",{top:u-d.helperProportions.height,left:0}).top-d.margins.top),r&&(i.position.top=d._convertPositionTo("relative",{top:h,left:0}).top-d.margins.top),s&&(i.position.left=d._convertPositionTo("relative",{top:0,left:a-d.helperProportions.width}).left-d.margins.left),o&&(i.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left)),p=n||r||s||o,"outer"!==f.snapMode&&(n=m>=Math.abs(u-v),r=m>=Math.abs(h-b),s=m>=Math.abs(a-g),o=m>=Math.abs(l-y),n&&(i.position.top=d._convertPositionTo("relative",{top:u,left:0}).top-d.margins.top),r&&(i.position.top=d._convertPositionTo("relative",{top:h-d.helperProportions.height,left:0}).top-d.margins.top),s&&(i.position.left=d._convertPositionTo("relative",{top:0,left:a}).left-d.margins.left),o&&(i.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left)),!d.snapElements[c].snapping&&(n||r||s||o||p)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,t,e.extend(d._uiHash(),{snapItem:d.snapElements[c].item})),d.snapElements[c].snapping=n||r||s||o||p)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,n=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});n.length&&(t=parseInt(e(n[0]).css("zIndex"),10)||0,e(n).each(function(i){e(this).css("zIndex",t+i)}),this.css("zIndex",t+n.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var n=e(i.helper),r=e(this).data("ui-draggable").options;n.css("zIndex")&&(r._zIndex=n.css("zIndex")),n.css("zIndex",r.zIndex)},stop:function(t,i){var n=e(this).data("ui-draggable").options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}})}(jQuery),function(e){function t(e,t,i){return e>t&&t+i>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,i){"disabled"===t?(this.options[t]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){var n=null,r=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(n=e(this),!1):undefined}),e.data(t.target,s.widgetName+"-item")===s&&(n=e(t.target)),n?!this.options.handle||i||(e(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(r=!0)}),r)?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,n){var r,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,n,r,s,o=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],r=n.item[0],s=this._intersectsWithPointer(n),s&&n.instance===this.currentContainer&&r!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==r&&!e.contains(this.placeholder[0],r)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],r):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,r=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,s=e.left,o=s+e.width,a=e.top,l=a+e.height,u=this.offset.click.top,h=this.offset.click.left,c="x"===this.options.axis||n+u>a&&l>n+u,p="y"===this.options.axis||t+h>s&&o>t+h,d=c&&p;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?d:t+this.helperProportions.width/2>s&&o>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>a&&l>r-this.helperProportions.height/2},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=i&&n,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return r?this.floating?o&&"right"===o||"down"===s?2:1:s&&("down"===s?2:1):!1},_intersectsWithSides:function(e){var i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&n||"left"===s&&!n:r&&("down"===r&&i||"up"===r&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){a.push(this)}var n,r,s,o,a=[],l=[],u=this._connectWith();if(u&&t)for(n=u.length-1;n>=0;n--)for(s=e(u[n]),r=s.length-1;r>=0;r--)o=e.data(s[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&l.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,n,r,s,o,a,l,u,h=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(i=p.length-1;i>=0;i--)for(r=e(p[i]),n=r.length-1;n>=0;n--)s=e.data(r[n],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(i=c.length-1;i>=0;i--)for(o=c[i][1],a=c[i][0],n=0,u=a.length;u>n;n++)l=e(a[n]),l.data(this.widgetName+"-item",o),h.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,r,s;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=r.outerWidth(),n.height=r.outerHeight()),s=r.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=t.currentItem[0].nodeName.toLowerCase(),r=e("<"+n+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(r)}):"img"===n&&r.attr("src",t.currentItem.attr("src")),i||r.css("visibility","hidden"),r},update:function(e,r){(!i||n.forcePlaceholderSize)&&(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(n){var r,s,o,a,l,u,h,c,p,d,f=null,m=null;for(r=this.containers.length-1;r>=0;r--)if(!e.contains(this.currentItem[0],this.containers[r].element[0]))if(this._intersectsWith(this.containers[r].containerCache)){if(f&&e.contains(this.containers[r].element[0],f.element[0]))continue;f=this.containers[r],m=r}else this.containers[r].containerCache.over&&(this.containers[r]._trigger("out",n,this._uiHash(this)),this.containers[r].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",n,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(o=1e4,a=null,d=f.floating||i(this.currentItem),l=d?"left":"top",u=d?"width":"height",h=this.positionAbs[l]+this.offset.click[l],s=this.items.length-1;s>=0;s--)e.contains(this.containers[m].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(!d||t(this.positionAbs.top+this.offset.click.top,this.items[s].top,this.items[s].height))&&(c=this.items[s].item.offset()[l],p=!1,Math.abs(c-h)>Math.abs(c+this.items[s][u]-h)&&(p=!0,c+=this.items[s][u]),o>Math.abs(c-h)&&(o=Math.abs(c-h),a=this.items[s],this.direction=p?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;a?this._rearrange(n,a,null,!0):this._rearrange(n,null,this.containers[m].element,!0),this._trigger("change",n,this._uiHash()),this.containers[m]._trigger("change",n,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",n,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),("document"===r.containment||"window"===r.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===r.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===r.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],i=e(r.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:r.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:r.scrollLeft())*n}},_generatePosition:function(t){var i,n,r=this.options,s=t.pageX,o=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),r.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/r.grid[1])*r.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-r.grid[1]:i+r.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/r.grid[0])*r.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-r.grid[0]:n+r.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;r.length>n;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;r.length>n;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,n=e.ui.mouse.prototype,r=n._mouseInit;n._touchStart=function(e){var n=this;!i&&n._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,n._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},n._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},n._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},n._mouseInit=function(){var t=this;t.element.bind("touchstart",e.proxy(t,"_touchStart")).bind("touchmove",e.proxy(t,"_touchMove")).bind("touchend",e.proxy(t,"_touchEnd")),r.call(t)}}}(jQuery),$(document).on("mobileinit",function(){$.mobile.ajaxEnabled=!1,$.mobile.hashListeningEnabled=!1,$.mobile.linkBindingEnabled=!1,$.mobile.changePage.defaults.changeHash=!1,$.mobile.defaultDialogTransition="none",$.mobile.defaultPageTransition="slidedown",$.mobile.page.prototype.options.degradeInputs.date=!0,$.mobile.page.prototype.options.domCache=!1,$.mobile.autoInitializePage=!1,$.mobile.ignoreContentEnabled=!0}),function(e,t,i){"function"==typeof define&&define.amd?define(["jquery"],function(n){return i(n,e,t),n.mobile}):i(e.jQuery,e,t)}(this,document,function(e,t,i){(function(e){e.mobile={}})(e),function(e){e.extend(e.mobile,{version:"1.4.0",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:e(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(e,this),function(e,t,i){var n={},r=e.find,s=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,o=/:jqmData\(([^)]*)\)/g;e.extend(e.mobile,{ns:"",getAttribute:function(t,i){var n;t=t.jquery?t[0]:t,t&&t.getAttribute&&(n=t.getAttribute("data-"+e.mobile.ns+i));try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:s.test(n)?JSON.parse(n):n}catch(r){}return n},nsNormalizeDict:n,nsNormalize:function(t){return n[t]||(n[t]=e.camelCase(e.mobile.ns+t))},closestPageData:function(e){return e.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),e.fn.jqmData=function(t,n){var r;return t!==i&&(t&&(t=e.mobile.nsNormalize(t)),r=2>arguments.length||n===i?this.data(t):this.data(t,n)),r},e.jqmData=function(t,n,r){var s;return n!==i&&(s=e.data(t,n?e.mobile.nsNormalize(n):n,r)),s},e.fn.jqmRemoveData=function(t){return this.removeData(e.mobile.nsNormalize(t))},e.jqmRemoveData=function(t,i){return e.removeData(t,e.mobile.nsNormalize(i))},e.find=function(t,i,n,s){return t.indexOf(":jqmData")>-1&&(t=t.replace(o,"[data-"+(e.mobile.ns||"")+"$1]")),r.call(this,t,i,n,s)},e.extend(e.find,r)}(e,this),function(e,t){function n(t,i){var n,s,o,a=t.nodeName.toLowerCase();return"area"===a?(n=t.parentNode,s=n.name,t.href&&s&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||i:i)&&r(t)
}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var s=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(this[0].ownerDocument||i):t},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function r(t,i,n,r){return e.each(s,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var s="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(o,r(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(o,r(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in i.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,s,o=e(this[0]);o.length&&o[0]!==i;){if(r=o.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(s=parseInt(o.css("zIndex"),10),!isNaN(s)&&0!==s))return s;o=o.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var r,s=e.ui[t].prototype;for(r in n)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([i,n[r]])},call:function(e,t,i,n){var r,s=e.plugins[t];if(s&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;s.length>r;r++)e.options[s[r][0]]&&s[r][1].apply(e.element,i)}}}(e),function(e,t){e.extend(e.mobile,{window:e(t),document:e(i),keyCode:e.ui.keyCode,behaviors:{},silentScroll:function(i){"number"!==e.type(i)&&(i=e.mobile.defaultHomeScroll),e.event.special.scrollstart.enabled=!1,setTimeout(function(){t.scrollTo(0,i),e.mobile.document.trigger("silentscroll",{x:0,y:i})},20),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(t){var i=e(t).closest(".ui-page").jqmData("url"),n=e.mobile.path.documentBase.hrefNoHash;return e.mobile.dynamicBaseEnabled&&i&&e.mobile.path.isPath(i)||(i=n),e.mobile.path.makeUrlAbsolute(i,n)},removeActiveLinkClass:function(t){!e.mobile.activeClickedLink||e.mobile.activeClickedLink.closest("."+e.mobile.activePageClass).length&&!t||e.mobile.activeClickedLink.removeClass(e.mobile.activeBtnClass),e.mobile.activeClickedLink=null},getInheritedTheme:function(e,t){for(var i,n,r=e[0],s="",o=/ui-(bar|body|overlay)-([a-z])\b/;r&&(i=r.className||"",!(i&&(n=o.exec(i))&&(s=n[2])));)r=r.parentNode;return s||t||"a"},enhanceable:function(e){return this.haveParents(e,"enhance")},hijackable:function(e){return this.haveParents(e,"ajax")},haveParents:function(t,i){if(!e.mobile.ignoreContentEnabled)return t;var n,r,s,o,a,l=t.length,u=e();for(o=0;l>o;o++){for(r=t.eq(o),s=!1,n=t[o];n;){if(a=n.getAttribute?n.getAttribute("data-"+e.mobile.ns+i):"","false"===a){s=!0;break}n=n.parentNode}s||(u=u.add(r))}return u},getScreenHeight:function(){return t.innerHeight||e.mobile.window.height()},resetActivePageHeight:function(t){var i=e("."+e.mobile.activePageClass),n=i.height(),r=i.outerHeight(!0);t="number"==typeof t?t:e.mobile.getScreenHeight(),i.css("min-height",t-(r-n))},loading:function(){var t=this.loading._widget||e(e.mobile.loader.prototype.defaultHtml).loader(),i=t.loader.apply(t,arguments);return this.loading._widget=t,i}}),e.addDependents=function(t,i){var n=e(t),r=n.jqmData("dependents")||e();n.jqmData("dependents",e(r).add(i))},e.fn.extend({removeWithDependents:function(){e.removeWithDependents(this)},enhanceWithin:function(){var t,i={},n=e.mobile.page.prototype.keepNativeSelector(),r=this;e.mobile.nojs&&e.mobile.nojs(this),e.mobile.links&&e.mobile.links(this),e.mobile.degradeInputsWithin&&e.mobile.degradeInputsWithin(this),e.fn.buttonMarkup&&this.find(e.fn.buttonMarkup.initSelector).not(n).jqmEnhanceable().buttonMarkup(),e.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(n).jqmEnhanceable().fieldcontain(),e.each(e.mobile.widgets,function(t,s){if(s.initSelector){var o=e.mobile.enhanceable(r.find(s.initSelector));o.length>0&&(o=o.not(n)),o.length>0&&(i[s.prototype.widgetName]=o)}});for(t in i)i[t][t]();return this},addDependents:function(t){e.addDependents(this,t)},getEncodedText:function(){return e("<a>").text(this.text()).html()},jqmEnhanceable:function(){return e.mobile.enhanceable(this)},jqmHijackable:function(){return e.mobile.hijackable(this)}}),e.removeWithDependents=function(t){var i=e(t);(i.jqmData("dependents")||e()).remove(),i.remove()},e.addDependents=function(t,i){var n=e(t),r=n.jqmData("dependents")||e();n.jqmData("dependents",e(r).add(i))},e.find.matches=function(t,i){return e.find(t,null,null,i)},e.find.matchesSelector=function(t,i){return e.find(i,null,null,[t]).length>0}}(e,this),function(e,t){var i=0,n=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(s){}r(t)},e.widget=function(i,n,r){var s,o,a,l,u={},h=i.split(".")[0];return i=i.split(".")[1],s=h+"-"+i,r||(r=n,n=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[h]=e[h]||{},o=e[h][i],a=e[h][i]=function(e,i){return this._createWidget?(arguments.length&&this._createWidget(e,i),t):new a(e,i)},e.extend(a,o,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),l=new n,l.options=e.widget.extend({},l.options),e.each(r,function(i,r){return e.isFunction(r)?(u[i]=function(){var e=function(){return n.prototype[i].apply(this,arguments)},t=function(e){return n.prototype[i].apply(this,e)};return function(){var i,n=this._super,s=this._superApply;return this._super=e,this._superApply=t,i=r.apply(this,arguments),this._super=n,this._superApply=s,i}}(),t):(u[i]=r,t)}),a.prototype=e.widget.extend(l,{widgetEventPrefix:o?l.widgetEventPrefix||i:i},u,{constructor:a,namespace:h,widgetName:i,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(i,a),a},e.widget.extend=function(i){for(var r,s,o=n.call(arguments,1),a=0,l=o.length;l>a;a++)for(r in o[a])s=o[a][r],o[a].hasOwnProperty(r)&&s!==t&&(i[r]=e.isPlainObject(s)?e.isPlainObject(i[r])?e.widget.extend({},i[r],s):e.widget.extend({},s):s);return i},e.widget.bridge=function(i,r){var s=r.prototype.widgetFullName||i;e.fn[i]=function(o){var a="string"==typeof o,l=n.call(arguments,1),u=this;return o=!a&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,a?this.each(function(){var n,r=e.data(this,s);return"instance"===o?(u=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,l),n!==r&&n!==t?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):t):e.error("no such method '"+o+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new r(o,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var r,s,o,a=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(a={},r=i.split("."),i=r.shift(),r.length){for(s=a[i]=e.widget.extend({},this.options[i]),o=0;r.length-1>o;o++)s[r[o]]=s[r[o]]||{},s=s[r[o]];if(i=r.pop(),n===t)return s[i]===t?null:s[i];s[i]=n}else{if(n===t)return this.options[i]===t?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(i,n,r){var s,o=this;"boolean"!=typeof i&&(r=n,n=i,i=!1),r?(n=s=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,s=this.widget()),e.each(r,function(r,a){function l(){return i||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):t}"string"!=typeof a&&(l.guid=a.guid=a.guid||l.guid||e.guid++);var u=r.match(/^(\w+)\s*(.*)$/),h=u[1]+o.eventNamespace,c=u[2];c?s.delegate(c,h,l):n.bind(h,l)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,s,o=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(r in s)r in i||(i[r]=s[r]);return this.element.trigger(i,n),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,s){"string"==typeof r&&(r={effect:r});var o,a=r?r===!0||"number"==typeof r?i:r.effect||i:t;r=r||{},"number"==typeof r&&(r={duration:r}),o=!e.isEmptyObject(r),r.complete=s,r.delay&&n.delay(r.delay),o&&e.effects&&e.effects.effect[a]?n[t](r):a!==t&&n[a]?n[a](r.duration,r.easing,s):n.queue(function(i){e(this)[t](),s&&s.call(n[0]),i()})}})}(e),function(e){var t=/[A-Z]/g,i=function(e){return"-"+e.toLowerCase()};e.extend(e.Widget.prototype,{_getCreateOptions:function(){var n,r,s=this.element[0],o={};if(!e.mobile.getAttribute(s,"defaults"))for(n in this.options)r=e.mobile.getAttribute(s,n.replace(t,i)),null!=r&&(o[n]=r);return o}}),e.mobile.widget=e.Widget}(e),function(e){var t="ui-loader",i=e("html");e.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+t+"'>"+"<span class='ui-icon-loading'></span>"+"<h1></h1>"+"</div>",fakeFixLoader:function(){var t=e("."+e.mobile.activeBtnClass).first();this.element.css({top:e.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||t.length&&t.offset().top||100})},checkLoaderPosition:function(){var t=this.element.offset(),i=this.window.scrollTop(),n=e.mobile.getScreenHeight();(i>t.top||t.top-i>n)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",e.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(e(this.defaultHtml).html())},show:function(n,r,s){var o,a,l;this.resetHtml(),"object"===e.type(n)?(l=e.extend({},this.options,n),n=l.theme):(l=this.options,n=n||l.theme),a=r||(l.text===!1?"":l.text),i.addClass("ui-loading"),o=l.textVisible,this.element.attr("class",t+" ui-corner-all ui-body-"+n+" ui-loader-"+(o||r||n.text?"verbose":"default")+(l.textonly||s?" ui-loader-textonly":"")),l.html?this.element.html(l.html):this.element.find("h1").text(a),this.element.appendTo(e.mobile.pageContainer),this.checkLoaderPosition(),this.window.bind("scroll",e.proxy(this.checkLoaderPosition,this))},hide:function(){i.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),e.mobile.window.unbind("scroll",this.fakeFixLoader),e.mobile.window.unbind("scroll",this.checkLoaderPosition)}})}(e,this),function(e,t,n){function r(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var s,o="hashchange",a=i,l=e.event.special,u=a.documentMode,h="on"+o in t&&(u===n||u>7);e.fn[o]=function(e){return e?this.bind(o,e):this.trigger(o)},e.fn[o].delay=50,l[o]=e.extend(l[o],{setup:function(){return h?!1:(e(s.start),n)},teardown:function(){return h?!1:(e(s.stop),n)}}),s=function(){function i(){var n=r(),a=d(u);n!==u?(p(u=n,a),e(t).trigger(o)):a!==u&&(location.href=location.href.replace(/#.*/,"")+a),s=setTimeout(i,e.fn[o].delay)}var s,l={},u=r(),c=function(e){return e},p=c,d=c;return l.start=function(){s||i()},l.stop=function(){s&&clearTimeout(s),s=n},t.attachEvent&&!t.addEventListener&&!h&&function(){var t,n;l.start=function(){t||(n=e.fn[o].src,n=n&&n+r(),t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){n||p(r()),i()}).attr("src",n||"javascript:0").insertAfter("body")[0].contentWindow,a.onpropertychange=function(){try{"title"===event.propertyName&&(t.document.title=a.title)}catch(e){}})},l.stop=c,d=function(){return r(t.location.href)},p=function(i,n){var r=t.document,s=e.fn[o].domain;i!==n&&(r.title=a.title,r.open(),s&&r.write('<script>document.domain="'+s+'"</script>'),r.close(),t.location.hash=i)}}(),l}()}(e,this),function(e){t.matchMedia=t.matchMedia||function(e){var t,i=e.documentElement,n=i.firstElementChild||i.firstChild,r=e.createElement("body"),s=e.createElement("div");return s.id="mq-test-1",s.style.cssText="position:absolute;top:-100em",r.style.background="none",r.appendChild(s),function(e){return s.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(r,n),t=42===s.offsetWidth,i.removeChild(r),{matches:t,media:e}}}(i),e.mobile.media=function(e){return t.matchMedia(e).matches}}(e),function(e){var t={touch:"ontouchend"in i};e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e){e.extend(e.support,{orientation:"orientation"in t&&"onorientationchange"in t})}(e),function(e,n){function r(e){var t,i=e.charAt(0).toUpperCase()+e.substr(1),r=(e+" "+m.join(i+" ")+i).split(" ");for(t in r)if(f[r[t]]!==n)return!0}function s(e,t,n){var r,s,o=i.createElement("div"),a=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},l=function(e){return""===e?"":"-"+e.charAt(0).toLowerCase()+e.substr(1)+"-"},u=function(i){var n=l(i)+e+": "+t+";",r=a(i),u=r+(""===r?e:a(e));o.setAttribute("style",n),o.style[u]&&(s=!0)},h=n?n:m;for(r=0;h.length>r;r++)u(h[r]);return!!s}function o(){var i=t,n=!(!i.document.createElementNS||!i.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||i.opera&&-1===navigator.userAgent.indexOf("Chrome")),r=function(t){t&&n||e("html").addClass("ui-nosvg")},s=new i.Image;s.onerror=function(){r(!1)},s.onload=function(){r(1===s.width&&1===s.height)},s.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}function a(){var r,s,o,a="transform-3d",l=e.mobile.media("(-"+m.join("-"+a+"),(-")+"-"+a+"),("+a+")");if(l)return!!l;r=i.createElement("div"),s={MozTransform:"-moz-transform",transform:"transform"},d.append(r);for(o in s)r.style[o]!==n&&(r.style[o]="translate3d( 100px, 1px, 1px )",l=t.getComputedStyle(r).getPropertyValue(s[o]));return!!l&&"none"!==l}function l(){var t,i,n=location.protocol+"//"+location.host+location.pathname+"ui-dir/",r=e("head base"),s=null,o="";return r.length?o=r.attr("href"):r=s=e("<base>",{href:n}).appendTo("head"),t=e("<a href='testurl' />").prependTo(d),i=t[0].href,r[0].href=o||location.pathname,s&&s.remove(),0===i.indexOf(n)}function u(){var e,n=i.createElement("x"),r=i.documentElement,s=t.getComputedStyle;return"pointerEvents"in n.style?(n.style.pointerEvents="auto",n.style.pointerEvents="x",r.appendChild(n),e=s&&"auto"===s(n,"").pointerEvents,r.removeChild(n),!!e):!1}function h(){var e=i.createElement("div");return e.getBoundingClientRect!==n}function c(){var e=t,i=navigator.userAgent,n=navigator.platform,r=i.match(/AppleWebKit\/([0-9]+)/),s=!!r&&r[1],o=i.match(/Fennec\/([0-9]+)/),a=!!o&&o[1],l=i.match(/Opera Mobi\/([0-9]+)/),u=!!l&&l[1];return(n.indexOf("iPhone")>-1||n.indexOf("iPad")>-1||n.indexOf("iPod")>-1)&&s&&534>s||e.operamini&&"[object OperaMini]"==={}.toString.call(e.operamini)||l&&7458>u||i.indexOf("Android")>-1&&s&&533>s||a&&6>a||"palmGetResource"in t&&s&&534>s||i.indexOf("MeeGo")>-1&&i.indexOf("NokiaBrowser/8.5.0")>-1?!1:!0}var p,d=e("<body>").prependTo("html"),f=d[0].style,m=["Webkit","Moz","O"],g="palmGetResource"in t,y=t.opera,v=t.operamini&&"[object OperaMini]"==={}.toString.call(t.operamini),b=t.blackberry&&!r("-webkit-transform");e.extend(e.mobile,{browser:{}}),e.mobile.browser.oldIE=function(){var e=3,t=i.createElement("div"),n=t.all||[];do t.innerHTML="<!--[if gt IE "+ ++e+"]><br><![endif]-->";while(n[0]);return e>4?e:!e}(),e.extend(e.support,{cssTransitions:"WebKitTransitionEvent"in t||s("transition","height 100ms linear",["Webkit","Moz",""])&&!e.mobile.browser.oldIE&&!y,pushState:"pushState"in history&&"replaceState"in history&&!(t.navigator.userAgent.indexOf("Firefox")>=0&&t.top!==t)&&-1===t.navigator.userAgent.search(/CriOS/),mediaquery:e.mobile.media("only all"),cssPseudoElement:!!r("content"),touchOverflow:!!r("overflowScrolling"),cssTransform3d:a(),cssAnimations:!!r("animationName"),boxShadow:!!r("boxShadow")&&!b,fixedPosition:c(),scrollTop:("pageXOffset"in t||"scrollTop"in i.documentElement||"scrollTop"in d[0])&&!g&&!v,dynamicBaseTag:l(),cssPointerEvents:u(),boundingRect:h(),inlineSVG:o}),d.remove(),p=function(){var e=t.navigator.userAgent;return e.indexOf("Nokia")>-1&&(e.indexOf("Symbian/3")>-1||e.indexOf("Series60/5")>-1)&&e.indexOf("AppleWebKit")>-1&&e.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}(),e.mobile.gradeA=function(){return(e.support.mediaquery&&e.support.cssPseudoElement||e.mobile.browser.oldIE&&e.mobile.browser.oldIE>=8)&&(e.support.boundingRect||null!==e.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},e.mobile.ajaxBlacklist=t.blackberry&&!t.WebKitPoint||v||p,p&&e(function(){e("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),e.support.boxShadow||e("html").addClass("ui-noboxshadow")}(e),function(e,t){var i,n=e.mobile.window,r=function(){};e.event.special.beforenavigate={setup:function(){n.on("navigate",r)},teardown:function(){n.off("navigate",r)}},e.event.special.navigate=i={bound:!1,pushStateEnabled:!0,originalEventName:t,isPushStateEnabled:function(){return e.support.pushState&&e.mobile.pushStateEnabled===!0&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return e.mobile.hashListeningEnabled===!0},popstate:function(t){var i=new e.Event("navigate"),r=new e.Event("beforenavigate"),s=t.originalEvent.state||{};r.originalEvent=t,n.trigger(r),r.isDefaultPrevented()||(t.historyState&&e.extend(s,t.historyState),i.originalEvent=t,setTimeout(function(){n.trigger(i,{state:s})},0))},hashchange:function(t){var i=new e.Event("navigate"),r=new e.Event("beforenavigate");r.originalEvent=t,n.trigger(r),r.isDefaultPrevented()||(i.originalEvent=t,n.trigger(i,{state:t.hashchangeState||{}}))},setup:function(){i.bound||(i.bound=!0,i.isPushStateEnabled()?(i.originalEventName="popstate",n.bind("popstate.navigate",i.popstate)):i.isHashChangeEnabled()&&(i.originalEventName="hashchange",n.bind("hashchange.navigate",i.hashchange)))}}}(e),function(e,i){var n,r,s="&ui-state=dialog";e.mobile.path=n={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=e?this.parseUrl(e):location,i=this.parseUrl(e||location.href).hash;return i="#"===i?"":i,t.protocol+"//"+t.host+t.pathname+t.search+i},getDocumentUrl:function(t){return t?e.extend({},n.documentUrl):n.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(t){if("object"===e.type(t))return t;var i=n.urlParseRE.exec(t||"")||[];return{href:i[0]||"",hrefNoHash:i[1]||"",hrefNoSearch:i[2]||"",domain:i[3]||"",protocol:i[4]||"",doubleSlash:i[5]||"",authority:i[6]||"",username:i[8]||"",password:i[9]||"",host:i[10]||"",hostname:i[11]||"",port:i[12]||"",pathname:i[13]||"",directory:i[14]||"",filename:i[15]||"",search:i[16]||"",hash:i[17]||""}},makePathAbsolute:function(e,t){var i,n,r,s;if(e&&"/"===e.charAt(0))return e;for(e=e||"",t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"",i=t?t.split("/"):[],n=e.split("/"),r=0;n.length>r;r++)switch(s=n[r]){case".":break;case"..":i.length&&i.pop();break;default:i.push(s)}return"/"+i.join("/")},isSameDomain:function(e,t){return n.parseUrl(e).domain===n.parseUrl(t).domain},isRelativeUrl:function(e){return""===n.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==n.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!n.isRelativeUrl(e))return e;t===i&&(t=this.documentBase);var r=n.parseUrl(e),s=n.parseUrl(t),o=r.protocol||s.protocol,a=r.protocol?r.doubleSlash:r.doubleSlash||s.doubleSlash,l=r.authority||s.authority,u=""!==r.pathname,h=n.makePathAbsolute(r.pathname||s.filename,s.pathname),c=r.search||!u&&s.search||"",p=r.hash;return o+a+l+h+c+p},addSearchParams:function(t,i){var r=n.parseUrl(t),s="object"==typeof i?e.param(i):i,o=r.search||"?";return r.hrefNoSearch+o+("?"!==o.charAt(o.length-1)?"&":"")+s+(r.hash||"")},convertUrlToDataUrl:function(e){var i=n.parseUrl(e);return n.isEmbeddedPage(i)?i.hash.split(s)[0].replace(/^#/,"").replace(/\?.*$/,""):n.isSameDomain(i,this.documentBase)?i.hrefNoHash.replace(this.documentBase.domain,"").split(s)[0]:t.decodeURIComponent(e)},get:function(e){return e===i&&(e=n.parseLocation().hash),n.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return n.stripHash(e.replace(/\?.*$/,"").replace(s,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=n.parseUrl(e);return t.protocol&&t.domain!==this.documentUrl.domain?!0:!1},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=n.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var i,r,s,o,a=this.isPath(e),l=this.parseUrl(e),u=l.hash,h="";return t=t||(n.isPath(e)?n.getLocation():n.getDocumentUrl()),r=a?n.stripHash(e):e,r=n.isPath(l.hash)?n.stripHash(l.hash):r,o=r.indexOf(this.uiStateKey),o>-1&&(h=r.slice(o),r=r.slice(0,o)),i=n.makeUrlAbsolute(r,t),s=this.parseUrl(i).search,a?((n.isPath(u)||0===u.replace("#","").indexOf(this.uiStateKey))&&(u=""),h&&-1===u.indexOf(this.uiStateKey)&&(u+=h),-1===u.indexOf("#")&&""!==u&&(u="#"+u),i=n.parseUrl(i),i=i.protocol+"//"+i.host+i.pathname+s+u):i+=i.indexOf("#")>-1?h:"#"+h,i},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(t){var i="&"+e.mobile.subPageUrlKey;return t&&t.split(i)[0].split(s)[0]},isFirstPageUrl:function(t){var r=n.parseUrl(n.makeUrlAbsolute(t,this.documentBase)),s=r.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&r.hrefNoHash===this.documentBase.hrefNoHash,o=e.mobile.firstPage,a=o&&o[0]?o[0].id:i;return s&&(!r.hash||"#"===r.hash||a&&r.hash.replace(/^#/,"")===a)},isPermittedCrossDomainRequest:function(t,i){return e.mobile.allowCrossDomainPages&&("file:"===t.protocol||"content:"===t.protocol)&&-1!==i.search(/^https?:/)}},n.documentUrl=n.parseLocation(),r=e("head").find("base"),n.documentBase=r.length?n.parseUrl(n.makeUrlAbsolute(r.attr("href"),n.documentUrl.href)):n.documentUrl,n.documentBaseDiffers=n.documentUrl.hrefNoHash!==n.documentBase.hrefNoHash,n.getDocumentBase=function(t){return t?e.extend({},n.documentBase):n.documentBase.href},e.extend(e.mobile,{getDocumentUrl:n.getDocumentUrl,getDocumentBase:n.getDocumentBase})}(e),function(e,t){e.mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},e.extend(e.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,i){t=t||this.stack;var n,r,s,o=t.length;for(r=0;o>r;r++)if(n=t[r],(decodeURIComponent(e)===decodeURIComponent(n.url)||decodeURIComponent(e)===decodeURIComponent(n.hash))&&(s=r,i))return s;return s},closest:function(e){var i,n=this.activeIndex;return i=this.find(e,this.stack.slice(0,n)),i===t&&(i=this.find(e,this.stack.slice(n),!0),i=i===t?i:i+n),i},direct:function(i){var n=this.closest(i.url),r=this.activeIndex;n!==t&&(this.activeIndex=n,this.previousIndex=r),r>n?(i.present||i.back||e.noop)(this.getActive(),"back"):n>r?(i.present||i.forward||e.noop)(this.getActive(),"forward"):n===t&&i.missing&&i.missing(this.getActive())}})}(e),function(e){var n=e.mobile.path,r=location.href;e.mobile.Navigator=function(t){this.history=t,this.ignoreInitialHashChange=!0,e.mobile.window.bind({"popstate.history":e.proxy(this.popstate,this),"hashchange.history":e.proxy(this.hashchange,this)})},e.extend(e.mobile.Navigator.prototype,{squash:function(r,s){var o,a,l=n.isPath(r)?n.stripHash(r):r;return a=n.squash(r),o=e.extend({hash:l,url:a},s),t.history.replaceState(o,o.title||i.title,a),o},hash:function(e,t){var i,r,s,o;return i=n.parseUrl(e),r=n.parseLocation(),r.pathname+r.search===i.pathname+i.search?s=i.hash?i.hash:i.pathname+i.search:n.isPath(e)?(o=n.parseUrl(t),s=o.pathname+o.search+(n.isPreservableHash(o.hash)?o.hash.replace("#",""):"")):s=e,s},go:function(r,s,o){var a,l,u,h,c=e.event.special.navigate.isPushStateEnabled();l=n.squash(r),u=this.hash(r,l),o&&u!==n.stripHash(n.parseLocation().hash)&&(this.preventNextHashChange=o),this.preventHashAssignPopState=!0,t.location.hash=u,this.preventHashAssignPopState=!1,a=e.extend({url:l,hash:u,title:i.title},s),c&&(h=new e.Event("popstate"),h.originalEvent={type:"popstate",state:null},this.squash(r,a),o||(this.ignorePopState=!0,e.mobile.window.trigger(h))),this.history.add(a.url,a)},popstate:function(t){var i,s;if(e.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,t.stopImmediatePropagation(),undefined):this.ignorePopState?(this.ignorePopState=!1,undefined):!t.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===r)?(t.preventDefault(),undefined):(i=n.parseLocation().hash,!t.originalEvent.state&&i?(s=this.squash(i),this.history.add(s.url,s),t.historyState=s,undefined):(this.history.direct({url:(t.originalEvent.state||{}).url||i,present:function(i,n){t.historyState=e.extend({},i),t.historyState.direction=n}}),undefined))},hashchange:function(t){var r,s;if(e.event.special.navigate.isHashChangeEnabled()&&!e.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,t.stopImmediatePropagation(),undefined;r=this.history,s=n.parseLocation().hash,this.history.direct({url:s,present:function(i,n){t.hashchangeState=e.extend({},i),t.hashchangeState.direction=n},missing:function(){r.add(s,{hash:s,title:i.title})}})}}})}(e),function(e){e.mobile.navigate=function(t,i,n){e.mobile.navigate.navigator.go(t,i,n)},e.mobile.navigate.history=new e.mobile.History,e.mobile.navigate.navigator=new e.mobile.Navigator(e.mobile.navigate.history);var t=e.mobile.path.parseLocation();e.mobile.navigate.history.add(t.href,{hash:t.hash})}(e),function(e,t,i,n){function r(e){for(;e&&e.originalEvent!==n;)e=e.originalEvent;return e}function s(t,i){var s,o,a,l,u,h,c,p,d,f=t.type;if(t=e.Event(t),t.type=i,s=t.originalEvent,o=e.event.props,f.search(/^(mouse|click)/)>-1&&(o=P),s)for(c=o.length,l;c;)l=o[--c],t[l]=s[l];if(f.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==f.search(/^touch/)&&(a=r(s),f=a.touches,u=a.changedTouches,h=f&&f.length?f[0]:u&&u.length?u[0]:n))for(p=0,d=k.length;d>p;p++)l=k[p],t[l]=h[l];return t}function o(t){for(var i,n,r={};t;){i=e.data(t,C);for(n in i)i[n]&&(r[n]=r.hasVirtualBinding=!0);t=t.parentNode}return r}function a(t,i){for(var n;t;){if(n=e.data(t,C),n&&(!i||n[i]))return t;t=t.parentNode}return null}function l(){R=!1}function u(){R=!0}function h(){U=0,D.length=0,M=!1,u()
}function c(){l()}function p(){d(),N=setTimeout(function(){N=0,h()},e.vmouse.resetTimerDuration)}function d(){N&&(clearTimeout(N),N=0)}function f(t,i,n){var r;return(n&&n[t]||!n&&a(i.target,t))&&(r=s(i,t),e(i.target).trigger(r)),r}function m(t){var i,n=e.data(t.target,E);M||U&&U===n||(i=f("v"+t.type,t),i&&(i.isDefaultPrevented()&&t.preventDefault(),i.isPropagationStopped()&&t.stopPropagation(),i.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function g(t){var i,n,s,a=r(t).touches;a&&1===a.length&&(i=t.target,n=o(i),n.hasVirtualBinding&&(U=j++,e.data(i,E,U),d(),c(),A=!1,s=r(t).touches[0],F=s.pageX,I=s.pageY,f("vmouseover",t,n),f("vmousedown",t,n)))}function y(e){R||(A||f("vmousecancel",e,o(e.target)),A=!0,p())}function v(t){if(!R){var i=r(t).touches[0],n=A,s=e.vmouse.moveDistanceThreshold,a=o(t.target);A=A||Math.abs(i.pageX-F)>s||Math.abs(i.pageY-I)>s,A&&!n&&f("vmousecancel",t,a),f("vmousemove",t,a),p()}}function b(e){if(!R){u();var t,i,n=o(e.target);f("vmouseup",e,n),A||(t=f("vclick",e,n),t&&t.isDefaultPrevented()&&(i=r(e).changedTouches[0],D.push({touchID:U,x:i.clientX,y:i.clientY}),M=!0)),f("vmouseout",e,n),A=!1,p()}}function _(t){var i,n=e.data(t,C);if(n)for(i in n)if(n[i])return!0;return!1}function w(){}function x(t){var i=t.substr(1);return{setup:function(){_(this)||e.data(this,C,{});var n=e.data(this,C);n[t]=!0,q[t]=(q[t]||0)+1,1===q[t]&&B.bind(i,m),e(this).bind(i,w),z&&(q.touchstart=(q.touchstart||0)+1,1===q.touchstart&&B.bind("touchstart",g).bind("touchend",b).bind("touchmove",v).bind("scroll",y))},teardown:function(){--q[t],q[t]||B.unbind(i,m),z&&(--q.touchstart,q.touchstart||B.unbind("touchstart",g).unbind("touchmove",v).unbind("touchend",b).unbind("scroll",y));var n=e(this),r=e.data(this,C);r&&(r[t]=!1),n.unbind(i,w),_(this)||n.removeData(C)}}}var L,O,C="virtualMouseBindings",E="virtualTouchID",S="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),k="clientX clientY pageX pageY screenX screenY".split(" "),T=e.event.mouseHooks?e.event.mouseHooks.props:[],P=e.event.props.concat(T),q={},N=0,F=0,I=0,A=!1,D=[],M=!1,R=!1,z="addEventListener"in i,B=e(i),j=1,U=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},O=0;S.length>O;O++)e.event.special[S[O]]=x(S[O]);z&&i.addEventListener("click",function(t){var i,r,s,o,a,l,u=D.length,h=t.target;if(u)for(i=t.clientX,r=t.clientY,L=e.vmouse.clickDistanceThreshold,s=h;s;){for(o=0;u>o;o++)if(a=D[o],l=0,s===h&&L>Math.abs(a.x-i)&&L>Math.abs(a.y-r)||e.data(s,E)===a.touchID)return t.preventDefault(),t.stopPropagation(),n;s=s.parentNode}},!0)}(e,t,i),function(e){function t(t,i,n){var r=n.type;n.type=i,e.event.dispatch.call(t,n),n.type=r}var n=e(i),r=e.mobile.support.touch,s="touchmove scroll",o=r?"touchstart":"mousedown",a=r?"touchend":"mouseup",l=r?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,i){e.fn[i]=function(e){return e?this.bind(i,e):this.trigger(i)},e.attrFn&&(e.attrFn[i]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function i(e,i){n=i,t(o,n?"scrollstart":"scrollstop",e)}var n,r,o=this,a=e(o);a.bind(s,function(t){e.event.special.scrollstart.enabled&&(n||i(t,!0),clearTimeout(r),r=setTimeout(function(){i(t,!1)},50))})},teardown:function(){e(this).unbind(s)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var i=this,r=e(i),s=!1;r.bind("vmousedown",function(o){function a(){clearTimeout(h)}function l(){a(),r.unbind("vclick",u).unbind("vmouseup",a),n.unbind("vmousecancel",l)}function u(e){l(),s||c!==e.target?s&&e.stopPropagation():t(i,"tap",e)}if(s=!1,o.which&&1!==o.which)return!1;var h,c=o.target;r.bind("vmouseup",a).bind("vclick",u),n.bind("vmousecancel",l),h=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(s=!0),t(i,"taphold",e.Event("taphold",{target:c}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),n.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(t){var i=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[i.pageX,i.pageY],origin:e(t.target)}},stop:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY]}},handleSwipe:function(i,n,r,s){if(n.time-i.time<e.event.special.swipe.durationThreshold&&Math.abs(i.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(i.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var o=i.coords[0]>n.coords[0]?"swipeleft":"swiperight";return t(r,"swipe",e.Event("swipe",{target:s,swipestart:i,swipestop:n})),t(r,o,e.Event(o,{target:s,swipestart:i,swipestop:n})),!0}return!1},setup:function(){var t=this,i=e(t);i.bind(o,function(n){function r(i){o&&(s=e.event.special.swipe.stop(i),h||(h=e.event.special.swipe.handleSwipe(o,s,t,u)),Math.abs(o.coords[0]-s.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&i.preventDefault())}var s,o=e.event.special.swipe.start(n),u=n.target,h=!1;i.bind(l,r).one(a,function(){h=!0,i.unbind(l,r)})})},teardown:function(){e(this).unbind(o).unbind(l).unbind(a)}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,i){e.event.special[t]={setup:function(){e(this).bind(i,e.noop)},teardown:function(){e(this).unbind(i)}}})}(e,this),function(e){e.event.special.throttledresize={setup:function(){e(this).bind("resize",s)},teardown:function(){e(this).unbind("resize",s)}};var t,i,n,r=250,s=function(){i=(new Date).getTime(),n=i-o,n>=r?(o=i,e(this).trigger("throttledresize")):(t&&clearTimeout(t),t=setTimeout(s,r-n))},o=0}(e),function(e,t){function n(){var e=r();e!==s&&(s=e,c.trigger(p))}var r,s,o,a,l,u,h,c=e(t),p="orientationchange",d={0:!0,180:!0};e.support.orientation&&(l=t.innerWidth||c.width(),u=t.innerHeight||c.height(),h=50,o=l>u&&l-u>h,a=d[t.orientation],(o&&a||!o&&!a)&&(d={"-90":!0,90:!0})),e.event.special.orientationchange=e.extend({},e.event.special.orientationchange,{setup:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:(s=r(),c.bind("throttledresize",n),undefined)},teardown:function(){return e.support.orientation&&!e.event.special.orientationchange.disabled?!1:(c.unbind("throttledresize",n),undefined)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=r(),t.apply(this,arguments)}}}),e.event.special.orientationchange.orientation=r=function(){var n=!0,r=i.documentElement;return n=e.support.orientation?d[t.orientation]:r&&1.1>r.clientWidth/r.clientHeight,n?"portrait":"landscape"},e.fn[p]=function(e){return e?this.bind(p,e):this.trigger(p)},e.attrFn&&(e.attrFn[p]=!0)}(e,this),function(e){var t=e("head").children("base"),i={element:t.length?t:e("<base>",{href:e.mobile.path.documentBase.hrefNoHash}).prependTo(e("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(t){e.mobile.dynamicBaseEnabled&&e.support.dynamicBaseTag&&i.element.attr("href",e.mobile.path.makeUrlAbsolute(t,e.mobile.path.documentBase))},rewrite:function(t,n){var r=e.mobile.path.get(t);n.find(i.linkSelector).each(function(t,i){var n=e(i).is("[href]")?"href":e(i).is("[src]")?"src":"action",s=e(i).attr(n);s=s.replace(location.protocol+"//"+location.host+location.pathname,""),/^(\w+:|#|\/)/.test(s)||e(i).attr(n,r+s)})},reset:function(){i.element.attr("href",e.mobile.path.documentBase.hrefNoSearch)}};e.mobile.base=i}(e),function(e,t){e.mobile.widgets={};var i=e.widget,n=e.mobile.keepNative;e.widget=function(i){return function(){var n=i.apply(this,arguments),r=n.prototype.widgetName;return n.initSelector=n.prototype.initSelector!==t?n.prototype.initSelector:":jqmData(role='"+r+"')",e.mobile.widgets[r]=n,n}}(e.widget),e.extend(e.widget,i),e.mobile.document.on("create",function(t){e(t.target).enhanceWithin()}),e.widget("mobile.page",{options:{theme:"a",domCache:!1,keepNativeDefault:e.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){e.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return this._trigger("beforecreate")===!1?!1:(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),"dialog"===e.mobile.getAttribute(this.element[0],"role")&&e.mobile.dialog&&this.element.dialog(),t)},_enhance:function(){var i="data-"+e.mobile.ns,n=this;this.options.role&&this.element.attr("data-"+e.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+i+"role='content']").each(function(){var r=e(this),s=this.getAttribute(i+"theme")||t;n.options.contentTheme=s||n.options.contentTheme||n.options.dialog&&n.options.theme||"dialog"===n.element.jqmData("role")&&n.options.theme,r.addClass("ui-content"),n.options.contentTheme&&r.addClass("ui-body-"+n.options.contentTheme),r.attr("role","main").addClass("ui-content")})},bindRemove:function(t){var i=this.element;!i.data("mobile-page").options.domCache&&i.is(":jqmData(external-page='true')")&&i.bind("pagehide.remove",t||function(t,i){if(!i.samePage){var n=e(this),r=new e.Event("pageremove");n.trigger(r),r.isDefaultPrevented()||n.removeWithDependents()}})},_setOptions:function(i){i.theme!==t&&this.element.removeClass("ui-body-"+this.options.theme).addClass("ui-body-"+i.theme),i.contentTheme!==t&&this.element.find("[data-"+e.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+i.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(e){this.element.parent().pagecontainer({theme:e||this.options.theme})},keepNativeSelector:function(){var t=this.options,i=e.trim(t.keepNative||""),r=e.trim(e.mobile.keepNative),s=e.trim(t.keepNativeDefault),o=n===r?"":r,a=""===o?s:"";return(i?[i]:[]).concat(o?[o]:[]).concat(a?[a]:[]).join(", ")}})}(e),function(e,n){e.widget("mobile.pagecontainer",{options:{theme:"a"},initSelector:!1,_create:function(){this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",e.proxy(function(){this.setLastScrollEnabled=!0},this))},_setOptions:function(e){e.theme!==n&&"none"!==e.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+e.theme):e.theme!==n&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(e)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var e,t,i,n=this._getActiveHistory();n&&(e=this._getScroll(),t=this._getMinScroll(),i=this._getDefaultScroll(),n.lastScroll=t>e?i:e)}},_delayedRecordScroll:function(){setTimeout(e.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return e.mobile.minScrollBack},_getDefaultScroll:function(){return e.mobile.defaultHomeScroll},_filterNavigateEvents:function(t,i){var n;t.originalEvent&&t.originalEvent.isDefaultPrevented()||(n=t.originalEvent.type.indexOf("hashchange")>-1?i.state.hash:i.state.url,n||(n=this._getHash()),n&&"#"!==n&&0!==n.indexOf("#"+e.mobile.path.uiStateKey)||(n=location.href),this._handleNavigate(n,i.state))},_getHash:function(){return e.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return e.mobile.firstPage},_getHistory:function(){return e.mobile.navigate.history},_getActiveHistory:function(){return e.mobile.navigate.history.getActive()},_getDocumentBase:function(){return e.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(i){if(e.mobile.hashListeningEnabled)t.history.go(i);else{var n=e.mobile.navigate.history.activeIndex,r=n+parseInt(i,10),s=e.mobile.navigate.history.stack[r].url,o=i>=1?"forward":"back";e.mobile.navigate.history.activeIndex=r,e.mobile.navigate.history.previousIndex=n,this.change(s,{direction:o,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(t){var i;return"string"===e.type(t)&&(t=e.mobile.path.stripHash(t)),t&&(i=this._getHistory(),t=e.mobile.path.isPath(t)?t:e.mobile.path.makeUrlAbsolute("#"+t,this._getDocumentBase()),t===e.mobile.path.makeUrlAbsolute("#"+i.initialDst,this._getDocumentBase())&&i.stack.length&&i.stack[0].url!==i.initialDst.replace(e.mobile.dialogHashKey,"")&&(t=this._getInitialContent())),t||this._getInitialContent()},_handleDialog:function(t,i){var n,r,s=this.getActivePage();return s&&!s.hasClass("ui-dialog")?("back"===i.direction?this.back():this.forward(),!1):(n=i.pageUrl,r=this._getActiveHistory(),e.extend(t,{role:r.role,transition:r.transition,reverse:"back"===i.direction}),n)},_handleNavigate:function(t,i){var r=e.mobile.path.stripHash(t),s=this._getHistory(),o=0===s.stack.length?"none":n,a={changeHash:!1,fromHashChange:!0,reverse:"back"===i.direction};e.extend(a,i,{transition:(s.getLast()||{}).transition||o}),s.activeIndex>0&&r.indexOf(e.mobile.dialogHashKey)>-1&&s.initialDst!==r&&(r=this._handleDialog(a,i),r===!1)||this._changeContent(this._handleDestination(r),a)},_changeContent:function(t,i){e.mobile.changePage(t,i)},_getBase:function(){return e.mobile.base},_getNs:function(){return e.mobile.ns},_enhance:function(e,t){return e.page({role:t})},_include:function(e,t){e.appendTo(this.element),this._enhance(e,t.role),e.page("bindRemove")},_find:function(t){var i,n=this._createFileUrl(t),r=this._createDataUrl(t),s=this._getInitialContent();return i=this.element.children("[data-"+this._getNs()+"url='"+r+"']"),0===i.length&&r&&!e.mobile.path.isPath(r)&&(i=this.element.children(e.mobile.path.hashToSelector("#"+r)).attr("data-"+this._getNs()+"url",r).jqmData("url",r)),0===i.length&&e.mobile.path.isFirstPageUrl(n)&&s&&s.parent().length&&(i=e(s)),i},_getLoader:function(){return e.mobile.loading()},_showLoading:function(t,i,n,r){this._loadMsg||(this._loadMsg=setTimeout(e.proxy(function(){this._getLoader().loader("show",i,n,r),this._loadMsg=0},this),t))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,e.mobile.pageLoadErrorMessageTheme,e.mobile.pageLoadErrorMessage,!0),setTimeout(e.proxy(this,"_hideLoading"),1500)},_parse:function(t,i){var n,r=e("<div></div>");return r.get(0).innerHTML=t,n=r.find(":jqmData(role='page'), :jqmData(role='dialog')").first(),n.length||(n=e("<div data-"+this._getNs()+"role='page'>"+(t.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),n.attr("data-"+this._getNs()+"url",e.mobile.path.convertUrlToDataUrl(i)).attr("data-"+this._getNs()+"external-page",!0),n},_setLoadedTitle:function(t,i){var n=i.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;n&&!t.jqmData("title")&&(n=e("<div>"+n+"</div>").text(),t.jqmData("title",n))},_isRewritableBaseTag:function(){return e.mobile.dynamicBaseEnabled&&!e.support.dynamicBaseTag},_createDataUrl:function(t){return e.mobile.path.convertUrlToDataUrl(t)},_createFileUrl:function(t){return e.mobile.path.getFilePath(t)},_triggerWithDeprecated:function(t,i,n){var r=e.Event("page"+t),s=e.Event(this.widgetName+t);return(n||this.element).trigger(r,i),this.element.trigger(s,i),{deprecatedEvent:r,event:s}},_loadSuccess:function(t,i,r,s){var o=this._createFileUrl(t),a=this._createDataUrl(t);return e.proxy(function(l,u,h){var c,p=RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),d=RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");p.test(l)&&RegExp.$1&&d.test(RegExp.$1)&&RegExp.$1&&(o=e.mobile.path.getFilePath(e("<div>"+RegExp.$1+"</div>").text())),r.prefetch===n&&this._getBase().set(o),c=this._parse(l,o),this._setLoadedTitle(c,l),i.xhr=h,i.textStatus=u,i.page=c,i.content=c,this._trigger("load",n,i)&&(this._isRewritableBaseTag()&&c&&this._getBase().rewrite(o,c),this._include(c,r),t.indexOf("&"+e.mobile.subPageUrlKey)>-1&&(c=this.element.children("[data-"+this._getNs()+"url='"+a+"']")),r.showLoadMsg&&this._hideLoading(),this.element.trigger("pageload"),s.resolve(t,r,c))},this)},_loadDefaults:{type:"get",data:n,reloadPage:!1,reload:!1,role:n,showLoadMsg:!1,loadMsgDelay:50},load:function(t,i){var r,s,o,a,l=i&&i.deferred||e.Deferred(),u=e.extend({},this._loadDefaults,i),h=null,c=e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault());return u.reload=u.reloadPage,u.data&&"get"===u.type&&(c=e.mobile.path.addSearchParams(c,u.data),u.data=n),u.data&&"post"===u.type&&(u.reload=!0),r=this._createFileUrl(c),s=this._createDataUrl(c),h=this._find(c),0===h.length&&e.mobile.path.isEmbeddedPage(r)&&!e.mobile.path.isFirstPageUrl(r)?(l.reject(c,u),n):(this._getBase().reset(),h.length&&!u.reload?(this._enhance(h,u.role),l.resolve(c,u,h),u.prefetch||this._getBase().set(t),n):(a={url:t,absUrl:c,dataUrl:s,deferred:l,options:u},o=this._triggerWithDeprecated("beforeload",a),o.deprecatedEvent.isDefaultPrevented()||o.event.isDefaultPrevented()?n:(u.showLoadMsg&&this._showLoading(u.loadMsgDelay),u.prefetch===n&&this._getBase().reset(),e.mobile.allowCrossDomainPages||e.mobile.path.isSameDomain(e.mobile.path.documentUrl,c)?(e.ajax({url:r,type:u.type,data:u.data,contentType:u.contentType,dataType:"html",success:this._loadSuccess(c,a,u,l),error:this._loadError(c,a,u,l)}),n):(l.reject(c,u),n))))},_loadError:function(t,i,n,r){return e.proxy(function(s,o,a){this._getBase().set(e.mobile.path.get()),i.xhr=s,i.textStatus=o,i.errorThrown=a;var l=this._triggerWithDeprecated("loadfailed",i);l.deprecatedEvent.isDefaultPrevented()||l.event.isDefaultPrevented()||(n.showLoadMsg&&this._showError(),r.reject(t,n))},this)},_getTransitionHandler:function(t){return t=e.mobile._maybeDegradeTransition(t),e.mobile.transitionHandlers[t]||e.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(t,i,n){var r=!1;n=n||"",i&&(t[0]===i[0]&&(r=!0),this._triggerWithDeprecated(n+"hide",{nextPage:t,samePage:r},i)),this._triggerWithDeprecated(n+"show",{prevPage:i||e("")},t)},_cssTransition:function(t,i,n){var r,s,o=n.transition,a=n.reverse,l=n.deferred;this._triggerCssTransitionEvents(t,i,"before"),this._hideLoading(),r=this._getTransitionHandler(o),s=new r(o,a,t,i).transition(),s.done(function(){l.resolve.apply(l,arguments)}),s.done(e.proxy(function(){this._triggerCssTransitionEvents(t,i)},this))},_releaseTransitionLock:function(){s=!1,r.length>0&&e.mobile.changePage.apply(null,r.pop())},_removeActiveLinkClass:function(t){e.mobile.removeActiveLinkClass(t)},_loadUrl:function(t,i,n){n.target=t,n.deferred=e.Deferred(),this.load(t,n),n.deferred.done(e.proxy(function(e,t,n){s=!1,t.absUrl=i.absUrl,this.transition(n,i,t)},this)),n.deferred.fail(e.proxy(function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",i)},this))},_triggerPageBeforeChange:function(t,i,n){var r=new e.Event("pagebeforechange");return e.extend(i,{toPage:t,options:n}),i.absUrl="string"===e.type(t)?e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault()):n.absUrl,this.element.trigger(r,i),r.isDefaultPrevented()?!1:!0},change:function(t,i){if(s)return r.unshift(arguments),n;var o=e.extend({},e.mobile.changePage.defaults,i),a={};o.fromPage=o.fromPage||this.activePage,this._triggerPageBeforeChange(t,a,o)&&(t=a.toPage,"string"===e.type(t)?(s=!0,this._loadUrl(t,a,o)):this.transition(t,a,o))},transition:function(t,o,a){var l,u,h,c,p,d,f,m,g,y,v,b,_,w;if(s)return r.unshift([t,a]),n;if(this._triggerPageBeforeChange(t,o,a)&&(w=this._triggerWithDeprecated("beforetransition",o),!w.deprecatedEvent.isDefaultPrevented()&&!w.event.isDefaultPrevented())){if(s=!0,t[0]!==e.mobile.firstPage[0]||a.dataUrl||(a.dataUrl=e.mobile.path.documentUrl.hrefNoHash),l=a.fromPage,u=a.dataUrl&&e.mobile.path.convertUrlToDataUrl(a.dataUrl)||t.jqmData("url"),h=u,c=e.mobile.path.getFilePath(u),p=e.mobile.navigate.history.getActive(),d=0===e.mobile.navigate.history.activeIndex,f=0,m=i.title,g=("dialog"===a.role||"dialog"===t.jqmData("role"))&&t.jqmData("dialog")!==!0,l&&l[0]===t[0]&&!a.allowSamePageTransition)return s=!1,this._triggerWithDeprecated("transition",o),this.element.trigger("pagechange",o),a.fromHashChange&&e.mobile.navigate.history.direct({url:u}),n;t.page({role:a.role}),a.fromHashChange&&(f="back"===a.direction?-1:1);try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()?e(i.activeElement).blur():e("input:focus, textarea:focus, select:focus").blur()}catch(x){}y=!1,g&&p&&(p.url&&p.url.indexOf(e.mobile.dialogHashKey)>-1&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&e.mobile.navigate.history.activeIndex>0&&(a.changeHash=!1,y=!0),u=p.url||"",u+=!y&&u.indexOf("#")>-1?e.mobile.dialogHashKey:"#"+e.mobile.dialogHashKey,0===e.mobile.navigate.history.activeIndex&&u===e.mobile.navigate.history.initialDst&&(u+=e.mobile.dialogHashKey)),v=p?t.jqmData("title")||t.children(":jqmData(role='header')").find(".ui-title").text():m,v&&m===i.title&&(m=v),t.jqmData("title")||t.jqmData("title",m),a.transition=a.transition||(f&&!d?p.transition:n)||(g?e.mobile.defaultDialogTransition:e.mobile.defaultPageTransition),!f&&y&&(e.mobile.navigate.history.getActive().pageUrl=h),u&&!a.fromHashChange&&(!e.mobile.path.isPath(u)&&0>u.indexOf("#")&&(u="#"+u),b={transition:a.transition,title:m,pageUrl:h,role:a.role},a.changeHash!==!1&&e.mobile.hashListeningEnabled?e.mobile.navigate(u,b,!0):t[0]!==e.mobile.firstPage[0]&&e.mobile.navigate.history.add(u,b)),i.title=m,e.mobile.activePage=t,this.activePage=t,a.reverse=a.reverse||0>f,_=e.Deferred(),this._cssTransition(t,l,{transition:a.transition,reverse:a.reverse,deferred:_}),_.done(e.proxy(function(i,n,r,s,l){e.mobile.removeActiveLinkClass(),a.duplicateCachedPage&&a.duplicateCachedPage.remove(),l||e.mobile.focusPage(t),this._releaseTransitionLock(),this.element.trigger("pagechange",o),this._triggerWithDeprecated("transition",o)},this))}},_findBaseWithDefault:function(){var t=this.activePage&&e.mobile.getClosestBaseUrl(this.activePage);return t||e.mobile.path.documentBase.hrefNoHash}}),e.mobile.navreadyDeferred=e.Deferred();var r=[],s=!1}(e),function(e,i){function n(e){for(;e&&("string"!=typeof e.nodeName||"a"!==e.nodeName.toLowerCase());)e=e.parentNode;return e}var r=e.Deferred(),s=e.mobile.path.documentUrl,o=null;e.mobile.loadPage=function(t,i){var n;return i=i||{},n=i.pageContainer||e.mobile.pageContainer,i.deferred=e.Deferred(),n.pagecontainer("load",t,i),i.deferred.promise()},e.mobile.back=function(){var i=t.navigator;this.phonegapNavigationEnabled&&i&&i.app&&i.app.backHistory?i.app.backHistory():e.mobile.pageContainer.pagecontainer("back")},e.mobile.focusPage=function(e){var t=e.find("[autofocus]"),n=e.find(".ui-title:eq(0)");return t.length?(t.focus(),i):(n.length?n.focus():e.focus(),i)},e.mobile._maybeDegradeTransition=e.mobile._maybeDegradeTransition||function(e){return e},e.fn.animationComplete=function(t){return e.support.cssTransitions?e(this).one("webkitAnimationEnd animationend",t):(setTimeout(t,0),e(this))},e.mobile.changePage=function(t,i){e.mobile.pageContainer.pagecontainer("change",t,i)},e.mobile.changePage.defaults={transition:i,reverse:!1,changeHash:!0,fromHashChange:!1,role:i,duplicateCachedPage:i,pageContainer:i,showLoadMsg:!0,dataUrl:i,fromPage:i,allowSamePageTransition:!1},e.mobile._registerInternalEvents=function(){var r=function(t,n){var r,a,l,u,h=!0;return!e.mobile.ajaxEnabled||t.is(":jqmData(ajax='false')")||!t.jqmHijackable().length||t.attr("target")?!1:(r=o&&o.attr("formaction")||t.attr("action"),u=(t.attr("method")||"get").toLowerCase(),r||(r=e.mobile.getClosestBaseUrl(t),"get"===u&&(r=e.mobile.path.parseUrl(r).hrefNoSearch),r===e.mobile.path.documentBase.hrefNoHash&&(r=s.hrefNoSearch)),r=e.mobile.path.makeUrlAbsolute(r,e.mobile.getClosestBaseUrl(t)),e.mobile.path.isExternal(r)&&!e.mobile.path.isPermittedCrossDomainRequest(s,r)?!1:(n||(a=t.serializeArray(),o&&o[0].form===t[0]&&(l=o.attr("name"),l&&(e.each(a,function(e,t){return t.name===l?(l="",!1):i}),l&&a.push({name:l,value:o.attr("value")}))),h={url:r,options:{type:u,data:e.param(a),transition:t.jqmData("transition"),reverse:"reverse"===t.jqmData("direction"),reloadPage:!0}}),h))};e.mobile.document.delegate("form","submit",function(t){var i;t.isDefaultPrevented()||(i=r(e(this)),i&&(e.mobile.changePage(i.url,i.options),t.preventDefault()))}),e.mobile.document.bind("vclick",function(t){var i,s,a=t.target,l=!1;if(!(t.which>1)&&e.mobile.linkBindingEnabled){if(o=e(a),e.data(a,"mobile-button")){if(!r(e(a).closest("form"),!0))return;a.parentNode&&(a=a.parentNode)}else{if(a=n(a),!a||"#"===e.mobile.path.parseUrl(a.getAttribute("href")||"#").hash)return;if(!e(a).jqmHijackable().length)return}~a.className.indexOf("ui-link-inherit")?a.parentNode&&(s=e.data(a.parentNode,"buttonElements")):s=e.data(a,"buttonElements"),s?a=s.outer:l=!0,i=e(a),l&&(i=i.closest(".ui-btn")),i.length>0&&!i.hasClass("ui-state-disabled")&&(e.mobile.removeActiveLinkClass(!0),e.mobile.activeClickedLink=i,e.mobile.activeClickedLink.addClass(e.mobile.activeBtnClass))}}),e.mobile.document.bind("click",function(r){if(e.mobile.linkBindingEnabled&&!r.isDefaultPrevented()){var o,a,l,u,h,c,p,d=n(r.target),f=e(d),m=function(){t.setTimeout(function(){e.mobile.removeActiveLinkClass(!0)},200)};if(e.mobile.activeClickedLink&&e.mobile.activeClickedLink[0]===r.target.parentNode&&m(),d&&!(r.which>1)&&f.jqmHijackable().length){if(f.is(":jqmData(rel='back')"))return e.mobile.back(),!1;if(o=e.mobile.getClosestBaseUrl(f),a=e.mobile.path.makeUrlAbsolute(f.attr("href")||"#",o),!e.mobile.ajaxEnabled&&!e.mobile.path.isEmbeddedPage(a))return m(),i;if(-1!==a.search("#")){if(a=a.replace(/[^#]*#/,""),!a)return r.preventDefault(),i;a=e.mobile.path.isPath(a)?e.mobile.path.makeUrlAbsolute(a,o):e.mobile.path.makeUrlAbsolute("#"+a,s.hrefNoHash)}if(l=f.is("[rel='external']")||f.is(":jqmData(ajax='false')")||f.is("[target]"),u=l||e.mobile.path.isExternal(a)&&!e.mobile.path.isPermittedCrossDomainRequest(s,a))return m(),i;h=f.jqmData("transition"),c="reverse"===f.jqmData("direction")||f.jqmData("back"),p=f.attr("data-"+e.mobile.ns+"rel")||i,e.mobile.changePage(a,{transition:h,reverse:c,role:p,link:f}),r.preventDefault()}}}),e.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var t=[];e(this).find("a:jqmData(prefetch)").each(function(){var i=e(this),n=i.attr("href");n&&-1===e.inArray(n,t)&&(t.push(n),e.mobile.loadPage(n,{role:i.attr("data-"+e.mobile.ns+"rel"),prefetch:!0}))})}),e.mobile.pageContainer.pagecontainer(),e.mobile.document.bind("pageshow",e.mobile.resetActivePageHeight),e.mobile.window.bind("throttledresize",e.mobile.resetActivePageHeight)},e(function(){r.resolve()}),e.when(r,e.mobile.navreadyDeferred).done(function(){e.mobile._registerInternalEvents()})}(e),function(e,t){e.mobile.Transition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(t,i,n,r){e.extend(this,{name:t,reverse:i,$to:n,$from:r,deferred:new e.Deferred})},cleanFrom:function(){this.$from.removeClass(e.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),e.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(e.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(e,t,i,n){this.beforeDoneOut(),this.startIn(e,t,i,n)},hideIn:function(e){this.$to.css("z-index",-10),e.call(this),this.$to.css("z-index","")},scrollPage:function(){e.event.special.scrollstart.enabled=!1,(e.mobile.hideUrlBar||this.toScroll!==e.mobile.defaultHomeScroll)&&t.scrollTo(0,this.toScroll),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},startIn:function(t,i,n,r){this.hideIn(function(){this.$to.addClass(e.mobile.activePageClass+this.toPreClass),r||e.mobile.focusPage(this.$to),this.$to.height(t+this.toScroll),n||this.scrollPage()}),n||this.$to.animationComplete(e.proxy(function(){this.doneIn()},this)),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+i),n&&this.doneIn()},startOut:function(t,i,n){this.beforeStartOut(t,i,n),this.$from.height(t+e.mobile.window.scrollTop()).addClass(this.name+" out"+i)},toggleViewportClass:function(){e.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var t=this.reverse?" reverse":"",i=e.mobile.getScreenHeight(),n=e.mobile.maxTransitionWidth!==!1&&e.mobile.window.width()>e.mobile.maxTransitionWidth,r=!e.support.cssTransitions||!e.support.cssAnimations||n||!this.name||"none"===this.name||Math.max(e.mobile.window.scrollTop(),this.toScroll)>e.mobile.getMaxScrollForTransition();return this.toScroll=e.mobile.navigate.history.getActive().lastScroll||e.mobile.defaultHomeScroll,this.toggleViewportClass(),this.$from&&!r?this.startOut(i,t,r):this.doneOut(i,t,r,!0),this.deferred.promise()}})}(e,this),function(e){e.mobile.SerialTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.SerialTransition.prototype,e.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(t,i,n){this.$from.animationComplete(e.proxy(function(){this.doneOut(t,i,n)},this))}})}(e),function(e){e.mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.ConcurrentTransition.prototype,e.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,t,i){this.doneOut(e,t,i)}})}(e),function(e){var t=function(){return 3*e.mobile.getScreenHeight()};e.mobile.transitionHandlers={sequential:e.mobile.SerialTransition,simultaneous:e.mobile.ConcurrentTransition},e.mobile.defaultTransitionHandler=e.mobile.transitionHandlers.sequential,e.mobile.transitionFallbacks={},e.mobile._maybeDegradeTransition=function(t){return t&&!e.support.cssTransform3d&&e.mobile.transitionFallbacks[t]&&(t=e.mobile.transitionFallbacks[t]),t},e.mobile.getMaxScrollForTransition=e.mobile.getMaxScrollForTransition||t}(e),function(e){e.mobile.transitionFallbacks.flip="fade"}(e,this),function(e){e.mobile.transitionFallbacks.flow="fade"}(e,this),function(e){e.mobile.transitionFallbacks.pop="fade"}(e,this),function(e){e.mobile.transitionHandlers.slide=e.mobile.transitionHandlers.simultaneous,e.mobile.transitionFallbacks.slide="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slidedown="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slidefade="fade"}(e,this),function(e){e.mobile.transitionFallbacks.slideup="fade"}(e,this),function(e){e.mobile.transitionFallbacks.turn="fade"}(e,this),function(e){e.mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},e.mobile.page.prototype.options.degradeInputs=e.mobile.degradeInputs,e.mobile.degradeInputsWithin=function(t){t=e(t),t.find("input").not(e.mobile.page.prototype.keepNativeSelector()).each(function(){var t,i,n,r,s=e(this),o=this.getAttribute("type"),a=e.mobile.degradeInputs[o]||"text";e.mobile.degradeInputs[o]&&(t=e("<div>").html(s.clone()).html(),i=t.indexOf(" type=")>-1,n=i?/\s+type=["']?\w+['"]?/:/\/?>/,r=' type="'+a+'" data-'+e.mobile.ns+'type="'+o+'"'+(i?"":">"),s.replaceWith(t.replace(n,r)))
})}}(e),function(e,t,i){e.widget("mobile.page",e.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(e.extend(this,{_inner:this.element.children(),_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog","class":"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(t){var n,r,s=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(s.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(n=s.closeBtn,r=t.closeBtnText),t.closeBtn!==i&&(n=t.closeBtn),n&&this._setCloseBtn(n,r),this._super(t)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(t,i){var n,r=this._headerCloseButton;t="left"===t?"left":"right"===t?"right":"none","none"===t?r&&(r.remove(),r=null):r?(r.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&r.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),r=e("<a></a>",{href:"#","class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).attr("data-"+e.mobile.ns+"rel","back").text(i||this.options.closeBtnText||"").prependTo(n),this._on(r,{click:"close"})),this._headerCloseButton=r}})}(e,this),function(e,t,i){e.widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(t){var i,n=e(t.target).closest("vclick"===t.type?"a":"form");n.length&&!n.jqmData("transition")&&(i={},i["data-"+e.mobile.ns+"transition"]=(e.mobile.navigate.history.getActive()||{}).transition||e.mobile.defaultDialogTransition,i["data-"+e.mobile.ns+"direction"]="reverse",n.attr(i))},_create:function(){var t=this.element,i=this.options;t.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog","class":"ui-dialog-contain ui-overlay-shadow"+(i.corners?" ui-corner-all":"")})),e.extend(this,{_isCloseable:!1,_inner:t.children(),_headerCloseButton:null}),this._on(t,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(i.closeBtn)},_setOptions:function(t){var n,r,s=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(s.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(n=s.closeBtn,r=t.closeBtnText),t.closeBtn!==i&&(n=t.closeBtn),n&&this._setCloseBtn(n,r),this._super(t)},_setCloseBtn:function(t,i){var n,r=this._headerCloseButton;t="left"===t?"left":"right"===t?"right":"none","none"===t?r&&(r.remove(),r=null):r?(r.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&r.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),r=e("<a></a>",{role:"button",href:"#","class":"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).text(i||this.options.closeBtnText||"").prependTo(n),this._on(r,{click:"close"})),this._headerCloseButton=r},close:function(){var t=e.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,e.mobile.hashListeningEnabled&&t.activeIndex>0?e.mobile.back():e.mobile.pageContainer.pagecontainer("back"))}})}(e,this),function(e,t){var i=/([A-Z])/g;e.widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var t=this.element,i={accordion:t.closest(":jqmData(role='collapsible-set')"+(e.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};e.extend(this,{_ui:i}),this.options.enhanced?(i.heading=e(".ui-collapsible-heading",this.element[0]),i.content=i.heading.next(),i.anchor=e("a",i.heading[0]).first(),i.status=i.anchor.children(".ui-collapsible-heading-status")):this._enhance(t,i),this._on(i.heading,{tap:function(){i.heading.find("a").first().addClass(e.mobile.activeBtnClass)},click:function(e){this._handleExpandCollapse(!i.heading.hasClass("ui-collapsible-heading-collapsed")),e.preventDefault(),e.stopPropagation()}})},_getOptions:function(t){var n,r=this._ui.accordion,s=this._ui.accordionWidget;t=e.extend({},t),r.length&&!s&&(this._ui.accordionWidget=s=r.data("mobile-collapsibleset"));for(n in t)t[n]=null!=t[n]?t[n]:s?s.options[n]:r.length?e.mobile.getAttribute(r[0],n.replace(i,"-$1").toLowerCase()):null,null==t[n]&&(t[n]=e.mobile.collapsible.defaults[n]);return t},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_enhance:function(t,i){var n,r=this._getOptions(this.options),s=this._themeClassFromOption("ui-body-",r.contentTheme);return t.addClass("ui-collapsible "+(r.inset?"ui-collapsible-inset ":"")+(r.inset&&r.corners?"ui-corner-all ":"")+(s?"ui-collapsible-themed-content ":"")),i.originalHeading=t.children(this.options.heading).first(),i.content=t.wrapInner("<div class='ui-collapsible-content "+s+"'></div>").children(".ui-collapsible-content"),i.heading=i.originalHeading,i.heading.is("legend")&&(i.heading=e("<div role='heading'>"+i.heading.html()+"</div>"),i.placeholder=e("<div><!-- placeholder for legend --></div>").insertBefore(i.originalHeading),i.originalHeading.remove()),n=r.collapsed?r.collapsedIcon?"ui-icon-"+r.collapsedIcon:"":r.expandedIcon?"ui-icon-"+r.expandedIcon:"",i.status=e("<span class='ui-collapsible-heading-status'></span>"),i.anchor=i.heading.detach().addClass("ui-collapsible-heading").append(i.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(n?n+" ":"")+(n?"ui-btn-icon-"+("right"===r.iconpos?"right":"left")+" ":"")+this._themeClassFromOption("ui-btn-",r.theme)+" "+(r.mini?"ui-mini ":"")),i.heading.insertBefore(i.content),this._handleExpandCollapse(this.options.collapsed),i},refresh:function(){var t,i={};for(t in e.mobile.collapsible.defaults)i[t]=this.options[t];this._setOptions(i)},_setOptions:function(e){var i,n,r,s,o=this.element,a=this._getOptions(this.options),l=this._ui,u=l.anchor,h=l.status,c=this._getOptions(e);e.collapsed!==t&&this._handleExpandCollapse(e.collapsed),i=o.hasClass("ui-collapsible-collapsed"),i?(c.expandCueText!==t&&h.text(c.expandCueText),c.collapsedIcon!==t&&(a.collapsedIcon&&u.removeClass("ui-icon-"+a.collapsedIcon),c.collapsedIcon&&u.addClass("ui-icon-"+c.collapsedIcon))):(c.collapseCueText!==t&&h.text(c.collapseCueText),c.expandedIcon!==t&&(a.expandedIcon&&u.removeClass("ui-icon-"+a.expandedIcon),c.expandedIcon&&u.addClass("ui-icon-"+c.expandedIcon))),c.iconpos!==t&&(u.removeClass("ui-btn-icon-"+("right"===a.iconPos?"right":"left")),u.addClass("ui-btn-icon-"+("right"===c.iconPos?"right":"left"))),c.theme!==t&&(r=this._themeClassFromOption("ui-btn-",a.theme),n=this._themeClassFromOption("ui-btn-",c.theme),u.removeClass(r).addClass(n)),c.contentTheme!==t&&(r=this._themeClassFromOption("ui-body-",a.theme),n=this._themeClassFromOption("ui-body-",c.theme),l.content.removeClass(r).addClass(n)),c.inset!==t&&(o.toggleClass("ui-collapsible-inset",c.inset),s=!(!c.inset||!c.corners&&!a.corners)),c.corners!==t&&(s=!(!c.corners||!c.inset&&!a.inset)),s!==t&&o.toggleClass("ui-corner-all",s),c.mini!==t&&u.toggleClass("ui-mini",c.mini),this._super(e)},_handleExpandCollapse:function(t){var i=this._getOptions(this.options),n=this._ui;n.status.text(t?i.expandCueText:i.collapseCueText),n.heading.toggleClass("ui-collapsible-heading-collapsed",t).find("a").first().toggleClass("ui-icon-"+i.expandedIcon,!t).toggleClass("ui-icon-"+i.collapsedIcon,t||i.expandedIcon===i.collapsedIcon).removeClass(e.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",t),n.content.toggleClass("ui-collapsible-content-collapsed",t).attr("aria-hidden",t).trigger("updatelayout"),this.options.collapsed=t,this._trigger(t?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var e=this._ui,t=this.options;t.enhanced||(e.placeholder?(e.originalHeading.insertBefore(e.placeholder),e.placeholder.remove(),e.heading.remove()):(e.status.remove(),e.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),e.anchor.contents().unwrap(),e.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),e.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1}}(e),function(e){e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var i;return t?i=e.not(".ui-screen-hidden"):(i=e.filter(":visible"),0===i.length&&(i=e.not(".ui-screen-hidden"))),i},_addFirstLastClasses:function(e,t,i){e.removeClass("ui-first-child ui-last-child"),t.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),i||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}}}(e),function(e,t){var i=":mobile-collapsible, "+e.mobile.collapsible.initSelector;e.widget("mobile.collapsibleset",e.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:e.extend({enhanced:!1},e.mobile.collapsible.defaults),_handleCollapsibleExpand:function(t){var i=e(t.target).closest(".ui-collapsible");i.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&i.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var t=this.element,i=this.options;e.extend(this,{_classes:""}),i.enhanced||(t.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",i.theme)+" "+(i.corners&&i.inset?"ui-corner-all ":"")),this.element.find(e.mobile.collapsible.initSelector).collapsible()),this._on(t,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_init:function(){this._refresh(!0),this.element.children(i).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(e){var i,n,r=this.element,s=this._themeClassFromOption("ui-group-theme-",e.theme);return s&&r.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(s),e.inset!==t&&(n=!(!e.inset||!e.corners&&!this.options.corners)),e.corners!==t&&(n=!(!e.corners||!e.inset&&!this.options.inset)),n!==t&&r.toggleClass("ui-corner-all",n),i=this._super(e),this.element.children(":mobile-collapsible").collapsible("refresh"),i},_destroy:function(){var e=this.element;this._removeFirstLastClasses(e.children(i)),e.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(t){var n=this.element.children(i);this.element.find(e.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(n,this._getVisibles(n,t),t)},refresh:function(){this._refresh(!1)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e){e.fn.fieldcontain=function(){return this.addClass("ui-field-contain")}}(e),function(e){e.fn.grid=function(t){return this.each(function(){var i,n,r=e(this),s=e.extend({grid:null},t),o=r.children(),a={solo:1,a:2,b:3,c:4,d:5},l=s.grid;if(!l)if(5>=o.length)for(n in a)a[n]===o.length&&(l=n);else l="a",r.addClass("ui-grid-duo");i=a[l],r.addClass("ui-grid-"+l),o.filter(":nth-child("+i+"n+1)").addClass("ui-block-a"),i>1&&o.filter(":nth-child("+i+"n+2)").addClass("ui-block-b"),i>2&&o.filter(":nth-child("+i+"n+3)").addClass("ui-block-c"),i>3&&o.filter(":nth-child("+i+"n+4)").addClass("ui-block-d"),i>4&&o.filter(":nth-child("+i+"n+5)").addClass("ui-block-e")})}}(e),function(e,t){e.widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var n=this.element,r=n.find("a"),s=r.filter(":jqmData(icon)").length?this.options.iconpos:t;n.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),r.each(function(){var t=e.mobile.getAttribute(this,"icon"),i=e.mobile.getAttribute(this,"theme"),n="ui-btn";i&&(n+=" ui-btn-"+i),t&&(n+=" ui-icon-"+t+" ui-btn-icon-"+s),e(this).addClass(n)}),n.delegate("a","vclick",function(){var t=e(this);t.hasClass("ui-state-disabled")||t.hasClass("ui-disabled")||t.hasClass(e.mobile.activeBtnClass)||(r.removeClass(e.mobile.activeBtnClass),t.addClass(e.mobile.activeBtnClass),e(i).one("pagehide",function(){t.removeClass(e.mobile.activeBtnClass)}))}),n.closest(".ui-page").bind("pagebeforeshow",function(){r.filter(".ui-state-persist").addClass(e.mobile.activeBtnClass)})}})}(e),function(e){var t=e.mobile.getAttribute;e.widget("mobile.listview",e.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var e=this,t="";t+=e.options.inset?" ui-listview-inset":"",e.options.inset&&(t+=e.options.corners?" ui-corner-all":"",t+=e.options.shadow?" ui-shadow":""),e.element.addClass(" ui-listview"+t),e.refresh(!0)},_findFirstElementByTagName:function(e,t,i,n){var r={};for(r[i]=r[n]=!0;e;){if(r[e.nodeName])return e;e=e[t]}return null},_addThumbClasses:function(t){var i,n,r=t.length;for(i=0;r>i;i++)n=e(this._findFirstElementByTagName(t[i].firstChild,"nextSibling","img","IMG")),n.length&&e(this._findFirstElementByTagName(n[0].parentNode,"parentNode","li","LI")).addClass(n.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(t,i,n){var r=[],s={};for(s[i]=s[n]=!0,t=t.firstChild;t;)s[t.nodeName]&&r.push(t),t=t.nextSibling;return e(r)},_beforeListviewRefresh:e.noop,_afterListviewRefresh:e.noop,refresh:function(i){var n,r,s,o,a,l,u,h,c,p,d,f,m,g,y,v,b,_,w,x,L=this.options,O=this.element,C=!!e.nodeName(O[0],"ol"),E=O.attr("start"),S={},k=O.find(".ui-li-count"),T=t(O[0],"counttheme")||this.options.countTheme,P=T?"ui-body-"+T:"ui-body-inherit";for(L.theme&&O.addClass("ui-group-theme-"+L.theme),C&&(E||0===E)&&(d=parseInt(E,10)-1,O.css("counter-reset","listnumbering "+d)),this._beforeListviewRefresh(),x=this._getChildrenByTagName(O[0],"li","LI"),r=0,s=x.length;s>r;r++)o=x.eq(r),a="",(i||0>o[0].className.search(/\bui-li-static\b|\bui-li-divider\b/))&&(c=this._getChildrenByTagName(o[0],"a","A"),p="list-divider"===t(o[0],"role"),m=o.attr("value"),l=t(o[0],"theme"),c.length&&0>c[0].className.search(/\bui-btn\b/)&&!p?(u=t(o[0],"icon"),h=u===!1?!1:u||L.icon,c.removeClass("ui-link"),n="ui-btn",l&&(n+=" ui-btn-"+l),c.length>1?(a="ui-li-has-alt",g=c.last(),y=t(g[0],"theme")||L.splitTheme||t(o[0],"theme",!0),v=y?" ui-btn-"+y:"",b=t(g[0],"icon")||t(o[0],"icon")||L.splitIcon,_="ui-btn ui-btn-icon-notext ui-icon-"+b+v,g.attr("title",e.trim(g.getEncodedText())).addClass(_).empty()):h&&(n+=" ui-btn-icon-right ui-icon-"+h),c.first().addClass(n)):p?(w=t(o[0],"theme")||L.dividerTheme||L.theme,a="ui-li-divider ui-bar-"+(w?w:"inherit"),o.attr("role","heading")):0>=c.length&&(a="ui-li-static ui-body-"+(l?l:"inherit")),C&&m&&(f=parseInt(m,10)-1,o.css("counter-reset","listnumbering "+f))),S[a]||(S[a]=[]),S[a].push(o[0]);for(a in S)e(S[a]).addClass(a);k.each(function(){e(this).closest("li").addClass("ui-li-has-count")}),P&&k.addClass(P),this._addThumbClasses(x),this._addThumbClasses(x.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(x,this._getVisibles(x,i),i)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e){function t(t){var i=e.trim(t.text())||null;return i?i=i.slice(0,1).toUpperCase():null}e.widget("mobile.listview",e.mobile.listview,{options:{autodividers:!1,autodividersSelector:t},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var t,n,r,s,o,a=null,l=this.element;for(l.children("li:jqmData(role='list-divider')").remove(),n=l.children("li"),t=0;n.length>t;t++)r=n[t],s=this.options.autodividersSelector(e(r)),s&&a!==s&&(o=i.createElement("li"),o.appendChild(i.createTextNode(s)),o.setAttribute("data-"+e.mobile.ns+"role","list-divider"),r.parentNode.insertBefore(o,r)),a=s}})}(e),function(e){var t=/(^|\s)ui-li-divider($|\s)/,i=/(^|\s)ui-screen-hidden($|\s)/;e.widget("mobile.listview",e.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var e,n,r,s=!0;if(this._superApply(arguments),this.options.hideDividers)for(e=this._getChildrenByTagName(this.element[0],"li","LI"),n=e.length-1;n>-1;n--)r=e[n],r.className.match(t)?(s&&(r.className=r.className+" ui-screen-hidden"),s=!0):r.className.match(i)||(s=!1)}})}(e),function(e){e.mobile.nojs=function(t){e(":jqmData(role='nojs')",t).addClass("ui-nojs")}}(e),function(e){e.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(e),function(e,t){e.widget("mobile.checkboxradio",e.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var t=this.element,i=this.options,n=function(e,t){return e.jqmData(t)||e.closest("form, fieldset").jqmData(t)},r=t.closest("label"),s=r.length?r:t.closest("form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')").find("label").filter("[for='"+e.mobile.path.hashToSelector(t[0].id)+"']").first(),o=t[0].type,a="ui-"+o+"-on",l="ui-"+o+"-off";("checkbox"===o||"radio"===o)&&(this.element[0].disabled&&(this.options.disabled=!0),i.iconpos=n(t,"iconpos")||s.attr("data-"+e.mobile.ns+"iconpos")||i.iconpos,i.mini=n(t,"mini")||i.mini,e.extend(this,{input:t,label:s,parentLabel:r,inputtype:o,checkedClass:a,uncheckedClass:l}),this.options.enhanced||this._enhance(),this._on(s,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(t,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),this.parentLabel.length>0?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return e("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' >")},_handleInputFocus:function(){this.label.addClass(e.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(e.mobile.focusClass)},_handleInputVClick:function(){var e=this.element;e.is(":checked")?(e.prop("checked",!0),this._getInputSet().not(e).prop("checked",!1)):e.prop("checked",!1),this._updateAll()},_handleLabelVMouseOver:function(e){this.label.parent().hasClass("ui-state-disabled")&&e.stopPropagation()},_handleLabelVClick:function(e){var i=this.element;return i.is(":disabled")?(e.preventDefault(),t):(this._cacheVals(),i.prop("checked","radio"===this.inputtype&&!0||!i.prop("checked")),i.triggerHandler("click"),this._getInputSet().not(i).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each(function(){e(this).attr("data-"+e.mobile.ns+"cacheVal",this.checked)})},_getInputSet:function(){return"checkbox"===this.inputtype?this.element:this.element.closest("form, :jqmData(role='page'), :jqmData(role='dialog')").find("input[name='"+this.element[0].name+"'][type='"+this.inputtype+"']")},_updateAll:function(){var t=this;this._getInputSet().each(function(){var i=e(this);(this.checked||"checkbox"===t.inputtype)&&i.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var t,i,n=e.mobile.controlgroup;return n&&(t=this.element.closest(":mobile-controlgroup,"+n.prototype.initSelector),t.length>0)?(i=e.data(t[0],"mobile-controlgroup"),"horizontal"!==(i?i.options.type:t.attr("data-"+e.mobile.ns+"type"))):!0},refresh:function(){var t=this._hasIcon(),i=this.element[0].checked,n=e.mobile.activeBtnClass,r="ui-btn-icon-"+this.options.iconpos,s=[],o=[];t?(o.push(n),s.push(r)):(o.push(r),(i?s:o).push(n)),i?(s.push(this.checkedClass),o.push(this.uncheckedClass)):(s.push(this.uncheckedClass),o.push(this.checkedClass)),this.label.addClass(s.join(" ")).removeClass(o.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(e){var i=this.label,n=this.options,r=this.widget(),s=this._hasIcon();e.disabled!==t&&(this.input.prop("disabled",!!e.disabled),r.toggleClass("ui-state-disabled",!!e.disabled)),e.mini!==t&&r.toggleClass("ui-mini",!!e.mini),e.theme!==t&&i.removeClass("ui-btn-"+n.theme).addClass("ui-btn-"+e.theme),e.wrapperClass!==t&&r.removeClass(n.wrapperClass).addClass(e.wrapperClass),e.iconpos!==t&&s?i.removeClass("ui-btn-icon-"+n.iconpos).addClass("ui-btn-icon-"+e.iconpos):s||i.removeClass("ui-btn-icon-"+n.iconpos),this._super(e)}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),e.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(e.mobile.focusClass)},blur:function(){this.widget().removeClass(e.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var t=this.options,i=this._getIconClasses(this.options);return e("<div class='ui-btn ui-input-btn"+(t.wrapperClass?" "+t.wrapperClass:"")+(t.theme?" ui-btn-"+t.theme:"")+(t.corners?" ui-corner-all":"")+(t.shadow?" ui-shadow":"")+(t.inline?" ui-btn-inline":"")+(t.mini?" ui-mini":"")+(t.disabled?" ui-state-disabled":"")+(i?" "+i:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.button),this.button.remove()},_getIconClasses:function(e){return e.icon?"ui-icon-"+e.icon+(e.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+e.iconpos:""},_setOptions:function(i){var n=this.widget();i.theme!==t&&n.removeClass(this.options.theme).addClass("ui-btn-"+i.theme),i.corners!==t&&n.toggleClass("ui-corner-all",i.corners),i.shadow!==t&&n.toggleClass("ui-shadow",i.shadow),i.inline!==t&&n.toggleClass("ui-btn-inline",i.inline),i.mini!==t&&n.toggleClass("ui-mini",i.mini),i.disabled!==t&&(this.element.prop("disabled",i.disabled),n.toggleClass("ui-state-disabled",i.disabled)),(i.icon!==t||i.iconshadow!==t||i.iconpos!==t)&&n.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(e.extend({},this.options,i))),this._super(i)},refresh:function(t){if(this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),!t){var i=this.element.detach();e(this.wrapper).text(this.element.val()).append(i)}}})}(e),function(e){var t=e("meta[name=viewport]"),i=t.attr("content"),n=i+",maximum-scale=1, user-scalable=no",r=i+",maximum-scale=10, user-scalable=yes",s=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(i);e.mobile.zoom=e.extend({},{enabled:!s,locked:!1,disable:function(i){s||e.mobile.zoom.locked||(t.attr("content",n),e.mobile.zoom.enabled=!1,e.mobile.zoom.locked=i||!1)},enable:function(i){s||e.mobile.zoom.locked&&i!==!0||(t.attr("content",r),e.mobile.zoom.enabled=!0,e.mobile.zoom.locked=!1)},restore:function(){s||(t.attr("content",i),e.mobile.zoom.enabled=!0)}})}(e),function(e,t){e.widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,wrapperClass:"",enhanced:!1},_create:function(){var t=this.options,i=this.element.is("[type='search'], :jqmData(type='search')"),n="TEXTAREA"===this.element[0].tagName,r=this.element.is("[data-"+(e.mobile.ns||"")+"type='range']"),s=(this.element.is("input")||this.element.is("[data-"+(e.mobile.ns||"")+"type='search']"))&&!r;this.element.prop("disabled")&&(t.disabled=!0),e.extend(this,{classes:this._classesFromOptions(),isSearch:i,isTextarea:n,isRange:r,inputNeedsWrap:s}),this._autoCorrect(),t.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var e=[];this.isTextarea&&e.push("ui-input-text"),(this.isTextarea||this.isRange)&&e.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):e=e.concat(this.classes),this.element.addClass(e.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var e=this.options,t=[];return t.push("ui-body-"+(null===e.theme?"inherit":e.theme)),e.corners&&t.push("ui-corner-all"),e.mini&&t.push("ui-mini"),e.disabled&&t.push("ui-state-disabled"),e.wrapperClass&&t.push(e.wrapperClass),t},_wrap:function(){return e("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" "+"ui-shadow-inset'></div>")},_autoCorrect:function(){this.element[0].autocorrect===t||e.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(e.mobile.focusClass),this.options.preventFocusZoom&&e.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&e.mobile.zoom.disable(!0),this.widget().addClass(e.mobile.focusClass)},_setOptions:function(e){var i=this.widget();this._super(e),(e.disabled!==t||e.mini!==t||e.corners!==t||e.theme!==t||e.wrapperClass!==t)&&(i.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),i.addClass(this.classes.join(" "))),e.disabled!==t&&this.element.prop("disabled",!!e.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}})}(e),function(e,n){e.widget("mobile.slider",e.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var r,s,o,a,l,u,h,c,p,d,f=this,m=this.element,g=this.options.trackTheme||e.mobile.getAttribute(m[0],"theme"),y=g?" ui-bar-"+g:" ui-bar-inherit",v=this.options.corners||m.jqmData("corners")?" ui-corner-all":"",b=this.options.mini||m.jqmData("mini")?" ui-mini":"",_=m[0].nodeName.toLowerCase(),w="select"===_,x=m.parent().is(":jqmData(role='rangeslider')"),L=w?"ui-slider-switch":"",O=m.attr("id"),C=e("[for='"+O+"']"),E=C.attr("id")||O+"-label",S=w?0:parseFloat(m.attr("min")),k=w?m.find("option").length-1:parseFloat(m.attr("max")),T=t.parseFloat(m.attr("step")||1),P=i.createElement("a"),q=e(P),N=i.createElement("div"),F=e(N),I=this.options.highlight&&!w?function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(F)}():!1;if(C.attr("id",E),this.isToggleSwitch=w,P.setAttribute("href","#"),N.setAttribute("role","application"),N.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",L,y,v,b].join(""),P.className="ui-slider-handle",N.appendChild(P),q.attr({role:"slider","aria-valuemin":S,"aria-valuemax":k,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":E}),e.extend(this,{slider:F,handle:q,control:m,type:_,step:T,max:k,min:S,valuebg:I,isRangeslider:x,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),w){for(h=m.attr("tabindex"),h&&q.attr("tabindex",h),m.attr("tabindex","-1").focus(function(){e(this).blur(),q.focus()}),s=i.createElement("div"),s.className="ui-slider-inneroffset",o=0,a=N.childNodes.length;a>o;o++)s.appendChild(N.childNodes[o]);for(N.appendChild(s),q.addClass("ui-slider-handle-snapping"),r=m.find("option"),l=0,u=r.length;u>l;l++)c=l?"a":"b",p=l?" "+e.mobile.activeBtnClass:"",d=i.createElement("span"),d.className=["ui-slider-label ui-slider-label-",c,p].join(""),d.setAttribute("role","img"),d.appendChild(i.createTextNode(r[l].innerHTML)),e(d).prependTo(F);f._labels=e(".ui-slider-label",F)}m.addClass(w?"ui-slider-switch":"ui-slider-input"),this._on(m,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),F.bind("vmousedown",e.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(i,{vmousemove:"_preventDocumentDrag"}),this._on(F.add(i),{vmouseup:"_sliderVMouseUp"}),F.insertAfter(m),w||x||(s=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",m.add(F).wrapAll(s)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(n,n,!0)},_setOptions:function(e){e.theme!==n&&this._setTheme(e.theme),e.trackTheme!==n&&this._setTrackTheme(e.trackTheme),e.corners!==n&&this._setCorners(e.corners),e.mini!==n&&this._setMini(e.mini),e.highlight!==n&&this._setHighlight(e.highlight),e.disabled!==n&&this._setDisabled(e.disabled),this._super(e)},_controlChange:function(e){return this._trigger("controlchange",e)===!1?!1:(this.mouseMoved||this.refresh(this._value(),!0),n)},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(t){var i=this._value();if(!this.options.disabled){switch(t.keyCode){case e.mobile.keyCode.HOME:case e.mobile.keyCode.END:case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:t.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(t.keyCode){case e.mobile.keyCode.HOME:this.refresh(this.min);break;case e.mobile.keyCode.END:this.refresh(this.max);break;case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:this.refresh(i+this.step);break;case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:this.refresh(i-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(e){return this.options.disabled||1!==e.which&&0!==e.which&&e.which!==n?!1:this._trigger("beforestart",e)===!1?!1:(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(e),this._trigger("start"),!1)
},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.mouseMoved?this.userModified?this.refresh(0===this.beforeStart?1:0):this.refresh(this.beforeStart):this.refresh(0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):n},_preventDocumentDrag:function(e){return this._trigger("drag",e)===!1?!1:this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(e),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):n},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(n,!1,!0)},refresh:function(t,r,s){var o,a,l,u,h,c,p,d,f,m,g,y,v,b,_,w,x,L,O,C,E=this,S=e.mobile.getAttribute(this.element[0],"theme"),k=this.options.theme||S,T=k?" ui-btn-"+k:"",P=this.options.trackTheme||S,q=P?" ui-bar-"+P:" ui-bar-inherit",N=this.options.corners?" ui-corner-all":"",F=this.options.mini?" ui-mini":"";if(E.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",q,N,F].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(E.slider)}()),this.handle.addClass("ui-btn"+T+" ui-shadow"),p=this.element,d=!this.isToggleSwitch,f=d?[]:p.find("option"),m=d?parseFloat(p.attr("min")):0,g=d?parseFloat(p.attr("max")):f.length-1,y=d&&parseFloat(p.attr("step"))>0?parseFloat(p.attr("step")):1,"object"==typeof t){if(l=t,u=8,o=this.slider.offset().left,a=this.slider.width(),h=a/((g-m)/y),!this.dragging||o-u>l.pageX||l.pageX>o+a+u)return;c=h>1?100*((l.pageX-o)/a):Math.round(100*((l.pageX-o)/a))}else null==t&&(t=d?parseFloat(p.val()||0):p[0].selectedIndex),c=100*((parseFloat(t)-m)/(g-m));if(!isNaN(c)&&(v=c/100*(g-m)+m,b=(v-m)%y,_=v-b,2*Math.abs(b)>=y&&(_+=b>0?y:-y),w=100/((g-m)/y),v=parseFloat(_.toFixed(5)),h===n&&(h=a/((g-m)/y)),h>1&&d&&(c=(v-m)*w*(1/y)),0>c&&(c=0),c>100&&(c=100),m>v&&(v=m),v>g&&(v=g),this.handle.css("left",c+"%"),this.handle[0].setAttribute("aria-valuenow",d?v:f.eq(v).attr("value")),this.handle[0].setAttribute("aria-valuetext",d?v:f.eq(v).getEncodedText()),this.handle[0].setAttribute("title",d?v:f.eq(v).getEncodedText()),this.valuebg&&this.valuebg.css("width",c+"%"),this._labels&&(x=100*(this.handle.width()/this.slider.width()),L=c&&x+(100-x)*c/100,O=100===c?0:Math.min(x+100-L,100),this._labels.each(function(){var t=e(this).hasClass("ui-slider-label-a");e(this).width((t?L:O)+"%")})),!s)){if(C=!1,d?(C=p.val()!==v,p.val(v)):(C=p[0].selectedIndex!==v,p[0].selectedIndex=v),this._trigger("beforechange",t)===!1)return!1;!r&&C&&p.trigger("change")}},_setHighlight:function(e){e=!!e,e?(this.options.highlight=!!e,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(e){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+e);var t=this.options.theme?this.options.theme:"inherit",i=e?e:"inherit";this.control.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setTrackTheme:function(e){var t=this.options.trackTheme?this.options.trackTheme:"inherit",i=e?e:"inherit";this.slider.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setMini:function(e){e=!!e,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",e),this.element.toggleClass("ui-mini",e)),this.slider.toggleClass("ui-mini",e)},_setCorners:function(e){this.slider.toggleClass("ui-corner-all",e),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",e)},_setDisabled:function(e){e=!!e,this.element.prop("disabled",e),this.slider.toggleClass("ui-state-disabled").attr("aria-disabled",e)}},e.mobile.behaviors.formReset))}(e),function(e){function t(){return i||(i=e("<div></div>",{"class":"ui-slider-popup ui-shadow ui-corner-all"})),i.clone()}var i;e.widget("mobile.slider",e.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),e.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var e=this.handle.offset();this._popup.offset({left:e.left+(this.handle.width()-this._popup.width())/2,top:e.top-this._popup.outerHeight()-5})},_setOption:function(e,i){this._super(e,i),"showValue"===e?this.handle.html(i&&!this.options.mini?this._value():""):"popupEnabled"===e&&i&&!this._popup&&(this._popup=t().addClass("ui-body-"+(this.options.theme||"a")).insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var e,t=this.options;t.popupEnabled&&this.handle.removeAttr("title"),e=this._value(),e!==this._currentValue&&(this._currentValue=e,t.popupEnabled&&this._popup?(this._positionPopup(),this._popup.html(e)):t.showValue&&!this.options.mini&&this.handle.html(e))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var e=this.options;e.popupEnabled&&this._popupVisible&&(e.showValue&&!e.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}})}(e),function(e,t){e.widget("mobile.flipswitch",e.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?e.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var t=e("<div>"),i=this.options,n=this.element,r=i.theme?i.theme:"inherit",s=e("<span></span>",{tabindex:1}),o=e("<span></span>"),a=n.get(0).tagName,l="INPUT"===a?i.onText:n.find("option").eq(1).text(),u="INPUT"===a?i.offText:n.find("option").eq(0).text();s.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(l),o.addClass("ui-flipswitch-off").text(u),t.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+r+" "+(i.wrapperClass?i.wrapperClass:"")+" "+(n.is(":checked")||n.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(n.is(":disabled")?" ui-state-disabled":"")+(i.corners?" ui-corner-all":"")+(i.mini?" ui-mini":"")).append(s,o),n.addClass("ui-flipswitch-input").after(t).appendTo(t),e.extend(this,{flipswitch:t,on:s,off:o,type:a})},_reset:function(){this.refresh()},refresh:function(){var e,t=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";e="SELECT"===this.type?this.element.get(0).selectedIndex>0?"_right":"_left":this.element.prop("checked")?"_right":"_left",e!==t&&this[e]()},_toggle:function(){var e=this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right";this[e]()},_keydown:function(t){t.which===e.mobile.keyCode.LEFT?this._left():t.which===e.mobile.keyCode.RIGHT?this._right():t.which===e.mobile.keyCode.SPACE&&(this._toggle(),t.preventDefault())},_setOptions:function(e){if(e.theme!==t){var i=e.theme?e.theme:"inherit",n=e.theme?e.theme:"inherit";this.widget().removeClass("ui-bar-"+i).addClass("ui-bar-"+n)}e.onText!==t&&this.on.text(e.onText),e.offText!==t&&this.off.text(e.offText),e.disabled!==t&&this.widget().toggleClass("ui-state-disabled",e.disabled),e.mini!==t&&this.widget().toggleClass("ui-mini",e.mini),e.corners!==t&&this.widget().toggleClass("ui-corner-all",e.corners),this._super(e)},_destroy:function(){this.options.enhanced||(this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.rangeslider",e.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var t=this.element,i=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",n=t.find("input").first(),r=t.find("input").last(),s=t.find("label").first(),o=e.data(n.get(0),"mobile-slider")||e.data(n.slider().get(0),"mobile-slider"),a=e.data(r.get(0),"mobile-slider")||e.data(r.slider().get(0),"mobile-slider"),l=o.slider,u=a.slider,h=o.handle,c=e("<div class='ui-rangeslider-sliders' />").appendTo(t);n.addClass("ui-rangeslider-first"),r.addClass("ui-rangeslider-last"),t.addClass(i),l.appendTo(c),u.appendTo(c),s.insertBefore(t),h.prependTo(u),e.extend(this,{_inputFirst:n,_inputLast:r,_sliderFirst:l,_sliderLast:u,_label:s,_targetVal:null,_sliderTarget:!1,_sliders:c,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(h,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var e=this;setTimeout(function(){e._updateHighlight()},0)},_dragFirstHandle:function(t){return e.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,e.data(this._inputFirst.get(0),"mobile-slider").refresh(t),!1},_slidedrag:function(i){var n=e(i.target).is(this._inputFirst),r=n?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&n||"last"===this._proxy&&!n?(e.data(r.get(0),"mobile-slider").dragging=!0,e.data(r.get(0),"mobile-slider").refresh(i),!1):t},_slidestop:function(t){var i=e(t.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",i?1:"")},_slidebeforestart:function(t){this._sliderTarget=!1,e(t.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=e(t.target).val())},_setOptions:function(e){e.theme!==t&&this._setTheme(e.theme),e.trackTheme!==t&&this._setTrackTheme(e.trackTheme),e.mini!==t&&this._setMini(e.mini),e.highlight!==t&&this._setHighlight(e.highlight),this._super(e),this.refresh()},refresh:function(){var e=this.element,t=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),e.find("input").slider({theme:t.theme,trackTheme:t.trackTheme,disabled:t.disabled,corners:t.corners,mini:t.mini,highlight:t.highlight}).slider("refresh"),this._updateHighlight()},_change:function(i){if("keyup"===i.type)return this._updateHighlight(),!1;var n=this,r=parseFloat(this._inputFirst.val(),10),s=parseFloat(this._inputLast.val(),10),o=e(i.target).hasClass("ui-rangeslider-first"),a=o?this._inputFirst:this._inputLast,l=o?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===i.type&&!e(i.target).hasClass("ui-slider-handle"))a.blur();else if("mousedown"===i.type)return;return r>s&&!this._sliderTarget?(a.val(o?s:r).slider("refresh"),this._trigger("normalize")):r>s&&(a.val(this._targetVal).slider("refresh"),setTimeout(function(){l.val(o?r:s).slider("refresh"),e.data(l.get(0),"mobile-slider").handle.focus(),n._sliderFirst.css("z-index",o?"":1),n._trigger("normalize")},0),this._proxy=o?"first":"last"),r===s?(e.data(a.get(0),"mobile-slider").handle.css("z-index",1),e.data(l.get(0),"mobile-slider").handle.css("z-index",0)):(e.data(l.get(0),"mobile-slider").handle.css("z-index",""),e.data(a.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),r>=s?!1:t},_updateHighlight:function(){var t=parseInt(e.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),i=parseInt(e.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10),n=i-t;this.element.find(".ui-slider-bg").css({"margin-left":t+"%",width:n+"%"})},_setTheme:function(e){this._inputFirst.slider("option","theme",e),this._inputLast.slider("option","theme",e)},_setTrackTheme:function(e){this._inputFirst.slider("option","trackTheme",e),this._inputLast.slider("option","trackTheme",e)},_setMini:function(e){this._inputFirst.slider("option","mini",e),this._inputLast.slider("option","mini",e),this.element.toggleClass("ui-mini",!!e)},_setHighlight:function(e){this._inputFirst.slider("option","highlight",e),this._inputLast.slider("option","highlight",e)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),(this.options.clearBtn||this.isSearch)&&this._addClearBtn()},clearButton:function(){return e("<a href='#' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all' title='"+this.options.clearBtnText+"'>"+this.options.clearBtnText+"</a>")},_clearBtnClick:function(e){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),e.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),e.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(e){this._super(e),e.clearbtn===t||this.element.is("textarea, :jqmData(type='range')")||(e.clearBtn?this._addClearBtn():this._destroyClear()),e.clearBtnText!==t&&this._clearBtn!==t&&this._clearBtn.text(e.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.element.removeClass("ui-input-has-clear"),this._unbindClear()._clearBtn.remove()},_destroy:function(){this._super(),this._destroyClear()}})}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(t){e.contains(t.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==t.type&&this.element.addClass("ui-textinput-autogrow-resize").one("transitionend webkitTransitionEnd oTransitionEnd",e.proxy(function(){this.element.removeClass("ui-textinput-autogrow-resize")},this)),this._prepareHeightUpdate())},_unbindAutogrow:function(){this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(e){this.keyupTimeout&&clearTimeout(this.keyupTimeout),e===t?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",e)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){this.keyupTimeout=0,this.element.css({height:0,"min-height":0,"max-height":0});var e,t,i,n=this.element[0].scrollHeight,r=this.element[0].clientHeight,s=parseFloat(this.element.css("border-top-width")),o=parseFloat(this.element.css("border-bottom-width")),a=s+o,l=n+a+15;0===r&&(e=parseFloat(this.element.css("padding-top")),t=parseFloat(this.element.css("padding-bottom")),i=e+t,l+=i),this.element.css({height:l,"min-height":"","max-height":""})},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(e){this._super(e),e.autogrow!==t&&this.isTextarea&&(e.autogrow?this._autogrow():this._unbindAutogrow())}})}(e),function(e){e.widget("mobile.selectmenu",e.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,mini:!1},_button:function(){return e("<div/>")},_setDisabled:function(e){return this.element.attr("disabled",e),this.button.attr("aria-disabled",e),this._setOption("disabled",e)},_focusButton:function(){var e=this;setTimeout(function(){e.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var t=this.options.inline||this.element.jqmData("inline"),i=this.options.mini||this.element.jqmData("mini"),n="";~this.element[0].className.indexOf("ui-btn-left")&&(n=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(n=" ui-btn-right"),t&&(n+=" ui-btn-inline"),i&&(n+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+n+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=e("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var e=this.element.parents(".ui-select");e.length>0&&(e.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(e.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(e),e.remove())},_create:function(){this._preExtension(),this.button=this._button();var i=this,n=this.options,r=n.icon?n.iconpos||this.select.jqmData("iconpos"):!1,s=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(n.icon?" ui-icon-"+n.icon+" ui-btn-icon-"+r+(n.iconshadow?" ui-shadow-icon":""):"")+(n.theme?" ui-btn-"+n.theme:"")+(n.corners?" ui-corner-all":"")+(n.shadow?" ui-shadow":""));this.setButtonText(),n.nativeMenu&&t.opera&&t.opera.version&&s.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=e("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(s.addClass("ui-li-has-count"))),(n.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){i.refresh(),n.nativeMenu&&this.blur()}),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var t=this;this.select.appendTo(t.button).bind("vmousedown",function(){t.button.addClass(e.mobile.activeBtnClass)}).bind("focus",function(){t.button.addClass(e.mobile.focusClass)}).bind("blur",function(){t.button.removeClass(e.mobile.focusClass)}).bind("focus vmouseover",function(){t.button.trigger("vmouseover")}).bind("vmousemove",function(){t.button.removeClass(e.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){t.button.trigger("vmouseout").removeClass(e.mobile.activeBtnClass)}),t.button.bind("vmousedown",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.label.bind("click focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.select.bind("focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.button.bind("mouseup",function(){t.options.preventFocusZoom&&setTimeout(function(){e.mobile.zoom.enable(!0)},0)}),t.select.bind("blur",function(){t.options.preventFocusZoom&&e.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var e=this;return this.selected().map(function(){return e._selectOptions().index(this)}).get()},setButtonText:function(){var t=this,n=this.selected(),r=this.placeholder,s=e(i.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(function(){return r=n.length?n.map(function(){return e(this).text()}).get().join(", "):t.placeholder,r?s.text(r):s.html("&nbsp;"),s.addClass(t.select.attr("class")).addClass(n.attr("class")).removeClass("ui-screen-hidden")}())},setButtonCount:function(){var e=this.selected();this.isMultiple&&this.buttonCount[e.length>1?"show":"hide"]().text(e.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:e.noop,close:e.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},e.mobile.behaviors.formReset))}(e),function(e){e.mobile.links=function(t){e(t).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var e=this,t=e.getAttribute("href").substring(1);t&&(e.setAttribute("aria-haspopup",!0),e.setAttribute("aria-owns",t),e.setAttribute("aria-expanded",!1))}).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")}}(e),function(e,i){function n(e,t,i,n){var r=n;return r=t>e?i+(e-t)/2:Math.min(Math.max(i,n-t/2),i+e-t)}function r(e){return{x:e.scrollLeft(),y:e.scrollTop(),cx:e[0].innerWidth||e.width(),cy:e[0].innerHeight||e.height()}}e.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!e.mobile.browser.oldIE},_create:function(){var t=this.element,i=t.attr("id"),n=this.options;n.history=n.history&&e.mobile.ajaxEnabled&&e.mobile.hashListeningEnabled,e.extend(this,{_scrollTop:0,_page:t.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=e("body")),n.enhanced?this._ui={container:t.parent(),screen:t.parent().prev(),placeholder:e(this.document[0].getElementById(i+"-placeholder"))}:(this._ui=this._enhance(t,i),this._applyTransition(n.transition)),this._setTolerance(n.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:e.proxy(this,"_handleWindowOrientationchange"),resize:e.proxy(this,"_handleWindowResize"),keyup:e.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(t,i){var n=this.options,r=n.wrapperClass,s={screen:e("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",n.overlayTheme)+"'></div>"),placeholder:e("<div style='display: none;'><!-- placeholder --></div>"),container:e("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(r?" "+r:"")+"'></div>")},o=this.document[0].createDocumentFragment();return o.appendChild(s.screen[0]),o.appendChild(s.container[0]),i&&(s.screen.attr("id",i+"-screen"),s.container.attr("id",i+"-popup"),s.placeholder.attr("id",i+"-placeholder").html("<!-- placeholder for "+i+" -->")),this._page[0].appendChild(o),s.placeholder.insertAfter(t),t.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",n.theme)+" "+(n.shadow?"ui-overlay-shadow ":"")+(n.corners?"ui-corner-all ":"")).appendTo(s.container),s},_eatEventAndClose:function(e){return e.preventDefault(),e.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var e=this._ui.screen,t=this._ui.container.outerHeight(!0),i=e.removeAttr("style").height(),n=this.document.height()-1;n>i?e.height(n):t>i&&e.height(t)},_handleWindowKeyUp:function(t){return this._isOpen&&t.keyCode===e.mobile.keyCode.ESCAPE?this._eatEventAndClose(t):i},_expectResizeEvent:function(){var e=r(this.window);if(this._resizeData){if(e.x===this._resizeData.windowCoordinates.x&&e.y===this._resizeData.windowCoordinates.y&&e.cx===this._resizeData.windowCoordinates.cx&&e.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:e},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(t){var i,n=t.target,r=this._ui;if(this._isOpen){if(n!==r.container[0]){if(i=e(n),0===i.parents().filter(r.container[0]).length)return e(this.document[0].activeElement).one("focus",function(){i.blur()}),r.focusElement.focus(),t.preventDefault(),t.stopImmediatePropagation(),!1;r.focusElement[0]===r.container[0]&&(r.focusElement=i)}this._ignoreResizeEvents()}},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:e+"inherit"},_applyTransition:function(t){return t&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==t&&(this._fallbackTransition=e.mobile._maybeDegradeTransition(t),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(e){var t=this.options,n=this.element,r=this._ui.screen;return e.wrapperClass!==i&&this._ui.container.removeClass(t.wrapperClass).addClass(e.wrapperClass),e.theme!==i&&n.removeClass(this._themeClassFromOption("ui-body-",t.theme)).addClass(this._themeClassFromOption("ui-body-",e.theme)),e.overlayTheme!==i&&(r.removeClass(this._themeClassFromOption("ui-overlay-",t.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",e.overlayTheme)),this._isOpen&&r.addClass("in")),e.shadow!==i&&n.toggleClass("ui-overlay-shadow",e.shadow),e.corners!==i&&n.toggleClass("ui-corner-all",e.corners),e.transition!==i&&(this._currentTransition||this._applyTransition(e.transition)),e.tolerance!==i&&this._setTolerance(e.tolerance),e.disabled!==i&&e.disabled&&this.close(),this._super(e)},_setTolerance:function(t){var n,r={t:30,r:15,b:30,l:15};if(t!==i)switch(n=(t+"").split(","),e.each(n,function(e,t){n[e]=parseInt(t,10)}),n.length){case 1:isNaN(n[0])||(r.t=r.r=r.b=r.l=n[0]);break;case 2:isNaN(n[0])||(r.t=r.b=n[0]),isNaN(n[1])||(r.l=r.r=n[1]);break;case 4:isNaN(n[0])||(r.t=n[0]),isNaN(n[1])||(r.r=n[1]),isNaN(n[2])||(r.b=n[2]),isNaN(n[3])||(r.l=n[3]);break;default:}return this._tolerance=r,this},_clampPopupWidth:function(e){var t,i=r(this.window),n={x:this._tolerance.l,y:i.y+this._tolerance.t,cx:i.cx-this._tolerance.l-this._tolerance.r,cy:i.cy-this._tolerance.t-this._tolerance.b};return e||this._ui.container.css("max-width",n.cx),t={cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)},{rc:n,menuSize:t}},_calculateFinalLocation:function(e,t){var i,r=t.rc,s=t.menuSize;return i={left:n(r.cx,s.cx,r.x,e.x),top:n(r.cy,s.cy,r.y,e.y)},i.top=Math.max(0,i.top),i.top-=Math.min(i.top,Math.max(0,i.top+s.cy-this.document.height())),i},_placementCoords:function(e){return this._calculateFinalLocation(e,this._clampPopupWidth())},_createPrerequisites:function(t,i,n){var r,s=this;r={screen:e.Deferred(),container:e.Deferred()},r.screen.then(function(){r===s._prerequisites&&t()}),r.container.then(function(){r===s._prerequisites&&i()}),e.when(r.screen,r.container).done(function(){r===s._prerequisites&&(s._prerequisites=null,n())}),s._prerequisites=r},_animate:function(t){return this._ui.screen.removeClass(t.classToRemove).addClass(t.screenClassToAdd),t.prerequisites.screen.resolve(),t.transition&&"none"!==t.transition&&(t.applyTransition&&this._applyTransition(t.transition),this._fallbackTransition)?(this._ui.container.animationComplete(e.proxy(t.prerequisites.container,"resolve")).addClass(t.containerClassToAdd).removeClass(t.classToRemove),i):(this._ui.container.removeClass(t.classToRemove),t.prerequisites.container.resolve(),i)},_desiredCoords:function(t){var i,n=null,s=r(this.window),o=t.x,a=t.y,l=t.positionTo;if(l&&"origin"!==l)if("window"===l)o=s.cx/2+s.x,a=s.cy/2+s.y;else{try{n=e(l)}catch(u){n=null}n&&(n.filter(":visible"),0===n.length&&(n=null))}return n&&(i=n.offset(),o=i.left+n.outerWidth()/2,a=i.top+n.outerHeight()/2),("number"!==e.type(o)||isNaN(o))&&(o=s.cx/2+s.x),("number"!==e.type(a)||isNaN(a))&&(a=s.cy/2+s.y),{x:o,y:a}},_reposition:function(e){e={x:e.x,y:e.y,positionTo:e.positionTo},this._trigger("beforeposition",i,e),this._ui.container.offset(this._placementCoords(this._desiredCoords(e)))},reposition:function(e){this._isOpen&&this._reposition(e)},_openPrerequisitesComplete:function(){var e=this.element.attr("id");this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),this._ui.container.attr("tabindex","0").focus(),this._ignoreResizeEvents(),e&&this.document.find("[aria-haspopup='true'][aria-owns='"+e+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(t){var i=e.extend({},this.options,t),n=function(){var e=navigator.userAgent,t=e.match(/AppleWebKit\/([0-9\.]+)/),i=!!t&&t[1],n=e.match(/Android (\d+(?:\.\d+))/),r=!!n&&n[1],s=e.indexOf("Chrome")>-1;return null!==n&&"4.0"===r&&i&&i>534.13&&!s?!0:!1}();this._createPrerequisites(e.noop,e.noop,e.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=i.transition,this._applyTransition(i.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(i),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&n&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:i.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")
},_closePrerequisitesDone:function(){var t=this._ui.container,n=this.element.attr("id");t.removeAttr("tabindex"),e.mobile.popup.active=i,e(":focus",t[0]).add(t[0]).blur(),n&&this.document.find("[aria-haspopup='true'][aria-owns='"+n+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(t){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(e.proxy(this,"_closePrerequisiteScreen"),e.proxy(this,"_closePrerequisiteContainer"),e.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:t?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:e.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return e.mobile.popup.active===this?(this.element.one("popupafterclose",e.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(i,n){var r,s,o=this.options,a=!1;i&&i.isDefaultPrevented()||e.mobile.popup.active!==this||(t.scrollTo(0,this._scrollTop),i&&"pagebeforechange"===i.type&&n&&(r="string"==typeof n.toPage?n.toPage:n.toPage.jqmData("url"),r=e.mobile.path.parseUrl(r),s=r.pathname+r.search+r.hash,this._myUrl!==e.mobile.path.makeUrlAbsolute(s)?a=!0:i.preventDefault()),this.window.off(o.closeEvents),this.element.undelegate(o.closeLinkSelector,o.closeLinkEvents),this._close(a))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,e.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(t){var i,n,r,s,o,a,l=this,u=this.options;return e.mobile.popup.active||u.disabled?this:(e.mobile.popup.active=this,this._scrollTop=this.window.scrollTop(),u.history?(a=e.mobile.navigate.history,n=e.mobile.dialogHashKey,r=e.mobile.activePage,s=r?r.hasClass("ui-dialog"):!1,this._myUrl=i=a.getActive().url,(o=i.indexOf(n)>-1&&!s&&a.activeIndex>0)?(l._open(t),l._bindContainerClose(),this):(-1!==i.indexOf(n)||s?i=e.mobile.path.parseLocation().hash+n:i+=i.indexOf("#")>-1?n:"#"+n,0===a.activeIndex&&i===a.initialDst&&(i+=n),this.window.one("beforenavigate",function(e){e.preventDefault(),l._open(t),l._bindContainerClose()}),this.urlAltered=!0,e.mobile.navigate(i,{role:"dialog"}),this)):(l._open(t),l._bindContainerClose(),l.element.delegate(u.closeLinkSelector,u.closeLinkEvents,function(e){l.close(),e.preventDefault()}),this))},close:function(){return e.mobile.popup.active!==this?this:(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(e.mobile.back(),this.urlAltered=!1):this._closePopup(),this)}}),e.mobile.popup.handleLink=function(t){var i,n=e.mobile.path,r=e(n.hashToSelector(n.parseUrl(t.attr("href")).hash)).first();r.length>0&&r.data("mobile-popup")&&(i=t.offset(),r.popup("open",{x:i.left+t.outerWidth()/2,y:i.top+t.outerHeight()/2,transition:t.jqmData("transition"),positionTo:t.jqmData("position-to")})),setTimeout(function(){t.removeClass(e.mobile.activeBtnClass)},300)},e.mobile.document.on("pagebeforechange",function(t,i){"popup"===i.options.role&&(e.mobile.popup.handleLink(i.options.link),t.preventDefault())})}(e),function(e,t){var n=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",r=function(e,t,i){var r=e[i+"All"]().not(n).first();r.length&&(t.blur().attr("tabindex","-1"),r.find("a").first().focus())};e.widget("mobile.selectmenu",e.mobile.selectmenu,{_create:function(){var e=this.options;return e.nativeMenu=e.nativeMenu||this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(e){this._super(e),this._handleButtonVclickKeydown(e)},_handleButtonVclickKeydown:function(t){this.options.disabled||this.isOpen||("vclick"===t.type||t.keyCode&&(t.keyCode===e.mobile.keyCode.ENTER||t.keyCode===e.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(e.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(e.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(t){var i="focusin"===t.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};e(t.target).attr("tabindex",i.tabindex).trigger(i.event)},_handleListKeydown:function(t){var i=e(t.target),n=i.closest("li");switch(t.keyCode){case 38:return r(n,i,"prev"),!1;case 40:return r(n,i,"next"),!1;case 13:case 32:return i.trigger("click"),!1}},_handleMenuPageHide:function(){this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):t},build:function(){var i,n,r,s,o,a,l,u,h,c,p,d,f,m,g,y,v,b,_,w=this.options;return w.nativeMenu?this._super():(_=this,i=this.selectId,n=i+"-listbox",r=i+"-dialog",s=this.label,o=this.element.closest(".ui-page"),a=this.element[0].multiple,l=i+"-menu",u=w.theme?" data-"+e.mobile.ns+"theme='"+w.theme+"'":"",h=w.overlayTheme?" data-"+e.mobile.ns+"theme='"+w.overlayTheme+"'":"",c=w.dividerTheme&&a?" data-"+e.mobile.ns+"divider-theme='"+w.dividerTheme+"'":"",p=e("<div data-"+e.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+r+"'"+u+h+">"+"<div data-"+e.mobile.ns+"role='header'>"+"<div class='ui-title'>"+s.getEncodedText()+"</div>"+"</div>"+"<div data-"+e.mobile.ns+"role='content'></div>"+"</div>"),d=e("<div id='"+n+"' class='ui-selectmenu'>").insertAfter(this.select).popup({theme:w.overlayTheme}),f=e("<ul class='ui-selectmenu-list' id='"+l+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+u+c+">").appendTo(d),m=e("<div class='ui-header ui-bar-"+(w.theme?w.theme:"inherit")+"'>").prependTo(d),g=e("<h1 class='ui-title'>").appendTo(m),this.isMultiple&&(b=e("<a>",{role:"button",text:w.closeText,href:"#","class":"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(m)),e.extend(this,{selectId:i,menuId:l,popupId:n,dialogId:r,thisPage:o,menuPage:p,label:s,isMultiple:a,theme:w.theme,listbox:d,list:f,header:m,headerTitle:g,headerClose:b,menuPageContent:y,menuPageClose:v,placeholder:""}),this.refresh(),this._origTabIndex===t&&(this._origTabIndex=null===this.select[0].getAttribute("tabindex")?!1:this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown"}),this.list.delegate("li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)","click",function(t){var i=_.select[0].selectedIndex,n=e.mobile.getAttribute(this,"option-index"),r=_._selectOptions().eq(n)[0];r.selected=_.isMultiple?!r.selected:!0,_.isMultiple&&e(this).find("a").toggleClass("ui-checkbox-on",r.selected).toggleClass("ui-checkbox-off",!r.selected),(_.isMultiple||i!==n)&&_.select.trigger("change"),_.isMultiple?_.list.find("li:not(.ui-li-divider)").eq(n).find("a").first().focus():_.close(),t.preventDefault()}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"close"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_isRebuildRequired:function(){var e=this.list.find("li"),t=this._selectOptions().not(".ui-screen-hidden");return t.text()!==e.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(i){var n,r;return this.options.nativeMenu?this._super(i):(n=this,(i||this._isRebuildRequired())&&n._buildList(),r=this.selectedIndices(),n.setButtonText(),n.setButtonCount(),n.list.find("li:not(.ui-li-divider)").find("a").removeClass(e.mobile.activeBtnClass).end().attr("aria-selected",!1).each(function(t){if(e.inArray(t,r)>-1){var i=e(this);i.attr("aria-selected",!0),n.isMultiple?i.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):i.hasClass("ui-screen-hidden")?i.next().find("a").addClass(e.mobile.activeBtnClass):i.find("a").addClass(e.mobile.activeBtnClass)}}),t)},close:function(){if(!this.options.disabled&&this.isOpen){var e=this;"page"===e.menuType?(e.menuPage.dialog("close"),e.list.appendTo(e.listbox)):e.listbox.popup("close"),e._focusButton(),e.isOpen=!1}},open:function(){this.button.click()},_focusMenuItem:function(){var t=this.list.find("a."+e.mobile.activeBtnClass);0===t.length&&(t=this.list.find("li:not("+n+") a.ui-btn")),t.first().focus()},_decideFormat:function(){var t=this,i=this.window,n=t.list.parent(),r=n.outerHeight(),s=i.scrollTop(),o=t.button.offset().top,a=i.height();r>a-80||!e.support.scrollTop?(t.menuPage.appendTo(e.mobile.pageContainer).page(),t.menuPageContent=t.menuPage.find(".ui-content"),t.menuPageClose=t.menuPage.find(".ui-header a"),t.thisPage.unbind("pagehide.remove"),0===s&&o>a&&t.thisPage.one("pagehide",function(){e(this).jqmData("lastScroll",o)}),t.menuPage.one({pageshow:e.proxy(this,"_focusMenuItem"),pagehide:e.proxy(this,"close")}),t.menuType="page",t.menuPageContent.append(t.list),t.menuPage.find("div .ui-title").text(t.label.text())):(t.menuType="overlay",t.listbox.one({popupafteropen:e.proxy(this,"_focusMenuItem")}))},_buildList:function(){var t,n,r,s,o,a,l,u,h,c,p,d,f,m,g=this,y=this.options,v=this.placeholder,b=!0,_="false",w="data-"+e.mobile.ns,x=w+"option-index",L=w+"icon",O=w+"role",C=w+"placeholder",E=i.createDocumentFragment(),S=!1;for(g.list.empty().filter(".ui-listview").listview("destroy"),t=this._selectOptions(),n=t.length,r=this.select[0],o=0;n>o;o++,S=!1)a=t[o],l=e(a),l.hasClass("ui-screen-hidden")||(u=a.parentNode,h=l.text(),c=i.createElement("a"),p=[],c.setAttribute("href","#"),c.appendChild(i.createTextNode(h)),u!==r&&"optgroup"===u.nodeName.toLowerCase()&&(d=u.getAttribute("label"),d!==s&&(f=i.createElement("li"),f.setAttribute(O,"list-divider"),f.setAttribute("role","option"),f.setAttribute("tabindex","-1"),f.appendChild(i.createTextNode(d)),E.appendChild(f),s=d)),!b||a.getAttribute("value")&&0!==h.length&&!l.jqmData("placeholder")||(b=!1,S=!0,null===a.getAttribute(C)&&(this._removePlaceholderAttr=!0),a.setAttribute(C,!0),y.hidePlaceholderMenuItems&&p.push("ui-screen-hidden"),v!==h&&(v=g.placeholder=h)),m=i.createElement("li"),a.disabled&&(p.push("ui-state-disabled"),m.setAttribute("aria-disabled",!0)),m.setAttribute(x,o),m.setAttribute(L,_),S&&m.setAttribute(C,!0),m.className=p.join(" "),m.setAttribute("role","option"),c.setAttribute("tabindex","-1"),this.isMultiple&&e(c).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),m.appendChild(c),E.appendChild(m));g.list[0].appendChild(E),this.isMultiple||v.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),g.list.listview()},_button:function(){return this.options.nativeMenu?this._super():e("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),this._origTabIndex!==t&&(this._origTabIndex!==!1?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+e.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}})}(e),function(e,t){function i(e,t){var i=t?t:[];return i.push("ui-btn"),e.theme&&i.push("ui-btn-"+e.theme),e.icon&&(i=i.concat(["ui-icon-"+e.icon,"ui-btn-icon-"+e.iconpos]),e.iconshadow&&i.push("ui-shadow-icon")),e.inline&&i.push("ui-btn-inline"),e.shadow&&i.push("ui-shadow"),e.corners&&i.push("ui-corner-all"),e.mini&&i.push("ui-mini"),i}function n(e){var i,n,r,o=!1,a=!0,l={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},u=[];for(e=e.split(" "),i=0;e.length>i;i++)r=!0,n=s[e[i]],n!==t?(r=!1,l[n]=!0):0===e[i].indexOf("ui-btn-icon-")?(r=!1,a=!1,l.iconpos=e[i].substring(12)):0===e[i].indexOf("ui-icon-")?(r=!1,l.icon=e[i].substring(8)):0===e[i].indexOf("ui-btn-")&&8===e[i].length?(r=!1,l.theme=e[i].substring(7)):"ui-btn"===e[i]&&(r=!1,o=!0),r&&u.push(e[i]);return a&&(l.icon=""),{options:l,unknownClasses:u,alreadyEnhanced:o}}function r(e){return"-"+e.toLowerCase()}var s={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},o=function(){var i=e.mobile.getAttribute.apply(this,arguments);return null==i?t:i},a=/[A-Z]/g;e.fn.buttonMarkup=function(s,l){var u,h,c,p,d,f=e.fn.buttonMarkup.defaults;for(u=0;this.length>u;u++){if(c=this[u],h=l?{alreadyEnhanced:!1,unknownClasses:[]}:n(c.className),p=e.extend({},h.alreadyEnhanced?h.options:{},s),!h.alreadyEnhanced)for(d in f)p[d]===t&&(p[d]=o(c,d.replace(a,r)));c.className=i(e.extend({},f,p),h.unknownClasses).join(" "),"button"!==c.tagName.toLowerCase()&&c.setAttribute("role","button")}return this},e.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},e.extend(e.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button"})}(e),function(e,t){e.widget("mobile.controlgroup",e.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var t=this.element,i=this.options;e.fn.buttonMarkup&&this.element.find(e.fn.buttonMarkup.initSelector).buttonMarkup(),e.each(this._childWidgets,e.proxy(function(t,i){e.mobile[i]&&this.element.find(e.mobile[i].initSelector).not(e.mobile.page.prototype.keepNativeSelector())[i]()},this)),e.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=i.enhanced?{groupLegend:t.children(".ui-controlgroup-label").children(),childWrapper:t.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(e){return e?"none"===e?"":"ui-group-theme-"+e:""},_enhance:function(){var t=this.element,i=this.options,n={groupLegend:t.children("legend"),childWrapper:t.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===i.type?"horizontal":"vertical")+" "+this._themeClassFromOption(i.theme)+" "+(i.corners?"ui-corner-all ":"")+(i.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(i.shadow===!0?"ui-shadow":"")+"'></div>").children()};return n.groupLegend.length>0&&e("<div role='heading' class='ui-controlgroup-label'></div>").append(n.groupLegend).prependTo(t),n},_init:function(){this.refresh()},_setOptions:function(e){var i,n,r=this.element;return e.type!==t&&(r.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===e.type?"horizontal":"vertical")),i=!0),e.theme!==t&&r.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(e.theme)),e.corners!==t&&r.toggleClass("ui-corner-all",e.corners),e.mini!==t&&r.toggleClass("ui-mini",e.mini),e.shadow!==t&&this._ui.childWrapper.toggleClass("ui-shadow",e.shadow),e.excludeInvisible!==t&&(this.options.excludeInvisible=e.excludeInvisible,i=!0),n=this._super(e),i&&this.refresh(),n},container:function(){return this._ui.childWrapper},refresh:function(){var t=this.container(),i=t.find(".ui-btn").not(".ui-slider-handle"),n=this._initialRefresh;e.mobile.checkboxradio&&t.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(i,this.options.excludeInvisible?this._getVisibles(i,n):i,n),this._initialRefresh=!1},_destroy:function(){var e,i,n=this.options;return n.enhanced?this:(e=this._ui,i=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(n.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(i),e.groupLegend.unwrap(),e.childWrapper.children().unwrap(),t)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e,t){e.widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var t,i,n=this.element.is(":jqmData(role='header')")?"header":"footer",r=this.element.closest(".ui-page");0===r.length&&(r=!1,this._on(this.document,{pageshow:"refresh"})),e.extend(this,{role:n,page:r,leftbtn:t,rightbtn:i,backBtn:null}),this.element.attr("role","header"===n?"banner":"contentinfo").addClass("ui-"+n),this.refresh(),this._setOptions(this.options)},_setOptions:function(i){if(i.addBackBtn!==t&&(this.options.addBackBtn&&"header"===this.role&&e(".ui-page").length>1&&this.page[0].getAttribute("data-"+e.mobile.ns+"url")!==e.mobile.path.stripHash(location.hash)&&!this.leftbtn?this._addBackButton():this.element.find(".ui-toolbar-back-btn").remove()),null!=i.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+i.backBtnTheme),i.backBtnText!==t&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(i.backBtnText),i.theme!==t){var n=this.options.theme?this.options.theme:"inherit",r=i.theme?i.theme:"inherit";this.element.removeClass("ui-bar-"+n).addClass("ui-bar-"+r)}this._super(i)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role&&this.element.appendTo("body")),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").attr("data-"+e.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var e=this.element.children("a, button");this.leftbtn=e.hasClass("ui-btn-left"),this.rightbtn=e.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||e.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||e.eq(1).addClass("ui-btn-right").length},_addBackButton:function(){var t,i=this.options;this.backBtn||(t=i.backBtnTheme||i.theme,this.backBtn=e("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(t?"ui-btn-"+t+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' "+"data-"+e.mobile.ns+"rel='back'>"+i.backBtnText+"</a>").prependTo(this.element))},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})}})}(e),function(e,t){e.widget("mobile.toolbar",e.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!e.support.fixedPosition}},_create:function(){this._super(),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers(),this._setOptions(this.options)},_setOptions:function(i){if("fixed"===i.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var n=this.page?this.page:e(".ui-page-active").length>0?e(".ui-page-active"):e(".ui-page").eq(0);i.fullscreen!==t&&(i.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),n.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),n.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(i)},_addTransitionClass:function(){var e=this.options.transition;e&&"none"!==e&&("slide"===e&&(e=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(e))},_bindPageEvents:function(){var e=this.page?this.element.closest(".ui-page"):this.document;this._on(e,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var t=this.options;t.disablePageZoom&&e.mobile.zoom.disable(!0),t.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(t,i){var n,r,s,o,a=this.options;a.disablePageZoom&&e.mobile.zoom.enable(!0),a.updatePagePadding&&this._off(this.window,"throttledresize"),a.trackPersistentToolbars&&(n=e(".ui-footer-fixed:jqmData(id)",this.page),r=e(".ui-header-fixed:jqmData(id)",this.page),s=n.length&&i.nextPage&&e(".ui-footer-fixed:jqmData(id='"+n.jqmData("id")+"')",i.nextPage)||e(),o=r.length&&i.nextPage&&e(".ui-header-fixed:jqmData(id='"+r.jqmData("id")+"')",i.nextPage)||e(),(s.length||o.length)&&(s.add(o).appendTo(e.mobile.pageContainer),i.nextPage.one("pageshow",function(){o.prependTo(this),s.appendTo(this)})))},_visible:!0,updatePagePadding:function(i){var n=this.element,r="header"===this.role,s=parseFloat(n.css(r?"top":"bottom"));this.options.fullscreen||(i=i&&i.type===t&&i||this.page||n.closest(".ui-page"),i=this.page?this.page:".ui-page-active",e(i).css("padding-"+(r?"top":"bottom"),n.outerHeight()+s))},_useTransition:function(t){var i=this.window,n=this.element,r=i.scrollTop(),s=n.height(),o=this.page?n.closest(".ui-page").height():e(".ui-page-active").height(),a=e.mobile.getScreenHeight();return!t&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&r>s||"footer"===this.role&&!this.options.fullscreen&&o-s>r+a)||this.options.fullscreen)},show:function(e){var t="ui-fixed-hidden",i=this.element;this._useTransition(e)?i.removeClass("out "+t).addClass("in").animationComplete(function(){i.removeClass("in")}):i.removeClass(t),this._visible=!0},hide:function(e){var t="ui-fixed-hidden",i=this.element,n="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(e)?i.addClass(n).removeClass("in").animationComplete(function(){i.addClass(t).removeClass(n)}):i.addClass(t).removeClass(n),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var t,i,n=this,r=n.options,s=!0,o=this.page?this.page:e(".ui-page");o.bind("vclick",function(t){r.tapToggle&&!e(t.target).closest(r.tapToggleBlacklist).length&&n.toggle()}).bind("focusin focusout",function(o){1025>screen.width&&e(o.target).is(r.hideDuringFocus)&&!e(o.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==o.type||s?"focusin"===o.type&&s&&(clearTimeout(t),s=!1,i=setTimeout(function(){n.hide()},0)):(s=!0,clearTimeout(i),t=setTimeout(function(){n.show()},0)))})},_setRelative:function(){"fixed"!==this.options.position&&e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var e=this.element,t=e.hasClass("ui-header");e.closest(".ui-page").css("padding-"+(t?"top":"bottom"),""),e.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden"),e.closest(".ui-page").removeClass("ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen")}})}(e),function(e){e.widget("mobile.toolbar",e.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var e=navigator.userAgent,t=navigator.platform,i=e.match(/AppleWebKit\/([0-9]+)/),n=!!i&&i[1],r=null,s=this;if(t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1||t.indexOf("iPod")>-1)r="ios";else{if(!(e.indexOf("Android")>-1))return;r="android"}if("ios"===r)s._bindScrollWorkaround();else{if(!("android"===r&&n&&534>n))return;s._bindScrollWorkaround(),s._bindListThumbWorkaround()}},_viewportOffset:function(){var e=this.element,t=e.hasClass("ui-header"),i=Math.abs(e.offset().top-this.window.scrollTop());return t||(i=Math.round(i-this.window.height()+e.outerHeight())-60),i},_bindScrollWorkaround:function(){var e=this;this._on(this.window,{scrollstop:function(){var t=e._viewportOffset();t>2&&e._visible&&e._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var t=parseFloat(e(".ui-page-active").css("padding-bottom"));e(".ui-page-active").css("padding-bottom",t+1+"px"),setTimeout(function(){e(".ui-page-active").css("padding-bottom",t+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(e),function(e,t){function i(){var e=r.clone(),t=e.eq(0),i=e.eq(1),n=i.children(),s=n.children();return{arEls:i.add(t),gd:t,ct:i,ar:n,bg:s}}var n=e.mobile.browser.oldIE&&8>=e.mobile.browser.oldIE,r=e("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(n?" ie":"")+"'>"+"<div class='ui-popup-arrow'>"+"<div class='ui-popup-arrow-background'></div>"+"</div>"+"</div>"),s=Math.sqrt(2)/2;e.widget("mobile.popup",e.mobile.popup,{options:{arrow:""},_create:function(){var e,t=this._super();return this.options.arrow&&(this._ui.arrow=e=this._addArrow()),t},_addArrow:function(){var e,t=this.options,n=i();return e=this._themeClassFromOption("ui-body-",t.theme),n.ar.addClass(e+(t.shadow?" ui-overlay-shadow":"")),n.bg.addClass(e),n.arEls.hide().appendTo(this.element),n},_unenhance:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()},_tryAnArrow:function(e,t,i,n,r){var s,o,a,l={},u={};return n.arFull[e.dimKey]>n.guideDims[e.dimKey]?r:(l[e.fst]=i[e.fst]+(n.arHalf[e.oDimKey]+n.menuHalf[e.oDimKey])*e.offsetFactor-n.contentBox[e.fst]+(n.clampInfo.menuSize[e.oDimKey]-n.contentBox[e.oDimKey])*e.arrowOffsetFactor,l[e.snd]=i[e.snd],s=n.result||this._calculateFinalLocation(l,n.clampInfo),o={x:s.left,y:s.top},u[e.fst]=o[e.fst]+n.contentBox[e.fst]+e.tipOffset,u[e.snd]=Math.max(s[e.prop]+n.guideOffset[e.prop]+n.arHalf[e.dimKey],Math.min(s[e.prop]+n.guideOffset[e.prop]+n.guideDims[e.dimKey]-n.arHalf[e.dimKey],i[e.snd])),a=Math.abs(i.x-u.x)+Math.abs(i.y-u.y),(!r||r.diff>a)&&(u[e.snd]-=n.arHalf[e.dimKey]+s[e.prop]+n.contentBox[e.snd],r={dir:t,diff:a,result:s,posProp:e.prop,posVal:u[e.snd]}),r)},_getPlacementState:function(e){var t,i,n=this._ui.arrow,r={clampInfo:this._clampPopupWidth(!e),arFull:{cx:n.ct.width(),cy:n.ct.height()},guideDims:{cx:n.gd.width(),cy:n.gd.height()},guideOffset:n.gd.offset()};return t=this.element.offset(),n.gd.css({left:0,top:0,right:0,bottom:0}),i=n.gd.offset(),r.contentBox={x:i.left-t.left,y:i.top-t.top,cx:n.gd.width(),cy:n.gd.height()},n.gd.removeAttr("style"),r.guideOffset={left:r.guideOffset.left-t.left,top:r.guideOffset.top-t.top},r.arHalf={cx:r.arFull.cx/2,cy:r.arFull.cy/2},r.menuHalf={cx:r.clampInfo.menuSize.cx/2,cy:r.clampInfo.menuSize.cy/2},r},_placementCoords:function(t){var i,r,o,a,l,u,h,c=this.options.arrow,p=this._ui.arrow;return p?(p.arEls.show(),h={},i=this._getPlacementState(!0),o={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-i.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:i.arHalf.cx+i.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:i.arHalf.cy+i.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-i.arHalf.cy,arrowOffsetFactor:0}},e.each((c===!0?"l,t,r,b":c).split(","),e.proxy(function(e,n){r=this._tryAnArrow(o[n],n,t,i,r)},this)),r?(p.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+r.dir).removeAttr("style").css(r.posProp,r.posVal).show(),n||(l=this.element.offset(),h[o[r.dir].fst]=p.ct.offset(),h[o[r.dir].snd]={left:l.left+i.contentBox.x,top:l.top+i.contentBox.y},a=p.bg.removeAttr("style").css("cx"===o[r.dir].dimKey?"width":"height",i.contentBox[o[r.dir].dimKey]).offset(),u={dx:h.x.left-a.left,dy:h.y.top-a.top},p.bg.css({left:s*u.dy+s*u.dx,top:s*u.dy-s*u.dx})),r.result):(p.arEls.hide(),this._super(t))):this._super(t)},_setOptions:function(e){var i,n=this.options.theme,r=this._ui.arrow,s=this._super(e);if(e.arrow!==t){if(!r&&e.arrow)return this._ui.arrow=this._addArrow(),t;r&&!e.arrow&&(r.arEls.remove(),this._ui.arrow=null)}return r=this._ui.arrow,r&&(e.theme!==t&&(n=this._themeClassFromOption("ui-body-",n),i=this._themeClassFromOption("ui-body-",e.theme),r.ar.removeClass(n).addClass(i),r.bg.removeClass(n).addClass(i)),e.shadow!==t&&r.ar.toggleClass("ui-overlay-shadow",e.shadow)),s},_destroy:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()}})}(e),function(e,i){e.widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_panelID:null,_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var t=this.element,i=t.closest(":jqmData(role='page')");e.extend(this,{_panelID:t.attr("id"),_closeLink:t.find(":jqmData(rel='close')"),_parentPage:i.length>0?i:!1,_page:this._getPage,_panelInner:this._getPanelInner(),_wrapper:this._getWrapper,_fixedToolbars:this._getFixedToolbars}),this._addPanelClasses(),e.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var e=this.element.find("."+this.options.classes.panelInner);return 0===e.length&&(e=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),e},_createModal:function(){var t=this,i=t._parentPage?t._parentPage.parent():t.element.parent();t._modal=e("<div class='"+t.options.classes.modal+"' data-panelid='"+t._panelID+"'></div>").on("mousedown",function(){t.close()}).appendTo(i)},_getPage:function(){var t=this._parentPage?this._parentPage:e("."+e.mobile.activePageClass);return t},_getWrapper:function(){var e=this._page().find("."+this.options.classes.pageWrapper);return 0===e.length&&(e=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),e},_getFixedToolbars:function(){var t=e("body").children(".ui-header-fixed, .ui-footer-fixed"),i=this._page().find(".ui-header-fixed, .ui-footer-fixed"),n=t.add(i).addClass(this.options.classes.pageFixedToolbar);return n},_getPosDisplayClasses:function(e){return e+"-position-"+this.options.position+" "+e+"-display-"+this.options.display},_getPanelClasses:function(){var e=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" "+"ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(e+=" "+this.options.classes.panelFixed),e},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())
},_bindCloseEvents:function(){var e=this;e._closeLink.on("click.panel",function(t){return t.preventDefault(),e.close(),!1}),e.element.on("click.panel","a:jqmData(ajax='false')",function(){e.close()})},_positionPanel:function(){var i=this,n=i._panelInner.outerHeight(),r=n>e.mobile.getScreenHeight();r||!i.options.positionFixed?(r&&(i._unfixPanel(),e.mobile.resetActivePageHeight(n)),t.scrollTo(0,e.mobile.defaultHomeScroll)):i._fixPanel()},_bindFixListener:function(){this._on(e(t),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(e(t),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var e=this;e.element.on("updatelayout",function(){e._open&&e._positionPanel()})},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(t){if(t.currentTarget.href.split("#")[1]===this._panelID&&this._panelID!==i){t.preventDefault();var n=e(t.target);return n.hasClass("ui-btn")&&(n.addClass(e.mobile.activeBtnClass),this.element.one("panelopen panelclose",function(){n.removeClass(e.mobile.activeBtnClass)})),this.toggle(),!1}},_bindSwipeEvents:function(){var e=this,t=e._modal?e.element.add(e._modal):e.element;e.options.swipeClose&&("left"===e.options.position?t.on("swipeleft.panel",function(){e.close()}):t.on("swiperight.panel",function(){e.close()}))},_bindPageEvents:function(){var e=this;this.document.on("panelbeforeopen",function(t){e._open&&t.target!==e.element[0]&&e.close()}).on("keyup.panel",function(t){27===t.keyCode&&e._open&&e.close()}),e._parentPage?this.document.on("pagehide",":jqmData(role='page')",function(){e._open&&e.close(!0)}):this.document.on("pagebeforehide",function(){e._open&&e.close(!0)})},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(t){if(!this._open){var i=this,n=i.options,r=function(){i.document.off("panelclose"),i._page().jqmData("panel","open"),e.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper().addClass(n.classes.animate),i._fixedToolbars().addClass(n.classes.animate)),!t&&e.support.cssTransform3d&&n.animate?i.document.on(i._transitionEndEvents,s):setTimeout(s,0),n.theme&&"overlay"!==n.display&&i._page().parent().addClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.removeClass(n.classes.panelClosed).addClass(n.classes.panelOpen),i._positionPanel(),i._pageContentOpenClasses=i._getPosDisplayClasses(n.classes.pageContentPrefix),"overlay"!==n.display&&(i._page().parent().addClass(n.classes.pageContainer),i._wrapper().addClass(i._pageContentOpenClasses),i._fixedToolbars().addClass(i._pageContentOpenClasses)),i._modalOpenClasses=i._getPosDisplayClasses(n.classes.modal)+" "+n.classes.modalOpen,i._modal&&i._modal.addClass(i._modalOpenClasses).height(Math.max(i._modal.height(),i.document.height()))},s=function(){i.document.off(i._transitionEndEvents,s),"overlay"!==n.display&&(i._wrapper().addClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().addClass(n.classes.pageContentPrefix+"-open")),i._bindFixListener(),i._trigger("open")};i._trigger("beforeopen"),"open"===i._page().jqmData("panel")?i.document.on("panelclose",function(){r()}):r(),i._open=!0}},close:function(t){if(this._open){var i=this,n=this.options,r=function(){!t&&e.support.cssTransform3d&&n.animate?i.document.on(i._transitionEndEvents,s):setTimeout(s,0),i.element.removeClass(n.classes.panelOpen),"overlay"!==n.display&&(i._wrapper().removeClass(i._pageContentOpenClasses),i._fixedToolbars().removeClass(i._pageContentOpenClasses)),i._modal&&i._modal.removeClass(i._modalOpenClasses)},s=function(){i.document.off(i._transitionEndEvents,s),n.theme&&"overlay"!==n.display&&i._page().parent().removeClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.addClass(n.classes.panelClosed),"overlay"!==n.display&&(i._page().parent().removeClass(n.classes.pageContainer),i._wrapper().removeClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().removeClass(n.classes.pageContentPrefix+"-open")),e.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper().removeClass(n.classes.animate),i._fixedToolbars().removeClass(n.classes.animate)),i._fixPanel(),i._unbindFixListener(),e.mobile.resetActivePageHeight(),i._page().jqmRemoveData("panel"),i._trigger("close")};i._trigger("beforeclose"),r(),i._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_transitionEndEvents:"webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",_destroy:function(){var t,i=this.options,n=e("body > :mobile-panel").length+e.mobile.activePage.find(":mobile-panel").length>1;"overlay"!==i.display&&(t=e("body > :mobile-panel").add(e.mobile.activePage.find(":mobile-panel")),0===t.not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper().children().unwrap(),this._open&&(this._fixedToolbars().removeClass(i.classes.pageContentPrefix+"-open"),e.support.cssTransform3d&&i.animate&&this._fixedToolbars().removeClass(i.classes.animate),this._page().parent().removeClass(i.classes.pageContainer),i.theme&&this._page().parent().removeClass(i.classes.pageContainer+"-themed "+i.classes.pageContainer+"-"+i.theme))),n||(this.document.off("panelopen panelclose"),this._open&&(this.document.off(this._transitionEndEvents),e.mobile.resetActivePageHeight())),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),i.classes.panelOpen,i.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout").off(this._transitionEndEvents),this._closeLink.off("click.panel"),this._modal&&this._modal.remove()}})}(e),function(e,t){e.widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),e.extend(this,{headers:t,allHeaders:t}),this._refresh(!0)},_setHeaders:function(){var e=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(e.children())},refresh:function(){this._refresh()},rebuild:e.noop,_refresh:function(){var t=this.element,i=t.find("thead tr");this._setHeaders(),i.each(function(){var n=0;e(this).children().each(function(){var r,s=parseInt(this.getAttribute("colspan"),10),o=":nth-child("+(n+1)+")";if(this.setAttribute("data-"+e.mobile.ns+"colstart",n+1),s)for(r=0;s-1>r;r++)n++,o+=", :nth-child("+(n+1)+")";e(this).jqmData("cells",t.find("tr").not(i.eq(0)).not(this).children(o)),n++})})}})}(e),function(e){e.widget("mobile.table",e.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:e.extend(e.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(e.extend(this,{_menu:null}),this.options.enhanced?(this._menu=e(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0),this._bindToggles(this._menu)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"})},_bindToggles:function(e){var t=e.find("input");this._on(t,{change:"_menuInputChange"})},_addToggles:function(t,i){var n,r=0,s=this.options,o=t.controlgroup("container");i?n=t.find("input"):o.empty(),this.headers.not("td").each(function(){var t=e(this),a=e.mobile.getAttribute(this,"priority"),l=t.add(t.jqmData("cells"));a&&(l.addClass(s.classes.priorityPrefix+a),(i?n.eq(r++):e("<label><input type='checkbox' checked />"+(t.children("abbr").first().attr("title")||t.text())+"</label>").appendTo(o).children(0).checkboxradio({theme:s.columnPopupTheme})).jqmData("cells",l))}),i||(t.controlgroup("refresh"),this._bindToggles(t))},_menuInputChange:function(t){var i=e(t.target),n=i[0].checked;i.jqmData("cells").toggleClass("ui-table-cell-hidden",!n).toggleClass("ui-table-cell-visible",n),i[0].getAttribute("locked")?(i.removeAttr("locked"),this._unlockCells(i.jqmData("cells"))):i.attr("locked",!0)},_unlockCells:function(e){e.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var t,i,n,r,s=this.element,o=this.options,a=e.mobile.ns,l=this.document[0].createDocumentFragment();return t=this._id()+"-popup",i=e("<a href='#"+t+"' "+"class='"+o.classes.columnBtn+" ui-btn "+"ui-btn-"+(o.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' "+"data-"+a+"rel='popup'>"+o.columnBtnText+"</a>"),n=e("<div class='"+o.classes.popup+"' id='"+t+"'></div>"),r=e("<fieldset></fieldset>").controlgroup(),this._addToggles(r,!1),r.appendTo(n),l.appendChild(n[0]),l.appendChild(i[0]),s.before(l),n.popup(),r},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"columntoggle"!==this.options.mode||(this._unlockCells(this.allHeaders),this._addToggles(this._menu,e),this._setToggleState())},_setToggleState:function(){this._menu.find("input").each(function(){var t=e(this);this.checked="table-cell"===t.jqmData("cells").eq(0).css("display"),t.checkboxradio("refresh")})},_destroy:function(){this._super()}})}(e),function(e){e.widget("mobile.table",e.mobile.table,{options:{mode:"reflow",classes:e.extend(e.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var t=this,i=this.options;e(t.allHeaders.get().reverse()).each(function(){var n,r,s=e(this).jqmData("cells"),o=e.mobile.getAttribute(this,"colstart"),a=s.not(this).filter("thead th").length&&" ui-table-cell-label-top",l=e(this).text();""!==l&&(a?(n=parseInt(this.getAttribute("colspan"),10),r="",n&&(r="td:nth-child("+n+"n + "+o+")"),t._addLabels(s.filter(r),i.classes.cellLabels+a,l)):t._addLabels(s,i.classes.cellLabels,l))})},_addLabels:function(e,t,i){e.not(":has(b."+t+")").prepend("<b class='"+t+"'>"+i+"</b>")}})}(e),function(e,i){var n=function(t,i){return-1===(""+(e.mobile.getAttribute(this,"filtertext")||e(this).text())).toLowerCase().indexOf(i)};e.widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:n,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var t=this.options;e.extend(this,{_search:null,_timer:0}),this._setInput(t.input),t.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var i,n,r=this._search;if(r){if(i=r.val().toLowerCase(),n=e.mobile.getAttribute(r[0],"lastval")+"",n&&n===i)return;this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._timer=this._delay(function(){this._trigger("beforefilter","beforefilter",{input:r}),r[0].setAttribute("data-"+e.mobile.ns+"lastval",i),this._filterItems(i),this._timer=0},250)}},_getFilterableItems:function(){var t=this.element,i=this.options.children,n=i?e.isFunction(i)?i():i.nodeName?e(i):i.jquery?i:this.element.find(i):{length:0};return 0===n.length&&(n=t.children()),n},_filterItems:function(t){var i,r,s,o,a=[],l=[],u=this.options,h=this._getFilterableItems();if(null!=t)for(r=u.filterCallback||n,s=h.length,i=0;s>i;i++)o=r.call(h[i],i,t)?l:a,o.push(h[i]);0===l.length?h[u.filterReveal?"addClass":"removeClass"]("ui-screen-hidden"):(e(l).addClass("ui-screen-hidden"),e(a).removeClass("ui-screen-hidden")),this._refreshChildWidget()},_refreshChildWidget:function(){var t,i,n=["collapsibleset","selectmenu","controlgroup","listview"];for(i=n.length-1;i>-1;i--)t=n[i],e.mobile[t]&&(t=this.element.data("mobile-"+t),t&&e.isFunction(t.refresh)&&t.refresh())},_setInput:function(i){var n=this._search;this._timer&&(t.clearTimeout(this._timer),this._timer=0),n&&(this._off(n,"keyup change input"),n=null),i&&(n=i.jquery?i:i.nodeName?e(i):this.document.find(i),this._on(n,{keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=n},_setOptions:function(e){var t=!(e.filterReveal===i&&e.filterCallback===i&&e.children===i);this._super(e),e.input!==i&&(this._setInput(e.input),t=!0),t&&this.refresh()},_destroy:function(){var e=this.options,t=this._getFilterableItems();e.enhanced?t.toggleClass("ui-screen-hidden",e.filterReveal):t.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(e),function(e,t){var i=function(e,t){return function(i){t.call(this,i),e._syncTextInputOptions(i)}},n=/(^|\s)ui-li-divider(\s|$)/,r=e.mobile.filterable.prototype.options.filterCallback;e.mobile.filterable.prototype.options.filterCallback=function(e,t){return!this.className.match(n)&&r.call(this,e,t)},e.widget("mobile.filterable",e.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var t,i,n=this.element,r=["collapsibleset","selectmenu","controlgroup","listview"],s={};for(this._super(),e.extend(this,{_widget:null}),t=r.length-1;t>-1;t--)if(i=r[t],e.mobile[i]){if(this._setWidget(n.data("mobile-"+i)))break;s[i+"create"]="_handleCreate"}this._widget||this._on(n,s)},_handleCreate:function(e){this._setWidget(this.element.data("mobile-"+e.type.substring(0,e.type.length-6)))},_setWidget:function(e){return!this._widget&&e&&(this._widget=e,this._widget._setOptions=i(this,this._widget._setOptions)),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hidedividers=!0,this._widget.element.listview("refresh"))),!!this._widget},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(t){var i=this.options,n=!0,r={};if(!t){if(this._isSearchInternal())return;n=!1,t=e("<input data-"+e.mobile.ns+"type='search' "+"placeholder='"+i.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),e("<form class='ui-filterable'></form>").append(t).submit(function(e){e.preventDefault(),t.blur()}).insertBefore(this.element),e.mobile.textinput&&(null!=this.options.filterTheme&&(r.theme=i.filterTheme),t.textinput(r))}this._super(t),this._isSearchInternal()&&n&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(i){var n=this._super(i);return i.filterPlaceholder!==t&&this._isSearchInternal()&&this._search.attr("placeholder",i.filterPlaceholder),i.filterTheme!==t&&this._search&&e.mobile.textinput&&this._search.textinput("option","theme",i.filterTheme),n},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(i){var n,r={};if(this._isSearchInternal()&&e.mobile.textinput){for(n in e.mobile.textinput.prototype.options)i[n]!==t&&(r[n]="theme"===n&&null!=this.options.filterTheme?this.options.filterTheme:i[n]);this._search.textinput("option",r)}}})}(e),function(e,t){function i(){return++r}function n(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(s,""))===decodeURIComponent(location.href.replace(s,""))}var r=0,s=/#.*$/;e.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var i=this.options.active,n=this.options.collapsible,r=location.hash.substring(1);return null===i&&(r&&this.tabs.each(function(n,s){return e(s).attr("aria-controls")===r?(i=n,!1):t}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=this.tabs.length?0:!1)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=n?!1:0)),!n&&i===!1&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(i){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),s=!0;if(!this._handlePageNav(i)){switch(i.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:s=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:return i.preventDefault(),clearTimeout(this.activating),this._activate(r),t;case e.ui.keyCode.ENTER:return i.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r),t;default:return}i.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,s),i.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(i){return i.altKey&&i.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):i.altKey&&i.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):t},_findNextTab:function(t,i){function n(){return t>r&&(t=0),0>t&&(t=r),t}for(var r=this.tabs.length-1;-1!==e.inArray(n(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,i){return"active"===e?(this._activate(i),t):"disabled"===e?(this._setupDisabled(i),t):(this._super(e,i),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",i),i||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(i),"heightStyle"===e&&this._setupHeightStyle(i),t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,r){var s,o,a,l=e(r).uniqueId().attr("id"),u=e(r).closest("li"),h=u.attr("aria-controls");n(r)?(s=r.hash,o=t.element.find(t._sanitizeSelector(s))):(a=t._tabId(u),s="#"+a,o=t.element.find(s),o.length||(o=t._createPanel(a),o.insertAfter(t.panels[i-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),h&&u.data("ui-tabs-aria-controls",h),u.attr({"aria-controls":s.substring(1),"aria-labelledby":l}),o.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,n=0;i=this.tabs[n];n++)t===!0||-1!==e.inArray(n,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,n=this.element.parent();"fill"===t?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,n=this.active,r=e(t.currentTarget),s=r.closest("li"),o=s[0]===n[0],a=o&&i.collapsible,l=a?e():this._getPanelForTab(s),u=n.length?this._getPanelForTab(n):e(),h={oldTab:n,oldPanel:u,newTab:a?e():s,newPanel:l};t.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,h)===!1||(i.active=a?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),u.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(s),t),this._toggle(t,h))},_toggle:function(t,i){function n(){s.running=!1,s._trigger("activate",t,i)}function r(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,n):(o.show(),n())}var s=this,o=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),r()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),o.length&&a.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;n!==!1&&(i===t?n=!1:(i=this._getIndex(i),n=e.isArray(n)?e.map(n,function(e){return e!==i?e:null}):e.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(n!==!0){if(i===t)n=!0;else{if(i=this._getIndex(i),-1!==e.inArray(i,n))return;n=e.isArray(n)?e.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(t,i){t=this._getIndex(t);var r=this,s=this.tabs.eq(t),o=s.find(".ui-tabs-anchor"),a=this._getPanelForTab(s),l={tab:s,panel:a};n(o[0])||(this.xhr=e.ajax(this._ajaxSettings(o,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(s.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),r._trigger("load",i,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,i,n){var r=this;return{url:t.attr("href"),beforeSend:function(t,s){return r._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:s},n))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(e),function(){}(e),function(e,t){function i(e){r=e.originalEvent,l=r.accelerationIncludingGravity,s=Math.abs(l.x),o=Math.abs(l.y),a=Math.abs(l.z),!t.orientation&&(s>7||(a>6&&8>o||8>a&&o>6)&&s>5)?n.enabled&&n.disable():n.enabled||n.enable()}e.mobile.iosorientationfixEnabled=!0;var n,r,s,o,a,l,u=navigator.userAgent;return/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(u)&&u.indexOf("AppleWebKit")>-1?(n=e.mobile.zoom,e.mobile.document.on("mobileinit",function(){e.mobile.iosorientationfixEnabled&&e.mobile.window.bind("orientationchange.iosorientationfix",n.enable).bind("devicemotion.iosorientationfix",i)}),undefined):(e.mobile.iosorientationfixEnabled=!1,undefined)}(e,this),function(e,t){function n(){r.removeClass("ui-mobile-rendering")}var r=e("html"),s=e.mobile.window;e(t.document).trigger("mobileinit"),e.mobile.gradeA()&&(e.mobile.ajaxBlacklist&&(e.mobile.ajaxEnabled=!1),r.addClass("ui-mobile ui-mobile-rendering"),setTimeout(n,5e3),e.extend(e.mobile,{initializePage:function(){var t=e.mobile.path,r=e(":jqmData(role='page'), :jqmData(role='dialog')"),o=t.stripHash(t.stripQueryParams(t.parseLocation().hash)),a=i.getElementById(o);r.length||(r=e("body").wrapInner("<div data-"+e.mobile.ns+"role='page'></div>").children(0)),r.each(function(){var t=e(this);t[0].getAttribute("data-"+e.mobile.ns+"url")||t.attr("data-"+e.mobile.ns+"url",t.attr("id")||location.pathname+location.search)}),e.mobile.firstPage=r.first(),e.mobile.pageContainer=e.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),e.mobile.navreadyDeferred.resolve(),s.trigger("pagecontainercreate"),e.mobile.loading("show"),n(),e.mobile.hashListeningEnabled&&e.mobile.path.isHashValid(location.hash)&&(e(a).is(":jqmData(role='page')")||e.mobile.path.isPath(o)||o===e.mobile.dialogHashKey)?e.event.special.navigate.isPushStateEnabled()?(e.mobile.navigate.history.stack=[],e.mobile.navigate(e.mobile.path.isPath(location.hash)?location.hash:location.href)):s.trigger("hashchange",[!0]):(e.mobile.path.isHashValid(location.hash)&&(e.mobile.navigate.history.initialDst=o.replace("#","")),e.event.special.navigate.isPushStateEnabled()&&e.mobile.navigate.navigator.squash(t.parseLocation().href),e.mobile.changePage(e.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),e(function(){e.support.inlineSVG(),e.mobile.hideUrlBar&&t.scrollTo(0,1),e.mobile.defaultHomeScroll=e.support.scrollTop&&1!==e.mobile.window.scrollTop()?1:0,e.mobile.autoInitializePage&&e.mobile.initializePage(),e.mobile.hideUrlBar&&s.load(e.mobile.silentScroll),e.support.cssPointerEvents||e.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})}))}(e,this)}),function(){function e(e){var i=!1;return function(){if(i)throw Error("Callback was already called.");i=!0,e.apply(t,arguments)}}var t,i,n={};t=this,null!=t&&(i=t.async),n.noConflict=function(){return t.async=i,n};var r=function(e,t){if(e.forEach)return e.forEach(t);for(var i=0;e.length>i;i+=1)t(e[i],i,e)},s=function(e,t){if(e.map)return e.map(t);var i=[];return r(e,function(e,n,r){i.push(t(e,n,r))}),i},o=function(e,t,i){return e.reduce?e.reduce(t,i):(r(e,function(e,n,r){i=t(i,e,n,r)}),i)},a=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t};"undefined"!=typeof process&&process.nextTick?(n.nextTick=process.nextTick,n.setImmediate="undefined"!=typeof setImmediate?setImmediate:n.nextTick):"function"==typeof setImmediate?(n.nextTick=function(e){setImmediate(e)},n.setImmediate=n.nextTick):(n.nextTick=function(e){setTimeout(e,0)},n.setImmediate=n.nextTick),n.each=function(t,i,n){if(n=n||function(){},!t.length)return n();var s=0;r(t,function(r){i(r,e(function(e){e?(n(e),n=function(){}):(s+=1,s>=t.length&&n(null))}))})},n.forEach=n.each,n.eachSeries=function(e,t,i){if(i=i||function(){},!e.length)return i();var n=0,r=function(){t(e[n],function(t){t?(i(t),i=function(){}):(n+=1,n>=e.length?i(null):r())})};r()},n.forEachSeries=n.eachSeries,n.eachLimit=function(e,t,i,n){var r=l(t);r.apply(null,[e,i,n])},n.forEachLimit=n.eachLimit;var l=function(e){return function(t,i,n){if(n=n||function(){},!t.length||0>=e)return n();var r=0,s=0,o=0;(function a(){if(r>=t.length)return n();for(;e>o&&t.length>s;)s+=1,o+=1,i(t[s-1],function(e){e?(n(e),n=function(){}):(r+=1,o-=1,r>=t.length?n():a())})})()}},u=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.each].concat(t))}},h=function(e,t){return function(){var i=Array.prototype.slice.call(arguments);
return t.apply(null,[l(e)].concat(i))}},c=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[n.eachSeries].concat(t))}},p=function(e,t,i,n){var r=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){i(e.value,function(i,n){r[e.index]=n,t(i)})},function(e){n(e,r)})};n.map=u(p),n.mapSeries=c(p),n.mapLimit=function(e,t,i,n){return d(t)(e,i,n)};var d=function(e){return h(e,p)};n.reduce=function(e,t,i,r){n.eachSeries(e,function(e,n){i(t,e,function(e,i){t=i,n(e)})},function(e){r(e,t)})},n.inject=n.reduce,n.foldl=n.reduce,n.reduceRight=function(e,t,i,r){var o=s(e,function(e){return e}).reverse();n.reduce(o,t,i,r)},n.foldr=n.reduceRight;var f=function(e,t,i,n){var r=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){i(e.value,function(i){i&&r.push(e),t()})},function(){n(s(r.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.filter=u(f),n.filterSeries=c(f),n.select=n.filter,n.selectSeries=n.filterSeries;var m=function(e,t,i,n){var r=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){i(e.value,function(i){i||r.push(e),t()})},function(){n(s(r.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};n.reject=u(m),n.rejectSeries=c(m);var g=function(e,t,i,n){e(t,function(e,t){i(e,function(i){i?(n(e),n=function(){}):t()})},function(){n()})};n.detect=u(g),n.detectSeries=c(g),n.some=function(e,t,i){n.each(e,function(e,n){t(e,function(e){e&&(i(!0),i=function(){}),n()})},function(){i(!1)})},n.any=n.some,n.every=function(e,t,i){n.each(e,function(e,n){t(e,function(e){e||(i(!1),i=function(){}),n()})},function(){i(!0)})},n.all=n.every,n.sortBy=function(e,t,i){n.map(e,function(e,i){t(e,function(t,n){t?i(t):i(null,{value:e,criteria:n})})},function(e,t){if(e)return i(e);var n=function(e,t){var i=e.criteria,n=t.criteria;return n>i?-1:i>n?1:0};i(null,s(t.sort(n),function(e){return e.value}))})},n.auto=function(e,t){t=t||function(){};var i=a(e);if(!i.length)return t(null);var s={},l=[],u=function(e){l.unshift(e)},h=function(e){for(var t=0;l.length>t;t+=1)if(l[t]===e)return l.splice(t,1),void 0},c=function(){r(l.slice(0),function(e){e()})};u(function(){a(s).length===i.length&&(t(null,s),t=function(){})}),r(i,function(i){var l=e[i]instanceof Function?[e[i]]:e[i],p=function(e){var o=Array.prototype.slice.call(arguments,1);if(1>=o.length&&(o=o[0]),e){var l={};r(a(s),function(e){l[e]=s[e]}),l[i]=o,t(e,l),t=function(){}}else s[i]=o,n.setImmediate(c)},d=l.slice(0,Math.abs(l.length-1))||[],f=function(){return o(d,function(e,t){return e&&s.hasOwnProperty(t)},!0)&&!s.hasOwnProperty(i)};if(f())l[l.length-1](p,s);else{var m=function(){f()&&(h(m),l[l.length-1](p,s))};u(m)}})},n.waterfall=function(e,t){if(t=t||function(){},e.constructor!==Array){var i=Error("First argument to waterfall must be an array of functions");return t(i)}if(!e.length)return t();var r=function(e){return function(i){if(i)t.apply(null,arguments),t=function(){};else{var s=Array.prototype.slice.call(arguments,1),o=e.next();o?s.push(r(o)):s.push(t),n.setImmediate(function(){e.apply(null,s)})}}};r(n.iterator(e))()};var y=function(e,t,i){if(i=i||function(){},t.constructor===Array)e.map(t,function(e,t){e&&e(function(e){var i=Array.prototype.slice.call(arguments,1);1>=i.length&&(i=i[0]),t.call(null,e,i)})},i);else{var n={};e.each(a(t),function(e,i){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);1>=r.length&&(r=r[0]),n[e]=r,i(t)})},function(e){i(e,n)})}};n.parallel=function(e,t){y({map:n.map,each:n.each},e,t)},n.parallelLimit=function(e,t,i){y({map:d(t),each:l(t)},e,i)},n.series=function(e,t){if(t=t||function(){},e.constructor===Array)n.mapSeries(e,function(e,t){e&&e(function(e){var i=Array.prototype.slice.call(arguments,1);1>=i.length&&(i=i[0]),t.call(null,e,i)})},t);else{var i={};n.eachSeries(a(e),function(t,n){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);1>=r.length&&(r=r[0]),i[t]=r,n(e)})},function(e){t(e,i)})}},n.iterator=function(e){var t=function(i){var n=function(){return e.length&&e[i].apply(null,arguments),n.next()};return n.next=function(){return e.length-1>i?t(i+1):null},n};return t(0)},n.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var v=function(e,t,i,n){var r=[];e(t,function(e,t){i(e,function(e,i){r=r.concat(i||[]),t(e)})},function(e){n(e,r)})};n.concat=u(v),n.concatSeries=c(v),n.whilst=function(e,t,i){e()?t(function(r){return r?i(r):(n.whilst(e,t,i),void 0)}):i()},n.doWhilst=function(e,t,i){e(function(r){return r?i(r):(t()?n.doWhilst(e,t,i):i(),void 0)})},n.until=function(e,t,i){e()?i():t(function(r){return r?i(r):(n.until(e,t,i),void 0)})},n.doUntil=function(e,t,i){e(function(r){return r?i(r):(t()?i():n.doUntil(e,t,i),void 0)})},n.queue=function(t,i){function s(e,t,s,o){t.constructor!==Array&&(t=[t]),r(t,function(t){var r={data:t,callback:"function"==typeof o?o:null};s?e.tasks.unshift(r):e.tasks.push(r),e.saturated&&e.tasks.length===i&&e.saturated(),n.setImmediate(e.process)})}void 0===i&&(i=1);var o=0,a={tasks:[],concurrency:i,saturated:null,empty:null,drain:null,push:function(e,t){s(a,e,!1,t)},unshift:function(e,t){s(a,e,!0,t)},process:function(){if(a.concurrency>o&&a.tasks.length){var i=a.tasks.shift();a.empty&&0===a.tasks.length&&a.empty(),o+=1;var n=function(){o-=1,i.callback&&i.callback.apply(i,arguments),a.drain&&0===a.tasks.length+o&&a.drain(),a.process()},r=e(n);t(i.data,r)}},length:function(){return a.tasks.length},running:function(){return o}};return a},n.cargo=function(e,t){var i=!1,o=[],a={tasks:o,payload:t,saturated:null,empty:null,drain:null,push:function(e,i){e.constructor!==Array&&(e=[e]),r(e,function(e){o.push({data:e,callback:"function"==typeof i?i:null}),a.saturated&&o.length===t&&a.saturated()}),n.setImmediate(a.process)},process:function l(){if(!i){if(0===o.length)return a.drain&&a.drain(),void 0;var n="number"==typeof t?o.splice(0,t):o.splice(0),u=s(n,function(e){return e.data});a.empty&&a.empty(),i=!0,e(u,function(){i=!1;var e=arguments;r(n,function(t){t.callback&&t.callback.apply(null,e)}),l()})}},length:function(){return o.length},running:function(){return i}};return a};var b=function(e){return function(t){var i=Array.prototype.slice.call(arguments,1);t.apply(null,i.concat([function(t){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&r(i,function(t){console[e](t)}))}]))}};n.log=b("log"),n.dir=b("dir"),n.memoize=function(e,t){var i={},n={};t=t||function(e){return e};var r=function(){var r=Array.prototype.slice.call(arguments),s=r.pop(),o=t.apply(null,r);o in i?s.apply(null,i[o]):o in n?n[o].push(s):(n[o]=[s],e.apply(null,r.concat([function(){i[o]=arguments;var e=n[o];delete n[o];for(var t=0,r=e.length;r>t;t++)e[t].apply(null,arguments)}])))};return r.memo=i,r.unmemoized=e,r},n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},n.times=function(e,t,i){for(var r=[],s=0;e>s;s++)r.push(s);return n.map(r,t,i)},n.timesSeries=function(e,t,i){for(var r=[],s=0;e>s;s++)r.push(s);return n.mapSeries(r,t,i)},n.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var t=this,i=Array.prototype.slice.call(arguments),r=i.pop();n.reduce(e,i,function(e,i,n){i.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))},function(e,i){r.apply(t,[e].concat(i))})}};var _=function(e,t){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),r=n.pop();return e(t,function(e,t){e.apply(i,n.concat([t]))},r)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};n.applyEach=u(_),n.applyEachSeries=c(_),n.forever=function(e,t){function i(n){if(n){if(t)return t(n);throw n}e(i)}i()},"undefined"!=typeof define&&define.amd?define([],function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:t.async=n}(),function(){var e=this,t=e._,i={},n=Array.prototype,r=Object.prototype,s=Function.prototype,o=n.push,a=n.slice,l=n.concat,u=r.toString,h=r.hasOwnProperty,c=n.forEach,p=n.map,d=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,y=n.some,v=n.indexOf,b=n.lastIndexOf,_=Array.isArray,w=Object.keys,x=s.bind,L=function(e){return e instanceof L?e:this instanceof L?(this._wrapped=e,void 0):new L(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=L),exports._=L):e._=L,L.VERSION="1.4.3";var O=L.each=L.forEach=function(e,t,n){if(null!=e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,s=e.length;s>r;r++)if(t.call(n,e[r],r,e)===i)return}else for(var o in e)if(L.has(e,o)&&t.call(n,e[o],o,e)===i)return};L.map=L.collect=function(e,t,i){var n=[];return null==e?n:p&&e.map===p?e.map(t,i):(O(e,function(e,r,s){n[n.length]=t.call(i,e,r,s)}),n)};var C="Reduce of empty array with no initial value";L.reduce=L.foldl=L.inject=function(e,t,i,n){var r=arguments.length>2;if(null==e&&(e=[]),d&&e.reduce===d)return n&&(t=L.bind(t,n)),r?e.reduce(t,i):e.reduce(t);if(O(e,function(e,s,o){r?i=t.call(n,i,e,s,o):(i=e,r=!0)}),!r)throw new TypeError(C);return i},L.reduceRight=L.foldr=function(e,t,i,n){var r=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=L.bind(t,n)),r?e.reduceRight(t,i):e.reduceRight(t);var s=e.length;if(s!==+s){var o=L.keys(e);s=o.length}if(O(e,function(a,l,u){l=o?o[--s]:--s,r?i=t.call(n,i,e[l],l,u):(i=e[l],r=!0)}),!r)throw new TypeError(C);return i},L.find=L.detect=function(e,t,i){var n;return E(e,function(e,r,s){return t.call(i,e,r,s)?(n=e,!0):void 0}),n},L.filter=L.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(O(e,function(e,r,s){t.call(i,e,r,s)&&(n[n.length]=e)}),n)},L.reject=function(e,t,i){return L.filter(e,function(e,n,r){return!t.call(i,e,n,r)},i)},L.every=L.all=function(e,t,n){t||(t=L.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,n):(O(e,function(e,s,o){return(r=r&&t.call(n,e,s,o))?void 0:i}),!!r)};var E=L.some=L.any=function(e,t,n){t||(t=L.identity);var r=!1;return null==e?r:y&&e.some===y?e.some(t,n):(O(e,function(e,s,o){return r||(r=t.call(n,e,s,o))?i:void 0}),!!r)};L.contains=L.include=function(e,t){return null==e?!1:v&&e.indexOf===v?-1!=e.indexOf(t):E(e,function(e){return e===t})},L.invoke=function(e,t){var i=a.call(arguments,2);return L.map(e,function(e){return(L.isFunction(t)?t:e[t]).apply(e,i)})},L.pluck=function(e,t){return L.map(e,function(e){return e[t]})},L.where=function(e,t){return L.isEmpty(t)?[]:L.filter(e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},L.max=function(e,t,i){if(!t&&L.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&L.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return O(e,function(e,r,s){var o=t?t.call(i,e,r,s):e;o>=n.computed&&(n={value:e,computed:o})}),n.value},L.min=function(e,t,i){if(!t&&L.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&L.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return O(e,function(e,r,s){var o=t?t.call(i,e,r,s):e;n.computed>o&&(n={value:e,computed:o})}),n.value},L.shuffle=function(e){var t,i=0,n=[];return O(e,function(e){t=L.random(i++),n[i-1]=n[t],n[t]=e}),n};var S=function(e){return L.isFunction(e)?e:function(t){return t[e]}};L.sortBy=function(e,t,i){var n=S(t);return L.pluck(L.map(e,function(e,t,r){return{value:e,index:t,criteria:n.call(i,e,t,r)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var k=function(e,t,i,n){var r={},s=S(t||L.identity);return O(e,function(t,o){var a=s.call(i,t,o,e);n(r,a,t)}),r};L.groupBy=function(e,t,i){return k(e,t,i,function(e,t,i){(L.has(e,t)?e[t]:e[t]=[]).push(i)})},L.countBy=function(e,t,i){return k(e,t,i,function(e,t){L.has(e,t)||(e[t]=0),e[t]++})},L.sortedIndex=function(e,t,i,n){i=null==i?L.identity:S(i);for(var r=i.call(n,t),s=0,o=e.length;o>s;){var a=s+o>>>1;r>i.call(n,e[a])?s=a+1:o=a}return s},L.toArray=function(e){return e?L.isArray(e)?a.call(e):e.length===+e.length?L.map(e,L.identity):L.values(e):[]},L.size=function(e){return null==e?0:e.length===+e.length?e.length:L.keys(e).length},L.first=L.head=L.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:a.call(e,0,t)},L.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},L.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},L.rest=L.tail=L.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},L.compact=function(e){return L.filter(e,L.identity)};var T=function(e,t,i){return O(e,function(e){L.isArray(e)?t?o.apply(i,e):T(e,t,i):i.push(e)}),i};L.flatten=function(e,t){return T(e,t,[])},L.without=function(e){return L.difference(e,a.call(arguments,1))},L.uniq=L.unique=function(e,t,i,n){L.isFunction(t)&&(n=i,i=t,t=!1);var r=i?L.map(e,i,n):e,s=[],o=[];return O(r,function(i,n){(t?n&&o[o.length-1]===i:L.contains(o,i))||(o.push(i),s.push(e[n]))}),s},L.union=function(){return L.uniq(l.apply(n,arguments))},L.intersection=function(e){var t=a.call(arguments,1);return L.filter(L.uniq(e),function(e){return L.every(t,function(t){return L.indexOf(t,e)>=0})})},L.difference=function(e){var t=l.apply(n,a.call(arguments,1));return L.filter(e,function(e){return!L.contains(t,e)})},L.zip=function(){for(var e=a.call(arguments),t=L.max(L.pluck(e,"length")),i=Array(t),n=0;t>n;n++)i[n]=L.pluck(e,""+n);return i},L.object=function(e,t){if(null==e)return{};for(var i={},n=0,r=e.length;r>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},L.indexOf=function(e,t,i){if(null==e)return-1;var n=0,r=e.length;if(i){if("number"!=typeof i)return n=L.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,r+i):i}if(v&&e.indexOf===v)return e.indexOf(t,i);for(;r>n;n++)if(e[n]===t)return n;return-1},L.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var r=n?i:e.length;r--;)if(e[r]===t)return r;return-1},L.range=function(e,t,i){1>=arguments.length&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),r=0,s=Array(n);n>r;)s[r++]=e,e+=i;return s};var P=function(){};L.bind=function(e,t){var i,n;if(e.bind===x&&x)return x.apply(e,a.call(arguments,1));if(!L.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));P.prototype=e.prototype;var r=new P;P.prototype=null;var s=e.apply(r,i.concat(a.call(arguments)));return Object(s)===s?s:r}},L.bindAll=function(e){var t=a.call(arguments,1);return 0==t.length&&(t=L.functions(e)),O(t,function(t){e[t]=L.bind(e[t],e)}),e},L.memoize=function(e,t){var i={};return t||(t=L.identity),function(){var n=t.apply(this,arguments);return L.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},L.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},L.defer=function(e){return L.delay.apply(L,[e,1].concat(a.call(arguments,1)))},L.throttle=function(e,t){var i,n,r,s,o=0,a=function(){o=new Date,r=null,s=e.apply(i,n)};return function(){var l=new Date,u=t-(l-o);return i=this,n=arguments,0>=u?(clearTimeout(r),r=null,o=l,s=e.apply(i,n)):r||(r=setTimeout(a,u)),s}},L.debounce=function(e,t,i){var n,r;return function(){var s=this,o=arguments,a=function(){n=null,i||(r=e.apply(s,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(a,t),l&&(r=e.apply(s,o)),r}},L.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},L.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},L.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},L.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},L.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)L.has(e,i)&&(t[t.length]=i);return t},L.values=function(e){var t=[];for(var i in e)L.has(e,i)&&t.push(e[i]);return t},L.pairs=function(e){var t=[];for(var i in e)L.has(e,i)&&t.push([i,e[i]]);return t},L.invert=function(e){var t={};for(var i in e)L.has(e,i)&&(t[e[i]]=i);return t},L.functions=L.methods=function(e){var t=[];for(var i in e)L.isFunction(e[i])&&t.push(i);return t.sort()},L.extend=function(e){return O(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},L.pick=function(e){var t={},i=l.apply(n,a.call(arguments,1));return O(i,function(i){i in e&&(t[i]=e[i])}),t},L.omit=function(e){var t={},i=l.apply(n,a.call(arguments,1));for(var r in e)L.contains(i,r)||(t[r]=e[r]);return t},L.defaults=function(e){return O(a.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},L.clone=function(e){return L.isObject(e)?L.isArray(e)?e.slice():L.extend({},e):e},L.tap=function(e,t){return t(e),e};var q=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof L&&(e=e._wrapped),t instanceof L&&(t=t._wrapped);var r=u.call(e);if(r!=u.call(t))return!1;switch(r){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=i.length;s--;)if(i[s]==e)return n[s]==t;i.push(e),n.push(t);var o=0,a=!0;if("[object Array]"==r){if(o=e.length,a=o==t.length)for(;o--&&(a=q(e[o],t[o],i,n)););}else{var l=e.constructor,h=t.constructor;if(l!==h&&!(L.isFunction(l)&&l instanceof l&&L.isFunction(h)&&h instanceof h))return!1;for(var c in e)if(L.has(e,c)&&(o++,!(a=L.has(t,c)&&q(e[c],t[c],i,n))))break;if(a){for(c in t)if(L.has(t,c)&&!o--)break;a=!o}}return i.pop(),n.pop(),a};L.isEqual=function(e,t){return q(e,t,[],[])},L.isEmpty=function(e){if(null==e)return!0;if(L.isArray(e)||L.isString(e))return 0===e.length;for(var t in e)if(L.has(e,t))return!1;return!0},L.isElement=function(e){return!(!e||1!==e.nodeType)},L.isArray=_||function(e){return"[object Array]"==u.call(e)},L.isObject=function(e){return e===Object(e)},O(["Arguments","Function","String","Number","Date","RegExp"],function(e){L["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),L.isArguments(arguments)||(L.isArguments=function(e){return!(!e||!L.has(e,"callee"))}),L.isFunction=function(e){return"function"==typeof e},L.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},L.isNaN=function(e){return L.isNumber(e)&&e!=+e},L.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},L.isNull=function(e){return null===e},L.isUndefined=function(e){return void 0===e},L.has=function(e,t){return h.call(e,t)},L.noConflict=function(){return e._=t,this},L.identity=function(e){return e},L.times=function(e,t,i){for(var n=Array(e),r=0;e>r;r++)n[r]=t.call(i,r);return n},L.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=L.invert(N.escape);var F={escape:RegExp("["+L.keys(N.escape).join("")+"]","g"),unescape:RegExp("("+L.keys(N.unescape).join("|")+")","g")};L.each(["escape","unescape"],function(e){L[e]=function(t){return null==t?"":(""+t).replace(F[e],function(t){return N[e][t]})}}),L.result=function(e,t){if(null==e)return null;var i=e[t];return L.isFunction(i)?i.call(e):i},L.mixin=function(e){O(L.functions(e),function(t){var i=L[t]=e[t];L.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),R.call(this,i.apply(L,e))}})};var I=0;L.uniqueId=function(e){var t=""+ ++I;return e?e+t:t},L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;L.template=function(e,t,i){i=L.defaults({},i,L.templateSettings);var n=RegExp([(i.escape||A).source,(i.interpolate||A).source,(i.evaluate||A).source].join("|")+"|$","g"),r=0,s="__p+='";e.replace(n,function(t,i,n,o,a){return s+=e.slice(r,a).replace(M,function(e){return"\\"+D[e]}),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+t.length,t}),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=Function(i.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(t)return o(t,L);var l=function(e){return o.call(this,e,L)};return l.source="function("+(i.variable||"obj")+"){\n"+s+"}",l},L.chain=function(e){return L(e).chain()};var R=function(e){return this._chain?L(e).chain():e};L.mixin(L),O(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];L.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],R.call(this,i)}}),O(["concat","join","slice"],function(e){var t=n[e];L.prototype[e]=function(){return R.call(this,t.apply(this._wrapped,arguments))}}),L.extend(L.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var e=this,t=e.Backbone,i=[];i.push;var n=i.slice;i.splice;var r;r="undefined"!=typeof exports?exports:e.Backbone={},r.VERSION="1.1.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),r.$=e.jQuery||e.Zepto||e.ender||e.$,r.noConflict=function(){return e.Backbone=t,this},r.emulateHTTP=!1,r.emulateJSON=!1;var o=r.Events={on:function(e,t,i){if(!l(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!l(this,"once",e,[t,i])||!t)return this;var n=this,r=s.once(function(){n.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var n,r,o,a,u,h,c,p;if(!this._events||!l(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:s.keys(this._events),u=0,h=a.length;h>u;u++)if(e=a[u],o=this._events[e]){if(this._events[e]=n=[],t||i)for(c=0,p=o.length;p>c;c++)r=o[c],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&n.push(r);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=n.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],r=this._events.all;return i&&u(i,t),r&&u(r,arguments),this},stopListening:function(e,t,i){var n=this._listeningTo;if(!n)return this;var r=!t&&!i;i||"object"!=typeof t||(i=this),e&&((n={})[e._listenId]=e);for(var o in n)e=n[o],e.off(t,i,this),(r||s.isEmpty(e._events))&&delete this._listeningTo[o];return this}},a=/\s+/,l=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)e[t].apply(e,[r,i[r]].concat(n));return!1}if(a.test(i)){for(var s=i.split(a),o=0,l=s.length;l>o;o++)e[t].apply(e,[s[o]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,r=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;r>++n;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;r>++n;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;r>++n;)(i=e[n]).callback.call(i.ctx,s,o);return;case 3:for(;r>++n;)(i=e[n]).callback.call(i.ctx,s,o,a);return;default:for(;r>++n;)(i=e[n]).callback.apply(i.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(e,t){o[t]=function(t,i,n){var r=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=s.uniqueId("l"));return r[o]=t,n||"object"!=typeof i||(n=this),t[e](i,n,this),this}}),o.bind=o.on,o.unbind=o.off,s.extend(r,o);var c=r.Model=function(e,t){var i=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(c.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return r.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,r,o,a,l,u,h,c;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;o=i.unset,l=i.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=s.clone(this.attributes),this.changed={}),c=this.attributes,h=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(n in r)t=r[n],s.isEqual(c[n],t)||a.push(n),s.isEqual(h[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete c[n]:c[n]=t;if(!l){a.length&&(this._pending=!0);for(var p=0,d=a.length;d>p;p++)this.trigger("change:"+a[p],this,c[a[p]],i)}if(u)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var r in e)s.isEqual(n[r],t=e[r])||((i||(i={}))[r]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),t.trigger("sync",t,n,e),void 0):!1},D(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,r,o,a=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=s.extend(n||{},t)),s.isObject(t)&&!l.set(t,i)?!1:(u&&u(l,e,i),l.trigger("sync",l,e,i),void 0)},D(this,i),r=this.isNew()?"create":i.patch?"patch":"update","patch"===r&&(i.attrs=n),o=this.sync(r,this,i),n&&i.wait&&(this.attributes=a),o},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(r){(e.wait||t.isNew())&&n(),i&&i(t,r,e),t.isNew()||t.trigger("sync",t,r,e)},this.isNew())return e.success(),!1;D(this,e);var r=this.sync("delete",this,e);return e.wait||n(),r},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||A();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,s.extend(t,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];s.each(p,function(e){c.prototype[e]=function(){var t=n.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var d=r.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};s.extend(d.prototype,o,{model:c,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return r.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.extend({merge:!1},t,m))},remove:function(e,t){var i=!s.isArray(e);e=i?[e]:s.clone(e),t||(t={});var n,r,o,a;for(n=0,r=e.length;r>n;n++)a=e[n]=this.get(e[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,t.silent||(t.index=o,a.trigger("remove",a,this,t)),this._removeReference(a));return i?e[0]:e},set:function(e,t){t=s.defaults({},t,f),t.parse&&(e=this.parse(e,t));var i=!s.isArray(e);e=i?e?[e]:[]:s.clone(e);var n,r,o,a,l,u,h,p=t.at,d=this.model,m=this.comparator&&null==p&&t.sort!==!1,g=s.isString(this.comparator)?this.comparator:null,y=[],v=[],b={},_=t.add,w=t.merge,x=t.remove,L=!m&&_&&x?[]:!1;for(n=0,r=e.length;r>n;n++){if(l=e[n],o=l instanceof c?a=l:l[d.prototype.idAttribute],u=this.get(o))x&&(b[u.cid]=!0),w&&(l=l===a?a.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),m&&!h&&u.hasChanged(g)&&(h=!0)),e[n]=u;else if(_){if(a=e[n]=this._prepareModel(l,t),!a)continue;y.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}L&&L.push(u||a)}if(x){for(n=0,r=this.length;r>n;++n)b[(a=this.models[n]).cid]||v.push(a);v.length&&this.remove(v,t)}if(y.length||L&&L.length)if(m&&(h=!0),this.length+=y.length,null!=p)for(n=0,r=y.length;r>n;n++)this.models.splice(p+n,0,y[n]);else{L&&(this.models.length=0);var O=L||y;for(n=0,r=O.length;r>n;n++)this.models.push(O[n])}if(h&&this.sort({silent:!0}),!t.silent){for(n=0,r=y.length;r>n;n++)(a=y[n]).trigger("add",a,this,t);(h||L&&L.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,s.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,s.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return n.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},D(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,r){r.wait&&i.add(e,r),n&&n(e,t,r)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof c)return e.collection||(e.collection=this),e;t=t?s.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)
},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(g,function(e){d.prototype[e]=function(){var t=n.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});var y=["groupBy","countBy","sortBy"];s.each(y,function(e){d.prototype[e]=function(t,i){var n=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,n,i)}});var v=r.View=function(e){this.cid=s.uniqueId("view"),e||(e={}),s.extend(this,s.pick(e,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];s.extend(v.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof r.$?e:r.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[e[t]]),i){var n=t.match(b),r=n[1],o=n[2];i=s.bind(i,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,i):this.$el.on(r,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className"));var t=r.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}}}),r.sync=function(e,t,i){var n=x[e];s.defaults(i||(i={}),{emulateHTTP:r.emulateHTTP,emulateJSON:r.emulateJSON});var o={type:n,dataType:"json"};if(i.url||(o.url=s.result(t,"url")||A()),null!=i.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||t.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){o.type="POST",i.emulateJSON&&(o.data._method=n);var a=i.beforeSend;i.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",n),a?a.apply(this,arguments):void 0}}"GET"===o.type||i.emulateJSON||(o.processData=!1),"PATCH"===o.type&&w&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=i.xhr=r.ajax(s.extend(o,i));return t.trigger("request",t,l,i),l};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};r.ajax=function(){return r.$.ajax.apply(r.$,arguments)};var L=r.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},O=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,E=/\*\w+/g,S=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(L.prototype,o,{initialize:function(){},route:function(e,t,i){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(t)&&(i=t,t=""),i||(i=this[t]);var n=this;return r.history.route(e,function(s){var o=n._extractParameters(e,s);i&&i.apply(n,o),n.trigger.apply(n,["route:"+t].concat(o)),n.trigger("route",t,o),r.history.trigger("route",n,t,o)}),this},navigate:function(e,t){return r.history.navigate(e,t),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(S,"\\$&").replace(O,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/]+)"}).replace(E,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return s.map(i,function(e){return e?decodeURIComponent(e):null})}});var k=r.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},T=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,q=/msie [\w.]+/,N=/\/$/,F=/[?#].*$/;k.started=!1,s.extend(k.prototype,o,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(N,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(T,"")},start:function(e){if(k.started)throw Error("Backbone.history has already been started");k.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),i=document.documentMode,n=q.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(P,"/"),n&&this._wantsHashChange&&(this.iframe=r.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?r.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?r.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(T,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){r.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),k.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl(),void 0)},loadUrl:function(e){return e=this.fragment=this.getFragment(e),s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!k.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(F,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),r.history=new k;var I=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};c.extend=d.extend=L.extend=v.extend=k.extend=I;var A=function(){throw Error('A "url" property or function must be specified')},D=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),function(){var e=function(){var e={},t={},i=function(){return function(){}},n=function(e,n){var r={id:e,exports:{}};n(r.exports,i(),r);var s=t[e]=r.exports;return s},r=function(i){if(t.hasOwnProperty(i))return t[i];if(e.hasOwnProperty(i))return n(i,e[i]);throw Error('Cannot find module "'+i+'"')};return r.register=function(t,i){e[t]=i},r}();e.register("chaplin/application",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c,p;p=e("underscore"),s=e("backbone"),c=e("chaplin/mediator"),a=e("chaplin/dispatcher"),u=e("chaplin/views/layout"),o=e("chaplin/composer"),h=e("chaplin/lib/router"),l=e("chaplin/lib/event_broker"),n.exports=r=function(){function e(e){null==e&&(e={}),this.initialize(e)}return e.extend=s.Model.extend,p.extend(e.prototype,l),e.prototype.title="",e.prototype.dispatcher=null,e.prototype.layout=null,e.prototype.router=null,e.prototype.composer=null,e.prototype.started=!1,e.prototype.initialize=function(e){if(null==e&&(e={}),this.started)throw Error("Application#initialize: App was already started");return this.initRouter(e.routes,e),this.initDispatcher(e),this.initLayout(e),this.initComposer(e),this.initMediator(),this.start()},e.prototype.initDispatcher=function(e){return this.dispatcher=new a(e)},e.prototype.initLayout=function(e){var t;return null==e&&(e={}),null==(t=e.title)&&(e.title=this.title),this.layout=new u(e)},e.prototype.initComposer=function(e){return null==e&&(e={}),this.composer=new o(e)},e.prototype.initMediator=function(){return c.seal()},e.prototype.initRouter=function(e,t){return this.router=new h(t),"function"==typeof e?e(this.router.match):void 0},e.prototype.start=function(){return this.router.startHistory(),this.started=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0},e.prototype.disposed=!1,e.prototype.dispose=function(){var e,t,i,n,r;if(!this.disposed){for(e="function"==typeof Object.isFrozen?Object.isFrozen(this):void 0,i=["dispatcher","layout","router","composer"],n=0,r=i.length;r>n;n++)t=i[n],null!=this[t]&&(this[t].dispose(),e||delete this[t]);return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},e}()}),e.register("chaplin/mediator",function(t,i,n){"use strict";var r,s,o,a,l,u,h=[].slice;r=e("backbone"),u=e("underscore"),a=e("chaplin/lib/support"),l=e("chaplin/lib/utils"),o={},o.subscribe=r.Events.on,o.unsubscribe=r.Events.off,o.publish=r.Events.trigger,o._callbacks=null,s=o._handlers={},o.setHandler=function(e,t,i){return s[e]={instance:i,method:t}},o.execute=function(){var e,t,i,n,r;if(n=arguments[0],e=arguments.length>=2?h.call(arguments,1):[],r=!1,"object"==typeof n?(r=n.silent,i=n.name):i=n,t=s[i])return t.method.apply(t.instance,e);if(!r)throw Error("mediator.execute: "+i+" handler is not defined")},o.removeHandlers=function(e){var t,i,n,r;if(e||(o._handlers={}),l.isArray(e))for(n=0,r=e.length;r>n;n++)i=e[n],delete s[i];else for(i in s)t=s[i],t.instance===e&&delete s[i]},l.readonly(o,"subscribe","unsubscribe","publish","setHandler","execute","removeHandlers"),o.seal=function(){return a.propertyDescriptors&&Object.seal?Object.seal(o):void 0},l.readonly(o,"seal"),n.exports=o}),e.register("chaplin/dispatcher",function(t,i,n){"use strict";var r,s,o,a,l,u;u=e("underscore"),r=e("backbone"),a=e("chaplin/mediator"),l=e("chaplin/lib/utils"),o=e("chaplin/lib/event_broker"),n.exports=s=function(){function e(){this.initialize.apply(this,arguments)}return e.extend=r.Model.extend,u.extend(e.prototype,o),e.prototype.previousRoute=null,e.prototype.currentController=null,e.prototype.currentRoute=null,e.prototype.currentParams=null,e.prototype.currentQuery=null,e.prototype.initialize=function(e){return null==e&&(e={}),this.settings=u.defaults(e,{controllerPath:"controllers/",controllerSuffix:"_controller"}),this.subscribeEvent("router:match",this.dispatch)},e.prototype.dispatch=function(e,t,i){var n,r,s=this;return t=t?u.extend({},t):{},i=i?u.extend({},i):{},null==i.query&&(i.query={}),i.changeURL!==!1&&(i.changeURL=!0),i.forceStartup!==!0&&(i.forceStartup=!1),!i.forceStartup&&(null!=(n=this.currentRoute)?n.controller:void 0)===e.controller&&(null!=(r=this.currentRoute)?r.action:void 0)===e.action&&u.isEqual(this.currentParams,t)&&u.isEqual(this.currentQuery,i.query)?void 0:this.loadController(e.controller,function(n){return s.controllerLoaded(e,t,i,n)})},e.prototype.loadController=function(e,t){var i,n;return i=e+this.settings.controllerSuffix,n=this.settings.controllerPath+i,("undefined"!=typeof define&&null!==define?define.amd:void 0)?require([n],t):setTimeout(function(){return t(require(n))},0)},e.prototype.controllerLoaded=function(e,t,i,n){var r;return this.previousRoute=this.currentRoute,this.currentRoute=u.extend({},e,{previous:l.beget(this.previousRoute)}),r=new n(t,this.currentRoute,i),this.executeBeforeAction(r,this.currentRoute,t,i)},e.prototype.executeAction=function(e,t,i,n){return this.currentController&&(this.publishEvent("beforeControllerDispose",this.currentController),this.currentController.dispose(i,t,n)),this.currentController=e,this.currentParams=i,this.currentQuery=n.query,e[t.action](i,t,n),e.redirected?void 0:(this.adjustURL(t,i,n),this.publishEvent("dispatcher:dispatch",this.currentController,i,t,n))},e.prototype.executeBeforeAction=function(e,t,i,n){var r,s,o,a=this;if(r=e.beforeAction,s=function(){return e.redirected||a.currentRoute&&t!==a.currentRoute?(e.dispose(),void 0):a.executeAction(e,t,i,n)},!r)return s(),void 0;if("function"!=typeof r)throw new TypeError("Controller#beforeAction: function expected. Old object-like form is not supported.");return o=e.beforeAction(i,t,n),o&&o.then?o.then(s):s()},e.prototype.adjustURL=function(e,t,i){var n;if(null!=e.path)return n=e.path+(e.query?"?"+e.query:""),i.changeURL?a.execute("router:changeURL",n,i):void 0},e.prototype.disposed=!1,e.prototype.dispose=function(){return this.disposed?void 0:(this.unsubscribeAllEvents(),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0)},e}()}),e.register("chaplin/composer",function(t,i,n){"use strict";var r,s,o,a,l,u,h;h=e("underscore"),r=e("backbone"),l=e("chaplin/mediator"),u=e("chaplin/lib/utils"),o=e("chaplin/lib/composition"),a=e("chaplin/lib/event_broker"),n.exports=s=function(){function e(){this.initialize.apply(this,arguments)}return e.extend=r.Model.extend,h.extend(e.prototype,a),e.prototype.compositions=null,e.prototype.initialize=function(e){return null==e&&(e={}),this.compositions={},l.setHandler("composer:compose",this.compose,this),l.setHandler("composer:retrieve",this.retrieve,this),this.subscribeEvent("dispatcher:dispatch",this.cleanup)},e.prototype.compose=function(e,t,i){return"function"==typeof t?i||t.prototype.dispose?t.prototype instanceof o?this._compose(e,{composition:t,options:i}):this._compose(e,{options:i,compose:function(){var e,i;return this.item=new t(this.options),e=this.item.autoRender,i=void 0===e||!e,i&&"function"==typeof this.item.render?this.item.render():void 0}}):this._compose(e,{compose:t}):"function"==typeof i?this._compose(e,{compose:i,options:t}):this._compose(e,t)},e.prototype._compose=function(e,t){var i,n,r,s;if("function"!=typeof t.compose&&null==t.composition)throw Error("Composer#compose was used incorrectly");return null!=t.composition?i=new t.composition(t.options):(i=new o(t.options),i.compose=t.compose,t.check&&(i.check=t.check)),n=this.compositions[e],r=!1,n&&n.check(i.options)?n.stale(!1):(n&&n.dispose(),s=i.compose(i.options),r="function"==typeof(null!=s?s.then:void 0),i.stale(!1),this.compositions[e]=i),r?s:this.compositions[e].item},e.prototype.retrieve=function(e){var t;return t=this.compositions[e],t&&!t.stale()?t.item:void 0},e.prototype.cleanup=function(){var e,t,i;i=this.compositions;for(t in i)e=i[t],e.stale()?(e.dispose(),delete this.compositions[t]):e.stale(!0)},e.prototype.dispose=function(){var e,t,i;if(!this.disposed){this.unsubscribeAllEvents(),l.removeHandlers(this),i=this.compositions;for(t in i)e=i[t],e.dispose();return delete this.compositions,this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},e}()}),e.register("chaplin/controllers/controller",function(t,i,n){"use strict";var r,s,o,a,l,u,h=[].slice,c={}.hasOwnProperty;u=e("underscore"),r=e("backbone"),o=e("chaplin/lib/event_broker"),l=e("chaplin/lib/utils"),a=e("chaplin/mediator"),n.exports=s=function(){function e(){this.initialize.apply(this,arguments)}return e.extend=r.Model.extend,u.extend(e.prototype,r.Events),u.extend(e.prototype,o),e.prototype.view=null,e.prototype.redirected=!1,e.prototype.initialize=function(){},e.prototype.beforeAction=function(){},e.prototype.adjustTitle=function(e){return a.execute("adjustTitle",e)},e.prototype.compose=function(){var e;return e=1===arguments.length?"retrieve":"compose",a.execute.apply(a,["composer:"+e].concat(h.call(arguments)))},e.prototype.redirectTo=function(e,t,i){return this.redirected=!0,l.redirectTo(e,t,i)},e.prototype.disposed=!1,e.prototype.dispose=function(){var e,t;if(!this.disposed){for(t in this)c.call(this,t)&&(e=this[t],e&&"function"==typeof e.dispose&&(e.dispose(),delete this[t]));return this.unsubscribeAllEvents(),this.stopListening(),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},e}()}),e.register("chaplin/models/collection",function(t,i,n){"use strict";var r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};u=e("underscore"),r=e("backbone"),o=e("chaplin/lib/event_broker"),a=e("chaplin/models/model"),l=e("chaplin/lib/utils"),n.exports=s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),u.extend(t.prototype,o),t.prototype.model=a,t.prototype.serialize=function(){return this.map(l.serialize)},t.prototype.disposed=!1,t.prototype.dispose=function(){var e,t,i,n;if(!this.disposed){for(this.trigger("dispose",this),this.reset([],{silent:!0}),this.unsubscribeAllEvents(),this.stopListening(),this.off(),t=["model","models","_byId","_byCid","_callbacks"],i=0,n=t.length;n>i;i++)e=t[i],delete this[e];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},t}(r.Collection)}),e.register("chaplin/models/model",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c={}.hasOwnProperty,p=function(e,t){function i(){this.constructor=e}for(var n in t)c.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};h=e("underscore"),r=e("backbone"),u=e("chaplin/lib/utils"),s=e("chaplin/lib/event_broker"),a=function(e,t,i){var n,s,o,a,h,c,p,d;n=u.beget(t),null==i&&(i={}),i[e.cid]=!0;for(s in t)if(h=t[s],h instanceof r.Model)n[s]=l(h,e,i);else if(h instanceof r.Collection){for(a=[],d=h.models,c=0,p=d.length;p>c;c++)o=d[c],a.push(l(o,e,i));n[s]=a}return delete i[e.cid],n},l=function(e,t,i){var n;return e===t||e.cid in i?null:(n="function"==typeof e.getAttributes?e.getAttributes():e.attributes,a(e,n,i))},n.exports=o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),h.extend(t.prototype,s),t.prototype.getAttributes=function(){return this.attributes},t.prototype.serialize=function(){return a(this,this.getAttributes())},t.prototype.disposed=!1,t.prototype.dispose=function(){var e,t,i,n;if(!this.disposed){for(this.trigger("dispose",this),this.unsubscribeAllEvents(),this.stopListening(),this.off(),t=["collection","attributes","changed","_escapedAttributes","_previousAttributes","_silent","_pending","_callbacks"],i=0,n=t.length;n>i;i++)e=t[i],delete this[e];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},t}(r.Model)}),e.register("chaplin/views/layout",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c,p=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty,f=function(e,t){function i(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};c=e("underscore"),s=e("backbone"),u=e("chaplin/mediator"),h=e("chaplin/lib/utils"),o=e("chaplin/lib/event_broker"),l=e("chaplin/views/view"),r=s.$,n.exports=a=function(e){function t(e){null==e&&(e={}),this.openLink=p(this.openLink,this),this.globalRegions=[],this.title=e.title,e.regions&&(this.regions=e.regions),this.settings=c.defaults(e,{titleTemplate:function(e){var t;return t=e.subtitle?""+e.subtitle+" – ":"",t+e.title},openExternalToBlank:!1,routeLinks:"a, .go-to",skipRouting:".noscript",scrollTo:[0,0]}),u.setHandler("region:show",this.showRegion,this),u.setHandler("region:register",this.registerRegionHandler,this),u.setHandler("region:unregister",this.unregisterRegionHandler,this),u.setHandler("region:find",this.regionByName,this),u.setHandler("adjustTitle",this.adjustTitle,this),t.__super__.constructor.apply(this,arguments),this.settings.routeLinks&&this.startLinkRouting()}return f(t,e),t.prototype.el="body",t.prototype.keepElement=!0,t.prototype.title="",t.prototype.globalRegions=null,t.prototype.listen={"beforeControllerDispose mediator":"scroll"},t.prototype.scroll=function(){var e;return e=this.settings.scrollTo,e?window.scrollTo(e[0],e[1]):void 0},t.prototype.adjustTitle=function(e){var t,i=this;return null==e&&(e=""),t=this.settings.titleTemplate({title:this.title,subtitle:e}),setTimeout(function(){return document.title=t,i.publishEvent("adjustTitle",e,t)},50),t},t.prototype.startLinkRouting=function(){var e;return(e=this.settings.routeLinks)?r?this.$el.on("click",e,this.openLink):this.delegate("click",e,this.openLink):void 0},t.prototype.stopLinkRouting=function(){var e;return e=this.settings.routeLinks,r?e?this.$el.off("click",e):void 0:this.undelegate("click",e,this.openLink)},t.prototype.isExternalLink=function(e){var t,i;return"_blank"===e.target||"external"===e.rel||"http:"!==(t=e.protocol)&&"https:"!==t&&"file:"!==t||(i=e.hostname)!==location.hostname&&""!==i},t.prototype.openLink=function(e){var t,i,n,o,a,l;if(!(h.modifierKeyPressed(e)||(t=r?e.currentTarget:e.delegateTarget,o="A"===t.nodeName,n=t.getAttribute("href")||t.getAttribute("data-href")||null,null==n||""===n||"#"===n.charAt(0)||(a=this.settings.skipRouting,l=typeof a,"function"===l&&!a(n,t)||"string"===l&&(r?r(t).is(a):s.utils.matchesSelector(t,a)))))){if(i=o&&this.isExternalLink(t))return this.settings.openExternalToBlank&&(e.preventDefault(),window.open(n)),void 0;h.redirectTo({url:n}),e.preventDefault()}},t.prototype.registerRegionHandler=function(e,t,i){return null!=t?this.registerGlobalRegion(e,t,i):this.registerGlobalRegions(e)},t.prototype.registerGlobalRegion=function(e,t,i){return this.unregisterGlobalRegion(e,t),this.globalRegions.unshift({instance:e,name:t,selector:i})},t.prototype.registerGlobalRegions=function(e){var t,i,n,r,s,o;for(o=h.getAllPropertyVersions(e,"regions"),r=0,s=o.length;s>r;r++){n=o[r];for(t in n)i=n[t],this.registerGlobalRegion(e,t,i)}},t.prototype.unregisterRegionHandler=function(e,t){return null!=t?this.unregisterGlobalRegion(e,t):this.unregisterGlobalRegions(e)},t.prototype.unregisterGlobalRegion=function(e,t){var i,n;return i=e.cid,this.globalRegions=function(){var e,r,s,o;for(s=this.globalRegions,o=[],e=0,r=s.length;r>e;e++)n=s[e],(n.instance.cid!==i||n.name!==t)&&o.push(n);return o}.call(this)},t.prototype.unregisterGlobalRegions=function(e){var t;return this.globalRegions=function(){var i,n,r,s;for(r=this.globalRegions,s=[],i=0,n=r.length;n>i;i++)t=r[i],t.instance.cid!==e.cid&&s.push(t);return s}.call(this)},t.prototype.regionByName=function(e){var t,i,n,r;for(r=this.globalRegions,i=0,n=r.length;n>i;i++)if(t=r[i],t.name===e&&!t.instance.stale)return t},t.prototype.showRegion=function(e,t){var i;if(i=this.regionByName(e),!i)throw Error("No region registered under "+e);return t.container=""===i.selector?r?i.instance.$el:i.instance.el:i.instance.noWrap?r?r(i.instance.container).find(i.selector):i.instance.container.querySelector(i.selector):i.instance[r?"$":"find"](i.selector)},t.prototype.dispose=function(){var e,i,n,r;if(!this.disposed){for(this.stopLinkRouting(),r=["globalRegions","title","route"],i=0,n=r.length;n>i;i++)e=r[i],delete this[e];return u.removeHandlers(this),t.__super__.dispose.apply(this,arguments)}},t}(l)}),e.register("chaplin/views/view",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c,p,d,f={}.hasOwnProperty,m=function(e,t){function i(){this.constructor=e}for(var n in t)f.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},g=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};d=e("underscore"),s=e("backbone"),h=e("chaplin/mediator"),o=e("chaplin/lib/event_broker"),p=e("chaplin/lib/utils"),r=s.$,u=function(){return Function.prototype.bind?function(e,t){return e.bind(t)}:d.bind?d.bind:void 0}(),c=function(){return r?function(e,t){return e.html(t)}:function(e,t){return e.innerHTML=t}}(),l=function(){return r?function(e){var t;return t=r(e.container),"function"==typeof e.containerMethod?e.containerMethod(t,e.el):t[e.containerMethod](e.el)}:function(e){var t;return t="string"==typeof e.container?document.querySelector(e.container):e.container,"function"==typeof e.containerMethod?e.containerMethod(t,e.el):t[e.containerMethod](e.el)}}(),n.exports=a=function(e){function t(e){var i,n,s,o,a=this;if(e)for(i in e)n=e[i],g.call(this.optionNames,i)>=0&&(this[i]=n);o=this.render,this.render=function(){return a.disposed?!1:(o.apply(a,arguments),a.autoAttach&&a.attach.apply(a,arguments),a)},this.subviews=[],this.subviewsByName={},this.noWrap&&(this.region&&(s=h.execute("region:find",this.region),null!=s&&(this.el=null!=s.instance.container?null!=s.instance.region?r(s.instance.container).find(s.selector):s.instance.container:s.instance.$(s.selector))),this.container&&(this.el=this.container)),t.__super__.constructor.apply(this,arguments),this.delegateListeners(),this.model&&this.listenTo(this.model,"dispose",this.dispose),this.collection&&this.listenTo(this.collection,"dispose",function(e){return e&&e!==a.collection?void 0:a.dispose()}),null!=this.regions&&h.execute("region:register",this),this.autoRender&&this.render()}return m(t,e),d.extend(t.prototype,o),t.prototype.autoRender=!1,t.prototype.autoAttach=!0,t.prototype.container=null,t.prototype.containerMethod=r?"append":"appendChild",t.prototype.regions=null,t.prototype.region=null,t.prototype.stale=!1,t.prototype.noWrap=!1,t.prototype.keepElement=!1,t.prototype.subviews=null,t.prototype.subviewsByName=null,t.prototype.optionNames=["autoAttach","autoRender","container","containerMethod","region","regions","noWrap"],t.prototype.delegate=function(e,t,i){var n,r,o,a,l,h;if(s.utils)return s.utils.delegate(this,e,t,i);if("string"!=typeof e)throw new TypeError("View#delegate: first argument must be a string");if(2===arguments.length)a=t;else{if(3!==arguments.length)throw new TypeError("View#delegate: only two or three arguments are allowed");if(h=t,"string"!=typeof h)throw new TypeError("View#delegate: second argument must be a string");a=i}if("function"!=typeof a)throw new TypeError("View#delegate: handler argument must be function");return l=function(){var t,i,n,s;for(n=e.split(" "),s=[],t=0,i=n.length;i>t;t++)r=n[t],s.push(""+r+".delegate"+this.cid);return s}.call(this),o=l.join(" "),n=u(a,this),this.$el.on(o,h||null,n),n},t.prototype._delegateEvents=function(e){var t,i,n,r,o,a,l;if(2===s.View.prototype.delegateEvents.length)return s.View.prototype.delegateEvents.call(this,e,!0);for(r in e){if(l=e[r],n="function"==typeof l?l:this[l],!n)throw Error("Method '"+n+"' does not exist");o=r.match(/^(\S+)\s*(.*)$/),i=""+o[1]+".delegateEvents"+this.cid,a=o[2],t=u(n,this),this.$el.on(i,a||null,t)}},t.prototype.delegateEvents=function(e,t){var i,n,r,s;if(t||this.undelegateEvents(),e)return this._delegateEvents(e);for(s=p.getAllPropertyVersions(this,"events"),n=0,r=s.length;r>n;n++){if(i=s[n],"function"==typeof i)throw new TypeError("View#delegateEvents: functions are not supported");this._delegateEvents(i)}},t.prototype.undelegate=function(e,t,i){var n,r,o,a,l;if(s.utils)return s.utils.undelegate(this,e,t,i);if(e){if("string"!=typeof e)throw new TypeError("View#undelegate: first argument must be a string");if(2===arguments.length)"string"==typeof t?l=t:o=t;else if(3===arguments.length){if(l=t,"string"!=typeof l)throw new TypeError("View#undelegate: second argument must be a string");o=i}return a=function(){var t,i,r,s;for(r=e.split(" "),s=[],t=0,i=r.length;i>t;t++)n=r[t],s.push(""+n+".delegate"+this.cid);return s}.call(this),r=a.join(" "),this.$el.off(r,l||null)}return this.$el.off(".delegate"+this.cid)},t.prototype.delegateListeners=function(){var e,t,i,n,r,s,o,a,l;if(this.listen)for(a=p.getAllPropertyVersions(this,"listen"),s=0,o=a.length;o>s;s++){r=a[s];for(t in r){if(i=r[t],"function"!=typeof i&&(i=this[i]),"function"!=typeof i)throw Error("View#delegateListeners: "+(""+i+" must be function"));l=t.split(" "),e=l[0],n=l[1],this.delegateListener(e,n,i)}}},t.prototype.delegateListener=function(e,t,i){var n;"model"===t||"collection"===t?(n=this[t],n&&this.listenTo(n,e,i)):"mediator"===t?this.subscribeEvent(e,i):t||this.on(e,i,this)},t.prototype.registerRegion=function(e,t){return h.execute("region:register",this,e,t)},t.prototype.unregisterRegion=function(e){return h.execute("region:unregister",this,e)},t.prototype.unregisterAllRegions=function(){return h.execute({name:"region:unregister",silent:!0},this)},t.prototype.subview=function(e,t){var i,n;return n=this.subviews,i=this.subviewsByName,e&&t?(this.removeSubview(e),n.push(t),i[e]=t,t):e?i[e]:void 0},t.prototype.removeSubview=function(e){var t,i,n,r,s,o,a;if(e){if(o=this.subviews,t=this.subviewsByName,"string"==typeof e)n=e,a=t[n];else{a=e;for(r in t)if(s=t[r],s===a){n=r;break}}if(n&&a&&a.dispose)return a.dispose(),i=p.indexOf(o,a),-1!==i&&o.splice(i,1),delete t[n]}},t.prototype.getTemplateData=function(){var e,t;return e=this.model?p.serialize(this.model):this.collection?{items:p.serialize(this.collection),length:this.collection.length}:{},t=this.model||this.collection,t&&("function"!=typeof t.isSynced||"synced"in e||(e.synced=t.isSynced())),e},t.prototype.getTemplateFunction=function(){throw Error("View#getTemplateFunction must be overridden")},t.prototype.render=function(){var e,t,i;if(this.disposed)return!1;if(i=this.getTemplateFunction(),"function"==typeof i)if(t=i(this.getTemplateData()),this.noWrap){if(e=document.createElement("div"),e.innerHTML=t,e.children.length>1)throw Error("There must be a single top-level element when using `noWrap`.");this.undelegateEvents(),this.setElement(e.firstChild,!0)}else c(r?this.$el:this.el,t);return this},t.prototype.attach=function(){return null!=this.region&&h.execute("region:show",this.region,this),this.container&&!document.body.contains(this.el)?(l(this),this.trigger("addedToDOM")):void 0},t.prototype.disposed=!1,t.prototype.dispose=function(){var e,t,i,n,r,s,o,a;if(!this.disposed){for(this.unregisterAllRegions(),a=this.subviews,n=0,s=a.length;s>n;n++)i=a[n],i.dispose();for(this.unsubscribeAllEvents(),this.off(),this.keepElement?(this.undelegateEvents(),this.undelegate(),this.stopListening()):this.remove(),t=["el","$el","options","model","collection","subviews","subviewsByName","_callbacks"],r=0,o=t.length;o>r;r++)e=t[r],delete this[e];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},t}(s.View)}),e.register("chaplin/views/collection_view",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c,p,d,f,m,g=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty,v=function(e,t){function i(){this.constructor=e}for(var n in t)y.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};m=e("underscore"),s=e("backbone"),a=e("chaplin/views/view"),f=e("chaplin/lib/utils"),r=s.$,h=function(e,t){var i,n,r,o;
if(!t)return e;for(o=[],n=0,r=e.length;r>n;n++)i=e[n],s.utils.matchesSelector(i,t)&&o.push(i);return o},d=function(){return r?function(e,t){return e.toggle(t)}:function(e,t){return e.style.display=t?"":"none"}}(),l=function(){return r?function(e,t){return e.addClass(t)}:function(e,t){return e.classList.add(t)}}(),p=function(){return r?function(e,t,i){return t?l(e,i):e.css("opacity",0)}:function(e,t,i){return t?l(e,i):e.style.opacity=0}}(),u=function(){return r?function(e,t){return e.animate({opacity:1},t)}:function(e,t){return e.style.transition="opacity "+t/1e3+"s",e.opacity=1}}(),c=function(){return r?function(e,t,i,n,r){var s,o,a,l,u;return a=i>0&&n>i,l=function(e){return 0===e||i===e},a||r?(s=e.children(r),o=s.length,s[i]!==t?l(o)?e.append(t):0===i?s.eq(i).before(t):s.eq(i-1).after(t):void 0):(u=l(n)?"append":"prepend",e[u](t))}:function(e,t,i,n,r){var s,o,a,l,u;return a=i>0&&n>i,l=function(e){return 0===e||i===e},a||r?(s=h(e.children,r),o=s.length,s[i]!==t?l(o)?e.appendChild(t):0===i?e.insertBefore(t,s[i]):(u=s[i-1],e.lastChild===u?e.appendChild(t):e.insertBefore(t,u.nextElementSibling)):void 0):l(n)?e.appendChild(t):e.insertBefore(t,e.firstChild)}}(),n.exports=o=function(e){function t(){this.renderAllItems=g(this.renderAllItems,this),this.toggleFallback=g(this.toggleFallback,this),this.itemsReset=g(this.itemsReset,this),this.itemRemoved=g(this.itemRemoved,this),this.itemAdded=g(this.itemAdded,this),this.visibleItems=[],t.__super__.constructor.apply(this,arguments)}return v(t,e),t.prototype.itemView=null,t.prototype.autoRender=!0,t.prototype.renderItems=!0,t.prototype.animationDuration=500,t.prototype.useCssAnimation=!1,t.prototype.animationStartClass="animated-item-view",t.prototype.animationEndClass="animated-item-view-end",t.prototype.listSelector=null,t.prototype.$list=null,t.prototype.fallbackSelector=null,t.prototype.$fallback=null,t.prototype.loadingSelector=null,t.prototype.$loading=null,t.prototype.itemSelector=void 0,t.prototype.filterer=null,t.prototype.filterCallback=function(e,t){return r&&e.$el.stop(!0,!0),d(r?e.$el:e.el,t)},t.prototype.visibleItems=null,t.prototype.optionNames=a.prototype.optionNames.concat(["renderItems","itemView"]),t.prototype.initialize=function(e){return null==e&&(e={}),this.addCollectionListeners(),null!=e.filterer?this.filter(e.filterer):void 0},t.prototype.addCollectionListeners=function(){return this.listenTo(this.collection,"add",this.itemAdded),this.listenTo(this.collection,"remove",this.itemRemoved),this.listenTo(this.collection,"reset sort",this.itemsReset)},t.prototype.getTemplateData=function(){var e;return e={length:this.collection.length},"function"==typeof this.collection.isSynced&&(e.synced=this.collection.isSynced()),e},t.prototype.getTemplateFunction=function(){},t.prototype.render=function(){var e;return t.__super__.render.apply(this,arguments),e=m.result(this,"listSelector"),r?this.$list=e?this.$(e):this.$el:this.list=e?this.find(this.listSelector):this.el,this.initFallback(),this.initLoadingIndicator(),this.renderItems?this.renderAllItems():void 0},t.prototype.itemAdded=function(e,t,i){return this.insertView(e,this.renderItem(e),i.at)},t.prototype.itemRemoved=function(e){return this.removeViewForItem(e)},t.prototype.itemsReset=function(){return this.renderAllItems()},t.prototype.initFallback=function(){return this.fallbackSelector?(r?this.$fallback=this.$(this.fallbackSelector):this.fallback=this.find(this.fallbackSelector),this.on("visibilityChange",this.toggleFallback),this.listenTo(this.collection,"syncStateChange",this.toggleFallback),this.toggleFallback()):void 0},t.prototype.toggleFallback=function(){var e;return e=0===this.visibleItems.length&&("function"==typeof this.collection.isSynced?this.collection.isSynced():!0),d(r?this.$fallback:this.fallback,e)},t.prototype.initLoadingIndicator=function(){return this.loadingSelector&&"function"==typeof this.collection.isSyncing?(r?this.$loading=this.$(this.loadingSelector):this.loading=this.find(this.loadingSelector),this.listenTo(this.collection,"syncStateChange",this.toggleLoadingIndicator),this.toggleLoadingIndicator()):void 0},t.prototype.toggleLoadingIndicator=function(){var e;return e=0===this.collection.length&&this.collection.isSyncing(),d(r?this.$loading:this.loading,e)},t.prototype.getItemViews=function(){var e,t,i,n;if(e={},this.subviews.length>0){n=this.subviewsByName;for(t in n)i=n[t],"itemView:"===t.slice(0,9)&&(e[t.slice(9)]=i)}return e},t.prototype.filter=function(e,t){var i,n,r,s,o,a,l,u,h=this;if(("function"==typeof e||null===e)&&(this.filterer=e),("function"==typeof t||null===t)&&(this.filterCallback=t),i=function(){var e;if(h.subviews.length>0)for(e in h.subviewsByName)if("itemView:"===e.slice(0,9))return!0;return!1}())for(u=this.collection.models,r=a=0,l=u.length;l>a;r=++a){if(s=u[r],n="function"==typeof this.filterer?this.filterer(s,r):!0,o=this.subview("itemView:"+s.cid),!o)throw Error("CollectionView#filter: "+("no view found for "+s.cid));this.filterCallback(o,n),this.updateVisibleItems(o.model,n,!1)}return this.trigger("visibilityChange",this.visibleItems)},t.prototype.renderAllItems=function(){var e,t,i,n,r,s,o,a,l,u,h;for(n=this.collection.models,this.visibleItems=[],r={},o=0,l=n.length;l>o;o++)i=n[o],s=this.subview("itemView:"+i.cid),s&&(r[i.cid]=s);h=this.getItemViews();for(e in h)y.call(h,e)&&(s=h[e],e in r||this.removeSubview("itemView:"+e));for(t=a=0,u=n.length;u>a;t=++a)i=n[t],s=this.subview("itemView:"+i.cid),s?this.insertView(i,s,t,!1):this.insertView(i,this.renderItem(i),t);return 0===n.length?this.trigger("visibilityChange",this.visibleItems):void 0},t.prototype.renderItem=function(e){var t;return t=this.subview("itemView:"+e.cid),t||(t=this.initItemView(e),this.subview("itemView:"+e.cid,t)),t.render(),t},t.prototype.initItemView=function(e){if(this.itemView)return new this.itemView({autoRender:!1,model:e});throw Error("The CollectionView#itemView property must be defined or the initItemView() must be overridden.")},t.prototype.insertView=function(e,t,i,n){var s,o,a,h,d=this;return null==n&&(n=!0),0===this.animationDuration&&(n=!1),"number"!=typeof i&&(i=this.collection.indexOf(e)),o="function"==typeof this.filterer?this.filterer(e,i):!0,s=r?t.$el:t.el,o&&n&&p(s,this.useCssAnimation,this.animationStartClass),this.filterer&&this.filterCallback(t,o),a=this.collection.length,h=r?this.$list:this.list,c(h,s,i,a,this.itemSelector),t.trigger("addedToParent"),this.updateVisibleItems(e,o),o&&n&&(this.useCssAnimation?setTimeout(function(){return l(s,d.animationEndClass)},0):u(s,this.animationDuration)),t},t.prototype.removeViewForItem=function(e){return this.updateVisibleItems(e,!1),this.removeSubview("itemView:"+e.cid)},t.prototype.updateVisibleItems=function(e,t,i){var n,r,s;return null==i&&(i=!0),r=!1,s=f.indexOf(this.visibleItems,e),n=-1!==s,t&&!n?(this.visibleItems.push(e),r=!0):!t&&n&&(this.visibleItems.splice(s,1),r=!0),r&&i&&this.trigger("visibilityChange",this.visibleItems),r},t.prototype.dispose=function(){var e,i,n,r;if(!this.disposed){for(i=["$list","$fallback","$loading","visibleItems"],n=0,r=i.length;r>n;n++)e=i[n],delete this[e];return t.__super__.dispose.apply(this,arguments)}},t}(a)}),e.register("chaplin/lib/route",function(t,i,n){"use strict";var r,s,o,a,l,u,h=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty;u=e("underscore"),r=e("backbone"),o=e("chaplin/lib/event_broker"),s=e("chaplin/controllers/controller"),l=e("chaplin/lib/utils"),n.exports=a=function(){function e(e,t,i,n){var r;if(this.pattern=e,this.controller=t,this.action=i,this.handler=h(this.handler,this),this.addParamName=h(this.addParamName,this),"string"!=typeof this.pattern)throw Error("Route: RegExps are not supported.        Use strings with :names and `constraints` option of route");if(this.options=n?u.extend({},n):{},null!=this.options.name&&(this.name=this.options.name),this.name&&-1!==this.name.indexOf("#"))throw Error('Route: "#" cannot be used in name');if(null==(r=this.name)&&(this.name=this.controller+"#"+this.action),this.paramNames=[],this.action in s.prototype)throw Error("Route: You should not use existing controller properties as action names");this.createRegExp(),"function"==typeof Object.freeze&&Object.freeze(this)}var t;return e.extend=r.Model.extend,u.extend(e.prototype,o),t=/[-[\]{}()+?.,\\^$|#\s]/g,e.prototype.matches=function(e){var t,i,n,r,s,o,a;if("string"==typeof e)return e===this.name;for(n=0,a=["name","action","controller"],s=0,o=a.length;o>s;s++)if(i=a[s],n++,r=e[i],r&&r!==this[i])return!1;return t=1===n&&("action"===i||"controller"===i),!t},e.prototype.reverse=function(e,t){var i,n,r,s,o,a,u;if(e=this.normalizeParams(e),e===!1)return!1;for(r=this.pattern,u=this.paramNames,o=0,a=u.length;a>o;o++)i=u[o],s=e[i],r=r.replace(RegExp("[:*]"+i,"g"),s);return t?"object"==typeof t?(n=l.queryParams.stringify(t),r+=n?"?"+n:""):r+=("?"===t[0]?"":"?")+t:r},e.prototype.normalizeParams=function(e){var t,i,n,r,s,o;if(l.isArray(e)){if(e.length<this.paramNames.length)return!1;for(n={},o=this.paramNames,t=r=0,s=o.length;s>r;t=++r)i=o[t],n[i]=e[t];if(!this.testConstraints(n))return!1;e=n}else if(null==e&&(e={}),!this.testParams(e))return!1;return e},e.prototype.testConstraints=function(e){var t,i,n;if(i=this.options.constraints)for(n in i)if(c.call(i,n)&&(t=i[n],!t.test(e[n])))return!1;return!0},e.prototype.testParams=function(e){var t,i,n,r;for(r=this.paramNames,i=0,n=r.length;n>i;i++)if(t=r[i],void 0===e[t])return!1;return this.testConstraints(e)},e.prototype.createRegExp=function(){var e;return e=this.pattern.replace(t,"\\$&").replace(/(?::|\*)(\w+)/g,this.addParamName),this.regExp=RegExp("^"+e+"(?=\\?|$)")},e.prototype.addParamName=function(e,t){return this.paramNames.push(t),":"===e.charAt(0)?"([^/?]+)":"(.*?)"},e.prototype.test=function(e){var t,i;return(i=this.regExp.test(e))?(t=this.options.constraints,t?this.testConstraints(this.extractParams(e)):!0):!1},e.prototype.handler=function(e,t){var i,n,r,s,o,a;return t=t?u.extend({},t):{},"object"==typeof e?(s=l.queryParams.stringify(t.query),n=e,r=this.reverse(n)):(a=e.split("?"),r=a[0],s=a[1],null==s?s="":t.query=l.queryParams.parse(s),n=this.extractParams(r)),i=u.extend({},n,this.options.params),o={path:r,action:this.action,controller:this.controller,name:this.name,query:s},this.publishEvent("router:match",o,i,t)},e.prototype.extractParams=function(e){var t,i,n,r,s,o,a,l;for(s={},n=this.regExp.exec(e),l=n.slice(1),t=o=0,a=l.length;a>o;t=++o)i=l[t],r=this.paramNames.length?this.paramNames[t]:t,s[r]=i;return s},e}()}),e.register("chaplin/lib/router",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c,p=function(e,t){return function(){return e.apply(t,arguments)}};c=e("underscore"),r=e("backbone"),u=e("chaplin/mediator"),s=e("chaplin/lib/event_broker"),o=e("chaplin/lib/history"),a=e("chaplin/lib/route"),h=e("chaplin/lib/utils"),n.exports=l=function(){function e(e){var t;this.options=null!=e?e:{},this.match=p(this.match,this),t="file:"!==window.location.protocol,c.defaults(this.options,{pushState:t,root:"/"}),this.removeRoot=RegExp("^"+h.escapeRegExp(this.options.root)+"(#)?"),this.subscribeEvent("!router:route",this.oldEventError),this.subscribeEvent("!router:routeByName",this.oldEventError),this.subscribeEvent("!router:changeURL",this.oldURLEventError),u.setHandler("router:route",this.route,this),u.setHandler("router:reverse",this.reverse,this),u.setHandler("router:changeURL",this.changeURL,this),this.createHistory()}return e.extend=r.Model.extend,c.extend(e.prototype,s),e.prototype.oldEventError=function(){throw Error("!router:route and !router:routeByName events were removed.  Use `Chaplin.helpers.redirectTo`")},e.prototype.oldURLEventError=function(){throw Error('!router:changeURL event was removed.  Use mediator.execute("router:changeURL")')},e.prototype.createHistory=function(){return r.history=new o},e.prototype.startHistory=function(){return r.history.start(this.options)},e.prototype.stopHistory=function(){return r.History.started?r.history.stop():void 0},e.prototype.findHandler=function(e){var t,i,n,s;for(s=r.history.handlers,i=0,n=s.length;n>i;i++)if(t=s[i],e(t))return t},e.prototype.match=function(e,t,i){var n,s,o,l;if(null==i&&(i={}),2===arguments.length&&"object"==typeof t){if(i=t,s=i.controller,n=i.action,!s||!n)throw Error("Router#match must receive either target or options.controller & options.action")}else{if(s=i.controller,n=i.action,s||n)throw Error("Router#match cannot use both target and options.controller / options.action");l=t.split("#"),s=l[0],n=l[1]}return o=new a(e,s,n,i),r.history.handlers.push({route:o,callback:o.handler}),o},e.prototype.route=function(e,t,i){var n,r;if(t=t?h.isArray(t)?t.slice():c.extend({},t):{},"object"==typeof e&&(r=e.url),null!=r?(r=r.replace(this.removeRoot,""),n=this.findHandler(function(e){return e.route.test(r)}),i=t,t=null):(i=i?c.extend({},i):{},n=this.findHandler(function(i){return i.route.matches(e)&&(t=i.route.normalizeParams(t))?!0:!1})),n)return c.defaults(i,{changeURL:!0}),n.callback(r||t,i),!0;throw Error("Router#route: request was not routed")},e.prototype.reverse=function(e,t,i){var n,s,o,a,l,u,h;if(a=this.options.root,null!=t&&"object"!=typeof t)throw new TypeError("Router#reverse: params must be an array or an object");for(s=r.history.handlers,u=0,h=s.length;h>u;u++)if(n=s[u],n.route.matches(e)&&(o=n.route.reverse(t,i),o!==!1))return l=a?a+o:o;throw Error("Router#reverse: invalid route specified")},e.prototype.changeURL=function(e,t){var i;return null==t&&(t={}),i={trigger:t.trigger===!0,replace:t.replace===!0},r.history.navigate(e,i)},e.prototype.disposed=!1,e.prototype.dispose=function(){return this.disposed?void 0:(this.stopHistory(),delete r.history,this.unsubscribeAllEvents(),u.removeHandlers(this),this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0)},e}()}),e.register("chaplin/lib/history",function(t,i,n){"use strict";var r,s,o,a,l,u,h,c={}.hasOwnProperty,p=function(e,t){function i(){this.constructor=e}for(var n in t)c.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};h=e("underscore"),r=e("backbone"),l=/^[#\/]|\s+$/g,a=/^\/+|\/+$/g,o=/msie [\w.]+/,u=/\/$/,s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.getFragment=function(e,t){var i;return null==e&&(this._hasPushState||!this._wantsHashChange||t?(e=this.location.pathname+this.location.search,i=this.root.replace(u,""),e.indexOf(i)||(e=e.substr(i.length))):e=this.getHash()),e.replace(l,"")},t.prototype.start=function(e){var t,i,n;if(r.History.started)throw Error("Backbone.history has already been started");return r.History.started=!0,this.options=h.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=Boolean(this.options.pushState),this._hasPushState=Boolean(this.options.pushState&&this.history&&this.history.pushState),i=this.getFragment(),this.root=("/"+this.root+"/").replace(a,"/"),this._hasPushState?r.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window?r.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i,n=this.location,t=n.pathname.replace(/[^\/]$/,"$&/")===this.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!t?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&t&&n.hash&&(this.fragment=this.getHash().replace(l,""),this.history.replaceState({},document.title,this.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},t}(r.History),n.exports=r.$?s:r.History}),e.register("chaplin/lib/event_broker",function(t,i,n){"use strict";var r,s,o=[].slice;s=e("chaplin/mediator"),r={subscribeEvent:function(e,t){if("string"!=typeof e)throw new TypeError("EventBroker#subscribeEvent: type argument must be a string");if("function"!=typeof t)throw new TypeError("EventBroker#subscribeEvent: handler argument must be a function");return s.unsubscribe(e,t,this),s.subscribe(e,t,this)},unsubscribeEvent:function(e,t){if("string"!=typeof e)throw new TypeError("EventBroker#unsubscribeEvent: type argument must be a string");if("function"!=typeof t)throw new TypeError("EventBroker#unsubscribeEvent: handler argument must be a function");return s.unsubscribe(e,t)},unsubscribeAllEvents:function(){return s.unsubscribe(null,null,this)},publishEvent:function(){var e,t;if(t=arguments[0],e=arguments.length>=2?o.call(arguments,1):[],"string"!=typeof t)throw new TypeError("EventBroker#publishEvent: type argument must be a string");return s.publish.apply(s,[t].concat(o.call(e)))}},"function"==typeof Object.freeze&&Object.freeze(r),n.exports=r}),e.register("chaplin/lib/support",function(e,t,i){"use strict";var n;n={propertyDescriptors:function(){var e;if("function"!=typeof Object.defineProperty||"function"!=typeof Object.defineProperties)return!1;try{return e={},Object.defineProperty(e,"foo",{value:"bar"}),"bar"===e.foo}catch(t){return!1}}()},i.exports=n}),e.register("chaplin/lib/composition",function(t,i,n){"use strict";var r,s,o,a,l,u={}.hasOwnProperty;l=e("underscore"),r=e("backbone"),o=e("chaplin/lib/event_broker"),a=Object.prototype.hasOwnProperty,n.exports=s=function(){function e(e){null!=e&&(this.options=l.extend({},e)),this.item=this,this.initialize(this.options)}return e.extend=r.Model.extend,l.extend(e.prototype,r.Events),l.extend(e.prototype,o),e.prototype.item=null,e.prototype.options=null,e.prototype._stale=!1,e.prototype.initialize=function(){},e.prototype.compose=function(){},e.prototype.check=function(e){return l.isEqual(this.options,e)},e.prototype.stale=function(e){var t,i;if(null==e)return this._stale;this._stale=e;for(i in this)t=this[i],t&&t!==this&&"object"==typeof t&&a.call(t,"stale")&&(t.stale=e)},e.prototype.disposed=!1,e.prototype.dispose=function(){var e,t,i,n,r;if(!this.disposed){for(t in this)u.call(this,t)&&(e=this[t],e&&"function"==typeof e.dispose&&e!==this&&(e.dispose(),delete this[t]));for(this.unsubscribeAllEvents(),this.stopListening(),i=["redirected"],n=0,r=i.length;r>n;n++)t=i[n],delete this[t];return this.disposed=!0,"function"==typeof Object.freeze?Object.freeze(this):void 0}},e}()}),e.register("chaplin/lib/sync_machine",function(e,t,i){"use strict";var n,r,s,o,a,l,u,h,c,p;for(a="unsynced",s="syncing",r="synced",n="syncStateChange",o={_syncState:a,_previousSyncState:null,syncState:function(){return this._syncState},isUnsynced:function(){return this._syncState===a},isSynced:function(){return this._syncState===r},isSyncing:function(){return this._syncState===s},unsync:function(){var e;((e=this._syncState)===s||e===r)&&(this._previousSync=this._syncState,this._syncState=a,this.trigger(this._syncState,this,this._syncState),this.trigger(n,this,this._syncState))},beginSync:function(){var e;((e=this._syncState)===a||e===r)&&(this._previousSync=this._syncState,this._syncState=s,this.trigger(this._syncState,this,this._syncState),this.trigger(n,this,this._syncState))},finishSync:function(){this._syncState===s&&(this._previousSync=this._syncState,this._syncState=r,this.trigger(this._syncState,this,this._syncState),this.trigger(n,this,this._syncState))},abortSync:function(){this._syncState===s&&(this._syncState=this._previousSync,this._previousSync=this._syncState,this.trigger(this._syncState,this,this._syncState),this.trigger(n,this,this._syncState))}},p=[a,s,r,n],u=function(e){return o[e]=function(t,i){return null==i&&(i=this),this.on(e,t,i),this._syncState===e?t.call(i):void 0}},h=0,c=p.length;c>h;h++)l=p[h],u(l);"function"==typeof Object.freeze&&Object.freeze(o),i.exports=o}),e.register("chaplin/lib/utils",function(t,i,n){"use strict";var r,s,o,a=[].slice,l=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1},u={}.hasOwnProperty;o=e("underscore"),r=e("chaplin/lib/support"),s={beget:function(){var e;return"function"==typeof Object.create?Object.create:(e=function(){},function(t){return e.prototype=t,new e})}(),indexOf:function(){return Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:o.indexOf?o.indexOf:void 0}(),isArray:Array.isArray||o.isArray,serialize:function(e){if("function"==typeof e.serialize)return e.serialize();if("function"==typeof e.toJSON)return e.toJSON();throw new TypeError("utils.serialize: Unknown data was passed")},readonly:function(){var e;return r.propertyDescriptors?(e={writable:!1,enumerable:!0,configurable:!1},function(){var t,i,n,r,s;for(t=arguments[0],n=arguments.length>=2?a.call(arguments,1):[],r=0,s=n.length;s>r;r++)i=n[r],e.value=t[i],Object.defineProperty(t,i,e);return!0}):function(){return!1}}(),getPrototypeChain:function(e){var t,i,n,r;for(t=[e.constructor.prototype];e=null!=(i=null!=(n=e.constructor)?n.__super__:void 0)?i:null!=(r=e.constructor)?r.superclass:void 0;)t.push(e);return t.reverse()},getAllPropertyVersions:function(e,t){var i,n,r,o,a,u;for(n=[],u=s.getPrototypeChain(e),o=0,a=u.length;a>o;o++)i=u[o],r=i[t],r&&0>l.call(n,r)&&n.push(r);return n},upcase:function(e){return e.charAt(0).toUpperCase()+e.substring(1)},escapeRegExp:function(e){return((e||"")+"").replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},modifierKeyPressed:function(e){return e.shiftKey||e.altKey||e.ctrlKey||e.metaKey},reverse:function(t,i,n){return e("chaplin/mediator").execute("router:reverse",t,i,n)},redirectTo:function(t,i,n){return e("chaplin/mediator").execute("router:route",t,i,n)},queryParams:{stringify:function(e){var t,i,n,r,o,a,l,h;r="",o=function(e,t){return null!=t?"&"+e+"="+encodeURIComponent(t):""};for(n in e)if(u.call(e,n))if(a=e[n],i=encodeURIComponent(n),s.isArray(a))for(l=0,h=a.length;h>l;l++)t=a[l],r+=o(i,t);else r+=o(i,a);return r&&r.substring(1)},parse:function(e){var t,i,n,r,s,o,a,l,u;if(s={},!e)return s;for(r=e.split("&"),a=0,l=r.length;l>a;a++)n=r[a],n.length&&(u=n.split("="),i=u[0],o=u[1],i.length&&(i=decodeURIComponent(i),o=decodeURIComponent(o),t=s[i],t?t.push?t.push(o):s[i]=[t,o]:s[i]=o));return s}}},"function"==typeof Object.seal&&Object.seal(s),n.exports=s}),e.register("chaplin",function(t,i,n){n.exports={Application:e("chaplin/application"),mediator:e("chaplin/mediator"),Dispatcher:e("chaplin/dispatcher"),Controller:e("chaplin/controllers/controller"),Composer:e("chaplin/composer"),Composition:e("chaplin/lib/composition"),Collection:e("chaplin/models/collection"),Model:e("chaplin/models/model"),Layout:e("chaplin/views/layout"),View:e("chaplin/views/view"),CollectionView:e("chaplin/views/collection_view"),Route:e("chaplin/lib/route"),Router:e("chaplin/lib/router"),EventBroker:e("chaplin/lib/event_broker"),support:e("chaplin/lib/support"),SyncMachine:e("chaplin/lib/sync_machine"),utils:e("chaplin/lib/utils")}});var t=function(t,i){e.register("backbone",function(e,i,n){n.exports=t}),e.register("underscore",function(e,t,n){n.exports=i})};if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(i,n){return t(i,n),e("chaplin")});else if("object"==typeof module&&module&&module.exports)t(require("backbone"),require("underscore")),module.exports=e("chaplin");else{if("function"!=typeof require)throw Error("Chaplin requires Common.js or AMD modules");t(window.Backbone,window._||window.Backbone.utils),window.Chaplin=e("chaplin")}}(),function(e){if("undefined"!=typeof exports&&"undefined"!=typeof require)var t=e.jQuery||e.Zepto||e.ender||require("jquery"),i=e._||require("underscore"),n=e.Backbone||require("backbone");else var t=e.jQuery,i=e._,n=e.Backbone;var r=n.View.extend({initialize:function(e){var t=this;e=e||{};var n=this.schema=function(){if(e.schema)return i.result(e,"schema");var n=e.model;return n&&n.schema?i.result(n,"schema"):t.schema?i.result(t,"schema"):{}}();i.extend(this,i.pick(e,"model","data","idPrefix","templateData"));var r=this.constructor;this.template=e.template||this.template||r.template,this.Fieldset=e.Fieldset||this.Fieldset||r.Fieldset,this.Field=e.Field||this.Field||r.Field,this.NestedField=e.NestedField||this.NestedField||r.NestedField;var s=this.selectedFields=e.fields||i.keys(n),o=this.fields={};i.each(s,function(e){var t=n[e];o[e]=this.createField(e,t)},this);var a=e.fieldsets||[s];this.fieldsets=[],i.each(a,function(e){this.fieldsets.push(this.createFieldset(e))},this)},createFieldset:function(e){var t={schema:e,fields:this.fields};return new this.Fieldset(t)},createField:function(e,t){var i={form:this,key:e,schema:t,idPrefix:this.idPrefix};this.model?i.model=this.model:i.value=this.data?this.data[e]:null;var n=new this.Field(i);return this.listenTo(n.editor,"all",this.handleEditorEvent),n},handleEditorEvent:function(e,t){var n=t.key+":"+e;switch(this.trigger.call(this,n,this,t,Array.prototype.slice.call(arguments,2)),e){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var r=this;setTimeout(function(){var e=i.find(r.fields,function(e){return e.editor.hasFocus});e||r.trigger("blur",r)},0)}}},render:function(){var e=this,n=this.fields,r=t(t.trim(this.template(i.result(this,"templateData"))));return r.find("[data-editors]").add(r).each(function(r,s){var o=t(s),a=o.attr("data-editors");if(!i.isUndefined(a)){var l="*"==a?e.selectedFields||i.keys(n):a.split(",");i.each(l,function(e){var t=n[e];o.append(t.editor.render().el)})}}),r.find("[data-fields]").add(r).each(function(r,s){var o=t(s),a=o.attr("data-fields");if(!i.isUndefined(a)){var l="*"==a?e.selectedFields||i.keys(n):a.split(",");i.each(l,function(e){var t=n[e];o.append(t.render().el)})}}),r.find("[data-fieldsets]").add(r).each(function(n,r){var s=t(r),o=s.attr("data-fieldsets");i.isUndefined(o)||i.each(e.fieldsets,function(e){s.append(e.render().el)})}),this.setElement(r),r.addClass(this.className),this},validate:function(e){var t=this.fields,n=this.model,r={};if(e=e||{},i.each(t,function(e){var t=e.validate();t&&(r[e.key]=t)}),!e.skipModelValidate&&n&&n.validate){var s=n.validate(this.getValue());if(s){var o=i.isObject(s)&&!i.isArray(s);o||(r._others=r._others||[],r._others.push(s)),o&&i.each(s,function(e,i){if(t[i]&&!r[i])t[i].setError(e),r[i]=e;else{r._others=r._others||[];var n={};n[i]=e,r._others.push(n)}})}}return i.isEmpty(r)?null:r},commit:function(e){e=e||{};var t={skipModelValidate:!e.validate},n=this.validate(t);if(n)return n;var r,s=i.extend({error:function(e,t){r=t}},e);return this.model.set(this.getValue(),s),r?r:void 0},getValue:function(e){if(e)return this.fields[e].getValue();var t={};return i.each(this.fields,function(e){t[e.key]=e.getValue()}),t},setValue:function(e,t){var i={};"string"==typeof e?i[e]=t:i=e;var n;for(n in this.schema)void 0!==i[n]&&this.fields[n].setValue(i[n])},getEditor:function(e){var t=this.fields[e];if(!t)throw Error("Field not found: "+e);return t.editor},focus:function(){if(!this.hasFocus){var e=this.fieldsets[0],t=e.getFieldAt(0);t&&t.editor.focus()}},blur:function(){if(this.hasFocus){var e=i.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},remove:function(){return i.each(this.fieldsets,function(e){e.remove()}),i.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.apply(this,arguments)}},{template:i.template("    <form data-fieldsets></form>  ",null,this.templateSettings),templateSettings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},editors:{}});r.validators=function(){var e={};return e.errMessages={required:"Required",regexp:"Invalid",email:"Invalid email address",url:"Invalid URL",match:i.template('Must match field "<%= field %>"',null,r.templateSettings)},e.required=function(e){return e=i.extend({type:"required",message:this.errMessages.required},e),function(t){e.value=t;var n={type:e.type,message:i.isFunction(e.message)?e.message(e):e.message};return null===t||void 0===t||t===!1||""===t?n:void 0}},e.regexp=function(e){if(!e.regexp)throw Error('Missing required "regexp" option for "regexp" validator');return e=i.extend({type:"regexp",match:!0,message:this.errMessages.regexp},e),function(t){e.value=t;var n={type:e.type,message:i.isFunction(e.message)?e.message(e):e.message};if(null!==t&&void 0!==t&&""!==t)return"string"==typeof e.regexp&&(e.regexp=RegExp(e.regexp,e.flags)),(e.match?!e.regexp.test(t):e.regexp.test(t))?n:void 0}},e.email=function(t){return t=i.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},t),e.regexp(t)},e.url=function(t){return t=i.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},t),e.regexp(t)},e.match=function(e){if(!e.field)throw Error('Missing required "field" options for "match" validator');return e=i.extend({type:"match",message:this.errMessages.match},e),function(t,n){e.value=t;var r={type:e.type,message:i.isFunction(e.message)?e.message(e):e.message};if(null!==t&&void 0!==t&&""!==t)return t!==n[e.field]?r:void 0}},e}(),r.Fieldset=n.View.extend({initialize:function(e){e=e||{};var t=this.schema=this.createSchema(e.schema);this.fields=i.pick(e.fields,t.fields),this.template=e.template||t.template||this.template||this.constructor.template},createSchema:function(e){return i.isArray(e)&&(e={fields:e}),e.legend=e.legend||null,e},getFieldAt:function(e){var t=this.schema.fields[e];return this.fields[t]},templateData:function(){return this.schema},render:function(){var e=(this.schema,this.fields),n=t(t.trim(this.template(i.result(this,"templateData"))));return n.find("[data-fields]").add(n).each(function(n,r){var s=t(r),o=s.attr("data-fields");i.isUndefined(o)||i.each(e,function(e){s.append(e.render().el)})}),this.setElement(n),this},remove:function(){i.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.call(this)}},{template:i.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,r.templateSettings)}),r.Field=n.View.extend({initialize:function(e){e=e||{},i.extend(this,i.pick(e,"form","key","model","value","idPrefix"));var t=this.schema=this.createSchema(e.schema);this.template=e.template||t.template||this.template||this.constructor.template,this.errorClassName=e.errorClassName||this.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(e){return i.isString(e)&&(e={type:e}),e=i.extend({type:"Text",title:this.createTitle()},e),e.type=i.isString(e.type)?r.editors[e.type]:e.type,e},createEditor:function(){var e=i.extend(i.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()}),t=this.schema.type;return new t(e)},createEditorId:function(){var e=this.idPrefix,t=this.key;return t=t.replace(/\./g,"_"),i.isString(e)||i.isNumber(e)?e+t:i.isNull(e)?t:this.model?this.model.cid+"_"+t:t},createTitle:function(){var e=this.key;return e=e.replace(/([A-Z])/g," $1"),e=e.replace(/^./,function(e){return e.toUpperCase()})},templateData:function(){var e=this.schema;return{help:e.help||"",title:e.title,fieldAttrs:e.fieldAttrs,editorAttrs:e.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var e=this.schema,n=this.editor;if(e.type==r.editors.Hidden)return this.setElement(n.render().el);var s=t(t.trim(this.template(i.result(this,"templateData"))));return e.fieldClass&&s.addClass(e.fieldClass),e.fieldAttrs&&s.attr(e.fieldAttrs),s.find("[data-editor]").add(s).each(function(e,r){var s=t(r),o=s.attr("data-editor");i.isUndefined(o)||s.append(n.render().el)}),this.setElement(s),this},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){this.editor.hasNestedForm||(this.$el.addClass(this.errorClassName),this.$("[data-error]").html(e))},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()
},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),n.View.prototype.remove.call(this)}},{template:i.template('    <div>      <label for="<%= editorId %>"><%= title %></label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,r.templateSettings),errorClassName:"error"}),r.NestedField=r.Field.extend({template:i.template(t.trim("    <div>      <span data-editor></span>      <% if (help) { %>        <div><%= help %></div>      <% } %>      <div data-error></div>    </div>  "),null,r.templateSettings)}),r.Editor=r.editors.Base=n.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){var e=e||{};if(e.model){if(!e.key)throw Error("Missing option: 'key'");this.model=e.model,this.value=this.model.get(e.key)}else void 0!==e.value&&(this.value=e.value);void 0===this.value&&(this.value=this.defaultValue),i.extend(this,i.pick(e,"key","form"));var t=this.schema=e.schema||{};this.validators=e.validators||t.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),t.editorClass&&this.$el.addClass(t.editorClass),t.editorAttrs&&this.$el.attr(t.editorAttrs)},getName:function(){var e=this.key||"";return e.replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){throw Error("Not implemented")},blur:function(){throw Error("Not implemented")},commit:function(e){var t=this.validate();return t?t:(this.listenTo(this.model,"invalid",function(e,i){t=i}),this.model.set(this.key,this.getValue(),e),t?t:void 0)},validate:function(){var e=(this.$el,null),t=this.getValue(),n=this.form?this.form.getValue():{},r=this.validators,s=this.getValidator;return r&&i.every(r,function(i){return e=s(i)(t,n),e?!1:!0}),e},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},getValidator:function(e){var t=r.validators;if(i.isRegExp(e))return t.regexp({regexp:e});if(i.isString(e)){if(!t[e])throw Error('Validator "'+e+'" not found');return t[e]()}if(i.isFunction(e))return e;if(i.isObject(e)&&e.type){var n=e;return t[n.type](n)}throw Error("Invalid validator: "+e)}}),r.editors.Text=r.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(){var e=this;setTimeout(function(){e.determineChange()},0)},select:function(){this.trigger("select",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);var t=this.schema,i="text";t&&t.editorAttrs&&t.editorAttrs.type&&(i=t.editorAttrs.type),t&&t.dataType&&(i=t.dataType),this.$el.attr("type",i)},render:function(){return this.setValue(this.value),this},determineChange:function(){var e=this.$el.val(),t=e!==this.previousValue;t&&(this.previousValue=e,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},select:function(){this.$el.select()}}),r.editors.TextArea=r.editors.Text.extend({tagName:"textarea",initialize:function(e){r.editors.Base.prototype.initialize.call(this,e)}}),r.editors.Password=r.editors.Text.extend({initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","password")}}),r.editors.Number=r.editors.Text.extend({defaultValue:0,events:i.extend({},r.editors.Text.prototype.events,{keypress:"onKeyPress",change:"onKeyPress"}),initialize:function(e){r.editors.Text.prototype.initialize.call(this,e);var t=this.schema;this.$el.attr("type","number"),t&&t.editorAttrs&&t.editorAttrs.step||this.$el.attr("step","any")},onKeyPress:function(e){var t=this,i=function(){setTimeout(function(){t.determineChange()},0)};if(0===e.charCode)return i(),void 0;var n=this.$el.val();void 0!=e.charCode&&(n+=String.fromCharCode(e.charCode));var r=/^[0-9]*\.?[0-9]*?$/.test(n);r?i():e.preventDefault()},getValue:function(){var e=this.$el.val();return""===e?null:parseFloat(e,10)},setValue:function(e){e=function(){return i.isNumber(e)?e:i.isString(e)&&""!==e?parseFloat(e,10):null}(),i.isNaN(e)&&(e=null),r.editors.Text.prototype.setValue.call(this,e)}}),r.editors.Hidden=r.editors.Text.extend({defaultValue:"",initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),r.editors.Checkbox=r.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e?this.$el.prop("checked",!0):this.$el.prop("checked",!1)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()}}),r.editors.Select=r.editors.Base.extend({tagName:"select",events:{change:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(e){if(r.editors.Base.prototype.initialize.call(this,e),!this.schema||!this.schema.options)throw Error("Missing required 'schema.options'")},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(e){var t=this;if(e instanceof n.Collection){var r=e;r.length>0?this.renderOptions(e):r.fetch({success:function(){t.renderOptions(e)}})}else i.isFunction(e)?e(function(e){t.renderOptions(e)},t):this.renderOptions(e)},renderOptions:function(e){var t,i=this.$el;t=this._getOptionsHtml(e),i.html(t),this.setValue(this.value)},_getOptionsHtml:function(e){var t;if(i.isString(e))t=e;else if(i.isArray(e))t=this._arrayToHtml(e);else if(e instanceof n.Collection)t=this._collectionToHtml(e);else if(i.isFunction(e)){var r;e(function(e){r=e},this),t=this._getOptionsHtml(r)}else t=this._objectToHtml(e);return t},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},_collectionToHtml:function(e){var t=[];e.each(function(e){t.push({val:e.id,label:""+e})});var i=this._arrayToHtml(t);return i},_objectToHtml:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({val:i,label:e[i]});var n=this._arrayToHtml(t);return n},_arrayToHtml:function(e){var t=[];return i.each(e,function(e){if(i.isObject(e))if(e.group)t.push('<optgroup label="'+e.group+'">'),t.push(this._getOptionsHtml(e.options)),t.push("</optgroup>");else{var n=e.val||0===e.val?e.val:"";t.push('<option value="'+n+'">'+e.label+"</option>")}else t.push("<option>"+e+"</option>")},this),t.join("")}}),r.editors.Radio=r.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=radio]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=radio]:focus")[0]||e.trigger("blur",e)},0)}}},getTemplate:function(){return this.schema.template||this.constructor.template},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.$("input[type=radio]").val([e])},focus:function(){if(!this.hasFocus){var e=this.$("input[type=radio]:checked");return e[0]?(e.focus(),void 0):(this.$("input[type=radio]").first().focus(),void 0)}},blur:function(){this.hasFocus&&this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var t=this,n=this.getTemplate(),r=t.getName(),s=t.id,o=i.map(e,function(e,t){var n={name:r,id:s+"-"+t};return i.isObject(e)?(n.value=e.val||0===e.val?e.val:"",n.label=e.label):(n.value=e,n.label=e),n});return n({items:o})}},{template:i.template('    <ul>      <% _.each(items, function(item) { %>        <li>          <input type="radio" name="<%= item.name %>" value="<%= item.value %>" id="<%= item.id %>" />          <label for="<%= item.id %>"><%= item.label %></label>        </li>      <% }); %>    </ul>  ',null,r.templateSettings)}),r.editors.Checkboxes=r.editors.Select.extend({tagName:"ul",groupNumber:0,events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=checkbox]:focus")[0]||e.trigger("blur",e)},0)}}},getValue:function(){var e=[];return this.$("input[type=checkbox]:checked").each(function(){e.push(t(this).val())}),e},setValue:function(e){i.isArray(e)||(e=[e]),this.$("input[type=checkbox]").val(e)},focus:function(){this.hasFocus||this.$("input[type=checkbox]").first().focus()},blur:function(){this.hasFocus&&this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var t=[],n=this;return i.each(e,function(e,r){var s="<li>",o=!0;if(i.isObject(e))if(e.group){var a=n.id;n.id+="-"+n.groupNumber++,s='<fieldset class="group"> <legend>'+e.group+"</legend>",s+=n._arrayToHtml(e.options),s+="</fieldset>",n.id=a,o=!1}else{var l=e.val||0===e.val?e.val:"";s+='<input type="checkbox" name="'+n.getName()+'" value="'+l+'" id="'+n.id+"-"+r+'" />',s+='<label for="'+n.id+"-"+r+'">'+e.label+"</label>"}else s+='<input type="checkbox" name="'+n.getName()+'" value="'+e+'" id="'+n.id+"-"+r+'" />',s+='<label for="'+n.id+"-"+r+'">'+e+"</label>";o&&(s+="</li>"),t.push(s)}),t.join("")}}),r.editors.Object=r.editors.Base.extend({hasNestedForm:!0,initialize:function(e){if(this.value={},r.editors.Base.prototype.initialize.call(this,e),!this.form)throw Error('Missing required option "form"');if(!this.schema.subSchema)throw Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var e=this.form.constructor;return this.nestedForm=new e({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:e.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.nestedForm.focus()},blur:function(){this.hasFocus&&this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),n.View.prototype.remove.call(this)},validate:function(){return this.nestedForm.validate()},_observeFormEvents:function(){this.nestedForm&&this.nestedForm.on("all",function(){var e=i.toArray(arguments);e[1]=this,this.trigger.apply(this,e)},this)}}),r.editors.NestedModel=r.editors.Object.extend({initialize:function(e){if(r.editors.Base.prototype.initialize.call(this,e),!this.form)throw Error('Missing required option "form"');if(!e.schema.model)throw Error('Missing required "schema.model" option for NestedModel editor')},render:function(){var e=this.form.constructor,t=this.value||{},i=(this.key,this.schema.model),n=t.constructor===i?t:new i(t);return this.nestedForm=new e({model:n,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var e=this.nestedForm.commit();return e?(this.$el.addClass("error"),e):r.editors.Object.prototype.commit.call(this)}}),r.editors.Date=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e);var t=r.editors.Date,n=new Date;if(this.options=i.extend({monthNames:t.monthNames,showMonthNames:t.showMonthNames},e),this.schema=i.extend({yearStart:n.getFullYear()-50,yearEnd:n.getFullYear()+50},e.schema||{}),this.value&&!i.isDate(this.value)&&(this.value=new Date(this.value)),!this.value){var s=new Date;s.setSeconds(0),s.setMilliseconds(0),this.value=s}this.template=e.template||this.constructor.template},render:function(){var e=this.options,n=this.schema,r=i.map(i.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),s=i.map(i.range(0,12),function(t){var i=e.showMonthNames?e.monthNames[t]:t+1;return'<option value="'+t+'">'+i+"</option>"}),o=n.yearStart<n.yearEnd?i.range(n.yearStart,n.yearEnd+1):i.range(n.yearStart,n.yearEnd-1,-1),a=i.map(o,function(e){return'<option value="'+e+'">'+e+"</option>"}),l=t(t.trim(this.template({dates:r.join(""),months:s.join(""),years:a.join("")})));return this.$date=l.find('[data-type="date"]'),this.$month=l.find('[data-type="month"]'),this.$year=l.find('[data-type="year"]'),this.$hidden=t('<input type="hidden" name="'+this.key+'" />'),l.append(this.$hidden),this.setValue(this.value),this.setElement(l),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),i=this.$date.val();return e&&t&&i?(current=new Date,new Date(Date.UTC(e,t,i,current.getHours(),current.getMinutes()))):null},setValue:function(e){this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();i.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{template:i.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,r.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),r.editors.DateTime=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e),this.options=i.extend({DateEditor:r.editors.DateTime.DateEditor},e),this.schema=i.extend({minsInterval:15},e.schema||{}),this.dateEditor=new this.options.DateEditor(e),this.value=this.dateEditor.value,this.template=e.template||this.constructor.template},render:function(){function e(e){return 10>e?"0"+e:e}var n=this.schema,r=i.map(i.range(0,24),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),s=i.map(i.range(0,60,n.minsInterval),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),o=t(t.trim(this.template({hours:r.join(),mins:s.join()})));return o.find("[data-date]").append(this.dateEditor.render().el),this.$hour=o.find('select[data-type="hour"]'),this.$min=o.find('select[data-type="min"]'),this.$hidden=o.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(o),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),i=this.$min.val();return e&&t&&i?(e.setHours(t),e.setMinutes(i),e):null},setValue:function(e){i.isDate(e)||(e=new Date(e)),this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();i.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),r.editors.Base.prototype.remove.call(this)}},{template:i.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,r.templateSettings),DateEditor:r.editors.Date}),r.VERSION="0.14.0",n.Form=r,"undefined"!=typeof exports&&(exports=r)}(window||global||this),function(e,t,i){var n=t.templateSettings;t.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/<%([\s\S]+?)%>/g};var r=t.template('    <div class="modal-dialog"><div class="modal-content">    <% if (title) { %>      <div class="modal-header">        <% if (allowCancel) { %>          <a class="close">&times;</a>        <% } %>        <h4>{{title}}</h4>      </div>    <% } %>    <div class="modal-body">{{content}}</div>    <% if (showFooter) { %>      <div class="modal-footer">        <% if (allowCancel) { %>          <% if (cancelText) { %>            <a href="#" class="btn cancel">{{cancelText}}</a>          <% } %>        <% } %>        <a href="#" class="btn ok btn-primary">{{okText}}</a>      </div>    <% } %>    </div></div>  ');t.templateSettings=n;var s=i.View.extend({className:"modal",events:{"click .close":function(e){e.preventDefault(),this.trigger("cancel"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this)},"click .cancel":function(e){e.preventDefault(),this.trigger("cancel"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this)},"click .ok":function(e){e.preventDefault(),this.trigger("ok"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("ok",this),this.options.okCloses&&this.close()},keypress:function(e){this.options.enterTriggersOk&&13==e.which&&(e.preventDefault(),this.trigger("ok"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("ok",this),this.options.okCloses&&this.close())}},initialize:function(e){this.options=t.extend({title:null,okText:"OK",focusOk:!0,okCloses:!0,cancelText:"Cancel",showFooter:!0,allowCancel:!0,escape:!0,animate:!1,template:r,enterTriggersOk:!1},e)},render:function(){var e=this.$el,t=this.options,i=t.content;return e.html(t.template(t)),this.$content=e.find(".modal-body"),i.$el&&(i.render(),e.find(".modal-body").html(i.$el)),t.animate&&e.addClass("fade"),this.isRendered=!0,this},open:function(i){this.isRendered||this.render();var n=this,r=this.$el;r.modal(t.extend({keyboard:this.options.allowCancel,backdrop:this.options.allowCancel?!0:"static"},this.options.modalOptions)),r.one("shown.bs.modal",function(){n.options.focusOk&&r.find(".btn.ok").focus(),n.options.content&&n.options.content.trigger&&n.options.content.trigger("shown",n),n.trigger("shown")});var o=s.count,a=e(".modal-backdrop:eq("+o+")"),l=parseInt(a.css("z-index"),10),u=parseInt(a.css("z-index"),10);return a.css("z-index",l+o),this.$el.css("z-index",u+o),this.options.allowCancel&&(a.one("click",function(){n.options.content&&n.options.content.trigger&&n.options.content.trigger("cancel",n),n.trigger("cancel")}),e(document).one("keyup.dismiss.modal",function(e){27==e.which&&n.trigger("cancel"),n.options.content&&n.options.content.trigger&&27==e.which&&n.options.content.trigger("shown",n)})),this.on("cancel",function(){n.close()}),s.count++,i&&n.on("ok",i),this},close:function(){var e=this,t=this.$el;return this._preventClose?(this._preventClose=!1,void 0):(t.one("hidden.bs.modal",function i(n){return n.target!==n.currentTarget?t.one("hidden",i):(e.remove(),e.options.content&&e.options.content.trigger&&e.options.content.trigger("hidden",e),e.trigger("hidden"),void 0)}),t.modal("hide"),s.count--,void 0)},preventClose:function(){this._preventClose=!0}},{count:0});return"function"==typeof require&&"undefined"!=typeof module&&exports&&(module.exports=s),"function"==typeof define&&define.amd?define(function(){i.BootstrapModal=s}):(i.BootstrapModal=s,void 0)}(jQuery,_,Backbone),Backbone.Form.editors.Range=Backbone.Form.editors.Text.extend({events:_.extend({},Backbone.Form.editors.Text.prototype.events,{change:function(){this.trigger("change",this)}}),initialize:function(e){Backbone.Form.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","range")},getValue:function(){this.el=$("#"+this.el.id)[0],this.$el=$("#"+this.el.id);var e=Backbone.Form.editors.Text.prototype.getValue.call(this);return parseInt(e)}}),Backbone.Form.editors.BooleanSelect=Backbone.Form.editors.Select.extend({initialize:function(e){e.schema.options=[{val:"",label:"Nie"},{val:"1",label:"Tak"}],Backbone.Form.editors.Select.prototype.initialize.call(this,e)},getValue:function(){return!!Backbone.Form.editors.Select.prototype.getValue.call(this)},setValue:function(e){e=e?"1":"",Backbone.Form.editors.Select.prototype.setValue.call(this,e)}}),function(e){e.Fieldset.template=_.template("                <fieldset data-fields>                <% if (legend) { %>                <legend><%= legend %></legend>                <% } %>                </fieldset>            "),e.Field.template=_.template('        <div class="ui-field-contain" data-mini="true" data-editor >      <label for="<%= editorId %>"><%= title %><% if (help) { %> <a class="form-help ui-btn ui-icon-info ui-btn-icon-notext ui-corner-all"><%= help %></a> <% } %>      <br />        <span class="help-block" data-error></span>      </label>        </div>  '),e.editors.Date.template=_.template('        <fieldset data-role="controlgroup" data-type="horizontal" data-editor >      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>        </fieldset>        <p class="help-block" data-error></p>  '),e.editors.Date.monthNames=["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],e.NestedField.template=_.template('    <div class="field-<%= key %>">      <div title="<%= title %>" class="input-xlarge">        <span data-editor></span>        <div class="help-inline" data-error></div>      </div>      <div class="help-block"><%= help %></div>    </div>  '),e.editors.Base.prototype.className="form-control",e.Field.errorClassName="has-error",e.editors.List&&(e.editors.List.template=_.template('      <div class="bbf-list">        <ul class="unstyled clearfix" data-items></ul>      </div>    '),e.editors.List.Item.template=_.template('      <li class="clearfix">        <div class="pull-left" data-editor></div>        <button type="button" class="btn bbf-del" data-action="remove">&times;</button>      </li>    '),e.editors.List.Object.template=e.editors.List.NestedModel.template=_.template('      <div class="bbf-list-modal"><%= summary %></div>    '))}(Backbone.Form),function(e){e.editors.List=e.editors.Base.extend({events:{},initialize:function(t){t=t||{};var i=e.editors;i.Base.prototype.initialize.call(this,t);var n=this.schema;if(!n)throw"Missing required option 'schema'";this.template=t.template||this.constructor.template,this.Editor=function(){var e=n.itemType;return e?i.List[e]?i.List[e]:i[e]:i.Text}(),this.items=[]},render:function(){var e=$($.trim(this.template()));return this.$list=e.is("[data-items]")?e:e.find("[data-items]"),this.renderItems(),this.setElement(e),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),this},renderItems:function(){var e=this,t=this.value||[];this.$list.empty(),t.length?_.each(t,function(t){e.addItem(t)}):this.Editor.isAsync||this.addItem()},addItem:function(t,i){var n=this,r=e.editors,s=new r.List.Item({list:this,form:this.form,schema:this.schema,value:t,Editor:this.Editor,key:this.key}).render(),o=function(){n.items.push(s),n.$list.append(s.el),s.editor.on("all",function(e){if("change"!==e){var t=_.toArray(arguments);t[0]="item:"+e,t.splice(1,0,n),r.List.prototype.trigger.apply(this,t)}},n),s.editor.on("change",function(){s.addEventTriggered||(s.addEventTriggered=!0,this.trigger("add",this,s.editor)),this.trigger("item:change",this,s.editor),this.trigger("change",this)},n),s.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},n),s.editor.on("blur",function(){if(this.hasFocus){var e=this;setTimeout(function(){_.find(e.items,function(e){return e.editor.hasFocus})||e.trigger("blur",e)},0)}},n),(i||t)&&(s.addEventTriggered=!0),i&&(n.trigger("add",n,s.editor),n.trigger("change",n))};return this.Editor.isAsync?s.editor.on("readyToAdd",o,this):(o(),s.editor.focus()),s},removeItem:function(e,t){var i=this.schema.confirmDelete;if(!i||confirm(i)){var t=t;this.items[t].remove(),this.items.splice(t,1),e.addEventTriggered&&(this.trigger("remove",this,e.editor),this.trigger("change",this)),this.items.length||this.Editor.isAsync||this.addItem()}},getValue:function(){var e=_.map(this.items,function(e){return e.getValue()});return _.without(e,void 0,"")},setValue:function(e){this.value=e,this.renderItems()},focus:function(){this.hasFocus||this.items[0]&&this.items[0].editor.focus()},blur:function(){if(this.hasFocus){var e=_.find(this.items,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},remove:function(){_.invoke(this.items,"remove"),e.editors.Base.prototype.remove.call(this)},validate:function(){if(!this.validators)return null;var e=_.map(this.items,function(e){return e.validate()}),t=_.compact(e).length?!0:!1;if(!t)return null;var i={type:"list",message:"Some of the items in the list failed validation",errors:e};return i}},{template:_.template('      <div >        <ul data-role="listview" id="resource_list" data-split-icon="delete" data-split-theme="a" data-inset="true" data-items></ul>        <div data-role="popup" id="resource_preview" data-overlay-theme="b" data-theme="b" data-corners="false">Replace me</div>      </div>    ',null,e.templateSettings)}),e.editors.List.Item=e.editors.Base.extend({events:{"keydown input[type=text]":function(e){13===e.keyCode&&(e.preventDefault(),this.list.addItem(),this.list.$list.find("> li:last input").focus())}},initialize:function(t){this.list=t.list,this.schema=t.schema||this.list.schema,this.value=t.value,this.Editor=t.Editor||e.editors.Text,this.key=t.key,this.template=t.template||this.schema.itemTemplate||this.constructor.template,this.errorClassName=t.errorClassName||this.constructor.errorClassName,this.form=t.form},render:function(){return this.editor=new this.Editor({key:this.key,schema:this.schema,value:this.value,list:this.list,item:this,tagName:"li",form:this.form}).render(),this.setElement($(this.editor.el)),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),Backbone.View.prototype.remove.call(this)},validate:function(){var e=this.getValue(),t=this.list.form?this.list.form.getValue():{},i=this.schema.validators,n=this.getValidator;if(!i)return null;var r=null;return _.every(i,function(i){return r=n(i)(e,t),r?!1:!0}),r?this.setError(r):this.clearError(),r?r:null},setError:function(e){this.$el.addClass(this.errorClassName),this.$el.attr("title",e.message)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$el.attr("title",null)}},{template:_.template("    ",null,e.templateSettings),errorClassName:"error"}),e.editors.List.Modal=e.editors.Base.extend({events:{},initialize:function(t){if(t=t||{},e.editors.Base.prototype.initialize.call(this,t),!e.editors.List.Modal.ModalAdapter)throw"A ModalAdapter is required";if(this.form=t.form,!t.form)throw'Missing required option: "form"';this.template=t.template||this.constructor.template},render:function(){var e=this;return _.isEmpty(this.value)?this.openEditor():(this.renderSummary(),setTimeout(function(){e.trigger("readyToAdd")},0)),this.hasFocus&&this.trigger("blur",this),this},renderSummary:function(){this.$el.html($.trim(this.template({summary:this.getStringValue()})))},itemToString:function(t){var i=function(t){var i={key:t};return e.Field.prototype.createTitle.call(i)};t=t||{};var n=[],r=!1,s=!1,o=!1,a=!1;_.each(this.nestedSchema,function(e,a){var l=e.title?e.title:i(a),u=t[a];(_.isUndefined(u)||_.isNull(u))&&(u=""),"mime_type"==a&&(s=u),"uuid"==a&&(o=u),"thumbnail"==a?r=u:("filename"==a||"uuid"==a||"size"==a)&&("size"==a&&0!=u&&(u=Math.round(parseInt(u)/1028)+"kB"),n.push(""+l+": "+u))});var l="<a data-action='remove' id='"+o+"'>Usuń Plik</a>";n.forEach(function(e,t){return n[t]=""+e+"<br>"});var u=new Image;return _.isBoolean(r)||_.isEmpty(r)?u.src="images/file.png":(u.src="data:"+s+";base64,"+r,a=!0),n.unshift(u.outerHTML),n.unshift("<a href='#resource_preview' data-rel='popup' data-position-to='window' id="+o+" data-preview="+a+">"),n.push("</a>"),n.push(l),n.join(" ")},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?"[Empty]":e.itemToString?e.itemToString(t):this.itemToString(t)},openEditor:function(){var t=this.form.constructor,i=this.modalForm=new t({schema:this.nestedSchema,data:this.value}),n=this.modal=new e.editors.List.Modal.ModalAdapter({content:i,animate:!0});n.open(),this.trigger("open",this),this.trigger("focus",this),n.on("cancel",this.onModalClosed,this),n.on("ok",_.bind(this.onModalSubmitted,this))},onModalSubmitted:function(){var e=this.modal,t=this.modalForm,i=!this.value,n=t.validate();return n?e.preventClose():(this.value=t.getValue(),this.renderSummary(),i&&this.trigger("readyToAdd"),this.trigger("change",this),this.onModalClosed(),void 0)},onModalClosed:function(){this.modal=null,this.modalForm=null,this.trigger("close",this),this.trigger("blur",this)},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){this.hasFocus||this.openEditor()},blur:function(){this.hasFocus&&this.modal&&this.modal.trigger("cancel")}},{template:_.template("      <%= summary %>    ",null,e.templateSettings),ModalAdapter:Backbone.BootstrapModal,isAsync:!0}),e.editors.List.Object=e.editors.List.Modal.extend({initialize:function(){e.editors.List.Modal.prototype.initialize.apply(this,arguments);var t=this.schema;if(!t.subSchema)throw'Missing required option "schema.subSchema"';this.nestedSchema=t.subSchema}}),e.editors.List.NestedModel=e.editors.List.Modal.extend({initialize:function(){e.editors.List.Modal.prototype.initialize.apply(this,arguments);var t=this.schema;if(!t.model)throw'Missing required option "schema.model"';var i=t.model.prototype.schema;this.nestedSchema=_.isFunction(i)?i():i},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?null:e.itemToString?e.itemToString(t):""+new e.model(t)}})}(Backbone.Form),function($){$.extend({tablesorter:new function(){function benchmark(e,t){log(e+","+((new Date).getTime()-t.getTime())+"ms")}function log(e){"undefined"!=typeof console&&console.debug!==void 0?console.log(e):alert(e)}function buildParserCache(e,t){if(e.config.debug)var i="";if(0!=e.tBodies.length){var n=e.tBodies[0].rows;if(n[0])for(var r=[],s=n[0].cells,o=s.length,a=0;o>a;a++){var l=!1;$.metadata&&$(t[a]).metadata()&&$(t[a]).metadata().sorter?l=getParserById($(t[a]).metadata().sorter):e.config.headers[a]&&e.config.headers[a].sorter&&(l=getParserById(e.config.headers[a].sorter)),l||(l=detectParserForColumn(e,n,-1,a)),e.config.debug&&(i+="column:"+a+" parser:"+l.id+"\n"),r.push(l)}return e.config.debug&&log(i),r}}function detectParserForColumn(e,t,i,n){for(var r=parsers.length,s=!1,o=!1,a=!0;""==o&&a;)i++,t[i]?(s=getNodeFromRowAndCellIndex(t,i,n),o=trimAndGetNodeText(e.config,s),e.config.debug&&log("Checking if value was empty on row:"+i)):a=!1;for(var l=1;r>l;l++)if(parsers[l].is(o,e,s))return parsers[l];return parsers[0]}function getNodeFromRowAndCellIndex(e,t,i){return e[t].cells[i]
}function trimAndGetNodeText(e,t){return $.trim(getElementText(e,t))}function getParserById(e){for(var t=parsers.length,i=0;t>i;i++)if(parsers[i].id.toLowerCase()==e.toLowerCase())return parsers[i];return!1}function buildCache(e){if(e.config.debug)var t=new Date;for(var i=e.tBodies[0]&&e.tBodies[0].rows.length||0,n=e.tBodies[0].rows[0]&&e.tBodies[0].rows[0].cells.length||0,r=e.config.parsers,s={row:[],normalized:[]},o=0;i>o;++o){var a=$(e.tBodies[0].rows[o]),l=[];if(a.hasClass(e.config.cssChildRow))s.row[s.row.length-1]=s.row[s.row.length-1].add(a);else{s.row.push(a);for(var u=0;n>u;++u)l.push(r[u].format(getElementText(e.config,a[0].cells[u]),e,a[0].cells[u]));l.push(s.normalized.length),s.normalized.push(l),l=null}}return e.config.debug&&benchmark("Building cache for "+i+" rows:",t),s}function getElementText(e,t){var i="";return t?(e.supportsTextContent||(e.supportsTextContent=t.textContent||!1),i="simple"==e.textExtraction?e.supportsTextContent?t.textContent:t.childNodes[0]&&t.childNodes[0].hasChildNodes()?t.childNodes[0].innerHTML:t.innerHTML:"function"==typeof e.textExtraction?e.textExtraction(t):$(t).text()):""}function appendToTable(e,t){if(e.config.debug)var i=new Date;for(var n=t,r=n.row,s=n.normalized,o=s.length,a=s[0].length-1,l=$(e.tBodies[0]),u=[],h=0;o>h;h++){var c=s[h][a];if(u.push(r[c]),!e.config.appender)for(var p=r[c].length,d=0;p>d;d++)l[0].appendChild(r[c][d])}e.config.appender&&e.config.appender(e,u),u=null,e.config.debug&&benchmark("Rebuilt table:",i),applyWidget(e),setTimeout(function(){$(e).trigger("sortEnd")},0)}function buildHeaders(e){if(e.config.debug)var t=new Date;$.metadata?!0:!1;var i=computeTableHeaderCellIndexes(e);return $tableHeaders=$(e.config.selectorHeaders,e).each(function(t){if(this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(e.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(e,t))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(e,t)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(e,t)),!this.sortDisabled){var n=$(this).addClass(e.config.cssHeader);e.config.onRenderHeader&&e.config.onRenderHeader.apply(n)}e.config.headerList[t]=this}),e.config.debug&&(benchmark("Built headers:",t),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(e){for(var t=[],i={},n=e.getElementsByTagName("THEAD")[0],r=n.getElementsByTagName("TR"),s=0;r.length>s;s++)for(var o=r[s].cells,a=0;o.length>a;a++){var l,u=o[a],h=u.parentNode.rowIndex,c=h+"-"+u.cellIndex,p=u.rowSpan||1,d=u.colSpan||1;t[h]===void 0&&(t[h]=[]);for(var f=0;t[h].length+1>f;f++)if(t[h][f]===void 0){l=f;break}i[c]=l;for(var f=h;h+p>f;f++){t[f]===void 0&&(t[f]=[]);for(var m=t[f],g=l;l+d>g;g++)m[g]="x"}}return i}function checkCellColSpan(e,t,i){for(var n=[],r=e.tHead.rows,s=r[i].cells,o=0;s.length>o;o++){var a=s[o];a.colSpan>1?n=n.concat(checkCellColSpan(e,headerArr,i++)):(1==e.tHead.length||a.rowSpan>1||!r[i+1])&&n.push(a)}return n}function checkHeaderMetadata(e){return $.metadata&&$(e).metadata().sorter===!1?!0:!1}function checkHeaderOptions(e,t){return e.config.headers[t]&&e.config.headers[t].sorter===!1?!0:!1}function checkHeaderOptionsSortingLocked(e,t){return e.config.headers[t]&&e.config.headers[t].lockedOrder?e.config.headers[t].lockedOrder:!1}function applyWidget(e){for(var t=e.config.widgets,i=t.length,n=0;i>n;n++)getWidgetById(t[n]).format(e)}function getWidgetById(e){for(var t=widgets.length,i=0;t>i;i++)if(widgets[i].id.toLowerCase()==e.toLowerCase())return widgets[i]}function formatSortingOrder(e){return"Number"!=typeof e?"desc"==e.toLowerCase()?1:0:1==e?1:0}function isValueInArray(e,t){for(var i=t.length,n=0;i>n;n++)if(t[n][0]==e)return!0;return!1}function setHeadersCss(e,t,i,n){t.removeClass(n[0]).removeClass(n[1]);var r=[];t.each(function(){this.sortDisabled||(r[this.column]=$(this))});for(var s=i.length,o=0;s>o;o++)r[i[o][0]].addClass(n[i[o][1]])}function fixColumnWidth(e){var t=e.config;if(t.widthFixed){var i=$("<colgroup>");$("tr:first td",e.tBodies[0]).each(function(){i.append($("<col>").css("width",$(this).width()))}),$(e).prepend(i)}}function updateHeaderSortCount(e,t){for(var i=e.config,n=t.length,r=0;n>r;r++){var s=t[r],o=i.headerList[s[0]];o.count=s[1],o.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;l>i;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?0==order?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):0==order?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;l>i;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+(""+sortList)+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(e,t,i){var n="a["+i+"]",r="b["+i+"]";return"text"==e&&"asc"==t?"("+n+" == "+r+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+r+" === null ? Number.NEGATIVE_INFINITY : ("+n+" < "+r+") ? -1 : 1 )));":"text"==e&&"desc"==t?"("+n+" == "+r+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+r+" === null ? Number.NEGATIVE_INFINITY : ("+r+" < "+n+") ? -1 : 1 )));":"numeric"==e&&"asc"==t?"("+n+" === null && "+r+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+r+" === null ? Number.NEGATIVE_INFINITY : "+n+" - "+r+"));":"numeric"==e&&"desc"==t?"("+n+" === null && "+r+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+r+" === null ? Number.NEGATIVE_INFINITY : "+r+" - "+n+"));":void 0}function makeSortText(e){return"((a["+e+"] < b["+e+"]) ? -1 : ((a["+e+"] > b["+e+"]) ? 1 : 0));"}function makeSortTextDesc(e){return"((b["+e+"] < a["+e+"]) ? -1 : ((b["+e+"] > a["+e+"]) ? 1 : 0));"}function makeSortNumeric(e){return"a["+e+"]-b["+e+"];"}function makeSortNumericDesc(e){return"b["+e+"]-a["+e+"];"}function sortText(e,t){return table.config.sortLocaleCompare?e.localeCompare(t):t>e?-1:e>t?1:0}function sortTextDesc(e,t){return table.config.sortLocaleCompare?t.localeCompare(e):e>t?-1:t>e?1:0}function sortNumeric(e,t){return e-t}function sortNumericDesc(e,t){return t-e}function getCachedSortType(e,t){return e[t].type}var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(e){return this.each(function(){if(this.tHead&&this.tBodies){var t,i,n,r;this.config={},r=$.extend(this.config,$.tablesorter.defaults,e),t=$(this),$.data(this,"tablesorter",r),i=buildHeaders(this),this.config.parsers=buildParserCache(this,i),n=buildCache(this);var s=[r.cssDesc,r.cssAsc];fixColumnWidth(this),i.click(function(e){var o=t[0].tBodies[0]&&t[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&o>0){t.trigger("sortStart"),$(this);var a=this.column;if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),e[r.sortMultiSortKey])if(isValueInArray(a,r.sortList))for(var l=0;r.sortList.length>l;l++){var u=r.sortList[l],h=r.headerList[u[0]];u[0]==a&&(h.count=u[1],h.count++,u[1]=h.count%2)}else r.sortList.push([a,this.order]);else{if(r.sortList=[],null!=r.sortForce)for(var c=r.sortForce,l=0;c.length>l;l++)c[l][0]!=a&&r.sortList.push(c[l]);r.sortList.push([a,this.order])}return setTimeout(function(){setHeadersCss(t[0],i,r.sortList,s),appendToTable(t[0],multisort(t[0],r.sortList,n))},1),!1}}).mousedown(function(){return r.cancelSelection?(this.onselectstart=function(){return!1},!1):void 0}),t.bind("update",function(){var e=this;setTimeout(function(){e.config.parsers=buildParserCache(e,i),n=buildCache(e)},1)}).bind("updateCell",function(e,t){var i=this.config,r=[t.parentNode.rowIndex-1,t.cellIndex];n.normalized[r[0]][r[1]]=i.parsers[r[1]].format(getElementText(i,t),t)}).bind("sorton",function(e,t){$(this).trigger("sortStart"),r.sortList=t;var o=r.sortList;updateHeaderSortCount(this,o),setHeadersCss(this,i,o,s),appendToTable(this,multisort(this,o,n))}).bind("appendCache",function(){appendToTable(this,n)}).bind("applyWidgetId",function(e,t){getWidgetById(t).format(this)}).bind("applyWidgets",function(){applyWidget(this)}),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(r.sortList=$(this).metadata().sortlist),r.sortList.length>0&&t.trigger("sorton",[r.sortList]),applyWidget(this)}})},this.addParser=function(e){for(var t=parsers.length,i=!0,n=0;t>n;n++)parsers[n].id.toLowerCase()==e.id.toLowerCase()&&(i=!1);i&&parsers.push(e)},this.addWidget=function(e){widgets.push(e)},this.formatFloat=function(e){var t=parseFloat(e);return isNaN(t)?0:t},this.formatInt=function(e){var t=parseInt(e);return isNaN(t)?0:t},this.isDigit=function(e){return/^[-+]?\d*$/.test($.trim(e.replace(/[,.']/g,"")))},this.clearTableBody=function(e){function t(){for(;this.firstChild;)this.removeChild(this.firstChild)}$.browser.msie?t.apply(e.tBodies[0]):e.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(){return!0},format:function(e){return $.trim(e.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(e,t){var i=t.config;return $.tablesorter.isDigit(e,i)},format:function(e){return $.tablesorter.formatFloat(e)},type:"numeric"}),ts.addParser({id:"currency",is:function(e){return/^[£$€?.]/.test(e)},format:function(e){return $.tablesorter.formatFloat(e.replace(RegExp(/[£$€]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(e){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(e)},format:function(e){for(var t=e.split("."),i="",n=t.length,r=0;n>r;r++){var s=t[r];i+=2==s.length?"0"+s:s}return $.tablesorter.formatFloat(i)},type:"numeric"}),ts.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\/$/.test(e)},format:function(e){return jQuery.trim(e.replace(RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},format:function(e){return $.tablesorter.formatFloat(""!=e?new Date(e.replace(RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(e){return/\%$/.test($.trim(e))},format:function(e){return $.tablesorter.formatFloat(e.replace(RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(e){return e.match(RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(e){return $.tablesorter.formatFloat(new Date(e).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(e){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(e)},format:function(e,t){var i=t.config;return e=e.replace(/\-/g,"/"),"us"==i.dateFormat?e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==i.dateFormat?e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):("dd/mm/yy"==i.dateFormat||"dd-mm-yy"==i.dateFormat)&&(e=e.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(e).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(e){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(e)},format:function(e){return $.tablesorter.formatFloat(new Date("2000/01/01 "+e).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(){return!1},format:function(e,t,i){var n=t.config,r=n.parserMetadataName?n.parserMetadataName:"sortValue";return $(i).metadata()[r]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(e){if(e.config.debug)var t=new Date;var i,n,r=-1;$("tr:visible",e.tBodies[0]).each(function(){i=$(this),i.hasClass(e.config.cssChildRow)||r++,n=0==r%2,i.removeClass(e.config.widgetZebra.css[n?0:1]).addClass(e.config.widgetZebra.css[n?1:0])}),e.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",t)}})}(jQuery);var CryptoJS=CryptoJS||function(e,t){var i={},n=i.lib={},r=function(){},s=n.Base={extend:function(e){r.prototype=this;var t=new r;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=n.WordArray=s.extend({init:function(e,i){e=this.words=e||[],this.sigBytes=i!=t?i:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var r=0;e>r;r++)t[n+r>>>2]|=(255&i[r>>>2]>>>24-8*(r%4))<<24-8*((n+r)%4);else if(i.length>65535)for(r=0;e>r;r+=4)t[n+r>>>2]=i[r>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-8*(i%4),t.length=e.ceil(i/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],n=0;t>n;n+=4)i.push(0|4294967296*e.random());return new o.init(i,t)}}),a=i.enc={},l=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;e>n;n++){var r=255&t[n>>>2]>>>24-8*(n%4);i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;t>n;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-4*(n%8);return new o.init(i,t/2)}},u=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;e>n;n++)i.push(String.fromCharCode(255&t[n>>>2]>>>24-8*(n%4)));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;t>n;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-8*(n%4);return new o.init(i,t)}},h=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},c=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,r=i.sigBytes,s=this.blockSize,a=r/(4*s),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*s,r=e.min(4*t,r),t){for(var l=0;t>l;l+=s)this._doProcessBlock(n,l);l=n.splice(0,t),i.sigBytes-=r}return new o.init(l,r)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new p.HMAC.init(e,i).finalize(t)}}});var p=i.algo={};return i}(Math);(function(e){for(var t=CryptoJS,i=t.lib,n=i.WordArray,r=i.Hasher,i=t.algo,s=[],o=[],a=function(e){return 0|4294967296*(e-(0|e))},l=2,u=0;64>u;){var h;e:{h=l;for(var c=e.sqrt(h),p=2;c>=p;p++)if(!(h%p)){h=!1;break e}h=!0}h&&(8>u&&(s[u]=a(e.pow(l,.5))),o[u]=a(e.pow(l,1/3)),u++),l++}var d=[],i=i.SHA256=r.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],a=i[3],l=i[4],u=i[5],h=i[6],c=i[7],p=0;64>p;p++){if(16>p)d[p]=0|e[t+p];else{var f=d[p-15],m=d[p-2];d[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+d[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+d[p-16]}f=c+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&u^~l&h)+o[p]+d[p],m=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&r^n&s^r&s),c=h,h=u,u=l,l=0|a+f,a=s,s=r,r=n,n=0|f+m}i[0]=0|i[0]+n,i[1]=0|i[1]+r,i[2]=0|i[2]+s,i[3]=0|i[3]+a,i[4]=0|i[4]+l,i[5]=0|i[5]+u,i[6]=0|i[6]+h,i[7]=0|i[7]+c},_doFinalize:function(){var t=this._data,i=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return i[r>>>5]|=128<<24-r%32,i[(r+64>>>9<<4)+14]=e.floor(n/4294967296),i[(r+64>>>9<<4)+15]=n,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(i),t.HmacSHA256=r._createHmacHelper(i)})(Math),function(){var e=CryptoJS,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,i){e=this._hasher=new e.init,"string"==typeof i&&(i=t.parse(i));var n=e.blockSize,r=4*n;i.sigBytes>r&&(i=e.finalize(i)),i.clamp();for(var s=this._oKey=i.clone(),o=this._iKey=i.clone(),a=s.words,l=o.words,u=0;n>u;u++)a[u]^=1549556828,l[u]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp(),e=[];for(var r=0;i>r;r+=3)for(var s=(255&t[r>>>2]>>>24-8*(r%4))<<16|(255&t[r+1>>>2]>>>24-8*((r+1)%4))<<8|255&t[r+2>>>2]>>>24-8*((r+2)%4),o=0;4>o&&i>r+.75*o;o++)e.push(n.charAt(63&s>>>6*(3-o)));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var i=e.length,n=this._map,r=n.charAt(64);r&&(r=e.indexOf(r),-1!=r&&(i=r));for(var r=[],s=0,o=0;i>o;o++)if(o%4){var a=n.indexOf(e.charAt(o-1))<<2*(o%4),l=n.indexOf(e.charAt(o))>>>6-2*(o%4);r[s>>>2]|=(a|l)<<24-8*(s%4),s++}return t.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:!0,_getScriptLocation:function(){for(var e,t,i=RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),n=document.getElementsByTagName("script"),r="",s=0,o=n.length;o>s;s++)if(e=n[s].getAttribute("src"),e&&(t=e.match(i))){r=t[1];break}return function(){return r}}(),ImgPath:""};OpenLayers.String={startsWith:function(e,t){return 0==e.indexOf(t)},contains:function(e,t){return-1!=e.indexOf(t)},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){for(var t=e.split("-"),i=t[0],n=1,r=t.length;r>n;n++){var s=t[n];i+=s.charAt(0).toUpperCase()+s.substring(1)}return i},format:function(e,t,i){t||(t=window);var n=function(e,n){for(var r,s=n.split(/\.+/),o=0;s.length>o&&(0==o&&(r=t),void 0!==r);o++)r=r[s[o]];return"function"==typeof r&&(r=i?r.apply(null,i):r()),r===void 0?"undefined":r};return e.replace(OpenLayers.String.tokenRegEx,n)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return OpenLayers.String.numberRegEx.test(e)},numericIf:function(e,t){var i=e;return t===!0&&null!=e&&e.replace&&(e=e.replace(/^\s*|\s*$/g,"")),OpenLayers.String.isNumeric(e)?parseFloat(e):i}},OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var i=0;return t>0&&(i=parseFloat(e.toPrecision(t))),i},format:function(e,t,i,n){t=t!==void 0?t:0,i=i!==void 0?i:OpenLayers.Number.thousandsSeparator,n=n!==void 0?n:OpenLayers.Number.decimalSeparator,null!=t&&(e=parseFloat(e.toFixed(t)));var r=(""+e).split(".");1==r.length&&null==t&&(t=0);var s=r[0];if(i)for(var o=/(-?[0-9]+)([0-9]{3})/;o.test(s);)s=s.replace(o,"$1"+i+"$2");var a;if(0==t)a=s;else{var l=r.length>1?r[1]:"0";null!=t&&(l+=Array(t-l.length+1).join("0")),a=s+n+l}return a},zeroPad:function(e,t,i){for(var n=e.toString(i||10);t>n.length;)n="0"+n;return n}},OpenLayers.Function={bind:function(e,t){var i=Array.prototype.slice.apply(arguments,[2]);return function(){var n=i.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,n)}},bindAsEventListener:function(e,t){return function(i){return e.call(t,i||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},OpenLayers.Array={filter:function(e,t,i){var n=[];if(Array.prototype.filter)n=e.filter(t,i);else{var r=e.length;if("function"!=typeof t)throw new TypeError;for(var s=0;r>s;s++)if(s in e){var o=e[s];t.call(i,o,s,e)&&n.push(o)}}return n}},OpenLayers.Class=function(){var e=arguments.length,t=arguments[0],i=arguments[e-1],n="function"==typeof i.initialize?i.initialize:function(){t.prototype.initialize.apply(this,arguments)};if(e>1){var r=[n,t].concat(Array.prototype.slice.call(arguments).slice(1,e-1),i);OpenLayers.inherit.apply(null,r)}else n.prototype=i;return n},OpenLayers.inherit=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i;var n,r,s;for(n=2,r=arguments.length;r>n;n++)s=arguments[n],"function"==typeof s&&(s=s.prototype),OpenLayers.Util.extend(e.prototype,s)},OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.extend=function(e,t){if(e=e||{},t){for(var i in t){var n=t[i];void 0!==n&&(e[i]=n)}var r="function"==typeof window.Event&&t instanceof window.Event;!r&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(e.toString=t.toString)}return e},OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(e,t,i,n){OpenLayers.Util.isArray(e)&&(n=e[3],i=e[2],t=e[1],e=e[0]),null!=e&&(this.left=OpenLayers.Util.toFloat(e)),null!=t&&(this.bottom=OpenLayers.Util.toFloat(t)),null!=i&&(this.right=OpenLayers.Util.toFloat(i)),null!=n&&(this.top=OpenLayers.Util.toFloat(n))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(e){var t=!1;return null!=e&&(t=this.left==e.left&&this.right==e.right&&this.top==e.top&&this.bottom==e.bottom),t},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(e,t){null==e&&(e=6);var i=Math.pow(10,e),n=Math.round(this.left*i)/i,r=Math.round(this.bottom*i)/i,s=Math.round(this.right*i)/i,o=Math.round(this.top*i)/i;return t===!0?r+","+n+","+o+","+s:n+","+r+","+s+","+o},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat},scale:function(e,t){null==t&&(t=this.getCenterLonLat());var i,n;"OpenLayers.LonLat"==t.CLASS_NAME?(i=t.lon,n=t.lat):(i=t.x,n=t.y);var r=(this.left-i)*e+i,s=(this.bottom-n)*e+n,o=(this.right-i)*e+i,a=(this.top-n)*e+n;return new OpenLayers.Bounds(r,s,o,a)},add:function(e,t){if(null==e||null==t)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+e,this.bottom+t,this.right+e,this.top+t)},extend:function(e){if(e)switch(e.CLASS_NAME){case"OpenLayers.LonLat":this.extendXY(e.lon,e.lat);break;case"OpenLayers.Geometry.Point":this.extendXY(e.x,e.y);break;case"OpenLayers.Bounds":this.centerLonLat=null,(null==this.left||e.left<this.left)&&(this.left=e.left),(null==this.bottom||e.bottom<this.bottom)&&(this.bottom=e.bottom),(null==this.right||e.right>this.right)&&(this.right=e.right),(null==this.top||e.top>this.top)&&(this.top=e.top)}},extendXY:function(e,t){this.centerLonLat=null,(null==this.left||this.left>e)&&(this.left=e),(null==this.bottom||this.bottom>t)&&(this.bottom=t),(null==this.right||e>this.right)&&(this.right=e),(null==this.top||t>this.top)&&(this.top=t)},containsLonLat:function(e,t){"boolean"==typeof t&&(t={inclusive:t}),t=t||{};var i=this.contains(e.lon,e.lat,t.inclusive),n=t.worldBounds;if(n&&!i){var r=n.getWidth(),s=(n.left+n.right)/2,o=Math.round((e.lon-s)/r);i=this.containsLonLat({lon:e.lon-o*r,lat:e.lat},{inclusive:t.inclusive})}return i},containsPixel:function(e,t){return this.contains(e.x,e.y,t)},contains:function(e,t,i){if(null==i&&(i=!0),null==e||null==t)return!1;e=OpenLayers.Util.toFloat(e),t=OpenLayers.Util.toFloat(t);var n=!1;return n=i?e>=this.left&&this.right>=e&&t>=this.bottom&&this.top>=t:e>this.left&&this.right>e&&t>this.bottom&&this.top>t},intersectsBounds:function(e,t){if("boolean"==typeof t&&(t={inclusive:t}),t=t||{},t.worldBounds){var i=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else i=this;null==t.inclusive&&(t.inclusive=!0);var n=!1,r=i.left==e.right||i.right==e.left||i.top==e.bottom||i.bottom==e.top;if(t.inclusive||!r){var s=e.bottom>=i.bottom&&e.bottom<=i.top||i.bottom>=e.bottom&&i.bottom<=e.top,o=e.top>=i.bottom&&e.top<=i.top||i.top>e.bottom&&i.top<e.top,a=e.left>=i.left&&e.left<=i.right||i.left>=e.left&&i.left<=e.right,l=e.right>=i.left&&e.right<=i.right||i.right>=e.left&&i.right<=e.right;n=(s||o)&&(a||l)}if(t.worldBounds&&!n){var u=t.worldBounds,h=u.getWidth(),c=!u.containsBounds(i),p=!u.containsBounds(e);c&&!p?(e=e.add(-h,0),n=i.intersectsBounds(e,{inclusive:t.inclusive})):p&&!c&&(i=i.add(-h,0),n=e.intersectsBounds(i,{inclusive:t.inclusive}))}return n},containsBounds:function(e,t,i){null==t&&(t=!1),null==i&&(i=!0);var n=this.contains(e.left,e.bottom,i),r=this.contains(e.right,e.bottom,i),s=this.contains(e.left,e.top,i),o=this.contains(e.right,e.top,i);return t?n||r||s||o:n&&r&&s&&o},determineQuadrant:function(e){var t="",i=this.getCenterLonLat();return t+=e.lat<i.lat?"b":"t",t+=e.lon<i.lon?"l":"r"},transform:function(e,t){this.centerLonLat=null;var i=OpenLayers.Projection.transform({x:this.left,y:this.bottom},e,t),n=OpenLayers.Projection.transform({x:this.right,y:this.bottom},e,t),r=OpenLayers.Projection.transform({x:this.left,y:this.top},e,t),s=OpenLayers.Projection.transform({x:this.right,y:this.top},e,t);return this.left=Math.min(i.x,r.x),this.bottom=Math.min(i.y,n.y),this.right=Math.max(n.x,s.x),this.top=Math.max(r.y,s.y),this},wrapDateLine:function(e,t){t=t||{};var i=t.leftTolerance||0,n=t.rightTolerance||0,r=this.clone();if(e){for(var s=e.getWidth();r.left<e.left&&r.right-n<=e.left;)r=r.add(s,0);for(;r.left+i>=e.right&&r.right>e.right;)r=r.add(-s,0);var o=r.left+i;e.right>o&&o>e.left&&r.right-n>e.right&&(r=r.add(-s,0))}return r},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(e,t){var i=e.split(",");return OpenLayers.Bounds.fromArray(i,t)},OpenLayers.Bounds.fromArray=function(e,t){return t===!0?new OpenLayers.Bounds(e[1],e[0],e[3],e[2]):new OpenLayers.Bounds(e[0],e[1],e[2],e[3])},OpenLayers.Bounds.fromSize=function(e){return new OpenLayers.Bounds(0,e.h,e.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(e){var t="";return t+="t"==e.charAt(0)?"b":"t",t+="l"==e.charAt(1)?"r":"l"},OpenLayers.Element={visible:function(e){return"none"!=OpenLayers.Util.getElement(e).style.display},toggle:function(){for(var e=0,t=arguments.length;t>e;e++){var i=OpenLayers.Util.getElement(arguments[e]),n=OpenLayers.Element.visible(i)?"none":"";i.style.display=n}},remove:function(e){e=OpenLayers.Util.getElement(e),e.parentNode.removeChild(e)},getHeight:function(e){return e=OpenLayers.Util.getElement(e),e.offsetHeight},hasClass:function(e,t){var i=e.className;return!!i&&RegExp("(^|\\s)"+t+"(\\s|$)").test(i)},addClass:function(e,t){return OpenLayers.Element.hasClass(e,t)||(e.className+=(e.className?" ":"")+t),e},removeClass:function(e,t){var i=e.className;return i&&(e.className=OpenLayers.String.trim(i.replace(RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))),e},toggleClass:function(e,t){return OpenLayers.Element.hasClass(e,t)?OpenLayers.Element.removeClass(e,t):OpenLayers.Element.addClass(e,t),e},getStyle:function(e,t){e=OpenLayers.Util.getElement(e);var i=null;if(e&&e.style){if(i=e.style[OpenLayers.String.camelize(t)],!i)if(document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(e,null);i=n?n.getPropertyValue(t):null}else e.currentStyle&&(i=e.currentStyle[OpenLayers.String.camelize(t)]);var r=["left","top","right","bottom"];window.opera&&-1!=OpenLayers.Util.indexOf(r,t)&&"static"==OpenLayers.Element.getStyle(e,"position")&&(i="auto")}return"auto"==i?null:i}},OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(e,t){OpenLayers.Util.isArray(e)&&(t=e[1],e=e[0]),this.lon=OpenLayers.Util.toFloat(e),this.lat=OpenLayers.Util.toFloat(t)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(e,t){if(null==e||null==t)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(e),this.lat+OpenLayers.Util.toFloat(t))},equals:function(e){var t=!1;return null!=e&&(t=this.lon==e.lon&&this.lat==e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t},transform:function(e,t){var i=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,t);return this.lon=i.x,this.lat=i.y,this},wrapDateLine:function(e){var t=this.clone();if(e){for(;t.lon<e.left;)t.lon+=e.getWidth();for(;t.lon>e.right;)t.lon-=e.getWidth()}return t},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(e){var t=e.split(",");return new OpenLayers.LonLat(t[0],t[1])},OpenLayers.LonLat.fromArray=function(e){var t=OpenLayers.Util.isArray(e),i=t&&e[0],n=t&&e[1];return new OpenLayers.LonLat(i,n)},OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(e,t){this.x=parseFloat(e),this.y=parseFloat(t)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(e){var t=!1;return null!=e&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},add:function(e,t){if(null==e||null==t)throw new TypeError("Pixel.add cannot receive null values");return new OpenLayers.Pixel(this.x+e,this.y+t)},offset:function(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t},CLASS_NAME:"OpenLayers.Pixel"}),OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(e,t){this.w=parseFloat(e),this.h=parseFloat(t)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(e){var t=!1;return null!=e&&(t=this.w==e.w&&this.h==e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t},CLASS_NAME:"OpenLayers.Size"}),OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(e){alert(e)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){for(var e=document.getElementsByTagName("script"),t=0,i=e.length;i>t;++t)if(-1!=e[t].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){return OpenLayers.Lang.code||OpenLayers.Lang.setCode(),OpenLayers.Lang.code
},setCode:function(e){var t;e||(e="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);var i=e.split("-");if(i[0]=i[0].toLowerCase(),"object"==typeof OpenLayers.Lang[i[0]]&&(t=i[0]),i[1]){var n=i[0]+"-"+i[1].toUpperCase();"object"==typeof OpenLayers.Lang[n]&&(t=n)}t||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+i.join("-")+" dictionary, falling back to default language"),t=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=t},translate:function(e,t){var i=OpenLayers.Lang[OpenLayers.Lang.getCode()],n=i&&i[e];return n||(n=e),t&&(n=OpenLayers.String.format(n,t)),n}},OpenLayers.i18n=OpenLayers.Lang.translate,OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.getElement=function(){for(var e=[],t=0,i=arguments.length;i>t;t++){var n=arguments[t];if("string"==typeof n&&(n=document.getElementById(n)),1==arguments.length)return n;e.push(n)}return e},OpenLayers.Util.isElement=function(e){return!(!e||1!==e.nodeType)},OpenLayers.Util.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},OpenLayers.Util.removeItem=function(e,t){for(var i=e.length-1;i>=0;i--)e[i]==t&&e.splice(i,1);return e},OpenLayers.Util.indexOf=function(e,t){if("function"==typeof e.indexOf)return e.indexOf(t);for(var i=0,n=e.length;n>i;i++)if(e[i]==t)return i;return-1},OpenLayers.Util.dotless=/\./g,OpenLayers.Util.modifyDOMElement=function(e,t,i,n,r,s,o,a){t&&(e.id=t.replace(OpenLayers.Util.dotless,"_")),i&&(e.style.left=i.x+"px",e.style.top=i.y+"px"),n&&(e.style.width=n.w+"px",e.style.height=n.h+"px"),r&&(e.style.position=r),s&&(e.style.border=s),o&&(e.style.overflow=o),parseFloat(a)>=0&&1>parseFloat(a)?(e.style.filter="alpha(opacity="+100*a+")",e.style.opacity=a):1==parseFloat(a)&&(e.style.filter="",e.style.opacity="")},OpenLayers.Util.createDiv=function(e,t,i,n,r,s,o,a){var l=document.createElement("div");return n&&(l.style.backgroundImage="url("+n+")"),e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),r||(r="absolute"),OpenLayers.Util.modifyDOMElement(l,e,t,i,r,s,o,a),l},OpenLayers.Util.createImage=function(e,t,i,n,r,s,o,a){function l(){u.style.display="",OpenLayers.Event.stopObservingElement(u)}var u=document.createElement("img");return e||(e=OpenLayers.Util.createUniqueID("OpenLayersDiv")),r||(r="relative"),OpenLayers.Util.modifyDOMElement(u,e,t,i,r,s,null,o),a&&(u.style.display="none",OpenLayers.Event.observe(u,"load",l),OpenLayers.Event.observe(u,"error",l)),u.style.alt=e,u.galleryImg="no",n&&(u.src=n),u},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var e=navigator.appVersion.split("MSIE"),t=parseFloat(e[1]),i=!1;try{i=!!document.body.filters}catch(n){}OpenLayers.Util.alphaHackNeeded=i&&t>=5.5&&7>t}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(e,t,i,n,r,s,o,a,l){OpenLayers.Util.modifyDOMElement(e,t,i,n,s,null,null,l);var u=e.childNodes[0];r&&(u.src=r),OpenLayers.Util.modifyDOMElement(u,e.id+"_innerImage",null,n,"relative",o),OpenLayers.Util.alphaHack()&&("none"!=e.style.display&&(e.style.display="inline-block"),null==a&&(a="scale"),e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+u.src+"', "+"sizingMethod='"+a+"')",parseFloat(e.style.opacity)>=0&&1>parseFloat(e.style.opacity)&&(e.style.filter+=" alpha(opacity="+100*e.style.opacity+")"),u.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(e,t,i,n,r,s,o,a,l){var u=OpenLayers.Util.createDiv(),h=OpenLayers.Util.createImage(null,null,null,null,null,null,null,l);return h.className="olAlphaImg",u.appendChild(h),OpenLayers.Util.modifyAlphaImageDiv(u,e,t,i,n,r,s,o,a),u},OpenLayers.Util.upperCaseObject=function(e){var t={};for(var i in e)t[i.toUpperCase()]=e[i];return t},OpenLayers.Util.applyDefaults=function(e,t){e=e||{};var i="function"==typeof window.Event&&t instanceof window.Event;for(var n in t)(void 0===e[n]||!i&&t.hasOwnProperty&&t.hasOwnProperty(n)&&!e.hasOwnProperty(n))&&(e[n]=t[n]);return!i&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")&&(e.toString=t.toString),e},OpenLayers.Util.getParameterString=function(e){var t=[];for(var i in e){var n=e[i];if(null!=n&&"function"!=typeof n){var r;if("object"==typeof n&&n.constructor==Array){for(var s,o=[],a=0,l=n.length;l>a;a++)s=n[a],o.push(encodeURIComponent(null===s||void 0===s?"":s));r=o.join(",")}else r=encodeURIComponent(n);t.push(encodeURIComponent(i)+"="+r)}}return t.join("&")},OpenLayers.Util.urlAppend=function(e,t){var i=e;if(t){var n=(e+" ").split(/[?&]/);i+=" "===n.pop()?t:n.length?"&"+t:"?"+t}return i},OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.getImageLocation=function(e){return OpenLayers.Util.getImagesLocation()+e},OpenLayers.Util.Try=function(){for(var e=null,t=0,i=arguments.length;i>t;t++){var n=arguments[t];try{e=n();break}catch(r){}}return e},OpenLayers.Util.getXmlNodeValue=function(e){var t=null;return OpenLayers.Util.Try(function(){t=e.text,t||(t=e.textContent),t||(t=e.firstChild.nodeValue)},function(){t=e.textContent}),t},OpenLayers.Util.mouseLeft=function(e,t){for(var i=e.relatedTarget?e.relatedTarget:e.toElement;i!=t&&null!=i;)i=i.parentNode;return i!=t},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(e,t){return null==t&&(t=OpenLayers.Util.DEFAULT_PRECISION),"number"!=typeof e&&(e=parseFloat(e)),0===t?e:parseFloat(e.toPrecision(t))},OpenLayers.Util.rad=function(e){return e*Math.PI/180},OpenLayers.Util.deg=function(e){return 180*e/Math.PI},OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},OpenLayers.Util.distVincenty=function(e,t){for(var i=OpenLayers.Util.VincentyConstants,n=i.a,r=i.b,s=i.f,o=OpenLayers.Util.rad(t.lon-e.lon),a=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(e.lat))),l=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(t.lat))),u=Math.sin(a),h=Math.cos(a),c=Math.sin(l),p=Math.cos(l),d=o,f=2*Math.PI,m=20;Math.abs(d-f)>1e-12&&--m>0;){var g=Math.sin(d),y=Math.cos(d),v=Math.sqrt(p*g*p*g+(h*c-u*p*y)*(h*c-u*p*y));if(0==v)return 0;var b=u*c+h*p*y,_=Math.atan2(v,b),w=Math.asin(h*p*g/v),x=Math.cos(w)*Math.cos(w),L=b-2*u*c/x,O=s/16*x*(4+s*(4-3*x));f=d,d=o+(1-O)*s*Math.sin(w)*(_+O*v*(L+O*b*(-1+2*L*L)))}if(0==m)return 0/0;var C=x*(n*n-r*r)/(r*r),E=1+C/16384*(4096+C*(-768+C*(320-175*C))),S=C/1024*(256+C*(-128+C*(74-47*C))),k=S*v*(L+S/4*(b*(-1+2*L*L)-S/6*L*(-3+4*v*v)*(-3+4*L*L))),T=r*E*(_-k),P=T.toFixed(3)/1e3;return P},OpenLayers.Util.destinationVincenty=function(e,t,i){for(var n=OpenLayers.Util,r=n.VincentyConstants,s=r.a,o=r.b,a=r.f,l=e.lon,u=e.lat,h=i,c=n.rad(t),p=Math.sin(c),d=Math.cos(c),f=(1-a)*Math.tan(n.rad(u)),m=1/Math.sqrt(1+f*f),g=f*m,y=Math.atan2(f,d),v=m*p,b=1-v*v,_=b*(s*s-o*o)/(o*o),w=1+_/16384*(4096+_*(-768+_*(320-175*_))),x=_/1024*(256+_*(-128+_*(74-47*_))),L=h/(o*w),O=2*Math.PI;Math.abs(L-O)>1e-12;){var C=Math.cos(2*y+L),E=Math.sin(L),S=Math.cos(L),k=x*E*(C+x/4*(S*(-1+2*C*C)-x/6*C*(-3+4*E*E)*(-3+4*C*C)));O=L,L=h/(o*w)+k}var T=g*E-m*S*d,P=Math.atan2(g*S+m*E*d,(1-a)*Math.sqrt(v*v+T*T)),q=Math.atan2(E*p,m*S-g*E*d),N=a/16*b*(4+a*(4-3*b)),F=q-(1-N)*a*v*(L+N*E*(C+N*S*(-1+2*C*C)));return Math.atan2(v,-T),new OpenLayers.LonLat(l+n.deg(F),n.deg(P))},OpenLayers.Util.getParameters=function(e,t){t=t||{},e=null===e||void 0===e?window.location.href:e;var i="";if(OpenLayers.String.contains(e,"?")){var n=e.indexOf("?")+1,r=OpenLayers.String.contains(e,"#")?e.indexOf("#"):e.length;i=e.substring(n,r)}for(var s={},o=i.split(/[&;]/),a=0,l=o.length;l>a;++a){var u=o[a].split("=");if(u[0]){var h=u[0];try{h=decodeURIComponent(h)}catch(c){h=unescape(h)}var p=(u[1]||"").replace(/\+/g," ");try{p=decodeURIComponent(p)}catch(c){p=unescape(p)}t.splitArgs!==!1&&(p=p.split(",")),1==p.length&&(p=p[0]),s[h]=p}}return s},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(e){return e=null==e?"id_":e.replace(OpenLayers.Util.dotless,"_"),OpenLayers.Util.lastSeqID+=1,e+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.37,km:39370,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1e3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(e){var t=e>1?1/e:e;return t},OpenLayers.Util.getResolutionFromScale=function(e,t){var i;if(e){null==t&&(t="degrees");var n=OpenLayers.Util.normalizeScale(e);i=1/(n*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH)}return i},OpenLayers.Util.getScaleFromResolution=function(e,t){null==t&&(t="degrees");var i=e*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH;return i},OpenLayers.Util.pagePosition=function(e){var t=[0,0],i=OpenLayers.Util.getViewportElement();if(!e||e==window||e==i)return t;var n,r=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&"absolute"==OpenLayers.Element.getStyle(e,"position")&&(""==e.style.top||""==e.style.left),s=null;if(e.getBoundingClientRect){n=e.getBoundingClientRect();var o=window.pageYOffset||i.scrollTop,a=window.pageXOffset||i.scrollLeft;t[0]=n.left+a,t[1]=n.top+o}else if(document.getBoxObjectFor&&!r){n=document.getBoxObjectFor(e);var l=document.getBoxObjectFor(i);t[0]=n.screenX-l.screenX,t[1]=n.screenY-l.screenY}else{if(t[0]=e.offsetLeft,t[1]=e.offsetTop,s=e.offsetParent,s!=e)for(;s;)t[0]+=s.offsetLeft,t[1]+=s.offsetTop,s=s.offsetParent;var u=OpenLayers.BROWSER_NAME;for(("opera"==u||"safari"==u&&"absolute"==OpenLayers.Element.getStyle(e,"position"))&&(t[1]-=document.body.offsetTop),s=e.offsetParent;s&&s!=document.body;)t[0]-=s.scrollLeft,("opera"!=u||"TR"!=s.tagName)&&(t[1]-=s.scrollTop),s=s.offsetParent}return t},OpenLayers.Util.getViewportElement=function(){var e=arguments.callee.viewportElement;return void 0==e&&(e="msie"==OpenLayers.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=e),e},OpenLayers.Util.isEquivalentUrl=function(e,t,i){i=i||{},OpenLayers.Util.applyDefaults(i,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0,splitArgs:!1});var n=OpenLayers.Util.createUrlObject(e,i),r=OpenLayers.Util.createUrlObject(t,i);for(var s in n)if("args"!==s&&n[s]!=r[s])return!1;for(var s in n.args){if(n.args[s]!=r.args[s])return!1;delete r.args[s]}for(var s in r.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(e,t){if(t=t||{},!/^\w+:\/\//.test(e)){var i=window.location,n=i.port?":"+i.port:"",r=i.protocol+"//"+i.host.split(":").shift()+n;if(0===e.indexOf("/"))e=r+e;else{var s=i.pathname.split("/");s.pop(),e=r+s.join("/")+"/"+e}}t.ignoreCase&&(e=e.toLowerCase());var o=document.createElement("a");o.href=e;var a={};a.host=o.host.split(":").shift(),a.protocol=o.protocol,a.port=t.ignorePort80?"80"==o.port||"0"==o.port?"":o.port:""==o.port||"0"==o.port?"80":o.port,a.hash=t.ignoreHash||"#"===o.hash?"":o.hash;var l=o.search;if(!l){var u=e.indexOf("?");l=-1!=u?e.substr(u):""}return a.args=OpenLayers.Util.getParameters(l,{splitArgs:t.splitArgs}),a.pathname="/"==o.pathname.charAt(0)?o.pathname:"/"+o.pathname,a},OpenLayers.Util.removeTail=function(e){var t=null,i=e.indexOf("?"),n=e.indexOf("#");return t=-1==i?-1!=n?e.substr(0,n):e:-1!=n?e.substr(0,Math.min(i,n)):e.substr(0,i)},OpenLayers.IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("webkit")&&-1!=e.indexOf("gecko")}(),OpenLayers.CANVAS_SUPPORTED=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),OpenLayers.BROWSER_NAME=function(){var e="",t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("opera")?e="opera":-1!=t.indexOf("msie")?e="msie":-1!=t.indexOf("safari")?e="safari":-1!=t.indexOf("mozilla")&&(e=-1!=t.indexOf("firefox")?"firefox":"mozilla"),e}(),OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME},OpenLayers.Util.getRenderedDimensions=function(e,t,i){var n,r,s=document.createElement("div");s.style.visibility="hidden";for(var o=i&&i.containerElement?i.containerElement:document.body,a=!1,l=null,u=o;u&&"body"!=u.tagName.toLowerCase();){var h=OpenLayers.Element.getStyle(u,"position");if("absolute"==h){a=!0;break}if(h&&"static"!=h)break;u=u.parentNode}!a||0!==o.clientHeight&&0!==o.clientWidth||(l=document.createElement("div"),l.style.visibility="hidden",l.style.position="absolute",l.style.overflow="visible",l.style.width=document.body.clientWidth+"px",l.style.height=document.body.clientHeight+"px",l.appendChild(s)),s.style.position="absolute",t&&(t.w?(n=t.w,s.style.width=n+"px"):t.h&&(r=t.h,s.style.height=r+"px")),i&&i.displayClass&&(s.className=i.displayClass);var c=document.createElement("div");if(c.innerHTML=e,c.style.overflow="visible",c.childNodes)for(var p=0,d=c.childNodes.length;d>p;p++)c.childNodes[p].style&&(c.childNodes[p].style.overflow="visible");return s.appendChild(c),l?o.appendChild(l):o.appendChild(s),n||(n=parseInt(c.scrollWidth),s.style.width=n+"px"),r||(r=parseInt(c.scrollHeight)),s.removeChild(c),l?(l.removeChild(s),o.removeChild(l)):o.removeChild(s),new OpenLayers.Size(n,r)},OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(null==e){var t=null,i=null,n=0,r=0;t=document.createElement("div"),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.width="100px",t.style.height="50px",t.style.overflow="hidden",i=document.createElement("div"),i.style.width="100%",i.style.height="200px",t.appendChild(i),document.body.appendChild(t),n=i.offsetWidth,t.style.overflow="scroll",r=i.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=n-r,e=OpenLayers.Util._scrollbarWidth}return e},OpenLayers.Util.getFormattedLonLat=function(e,t,i){i||(i="dms"),e=(e+540)%360-180;var n=Math.abs(e),r=Math.floor(n),s=(n-r)/(1/60),o=s;s=Math.floor(s);var a=(o-s)/(1/60);a=Math.round(10*a),a/=10,a>=60&&(a-=60,s+=1,s>=60&&(s-=60,r+=1)),10>r&&(r="0"+r);var l=r+"°";return i.indexOf("dm")>=0&&(10>s&&(s="0"+s),l+=s+"'",i.indexOf("dms")>=0&&(10>a&&(a="0"+a),l+=a+'"')),l+="lon"==t?0>e?OpenLayers.i18n("W"):OpenLayers.i18n("E"):0>e?OpenLayers.i18n("S"):OpenLayers.i18n("N")},OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&1==e.touches.length},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&1==e.which||e.button&&1==e.button},isRightClick:function(e){return e.which&&3==e.which||e.button&&2==e.button},stop:function(e,t){t||OpenLayers.Event.preventDefault(e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},findElement:function(e,t){for(var i=OpenLayers.Event.element(e);i.parentNode&&(!i.tagName||i.tagName.toUpperCase()!=t.toUpperCase());)i=i.parentNode;return i},observe:function(e,t,i,n){var r=OpenLayers.Util.getElement(e);if(n=n||!1,"keypress"==t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||r.attachEvent)&&(t="keydown"),this.observers||(this.observers={}),!r._eventCacheID){var s="eventCacheID_";r.id&&(s=r.id+"_"+s),r._eventCacheID=OpenLayers.Util.createUniqueID(s)}var o=r._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:r,name:t,observer:i,useCapture:n}),r.addEventListener?r.addEventListener(t,i,n):r.attachEvent&&r.attachEvent("on"+t,i)},stopObservingElement:function(e){var t=OpenLayers.Util.getElement(e),i=t._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[i])},_removeElementObservers:function(e){if(e)for(var t=e.length-1;t>=0;t--){var i=e[t];OpenLayers.Event.stopObserving.apply(this,[i.element,i.name,i.observer,i.useCapture])}},stopObserving:function(e,t,i,n){n=n||!1;var r=OpenLayers.Util.getElement(e),s=r._eventCacheID;"keypress"==t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||r.detachEvent)&&(t="keydown");var o=!1,a=OpenLayers.Event.observers[s];if(a)for(var l=0;!o&&a.length>l;){var u=a[l];if(u.name==t&&u.observer==i&&u.useCapture==n){a.splice(l,1),0==a.length&&delete OpenLayers.Event.observers[s],o=!0;break}l++}return o&&(r.removeEventListener?r.removeEventListener(t,i,n):r&&r.detachEvent&&r.detachEvent("on"+t,i)),o},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var e in OpenLayers.Event.observers){var t=OpenLayers.Event.observers[e];OpenLayers.Event._removeElementObservers.apply(this,[t])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1),OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(e,t,i,n,r){OpenLayers.Util.extend(this,r),this.object=e,this.fallThrough=n,this.listeners={},this.extensions={},this.extensionCount={},this._msTouches=[],null!=t&&this.attachToElement(t)},destroy:function(){for(var e in this.extensions)"boolean"!=typeof this.extensions[e]&&this.extensions[e].destroy();this.extensions=null,this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(){},attachToElement:function(e){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)),this.element=e;for(var t,i=!!window.navigator.msMaxTouchPoints,n=0,r=this.BROWSER_EVENTS.length;r>n;n++)t=this.BROWSER_EVENTS[n],OpenLayers.Event.observe(e,t,this.eventHandler),i&&0===t.indexOf("touch")&&this.addMsTouchListener(e,t,this.eventHandler);OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(e){for(var t in e)"scope"!=t&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])},register:function(e,t,i,n){if(e in OpenLayers.Events&&!this.extensions[e]&&(this.extensions[e]=new OpenLayers.Events[e](this)),null!=i){null==t&&(t=this.object);var r=this.listeners[e];r||(r=[],this.listeners[e]=r,this.extensionCount[e]=0);var s={obj:t,func:i};n?(r.splice(this.extensionCount[e],0,s),"object"==typeof n&&n.extension&&this.extensionCount[e]++):r.push(s)}},registerPriority:function(e,t,i){this.register(e,t,i,!0)},un:function(e){for(var t in e)"scope"!=t&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])},unregister:function(e,t,i){null==t&&(t=this.object);var n=this.listeners[e];if(null!=n)for(var r=0,s=n.length;s>r;r++)if(n[r].obj==t&&n[r].func==i){n.splice(r,1);break}},remove:function(e){null!=this.listeners[e]&&(this.listeners[e]=[])},triggerEvent:function(e,t){var i=this.listeners[e];if(!i||0==i.length)return void 0;null==t&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e),i=i.slice();for(var n,r=0,s=i.length;s>r;r++){var o=i[r];if(n=o.func.apply(o.obj,[t]),void 0!=n&&0==n)break}return this.fallThrough||OpenLayers.Event.stop(t,!0),n},handleBrowserEvent:function(e){var t=e.type,i=this.listeners[t];if(i&&0!=i.length){var n=e.touches;if(n&&n[0]){for(var r,s=0,o=0,a=n.length,l=0;a>l;++l)r=this.getTouchClientXY(n[l]),s+=r.clientX,o+=r.clientY;e.clientX=s/a,e.clientY=o/a}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)}},getTouchClientXY:function(e){var t=window.olMockWin||window,i=t.pageXOffset,n=t.pageYOffset,r=e.clientX,s=e.clientY;return 0===e.pageY&&Math.floor(s)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(r)>Math.floor(e.pageX)?(r-=i,s-=n):(e.pageY-n>s||e.pageX-i>r)&&(r=e.pageX-i,s=e.pageY-n),e.olClientX=r,e.olClientY=s,{clientX:r,clientY:s}},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null,this.element.offsets=null},getMousePosition:function(e){if(this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),!this.element.scrolls){var t=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||t.scrollLeft,window.pageYOffset||t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element)),new OpenLayers.Pixel(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(e,t,i){function n(e){i(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var e=r.length-1;e>=0;--e)r[e].stopPropagation()},preventDefault:function(){for(var e=r.length-1;e>=0;--e)r[e].preventDefault()},type:t},e))}this.eventHandler;var r=this._msTouches;switch(t){case"touchstart":return this.addMsTouchListenerStart(e,t,n);case"touchend":return this.addMsTouchListenerEnd(e,t,n);case"touchmove":return this.addMsTouchListenerMove(e,t,n);default:throw"Unknown touch event type"}},addMsTouchListenerStart:function(e,t,i){var n=this._msTouches,r=function(e){for(var t=!1,r=0,s=n.length;s>r;++r)if(n[r].pointerId==e.pointerId){t=!0;break}t||n.push(e),e.touches=n.slice(),i(e)};OpenLayers.Event.observe(e,"MSPointerDown",r);var s=function(e){for(var t=0,i=n.length;i>t;++t)if(n[t].pointerId==e.pointerId){n.splice(t,1);break}};OpenLayers.Event.observe(e,"MSPointerUp",s)},addMsTouchListenerMove:function(e,t,i){var n=this._msTouches,r=function(e){if(!(e.pointerType==e.MSPOINTER_TYPE_MOUSE&&0==e.buttons||1==n.length&&n[0].pageX==e.pageX&&n[0].pageY==e.pageY)){for(var t=0,r=n.length;r>t;++t)if(n[t].pointerId==e.pointerId){n[t]=e;break}e.touches=n.slice(),i(e)}};OpenLayers.Event.observe(e,"MSPointerMove",r)},addMsTouchListenerEnd:function(e,t,i){var n=this._msTouches,r=function(e){for(var t=0,r=n.length;r>t;++t)if(n[t].pointerId==e.pointerId){n.splice(t,1);break}e.touches=n.slice(),i(e)};OpenLayers.Event.observe(e,"MSPointerUp",r)},CLASS_NAME:"OpenLayers.Events"}),OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(e){this.target=e;for(var t=this.events.length-1;t>=0;--t)this.target.register(this.events[t],this,this.buttonClick,{extension:!0})},destroy:function(){for(var e=this.events.length-1;e>=0;--e)this.target.unregister(this.events[e],this,this.buttonClick);delete this.target},getPressedButton:function(e){var t,i=3;do{if(OpenLayers.Element.hasClass(e,"olButton")){t=e;break}e=e.parentNode}while(--i>0&&e);return t},ignore:function(e){var t=3,i=!1;do{if("a"===e.nodeName.toLowerCase()){i=!0;break}e=e.parentNode}while(--t>0&&e);return i},buttonClick:function(e){var t=!0,i=OpenLayers.Event.element(e);if(i&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){var n=this.getPressedButton(i);if(n){if("keydown"===e.type)switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:n}),OpenLayers.Event.stop(e),t=!1}else if(this.startEvt){if(this.completeRegEx.test(e.type)){var r=OpenLayers.Util.pagePosition(n),s=OpenLayers.Util.getViewportElement(),o=window.pageYOffset||s.scrollTop,a=window.pageXOffset||s.scrollLeft;r[0]=r[0]-a,r[1]=r[1]-o,this.target.triggerEvent("buttonclick",{buttonElement:n,buttonXY:{x:this.startEvt.clientX-r[0],y:this.startEvt.clientY-r[1]}})}this.cancelRegEx.test(e.type)&&delete this.startEvt,OpenLayers.Event.stop(e),t=!1}this.startRegEx.test(e.type)&&(this.startEvt=e,OpenLayers.Event.stop(e),t=!1)}else t=!this.ignore(OpenLayers.Event.element(e)),delete this.startEvt}return t}}),OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(e){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,e),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){if(this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null),this.handlers){for(var e in this.handlers)this.handlers.hasOwnProperty(e)&&"function"==typeof this.handlers[e].destroy&&this.handlers[e].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null),this.div=null},setMap:function(e){this.map=e,this.handler&&this.handler.setMap(e)},draw:function(e){return null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&&(this.div.title=this.title)),null!=e&&(this.position=e.clone()),this.moveTo(this.position),this.div},moveTo:function(e){null!=e&&null!=this.div&&(this.div.style.left=e.x+"px",this.div.style.top=e.y+"px")},activate:function(){return this.active?!1:(this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate"),!0)},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(e){e&&(this.bounds=e.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)},getBounds:function(){return null==this.bounds&&this.calculateBounds(),this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(e,t,i){var n=!1,r=this.getBounds();if(null!=r&&null!=e){var s=null!=t?t:0,o=null!=i?i:0,a=new OpenLayers.Bounds(this.bounds.left-s,this.bounds.bottom-o,this.bounds.right+s,this.bounds.top+o);n=a.containsLonLat(e)}return n},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var e;return e=OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(e){var t;if(OpenLayers.Format&&OpenLayers.Format.WKT){var i=OpenLayers.Geometry.fromWKT.format;i||(i=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=i);var n=i.read(e);if(n instanceof OpenLayers.Feature.Vector)t=n.geometry;else if(OpenLayers.Util.isArray(n)){for(var r=n.length,s=Array(r),o=0;r>o;++o)s[o]=n[o].geometry;t=new OpenLayers.Geometry.Collection(s)}}return t},OpenLayers.Geometry.segmentsIntersect=function(e,t,i){var n=i&&i.point,r=i&&i.tolerance,s=!1,o=e.x1-t.x1,a=e.y1-t.y1,l=e.x2-e.x1,u=e.y2-e.y1,h=t.y2-t.y1,c=t.x2-t.x1,p=h*l-c*u,d=c*a-h*o,f=l*a-u*o;if(0==p)0==d&&0==f&&(s=!0);else{var m=d/p,g=f/p;if(m>=0&&1>=m&&g>=0&&1>=g)if(n){var y=e.x1+m*l,v=e.y1+m*u;s=new OpenLayers.Geometry.Point(y,v)}else s=!0}if(r){var b;if(s){if(n){var _,y,v,w=[e,t];
e:for(var x=0;2>x;++x){_=w[x];for(var L=1;3>L;++L)if(y=_["x"+L],v=_["y"+L],b=Math.sqrt(Math.pow(y-s.x,2)+Math.pow(v-s.y,2)),r>b){s.x=y,s.y=v;break e}}}}else{var O,C,y,v,E,S,w=[e,t];e:for(var x=0;2>x;++x){O=w[x],C=w[(x+1)%2];for(var L=1;3>L;++L)if(E={x:O["x"+L],y:O["y"+L]},S=OpenLayers.Geometry.distanceToSegment(E,C),r>S.distance){s=n?new OpenLayers.Geometry.Point(E.x,E.y):!0;break e}}}}return s},OpenLayers.Geometry.distanceToSegment=function(e,t){var i=OpenLayers.Geometry.distanceSquaredToSegment(e,t);return i.distance=Math.sqrt(i.distance),i},OpenLayers.Geometry.distanceSquaredToSegment=function(e,t){var i,n,r=e.x,s=e.y,o=t.x1,a=t.y1,l=t.x2,u=t.y2,h=l-o,c=u-a,p=(h*(r-o)+c*(s-a))/(Math.pow(h,2)+Math.pow(c,2));return 0>=p?(i=o,n=a):p>=1?(i=l,n=u):(i=o+p*h,n=a+p*c),{distance:Math.pow(i-r,2)+Math.pow(n-s,2),x:i,y:n,along:p}},OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],null!=e&&this.addComponents(e)},destroy:function(){this.components.length=0,this.components=null,OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var geometry=eval("new "+this.CLASS_NAME+"()"),i=0,len=this.components.length;len>i;i++)geometry.addComponent(this.components[i].clone());return OpenLayers.Util.applyDefaults(geometry,this),geometry},getComponentsString:function(){for(var e=[],t=0,i=this.components.length;i>t;t++)e.push(this.components[t].toShortString());return e.join(",")},calculateBounds:function(){this.bounds=null;var e=new OpenLayers.Bounds,t=this.components;if(t)for(var i=0,n=t.length;n>i;i++)e.extend(t[i].getBounds());null!=e.left&&null!=e.bottom&&null!=e.right&&null!=e.top&&this.setBounds(e)},addComponents:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,i=e.length;i>t;t++)this.addComponent(e[t])},addComponent:function(e,t){var i=!1;if(e&&(null==this.componentTypes||OpenLayers.Util.indexOf(this.componentTypes,e.CLASS_NAME)>-1)){if(null!=t&&this.components.length>t){var n=this.components.slice(0,t),r=this.components.slice(t,this.components.length);n.push(e),this.components=n.concat(r)}else this.components.push(e);e.parent=this,this.clearBounds(),i=!0}return i},removeComponents:function(e){var t=!1;OpenLayers.Util.isArray(e)||(e=[e]);for(var i=e.length-1;i>=0;--i)t=this.removeComponent(e[i])||t;return t},removeComponent:function(e){return OpenLayers.Util.removeItem(this.components,e),this.clearBounds(),!0},getLength:function(){for(var e=0,t=0,i=this.components.length;i>t;t++)e+=this.components[t].getLength();return e},getArea:function(){for(var e=0,t=0,i=this.components.length;i>t;t++)e+=this.components[t].getArea();return e},getGeodesicArea:function(e){for(var t=0,i=0,n=this.components.length;n>i;i++)t+=this.components[i].getGeodesicArea(e);return t},getCentroid:function(e){if(!e)return this.components.length&&this.components[0].getCentroid();var t=this.components.length;if(!t)return!1;for(var i,n=[],r=[],s=0,o=Number.MAX_VALUE,a=0;t>a;++a){i=this.components[a];var l=i.getArea(),u=i.getCentroid(!0);isNaN(l)||isNaN(u.x)||isNaN(u.y)||(n.push(l),s+=l,o=o>l&&l>0?l:o,r.push(u))}if(t=n.length,0===s){for(var a=0;t>a;++a)n[a]=1;s=n.length}else{for(var a=0;t>a;++a)n[a]/=o;s/=o}for(var u,l,h=0,c=0,a=0;t>a;++a)u=r[a],l=n[a],h+=u.x*l,c+=u.y*l;return new OpenLayers.Geometry.Point(h/s,c/s)},getGeodesicLength:function(e){for(var t=0,i=0,n=this.components.length;n>i;i++)t+=this.components[i].getGeodesicLength(e);return t},move:function(e,t){for(var i=0,n=this.components.length;n>i;i++)this.components[i].move(e,t)},rotate:function(e,t){for(var i=0,n=this.components.length;n>i;++i)this.components[i].rotate(e,t)},resize:function(e,t,i){for(var n=0;this.components.length>n;++n)this.components[n].resize(e,t,i);return this},distanceTo:function(e,t){for(var i,n,r,s=!(t&&t.edge===!1),o=s&&t&&t.details,a=Number.POSITIVE_INFINITY,l=0,u=this.components.length;u>l&&(i=this.components[l].distanceTo(e,t),r=o?i.distance:i,!(a>r&&(a=r,n=i,0==a)));++l);return n},equals:function(e){var t=!0;if(e&&e.CLASS_NAME&&this.CLASS_NAME==e.CLASS_NAME)if(OpenLayers.Util.isArray(e.components)&&e.components.length==this.components.length){for(var i=0,n=this.components.length;n>i;++i)if(!this.components[i].equals(e.components[i])){t=!1;break}}else t=!1;else t=!1;return t},transform:function(e,t){if(e&&t){for(var i=0,n=this.components.length;n>i;i++){var r=this.components[i];r.transform(e,t)}this.bounds=null}return this},intersects:function(e){for(var t=!1,i=0,n=this.components.length;n>i&&!(t=e.intersects(this.components[i]));++i);return t},getVertices:function(e){for(var t=[],i=0,n=this.components.length;n>i;++i)Array.prototype.push.apply(t,this.components[i].getVertices(e));return t},CLASS_NAME:"OpenLayers.Geometry.Collection"}),OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(e,t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(e),this.y=parseFloat(t)},clone:function(e){return null==e&&(e=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(e,this),e},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(e,t){var i,n,r,s,o,a,l=!(t&&t.edge===!1),u=l&&t&&t.details;return e instanceof OpenLayers.Geometry.Point?(n=this.x,r=this.y,s=e.x,o=e.y,i=Math.sqrt(Math.pow(n-s,2)+Math.pow(r-o,2)),a=u?{x0:n,y0:r,x1:s,y1:o,distance:i}:i):(a=e.distanceTo(this,t),u&&(a={x0:a.x1,y0:a.y1,x1:a.x0,y1:a.y0,distance:a.distance})),a},equals:function(e){var t=!1;return null!=e&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t},toShortString:function(){return this.x+", "+this.y},move:function(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()},rotate:function(e,t){e*=Math.PI/180;var i=this.distanceTo(t),n=e+Math.atan2(this.y-t.y,this.x-t.x);this.x=t.x+i*Math.cos(n),this.y=t.y+i*Math.sin(n),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,t,i){return i=void 0==i?1:i,this.x=t.x+e*i*(this.x-t.x),this.y=t.y+e*(this.y-t.y),this.clearBounds(),this},intersects:function(e){var t=!1;return t="OpenLayers.Geometry.Point"==e.CLASS_NAME?this.equals(e):e.intersects(this)},transform:function(e,t){return e&&t&&(OpenLayers.Projection.transform(this,e,t),this.bounds=null),this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(e,t){this.addComponent(e,t)},removePoint:function(e){this.removeComponent(e)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&this.components.length>1)for(var t=1,i=this.components.length;i>t;t++)e+=this.components[t-1].distanceTo(this.components[t]);return e},getGeodesicLength:function(e){var t=this;if(e){var i=new OpenLayers.Projection("EPSG:4326");i.equals(e)||(t=this.clone().transform(e,i))}var n=0;if(t.components&&t.components.length>1)for(var r,s,o=1,a=t.components.length;a>o;o++)r=t.components[o-1],s=t.components[o],n+=OpenLayers.Util.distVincenty({lon:r.x,lat:r.y},{lon:s.x,lat:s.y});return 1e3*n},CLASS_NAME:"OpenLayers.Geometry.Curve"}),OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(){var e=this.components&&this.components.length>2;return e&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),e},intersects:function(e){var t=!1,i=e.CLASS_NAME;if("OpenLayers.Geometry.LineString"==i||"OpenLayers.Geometry.LinearRing"==i||"OpenLayers.Geometry.Point"==i){var n,r=this.getSortedSegments();n="OpenLayers.Geometry.Point"==i?[{x1:e.x,y1:e.y,x2:e.x,y2:e.y}]:e.getSortedSegments();var s,o,a,l,u,h,c,p;e:for(var d=0,f=r.length;f>d;++d){s=r[d],o=s.x1,a=s.x2,l=s.y1,u=s.y2;for(var m=0,g=n.length;g>m&&(h=n[m],!(h.x1>a));++m)if(!(o>h.x2||(c=h.y1,p=h.y2,Math.min(c,p)>Math.max(l,u)||Math.max(c,p)<Math.min(l,u)||!OpenLayers.Geometry.segmentsIntersect(s,h)))){t=!0;break e}}}else t=e.intersects(this);return t},getSortedSegments:function(){function e(e,t){return e.x1-t.x1}for(var t,i,n=this.components.length-1,r=Array(n),s=0;n>s;++s)t=this.components[s],i=this.components[s+1],r[s]=t.x<i.x?{x1:t.x,y1:t.y,x2:i.x,y2:i.y}:{x1:i.x,y1:i.y,x2:t.x,y2:t.y};return r.sort(e)},splitWithSegment:function(e,t){for(var i,n,r,s,o,a=!(t&&t.edge===!1),l=t&&t.tolerance,u=[],h=this.getVertices(),c=[],p=[],d=!1,f={point:!0,tolerance:l},m=null,g=0,y=h.length-2;y>=g;++g)if(i=h[g],c.push(i.clone()),n=h[g+1],o={x1:i.x,y1:i.y,x2:n.x,y2:n.y},r=OpenLayers.Geometry.segmentsIntersect(e,o,f),r instanceof OpenLayers.Geometry.Point&&(s=r.x===e.x1&&r.y===e.y1||r.x===e.x2&&r.y===e.y2||r.equals(i)||r.equals(n)?!0:!1,s||a)){if(r.equals(p[p.length-1])||p.push(r.clone()),0===g&&r.equals(i))continue;if(r.equals(n))continue;d=!0,r.equals(i)||c.push(r),u.push(new OpenLayers.Geometry.LineString(c)),c=[r.clone()]}if(d&&(c.push(n.clone()),u.push(new OpenLayers.Geometry.LineString(c))),p.length>0){var v=e.x1<e.x2?1:-1,b=e.y1<e.y2?1:-1;m={lines:u,points:p.sort(function(e,t){return v*e.x-v*t.x||b*e.y-b*t.y})}}return m},split:function(e,t){var i,n,r,s,o=null,a=t&&t.mutual;if(e instanceof OpenLayers.Geometry.LineString){var l,u,h,c,p,d,f=this.getVertices(),m=[];r=[];for(var g=0,y=f.length-2;y>=g;++g){l=f[g],u=f[g+1],h={x1:l.x,y1:l.y,x2:u.x,y2:u.y},s=s||[e],a&&m.push(l.clone());for(var v=0;s.length>v;++v)if(c=s[v].splitWithSegment(h,t),c&&(p=c.lines,p.length>0&&(p.unshift(v,1),Array.prototype.splice.apply(s,p),v+=p.length-2),a))for(var b=0,_=c.points.length;_>b;++b)d=c.points[b],d.equals(l)||(m.push(d),r.push(new OpenLayers.Geometry.LineString(m)),m=d.equals(u)?[]:[d.clone()])}a&&r.length>0&&m.length>0&&(m.push(u.clone()),r.push(new OpenLayers.Geometry.LineString(m)))}else o=e.splitWith(this,t);return s&&s.length>1?n=!0:s=[],r&&r.length>1?i=!0:r=[],(n||i)&&(o=a?[r,s]:s),o},splitWith:function(e,t){return e.split(this,t)},getVertices:function(e){var t;return t=e===!0?[this.components[0],this.components[this.components.length-1]]:e===!1?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(e,t){var i,n=!(t&&t.edge===!1),r=n&&t&&t.details,s={},o=Number.POSITIVE_INFINITY;if(e instanceof OpenLayers.Geometry.Point){for(var a,l=this.getSortedSegments(),u=e.x,h=e.y,c=0,p=l.length;p>c;++c)if(a=l[c],i=OpenLayers.Geometry.distanceToSegment(e,a),o>i.distance){if(o=i.distance,s=i,0===o)break}else if(a.x2>u&&(h>a.y1&&a.y2>h||a.y1>h&&h>a.y2))break;s=r?{distance:s.distance,x0:s.x,y0:s.y,x1:u,y1:h}:s.distance}else if(e instanceof OpenLayers.Geometry.LineString){var d,f,m,g,y,v=this.getSortedSegments(),b=e.getSortedSegments(),_=b.length,w={point:!0};e:for(var c=0,p=v.length;p>c;++c){d=v[c],g=d.x1,y=d.y1;for(var x=0;_>x;++x){if(f=b[x],m=OpenLayers.Geometry.segmentsIntersect(d,f,w)){o=0,s={distance:0,x0:m.x,y0:m.y,x1:m.x,y1:m.y};break e}i=OpenLayers.Geometry.distanceToSegment({x:g,y:y},f),o>i.distance&&(o=i.distance,s={distance:o,x0:g,y0:y,x1:i.x,y1:i.y})}}if(r||(s=s.distance),0!==o&&d){i=e.distanceTo(new OpenLayers.Geometry.Point(d.x2,d.y2),t);var L=r?i.distance:i;o>L&&(s=r?{distance:o,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}:L)}}else s=e.distanceTo(this,t),r&&(s={distance:s.distance,x0:s.x1,y0:s.y1,x1:s.x0,y1:s.y0});return s},simplify:function(e){if(this&&null!==this){var t=this.getVertices();if(3>t.length)return this;var i=function(e,t){return e-t},n=function(e,t,i,s){for(var o,l=0,u=0,h=t;i>h;h++)o=r(e[t],e[i],e[h]),o>l&&(l=o,u=h);l>s&&u!=t&&(a.push(u),n(e,t,u,s),n(e,u,i,s))},r=function(e,t,i){var n=Math.abs(.5*(e.x*t.y+t.x*i.y+i.x*e.y-t.x*e.y-i.x*t.y-e.x*i.y)),r=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=2*(n/r);return s},s=0,o=t.length-1,a=[];for(a.push(s),a.push(o);t[s].equals(t[o]);)o--,a.push(o);n(t,s,o,e);var l=[];a.sort(i);for(var u=0;a.length>u;u++)l.push(t[a[u]]);return new OpenLayers.Geometry.LineString(l)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"}),OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(e,t){var i=!1,n=this.components.pop();null==t&&e.equals(n)||(i=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments));var r=this.components[0];return OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[r]),i},removeComponent:function(){var e=this.components&&this.components.length>3;if(e){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var t=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[t])}return e},move:function(e,t){for(var i=0,n=this.components.length;n-1>i;i++)this.components[i].move(e,t)},rotate:function(e,t){for(var i=0,n=this.components.length;n-1>i;++i)this.components[i].rotate(e,t)},resize:function(e,t,i){for(var n=0,r=this.components.length;r-1>n;++n)this.components[n].resize(e,t,i);return this},transform:function(e,t){if(e&&t){for(var i=0,n=this.components.length;n-1>i;i++){var r=this.components[i];r.transform(e,t)}this.bounds=null}return this},getCentroid:function(){if(this.components){var e=this.components.length;if(e>0&&2>=e)return this.components[0].clone();if(e>2){var t=0,i=0,n=this.components[0].x,r=this.components[0].y,s=-1*this.getArea();if(0!=s){for(var o=0;e-1>o;o++){var a=this.components[o],l=this.components[o+1];t+=(a.x+l.x-2*n)*((a.x-n)*(l.y-r)-(l.x-n)*(a.y-r)),i+=(a.y+l.y-2*r)*((a.x-n)*(l.y-r)-(l.x-n)*(a.y-r))}var u=n+t/(6*s),h=r+i/(6*s)}else{for(var o=0;e-1>o;o++)t+=this.components[o].x,i+=this.components[o].y;var u=t/(e-1),h=i/(e-1)}return new OpenLayers.Geometry.Point(u,h)}return null}},getArea:function(){var e=0;if(this.components&&this.components.length>2){for(var t=0,i=0,n=this.components.length;n-1>i;i++){var r=this.components[i],s=this.components[i+1];t+=(r.x+s.x)*(s.y-r.y)}e=-t/2}return e},getGeodesicArea:function(e){var t=this;if(e){var i=new OpenLayers.Projection("EPSG:4326");i.equals(e)||(t=this.clone().transform(e,i))}var n=0,r=t.components&&t.components.length;if(r>2){for(var s,o,a=0;r-1>a;a++)s=t.components[a],o=t.components[a+1],n+=OpenLayers.Util.rad(o.x-s.x)*(2+Math.sin(OpenLayers.Util.rad(s.y))+Math.sin(OpenLayers.Util.rad(o.y)));n=6378137*6378137*n/2}return n},containsPoint:function(e){function t(e,t,i,n,r){return(e-r)*((n-t)/(r-i))+n}for(var i,n,r,s,o,a,l,u=OpenLayers.Number.limitSigDigs,h=14,c=u(e.x,h),p=u(e.y,h),d=this.components.length-1,f=0,m=0;d>m;++m)if(i=this.components[m],r=u(i.x,h),s=u(i.y,h),n=this.components[m+1],o=u(n.x,h),a=u(n.y,h),s!=a){if(l=u(t(p,r,s,o,a),h),l==c&&(a>s&&p>=s&&a>=p||s>a&&s>=p&&p>=a)){f=-1;break}c>=l||r!=o&&(Math.min(r,o)>l||l>Math.max(r,o))||(a>s&&p>=s&&a>p||s>a&&s>p&&p>=a)&&++f}else if(p==s&&(o>=r&&c>=r&&o>=c||r>=o&&r>=c&&c>=o)){f=-1;break}var g=-1==f?1:!!(1&f);return g},intersects:function(e){var t=!1;if("OpenLayers.Geometry.Point"==e.CLASS_NAME)t=this.containsPoint(e);else if("OpenLayers.Geometry.LineString"==e.CLASS_NAME)t=e.intersects(this);else if("OpenLayers.Geometry.LinearRing"==e.CLASS_NAME)t=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[e]);else for(var i=0,n=e.components.length;n>i&&!(t=e.components[i].intersects(this));++i);return t},getVertices:function(e){return e===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.vendorPrefix=function(){"use strict";function e(e){return e?e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-"):null}function t(t){if(void 0===o[t]){var i=t.replace(/(-[\s\S])/g,function(e){return e.charAt(1).toUpperCase()}),r=n(i);o[t]=e(r)}return o[t]}function i(e,t){if(void 0===a[t]){var i,n,s=0,o=r.length,l=e.cssText!==void 0;for(a[t]=null;o>s;s++)if(n=r[s],n?(l||(n=n.toLowerCase()),i=n+t.charAt(0).toUpperCase()+t.slice(1)):i=t,void 0!==e[i]){a[t]=i;break}}return a[t]}function n(e){return i(s,e)}var r=["","O","ms","Moz","Webkit"],s=document.createElement("div").style,o={},a={};return{css:t,js:i,style:n,cssCache:o,jsCache:a}}(),OpenLayers.Animation=function(e){function t(e,t,i){t=t>0?t:Number.POSITIVE_INFINITY;var n=++o,r=+new Date;return a[n]=function(){a[n]&&t>=+new Date-r?(e(),a[n]&&s(a[n],i)):delete a[n]},s(a[n],i),n}function i(e){delete a[e]}var n=OpenLayers.Util.vendorPrefix.js(e,"requestAnimationFrame"),r=!!n,s=function(){var t=e[n]||function(t){e.setTimeout(t,16)};return function(i,n){t.apply(e,[i,n])}}(),o=0,a={};return{isNative:r,requestFrame:s,start:t,stop:i}}(window),OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:!1,initialize:function(e){this.easing=e?e:OpenLayers.Easing.Expo.easeOut},start:function(e,t,i,n){this.playing=!0,this.begin=e,this.finish=t,this.duration=i,this.callbacks=n.callbacks,this.minFrameRate=n.minFrameRate||30,this.time=0,this.startTime=(new Date).getTime(),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var e={};for(var t in this.begin){var i=this.begin[t],n=this.finish[t];if(null==i||null==n||isNaN(i)||isNaN(n))throw new TypeError("invalid value for Tween");var r=n-i;e[t]=this.easing.apply(this,[this.time,i,r,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&((new Date).getTime()-this.startTime)/this.time<=1e3/this.minFrameRate&&this.callbacks.eachStep.call(this,e),this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(e,t,i,n){return i*e/n+t},easeOut:function(e,t,i,n){return i*e/n+t},easeInOut:function(e,t,i,n){return i*e/n+t},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(e,t,i,n){return 0==e?t:i*Math.pow(2,10*(e/n-1))+t},easeOut:function(e,t,i,n){return e==n?t+i:i*(-Math.pow(2,-10*e/n)+1)+t},easeInOut:function(e,t,i,n){return 0==e?t:e==n?t+i:1>(e/=n/2)?i/2*Math.pow(2,10*(e-1))+t:i/2*(-Math.pow(2,-10*--e)+2)+t},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(e,t,i,n){return i*(e/=n)*e+t},easeOut:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},easeInOut:function(e,t,i,n){return 1>(e/=n/2)?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},CLASS_NAME:"OpenLayers.Easing.Quad"},OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.projCode=e,"object"==typeof Proj4js&&(this.proj=new Proj4js.Proj(e))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(e){var t=e,i=!1;if(t)if(t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),"object"==typeof Proj4js&&this.proj.defData&&t.proj.defData)i=this.proj.defData.replace(this.titleRegEx,"")==t.proj.defData.replace(this.titleRegEx,"");else if(t.getCode){var n=this.getCode(),r=t.getCode();i=n==r||!!OpenLayers.Projection.transforms[n]&&OpenLayers.Projection.transforms[n][r]===OpenLayers.Projection.nullTransform}return i},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},OpenLayers.Projection.addTransform=function(e,t,i){if(i===OpenLayers.Projection.nullTransform){var n=OpenLayers.Projection.defaults[e];n&&!OpenLayers.Projection.defaults[t]&&(OpenLayers.Projection.defaults[t]=n)}OpenLayers.Projection.transforms[e]||(OpenLayers.Projection.transforms[e]={}),OpenLayers.Projection.transforms[e][t]=i},OpenLayers.Projection.transform=function(e,t,i){if(t&&i)if(t instanceof OpenLayers.Projection||(t=new OpenLayers.Projection(t)),i instanceof OpenLayers.Projection||(i=new OpenLayers.Projection(i)),t.proj&&i.proj)e=Proj4js.transform(t.proj,i.proj,e);else{var n=t.getCode(),r=i.getCode(),s=OpenLayers.Projection.transforms;s[n]&&s[n][r]&&s[n][r](e)}return e},OpenLayers.Projection.nullTransform=function(e){return e},function(){function e(e){return e.x=180*e.x/r,e.y=180/Math.PI*(2*Math.atan(Math.exp(e.y/r*Math.PI))-Math.PI/2),e}function t(e){e.x=e.x*r/180;var t=Math.log(Math.tan((90+e.y)*Math.PI/360))/Math.PI*r;return e.y=Math.max(-20037508.34,Math.min(t,20037508.34)),e}function i(i,n){var r,s,o,a,l,u=OpenLayers.Projection.addTransform,h=OpenLayers.Projection.nullTransform;for(r=0,s=n.length;s>r;++r)for(o=n[r],u(i,o,t),u(o,i,e),l=r+1;s>l;++l)a=n[l],u(o,a,h),u(a,o,h)}var n,r=20037508.34,s=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],o=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"];for(n=s.length-1;n>=0;--n)i(s[n],o);for(n=o.length-1;n>=0;--n)i(o[n],s)}(),OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!1,autoUpdateSize:!0,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(e,t){1===arguments.length&&"object"==typeof e&&(t=e,e=t&&t.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",this.options=OpenLayers.Util.extend({},t),OpenLayers.Util.extend(this,t);var i=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[i]),!this.maxExtent||this.maxExtent instanceof OpenLayers.Bounds||(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)),!this.minExtent||this.minExtent instanceof OpenLayers.Bounds||(this.minExtent=new OpenLayers.Bounds(this.minExtent)),!this.restrictedExtent||this.restrictedExtent instanceof OpenLayers.Bounds||(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)),!this.center||this.center instanceof OpenLayers.LonLat||(this.center=new OpenLayers.LonLat(this.center)),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(e),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var n=this.id+"_OpenLayers_ViewPort";if(this.viewPortDiv=OpenLayers.Util.createDiv(n,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0}),OpenLayers.TileManager&&null!==this.tileManager&&(this.tileManager instanceof OpenLayers.TileManager||(this.tileManager=new OpenLayers.TileManager(this.tileManager)),this.tileManager.addMap(this)),n=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(n),this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.layerContainerOriginPx={x:0,y:0},this.applyTransform(),this.viewPortDiv.appendChild(this.layerContainerDiv),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.autoUpdateSize===!0&&(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)),this.theme){for(var r=!0,s=document.getElementsByTagName("link"),o=0,a=s.length;a>o;++o)if(OpenLayers.Util.isEquivalentUrl(s.item(o).href,this.theme)){r=!1;break}if(r){var l=document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(l)}}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));for(var o=0,a=this.controls.length;a>o;o++)this.addControlToMap(this.controls[o]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),t&&t.layers&&(delete this.center,delete this.zoom,this.addLayers(t.layers),t.center&&!this.getCenter()&&this.setCenter(t.center,t.zoom)),this.panMethod&&(this.panTween=new OpenLayers.Tween(this.panMethod)),this.zoomMethod&&this.applyTransform.transform&&(this.zoomTween=new OpenLayers.Tween(this.zoomMethod))},getViewport:function(){return this.viewPortDiv},render:function(e){this.div=OpenLayers.Util.getElement(e),OpenLayers.Element.addClass(this.div,"olMap"),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;if(this.panTween&&(this.panTween.stop(),this.panTween=null),this.zoomTween&&(this.zoomTween.stop(),this.zoomTween=null),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy&&OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy),this.paddingForPopups=null,null!=this.controls){for(var e=this.controls.length-1;e>=0;--e)this.controls[e].destroy();this.controls=null}if(null!=this.layers){for(var e=this.layers.length-1;e>=0;--e)this.layers[e].destroy(!1);this.layers=null}this.viewPortDiv&&this.viewPortDiv.parentNode&&this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.tileManager&&(this.tileManager.removeMap(this),this.tileManager=null),this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null,this.options=null},setOptions:function(e){var t=this.minPx&&e.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,e),t&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(e,t,i){var n="function"==typeof i.test,r=OpenLayers.Array.filter(this[e],function(e){return e[t]==i||n&&i.test(e[t])});return r},getLayersBy:function(e,t){return this.getBy("layers",e,t)},getLayersByName:function(e){return this.getLayersBy("name",e)},getLayersByClass:function(e){return this.getLayersBy("CLASS_NAME",e)},getControlsBy:function(e,t){return this.getBy("controls",e,t)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},getLayer:function(e){for(var t=null,i=0,n=this.layers.length;n>i;i++){var r=this.layers[i];if(r.id==e){t=r;break}}return t},setLayerZIndex:function(e,t){e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer?"BaseLayer":"Overlay"]+5*t)},resetLayersZIndex:function(){for(var e=0,t=this.layers.length;t>e;e++){var i=this.layers[e];this.setLayerZIndex(i,e)}},addLayer:function(e){for(var t=0,i=this.layers.length;i>t;t++)if(this.layers[t]==e)return!1;return this.events.triggerEvent("preaddlayer",{layer:e})===!1?!1:(this.allOverlays&&(e.isBaseLayer=!1),e.div.className="olLayerDiv",e.div.style.overflow="",this.setLayerZIndex(e,this.layers.length),e.isFixed?this.viewPortDiv.appendChild(e.div):this.layerContainerDiv.appendChild(e.div),this.layers.push(e),e.setMap(this),e.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(e):e.setVisibility(!1):e.redraw(),this.events.triggerEvent("addlayer",{layer:e}),e.events.triggerEvent("added",{map:this,layer:e}),e.afterAdd(),!0)},addLayers:function(e){for(var t=0,i=e.length;i>t;t++)this.addLayer(e[t])},removeLayer:function(e,t){if(this.events.triggerEvent("preremovelayer",{layer:e})!==!1){if(null==t&&(t=!0),e.isFixed?this.viewPortDiv.removeChild(e.div):this.layerContainerDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.layers,e),e.removeMap(this),e.map=null,this.baseLayer==e&&(this.baseLayer=null,t))for(var i=0,n=this.layers.length;n>i;i++){var r=this.layers[i];if(r.isBaseLayer||this.allOverlays){this.setBaseLayer(r);break}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:e}),e.events.triggerEvent("removed",{map:this,layer:e})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(e){return OpenLayers.Util.indexOf(this.layers,e)},setLayerIndex:function(e,t){var i=this.getLayerIndex(e);if(0>t?t=0:t>this.layers.length&&(t=this.layers.length),i!=t){this.layers.splice(i,1),this.layers.splice(t,0,e);for(var n=0,r=this.layers.length;r>n;n++)this.setLayerZIndex(this.layers[n],n);this.events.triggerEvent("changelayer",{layer:e,property:"order"}),this.allOverlays&&(0===t?this.setBaseLayer(e):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(e,t){var i=this.getLayerIndex(e)+t;this.setLayerIndex(e,i)},setBaseLayer:function(e){if(e!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,e)){var t=this.getCachedCenter(),i=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);if(null==this.baseLayer||this.allOverlays||this.baseLayer.setVisibility(!1),this.baseLayer=e,(!this.allOverlays||this.baseLayer.visibility)&&(this.baseLayer.setVisibility(!0),this.baseLayer.inRange===!1&&this.baseLayer.redraw()),null!=t){var n=this.getZoomForResolution(i||this.resolution,!0);this.setCenter(t,n,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(e,t){this.controls.push(e),this.addControlToMap(e,t)},addControls:function(e,t){for(var i=1===arguments.length?[]:t,n=0,r=e.length;r>n;n++){var s=e[n],o=i[n]?i[n]:null;this.addControl(s,o)}},addControlToMap:function(e,t){e.outsideViewport=null!=e.div,this.displayProjection&&!e.displayProjection&&(e.displayProjection=this.displayProjection),e.setMap(this);var i=e.draw(t);i&&(e.outsideViewport||(i.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(i))),e.autoActivate&&e.activate()},getControl:function(e){for(var t=null,i=0,n=this.controls.length;n>i;i++){var r=this.controls[i];if(r.id==e){t=r;break}}return t},removeControl:function(e){e&&e==this.getControl(e.id)&&(e.div&&e.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(e.div),OpenLayers.Util.removeItem(this.controls,e))},addPopup:function(e,t){if(t)for(var i=this.popups.length-1;i>=0;--i)this.removePopup(this.popups[i]);
e.map=this,this.popups.push(e);var n=e.draw();n&&(n.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(n))},removePopup:function(e){if(OpenLayers.Util.removeItem(this.popups,e),e.div)try{this.layerContainerDiv.removeChild(e.div)}catch(t){}e.map=null},getSize:function(){var e=null;return null!=this.size&&(e=this.size.clone()),e},updateSize:function(){var e=this.getCurrentSize();if(e&&!isNaN(e.h)&&!isNaN(e.w)){this.events.clearMouseCache();var t=this.getSize();if(null==t&&(this.size=t=e),!e.equals(t)){this.size=e;for(var i=0,n=this.layers.length;n>i;i++)this.layers[i].onMapResize();var r=this.getCachedCenter();if(null!=this.baseLayer&&null!=r){var s=this.getZoom();this.zoom=null,this.setCenter(r,s)}}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var e=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);return(0==e.w&&0==e.h||isNaN(e.w)&&isNaN(e.h))&&(e.w=this.div.offsetWidth,e.h=this.div.offsetHeight),(0==e.w&&0==e.h||isNaN(e.w)&&isNaN(e.h))&&(e.w=parseInt(this.div.style.width),e.h=parseInt(this.div.style.height)),e},calculateBounds:function(e,t){var i=null;if(null==e&&(e=this.getCachedCenter()),null==t&&(t=this.getResolution()),null!=e&&null!=t){var n=this.size.w*t/2,r=this.size.h*t/2;i=new OpenLayers.Bounds(e.lon-n,e.lat-r,e.lon+n,e.lat+r)}return i},getCenter:function(){var e=null,t=this.getCachedCenter();return t&&(e=t.clone()),e},getCachedCenter:function(){return!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})),this.center},getZoom:function(){return this.zoom},pan:function(e,t,i){if(i=OpenLayers.Util.applyDefaults(i,{animate:!0,dragging:!1}),i.dragging)(0!=e||0!=t)&&this.moveByPx(e,t);else{var n=this.getViewPortPxFromLonLat(this.getCachedCenter()),r=n.add(e,t);if(this.dragging||!r.equals(n)){var s=this.getLonLatFromViewPortPx(r);i.animate?this.panTo(s):(this.moveTo(s),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(e){if(this.panTween&&this.getExtent().scale(this.panRatio).containsLonLat(e)){var t=this.getCachedCenter();if(e.equals(t))return;var i=this.getPixelFromLonLat(t),n=this.getPixelFromLonLat(e),r={x:n.x-i.x,y:n.y-i.y},s={x:0,y:0};this.panTween.start({x:0,y:0},r,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(e){var t=e.x-s.x,i=e.y-s.y;this.moveByPx(t,i),s.x=Math.round(e.x),s.y=Math.round(e.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(e),this.dragging=!1,this.events.triggerEvent("moveend")},this)}})}else this.setCenter(e)},setCenter:function(e,t,i,n){this.panTween&&this.panTween.stop(),this.zoomTween&&this.zoomTween.stop(),this.moveTo(e,t,{dragging:i,forceZoomChange:n})},moveByPx:function(e,t){var i=this.size.w/2,n=this.size.h/2,r=i+e,s=n+t,o=this.baseLayer.wrapDateLine,a=0,l=0;if(this.restrictedExtent&&(a=i,l=n,o=!1),e=o||this.maxPx.x-a>=r&&r>=this.minPx.x+a?Math.round(e):0,t=this.maxPx.y-l>=s&&s>=this.minPx.y+l?Math.round(t):0,e||t){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")),this.center=null,e&&(this.layerContainerOriginPx.x-=e,this.minPx.x-=e,this.maxPx.x-=e),t&&(this.layerContainerOriginPx.y-=t,this.minPx.y-=t,this.maxPx.y-=t),this.applyTransform();var u,h,c;for(h=0,c=this.layers.length;c>h;++h)u=this.layers[h],u.visibility&&(u===this.baseLayer||u.inRange)&&(u.moveByPx(e,t),u.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(e){if(this.baseLayer&&this.baseLayer.wrapDateLine){var t=this.baseLayer.resolutions,i=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(e)>i)if(this.fractionalZoom)e=this.getZoomForResolution(i);else for(var n=0|e,r=t.length;r>n;++n)if(i>=t[n]){e=n;break}}return e},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(e,t,i){null==e||e instanceof OpenLayers.LonLat||(e=new OpenLayers.LonLat(e)),i||(i={}),null!=t&&(t=parseFloat(t),this.fractionalZoom||(t=Math.round(t)));var n=t;t=this.adjustZoom(t),t!==n&&(e=this.getCenter());var r=i.dragging||this.dragging,s=i.forceZoomChange;if(this.getCachedCenter()||this.isValidLonLat(e)||(e=this.maxExtent.getCenterLonLat(),this.center=e.clone()),null!=this.restrictedExtent){null==e&&(e=this.center),null==t&&(t=this.getZoom());var o=this.getResolutionForZoom(t),a=this.calculateBounds(e,o);if(!this.restrictedExtent.containsBounds(a)){var l=this.restrictedExtent.getCenterLonLat();a.getWidth()>this.restrictedExtent.getWidth()?e=new OpenLayers.LonLat(l.lon,e.lat):a.left<this.restrictedExtent.left?e=e.add(this.restrictedExtent.left-a.left,0):a.right>this.restrictedExtent.right&&(e=e.add(this.restrictedExtent.right-a.right,0)),a.getHeight()>this.restrictedExtent.getHeight()?e=new OpenLayers.LonLat(e.lon,l.lat):a.bottom<this.restrictedExtent.bottom?e=e.add(0,this.restrictedExtent.bottom-a.bottom):a.top>this.restrictedExtent.top&&(e=e.add(0,this.restrictedExtent.top-a.top))}}var u=s||this.isValidZoomLevel(t)&&t!=this.getZoom(),h=this.isValidLonLat(e)&&!e.equals(this.center);if(u||h||r){r||this.events.triggerEvent("movestart",{zoomChanged:u}),h&&(!u&&this.center&&this.centerLayerContainer(e),this.center=e.clone());var c=u?this.getResolutionForZoom(t):this.getResolution();if(u||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter(),this.layerContainerOriginPx.x=0,this.layerContainerOriginPx.y=0,this.applyTransform();var p=this.getMaxExtent({restricted:!0}),d=p.getCenterLonLat(),f=this.center.lon-d.lon,m=d.lat-this.center.lat,g=Math.round(p.getWidth()/c),y=Math.round(p.getHeight()/c);this.minPx={x:(this.size.w-g)/2-f/c,y:(this.size.h-y)/2-m/c},this.maxPx={x:this.minPx.x+Math.round(p.getWidth()/c),y:this.minPx.y+Math.round(p.getHeight()/c)}}u&&(this.zoom=t,this.resolution=c);var v=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(v,u,i.dragging),i.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:u})),v=this.baseLayer.getExtent();for(var b=this.layers.length-1;b>=0;--b){var _=this.layers[b];if(_!==this.baseLayer&&!_.isBaseLayer){var w=_.calculateInRange();_.inRange!=w&&(_.inRange=w,w||_.display(!1),this.events.triggerEvent("changelayer",{layer:_,property:"visibility"})),w&&_.visibility&&(_.moveTo(v,u,i.dragging),i.dragging||_.events.triggerEvent("moveend",{zoomChanged:u}))}}if(this.events.triggerEvent("move"),r||this.events.triggerEvent("moveend"),u){for(var b=0,x=this.popups.length;x>b;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(e){var t=this.getViewPortPxFromLonLat(this.layerContainerOrigin),i=this.getViewPortPxFromLonLat(e);if(null!=t&&null!=i){var n=this.layerContainerOriginPx.x,r=this.layerContainerOriginPx.y,s=Math.round(t.x-i.x),o=Math.round(t.y-i.y);this.applyTransform(this.layerContainerOriginPx.x=s,this.layerContainerOriginPx.y=o);var a=n-s,l=r-o;this.minPx.x-=a,this.maxPx.x-=a,this.minPx.y-=l,this.maxPx.y-=l}},isValidZoomLevel:function(e){return null!=e&&e>=0&&this.getNumZoomLevels()>e},isValidLonLat:function(e){var t=!1;if(null!=e){var i=this.getMaxExtent(),n=this.baseLayer.wrapDateLine&&i;t=i.containsLonLat(e,{worldBounds:n})}return t},getProjection:function(){var e=this.getProjectionObject();return e?e.getCode():null},getProjectionObject:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.projection),e},getMaxResolution:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.maxResolution),e},getMaxExtent:function(e){var t=null;return e&&e.restricted&&this.restrictedExtent?t=this.restrictedExtent:null!=this.baseLayer&&(t=this.baseLayer.maxExtent),t},getNumZoomLevels:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.numZoomLevels),e},getExtent:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.getExtent()),e},getResolution:function(){var e=null;return null!=this.baseLayer?e=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(e=this.layers[0].getResolution()),e},getUnits:function(){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.units),e},getScale:function(){var e=null;if(null!=this.baseLayer){var t=this.getResolution(),i=this.baseLayer.units;e=OpenLayers.Util.getScaleFromResolution(t,i)}return e},getZoomForExtent:function(e,t){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForExtent(e,t)),i},getResolutionForZoom:function(e){var t=null;return this.baseLayer&&(t=this.baseLayer.getResolutionForZoom(e)),t},getZoomForResolution:function(e,t){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForResolution(e,t)),i},zoomTo:function(e,t){var i=this;if(i.isValidZoomLevel(e))if(i.baseLayer.wrapDateLine&&(e=i.adjustZoom(e)),i.zoomTween){var n=i.getResolution(),r=i.getResolutionForZoom(e),s={scale:1},o={scale:n/r};if(i.zoomTween.playing&&i.zoomTween.duration<3*i.zoomDuration)i.zoomTween.finish={scale:i.zoomTween.finish.scale*o.scale};else{if(!t){var a=i.getSize();t={x:a.w/2,y:a.h/2}}i.zoomTween.start(s,o,i.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(e){var n=i.layerContainerOriginPx,r=e.scale,s=0|(r-1)*(n.x-t.x),o=0|(r-1)*(n.y-t.y);i.applyTransform(n.x+s,n.y+o,r)},done:function(e){i.applyTransform();var n=i.getResolution()/e.scale,r=i.getZoomForResolution(n,!0);i.moveTo(i.getZoomTargetCenter(t,n),r,!0)}}})}}else{var l=t?i.getZoomTargetCenter(t,i.getResolutionForZoom(e)):null;i.setCenter(l,e)}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,t){e instanceof OpenLayers.Bounds||(e=new OpenLayers.Bounds(e));var i=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){var n=this.getMaxExtent();for(e=e.clone();e.right<e.left;)e.right+=n.getWidth();i=e.getCenterLonLat().wrapDateLine(n)}this.setCenter(i,this.getZoomForExtent(e,t))},zoomToMaxExtent:function(e){var t=e?e.restricted:!0,i=this.getMaxExtent({restricted:t});this.zoomToExtent(i)},zoomToScale:function(e,t){var i=OpenLayers.Util.getResolutionFromScale(e,this.baseLayer.units),n=this.size.w*i/2,r=this.size.h*i/2,s=this.getCachedCenter(),o=new OpenLayers.Bounds(s.lon-n,s.lat-r,s.lon+n,s.lat+r);this.zoomToExtent(o,t)},getLonLatFromViewPortPx:function(e){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.getLonLatFromViewPortPx(e)),t},getViewPortPxFromLonLat:function(e){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.getViewPortPxFromLonLat(e)),t},getZoomTargetCenter:function(e,t){var i=null,n=this.getSize(),r=n.w/2-e.x,s=e.y-n.h/2,o=this.getLonLatFromPixel(e);return o&&(i=new OpenLayers.LonLat(o.lon+r*t,o.lat+s*t)),i},getLonLatFromPixel:function(e){return this.getLonLatFromViewPortPx(e)},getPixelFromLonLat:function(e){var t=this.getViewPortPxFromLonLat(e);return t.x=Math.round(t.x),t.y=Math.round(t.y),t},getGeodesicPixelSize:function(e){var t=e?this.getLonLatFromPixel(e):this.getCachedCenter()||new OpenLayers.LonLat(0,0),i=this.getResolution(),n=t.add(-i/2,0),r=t.add(i/2,0),s=t.add(0,-i/2),o=t.add(0,i/2),a=new OpenLayers.Projection("EPSG:4326"),l=this.getProjectionObject()||a;return l.equals(a)||(n.transform(l,a),r.transform(l,a),s.transform(l,a),o.transform(l,a)),new OpenLayers.Size(OpenLayers.Util.distVincenty(n,r),OpenLayers.Util.distVincenty(s,o))},getViewPortPxFromLayerPx:function(e){var t=null;if(null!=e){var i=this.layerContainerOriginPx.x,n=this.layerContainerOriginPx.y;t=e.add(i,n)}return t},getLayerPxFromViewPortPx:function(e){var t=null;if(null!=e){var i=-this.layerContainerOriginPx.x,n=-this.layerContainerOriginPx.y;t=e.add(i,n),(isNaN(t.x)||isNaN(t.y))&&(t=null)}return t},getLonLatFromLayerPx:function(e){return e=this.getViewPortPxFromLayerPx(e),this.getLonLatFromViewPortPx(e)},getLayerPxFromLonLat:function(e){var t=this.getPixelFromLonLat(e);return this.getLayerPxFromViewPortPx(t)},applyTransform:function(e,t,i){i=i||1;var n=this.layerContainerOriginPx,r=1!==i;e=e||n.x,t=t||n.y;var s=this.layerContainerDiv.style,o=this.applyTransform.transform,a=this.applyTransform.template;if(void 0===o&&(o=OpenLayers.Util.vendorPrefix.style("transform"),this.applyTransform.transform=o,o)){var l=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));l&&"none"===l||(a=["translate3d(",",0) ","scale3d(",",1)"],s[o]=[a[0],"0,0",a[1]].join("")),a&&~s[o].indexOf(a[0])||(a=["translate(",") ","scale(",")"]),this.applyTransform.template=a}null===o||"translate3d("!==a[0]&&r!==!0?(s.left=e+"px",s.top=t+"px",null!==o&&(s[o]="")):(r===!0&&"translate("===a[0]&&(e-=n.x,t-=n.y,s.left=n.x+"px",s.top=n.y+"px"),s[o]=[a[0],e,"px,",t,"px",a[1],a[2],i,",",i,a[3]].join(""))},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(e,t){this.metadata={},t=OpenLayers.Util.extend({},t),null!=this.alwaysInRange&&(t.alwaysInRange=this.alwaysInRange),this.addOptions(t),this.name=e,null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object&&this.events.on(this.eventListeners))},destroy:function(e){null==e&&(e=!0),null!=this.map&&this.map.removeLayer(this,e),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(e){return null==e&&(e=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(e,this),e.map=null,e},getOptions:function(){var e={};for(var t in this.options)e[t]=this[t];return e},setName:function(e){e!=this.name&&(this.name=e,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(e,t){if(null==this.options&&(this.options={}),e&&("string"==typeof e.projection&&(e.projection=new OpenLayers.Projection(e.projection)),e.projection&&OpenLayers.Util.applyDefaults(e,OpenLayers.Projection.defaults[e.projection.getCode()]),!e.maxExtent||e.maxExtent instanceof OpenLayers.Bounds||(e.maxExtent=new OpenLayers.Bounds(e.maxExtent)),!e.minExtent||e.minExtent instanceof OpenLayers.Bounds||(e.minExtent=new OpenLayers.Bounds(e.minExtent))),OpenLayers.Util.extend(this.options,e),OpenLayers.Util.extend(this,e),this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits()),this.map){var i=this.map.getResolution(),n=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var r in e)if(e.hasOwnProperty(r)&&OpenLayers.Util.indexOf(n,r)>=0){this.initResolutions(),t&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(i),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var e=!1;if(this.map){this.inRange=this.calculateInRange();var t=this.getExtent();if(t&&this.inRange&&this.visibility){var i=!0;this.moveTo(t,i,!1),this.events.triggerEvent("moveend",{zoomChanged:i}),e=!0}}return e},moveTo:function(){var e=this.visibility;this.isBaseLayer||(e=e&&this.inRange),this.display(e)},moveByPx:function(){},setMap:function(e){if(null==this.map){if(this.map=e,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),!this.isBaseLayer){this.inRange=this.calculateInRange();var t=this.visibility&&this.inRange;this.div.style.display=t?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(e){var t=e?e:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=t,this.gutter&&(this.imageSize=new OpenLayers.Size(t.w+2*this.gutter,t.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(e){e!=this.visibility&&(this.visibility=e,this.display(e),this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(e){e!=("none"!=this.div.style.display)&&(this.div.style.display=e&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var e=!1;if(this.alwaysInRange)e=!0;else if(this.map){var t=this.map.getResolution();e=t>=this.minResolution&&this.maxResolution>=t}return e},setIsBaseLayer:function(e){e!=this.isBaseLayer&&(this.isBaseLayer=e,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var e,t,i,n={},r=!0;for(e=0,t=this.RESOLUTION_PROPERTIES.length;t>e;e++)i=this.RESOLUTION_PROPERTIES[e],n[i]=this.options[i],r&&this.options[i]&&(r=!1);if(null==this.options.alwaysInRange&&(this.alwaysInRange=r),null==n.resolutions&&(n.resolutions=this.resolutionsFromScales(n.scales)),null==n.resolutions&&(n.resolutions=this.calculateResolutions(n)),null==n.resolutions){for(e=0,t=this.RESOLUTION_PROPERTIES.length;t>e;e++)i=this.RESOLUTION_PROPERTIES[e],n[i]=null!=this.options[i]?this.options[i]:this.map[i];null==n.resolutions&&(n.resolutions=this.resolutionsFromScales(n.scales)),null==n.resolutions&&(n.resolutions=this.calculateResolutions(n))}var s;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(s=this.options.maxResolution),this.options.minScale&&(s=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var o;if(this.options.minResolution&&"auto"!==this.options.minResolution&&(o=this.options.minResolution),this.options.maxScale&&(o=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)),n.resolutions&&(n.resolutions.sort(function(e,t){return t-e}),s||(s=n.resolutions[0]),!o)){var a=n.resolutions.length-1;o=n.resolutions[a]}if(this.resolutions=n.resolutions,this.resolutions){for(t=this.resolutions.length,this.scales=Array(t),e=0;t>e;e++)this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units);this.numZoomLevels=t}this.minResolution=o,o&&(this.maxScale=OpenLayers.Util.getScaleFromResolution(o,this.units)),this.maxResolution=s,s&&(this.minScale=OpenLayers.Util.getScaleFromResolution(s,this.units))},resolutionsFromScales:function(e){if(null!=e){var t,i,n;for(n=e.length,t=Array(n),i=0;n>i;i++)t[i]=OpenLayers.Util.getResolutionFromScale(e[i],this.units);return t}},calculateResolutions:function(e){var t,i,n,r=e.maxResolution;null!=e.minScale?r=OpenLayers.Util.getResolutionFromScale(e.minScale,this.units):"auto"==r&&null!=this.maxExtent&&(t=this.map.getSize(),i=this.maxExtent.getWidth()/t.w,n=this.maxExtent.getHeight()/t.h,r=Math.max(i,n));var s=e.minResolution;if(null!=e.maxScale?s=OpenLayers.Util.getResolutionFromScale(e.maxScale,this.units):"auto"==e.minResolution&&null!=this.minExtent&&(t=this.map.getSize(),i=this.minExtent.getWidth()/t.w,n=this.minExtent.getHeight()/t.h,s=Math.max(i,n)),"number"!=typeof r&&"number"!=typeof s&&null!=this.maxExtent){var o=this.map.getTileSize();r=Math.max(this.maxExtent.getWidth()/o.w,this.maxExtent.getHeight()/o.h)}var a=e.maxZoomLevel,l=e.numZoomLevels;if("number"==typeof s&&"number"==typeof r&&void 0===l){var u=r/s;l=Math.floor(Math.log(u)/Math.log(2))+1}else void 0===l&&null!=a&&(l=a+1);if(!("number"!=typeof l||0>=l||"number"!=typeof r&&"number"!=typeof s)){var h=Array(l),c=2;"number"==typeof s&&"number"==typeof r&&(c=Math.pow(r/s,1/(l-1)));var p;if("number"==typeof r)for(p=0;l>p;p++)h[p]=r/Math.pow(c,p);else for(p=0;l>p;p++)h[l-1-p]=s*Math.pow(c,p);return h}},getResolution:function(){var e=this.map.getZoom();return this.getResolutionForZoom(e)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,t){var i=this.map.getSize(),n=Math.max(e.getWidth()/i.w,e.getHeight()/i.h);return this.getZoomForResolution(n,t)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));var t;if(this.map.fractionalZoom){var i=Math.floor(e),n=Math.ceil(e);t=this.resolutions[i]-(e-i)*(this.resolutions[i]-this.resolutions[n])}else t=this.resolutions[Math.round(e)];return t},getZoomForResolution:function(e,t){var i,n,r;if(this.map.fractionalZoom){var s,o=0,a=this.resolutions.length-1,l=this.resolutions[o],u=this.resolutions[a];for(n=0,r=this.resolutions.length;r>n;++n)if(s=this.resolutions[n],s>=e&&(l=s,o=n),e>=s){u=s,a=n;break}var h=l-u;i=h>0?o+(l-e)/h:o}else{var c,p=Number.POSITIVE_INFINITY;for(n=0,r=this.resolutions.length;r>n;n++)if(t){if(c=Math.abs(this.resolutions[n]-e),c>p)break;p=c}else if(e>this.resolutions[n])break;i=Math.max(0,n-1)}return i},getLonLatFromViewPortPx:function(e){var t=null,i=this.map;if(null!=e&&i.minPx){var n=i.getResolution(),r=i.getMaxExtent({restricted:!0}),s=(e.x-i.minPx.x)*n+r.left,o=(i.minPx.y-e.y)*n+r.top;t=new OpenLayers.LonLat(s,o),this.wrapDateLine&&(t=t.wrapDateLine(this.maxExtent))}return t},getViewPortPxFromLonLat:function(e,t){var i=null;if(null!=e){t=t||this.map.getResolution();var n=this.map.calculateBounds(null,t);i=new OpenLayers.Pixel(1/t*(e.lon-n.left),1/t*(n.top-e.lat))}return i},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=this.div.childNodes,i=0,n=t.length;n>i;++i){var r=t[i].firstChild||t[i],s=t[i].lastChild;s&&"iframe"===s.nodeName.toLowerCase()&&(r=s.parentNode),OpenLayers.Util.modifyDOMElement(r,null,null,null,null,null,null,e)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(e){this.div.style.zIndex=e},adjustBounds:function(e){if(this.gutter){var t=this.gutter*this.map.getResolution();e=new OpenLayers.Bounds(e.left-t,e.bottom-t,e.right+t,e.top+t)}if(this.wrapDateLine){var i={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};e=e.wrapDateLine(this.maxExtent,i)}return e},CLASS_NAME:"OpenLayers.Layer"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(e,t,i,n){OpenLayers.Layer.prototype.initialize.apply(this,[e,n]),this.url=t,this.params||(this.params=OpenLayers.Util.extend({},i))},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e])},setUrl:function(e){this.url=e},mergeNewParams:function(e){this.params=OpenLayers.Util.extend(this.params,e);var t=this.redraw();return null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"}),t},redraw:function(e){return e?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(e,t){for(var i=1,n=0,r=e.length;r>n;n++)i*=e.charCodeAt(n)*this.URL_HASH_FACTOR,i-=Math.floor(i);return t[Math.floor(i*t.length)]},getFullRequestString:function(e,t){var i=t||this.url,n=OpenLayers.Util.extend({},this.params);n=OpenLayers.Util.extend(n,e);var r=OpenLayers.Util.getParameterString(n);OpenLayers.Util.isArray(i)&&(i=this.selectUrl(r,i));var s=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var o in n)o.toUpperCase()in s&&delete n[o];return r=OpenLayers.Util.getParameterString(n),OpenLayers.Util.urlAppend(i,r)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(e,t,i,n,r,s){this.layer=e,this.position=t.clone(),this.setBounds(i),this.url=n,r&&(this.size=r.clone()),this.id=OpenLayers.Util.createUniqueID("Tile_"),OpenLayers.Util.extend(this,s),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.eventListeners=null,this.events=null},draw:function(e){e||this.clear();var t=this.shouldDraw();return t&&!e&&this.events.triggerEvent("beforedraw")===!1&&(t=null),t},shouldDraw:function(){var e=!1,t=this.layer.maxExtent;if(t){var i=this.layer.map,n=i.baseLayer.wrapDateLine&&i.getMaxExtent();this.bounds.intersectsBounds(t,{inclusive:!1,worldBounds:n})&&(e=!0)}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){if(e=e.clone(),this.layer.map.baseLayer.wrapDateLine){var t=this.layer.map.getMaxExtent(),i=this.layer.map.getResolution();e=e.wrapDateLine(t,{leftTolerance:i,rightTolerance:i})}this.bounds=e},moveTo:function(e,t,i){null==i&&(i=!0),this.setBounds(e),this.position=t.clone(),i&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"}),OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(e,t,i,n){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=n,this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack(),(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)&&(this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden"),null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.imgDiv=null,this.frame=null),this.asyncRequestId=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);return e?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.renderTile(),this.positionTile()):e===!1&&this.unload(),e},renderTile:function(){if(this.layer.async){var e=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(t){e==this.asyncRequestId&&(this.url=t,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var e=this.getTile().style,t=this.frame?this.size:this.layer.getImageSize(this.bounds),i=1;this.layer instanceof OpenLayers.Layer.Grid&&(i=this.layer.getServerResolution()/this.layer.map.getResolution()),e.left=this.position.x+"px",e.top=this.position.y+"px",e.width=Math.round(i*t.w)+"px",e.height=Math.round(i*t.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var e=this.imgDiv;if(e){var t=this.getTile();t.parentNode===this.layer.div&&this.layer.div.removeChild(t),this.setImgSrc(),this.layerAlphaHack===!0&&(e.style.filter=""),OpenLayers.Element.removeClass(e,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!1);var e=this.imgDiv.style;if(this.frame){var t=0,i=0;this.layer.gutter&&(t=100*(this.layer.gutter/this.layer.tileSize.w),i=100*(this.layer.gutter/this.layer.tileSize.h)),e.left=-t+"%",e.top=-i+"%",e.width=2*t+100+"%",e.height=2*i+100+"%"}e.visibility="hidden",e.opacity=0,1>this.layer.opacity&&(e.filter="alpha(opacity="+100*this.layer.opacity+")"),e.position="absolute",this.layerAlphaHack&&(e.paddingTop=e.height,e.height="0",e.width="100%"),this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},setImage:function(e){this.imgDiv=e},initImage:function(){if(!this.url&&!this.imgDiv)return this.isLoading=!1,void 0;this.events.triggerEvent("beforeload"),this.layer.div.appendChild(this.getTile()),this.events.triggerEvent(this._loadEvent);var e=this.getImage(),t=e.getAttribute("src")||"";this.url&&OpenLayers.Util.isEquivalentUrl(t,this.url)?this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad,this),0):(this.stopLoading(),this.crossOriginKeyword&&e.removeAttribute("crossorigin"),OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url))},setImgSrc:function(e){var t=this.imgDiv;e?(t.style.visibility="hidden",t.style.opacity=0,this.crossOriginKeyword&&("data:"!==e.substr(0,5)?t.setAttribute("crossorigin",this.crossOriginKeyword):t.removeAttribute("crossorigin")),t.src=e):(this.stopLoading(),this.imgDiv=null,t.parentNode&&t.parentNode.removeChild(t))},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var e;return this.frame?(e=this.frame.cloneNode(!1),e.appendChild(this.imgDiv)):e=this.imgDiv,this.imgDiv=null,e}},onImageLoad:function(){var e=this.imgDiv;this.stopLoading(),e.style.visibility="inherit",e.style.opacity=this.layer.opacity,this.isLoading=!1,this.canvasContext=null,this.events.triggerEvent("loadend"),this.layerAlphaHack===!0&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')")},onImageError:function(){var e=this.imgDiv;null!=e.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(e,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv),window.clearTimeout(this._loadTimeout),delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var e=document.createElement("canvas");e.width=this.size.w,e.height=this.size.h,this.canvasContext=e.getContext("2d"),this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Tile.Image.IMAGE=function(){var e=new Image;return e.className="olTileImage",e.galleryImg="no",e}(),OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend","webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=[],this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this),this.initProperties(),this.rowSign="t"===this.tileOriginCorner.substr(0,1)?1:-1},initProperties:function(){void 0===this.options.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500),void 0===this.options.className&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid")
},setMap:function(e){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,e),OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer(),this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var e=0,t=this.grid.length;t>e;e++)for(var i=this.grid[e],n=0,r=i.length;r>n;n++){var s=i[n];this.destroyTile(s)}this.grid=[],this.gridResolution=null,this.gridLayout=null}},addOptions:function(e){var t=void 0!==e.singleTile&&e.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments),this.map&&t&&(this.initProperties(),this.clearGrid(),this.tileSize=this.options.tileSize,this.setTileSize(),this.moveTo(null,!0))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[e]),null!=this.tileSize&&(e.tileSize=this.tileSize.clone()),e.grid=[],e.gridResolution=null,e.backBuffer=null,e.backBufferTimerId=null,e.loading=!1,e.numLoadingTiles=0,e},moveTo:function(e,t,i){if(OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),e=e||this.map.getExtent(),null!=e){var n=!this.grid.length||t,r=this.getTilesBounds(),s=this.map.getResolution();this.getServerResolution(s),this.singleTile?(n||!i&&!r.containsBounds(e))&&(t&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),t&&"resize"!==this.transitionEffect||this.applyBackBuffer(s),this.initSingleTile(e)):(n=n||!r.intersectsBounds(e,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}),n?(!t||"resize"!==this.transitionEffect&&this.gridResolution!==s||this.applyBackBuffer(s),this.initGriddedTiles(e)):this.moveGriddedTiles())}},getTileData:function(e){var t=null,i=e.lon,n=e.lat,r=this.grid.length;if(this.map&&r){var s=this.map.getResolution(),o=this.tileSize.w,a=this.tileSize.h,l=this.grid[0][0].bounds,u=l.left,h=l.top;if(u>i&&this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent().getWidth(),p=Math.ceil((u-i)/c);i+=c*p}var d=(i-u)/(s*o),f=(h-n)/(s*a),m=Math.floor(d),g=Math.floor(f);if(g>=0&&r>g){var y=this.grid[g][m];y&&(t={tile:y,i:Math.floor((d-m)*o),j:Math.floor((f-g)*a)})}}return t},destroyTile:function(e){this.removeTileMonitoringHooks(e),e.destroy()},getServerResolution:function(e){var t=Number.POSITIVE_INFINITY;if(e=e||this.map.getResolution(),this.serverResolutions&&-1===OpenLayers.Util.indexOf(this.serverResolutions,e)){var i,n,r,s;for(i=this.serverResolutions.length-1;i>=0&&(r=this.serverResolutions[i],n=Math.abs(r-e),!(n>t));i--)t=n,s=r;e=s}return e},getServerZoom:function(){var e=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoomForResolution(e)+(this.zoomOffset||0)},applyBackBuffer:function(e){null!==this.backBufferTimerId&&this.removeBackBuffer();var t=this.backBuffer;if(!t){if(t=this.createBackBuffer(),!t)return;e===this.gridResolution?this.div.insertBefore(t,this.div.firstChild):this.map.baseLayer.div.parentNode.insertBefore(t,this.map.baseLayer.div),this.backBuffer=t;var i=this.grid[0][0].bounds;this.backBufferLonLat={lon:i.left,lat:i.top},this.backBufferResolution=this.gridResolution}for(var n,r=this.backBufferResolution/e,s=t.childNodes,o=s.length-1;o>=0;--o)n=s[o],n.style.top=(0|r*n._i*n._h)+"px",n.style.left=(0|r*n._j*n._w)+"px",n.style.width=Math.round(r*n._w)+"px",n.style.height=Math.round(r*n._h)+"px";var a=this.getViewPortPxFromLonLat(this.backBufferLonLat,e),l=this.map.layerContainerOriginPx.x,u=this.map.layerContainerOriginPx.y;t.style.left=Math.round(a.x-l)+"px",t.style.top=Math.round(a.y-u)+"px"},createBackBuffer:function(){var e;if(this.grid.length>0){e=document.createElement("div"),e.id=this.div.id+"_bb",e.className="olBackBuffer",e.style.position="absolute";var t=this.map;e.style.zIndex="resize"===this.transitionEffect?this.getZIndex()-1:t.Z_INDEX_BASE.BaseLayer-(t.getNumLayers()-t.getLayerIndex(this));for(var i=0,n=this.grid.length;n>i;i++)for(var r=0,s=this.grid[i].length;s>r;r++){var o=this.grid[i][r],a=this.grid[i][r].createBackBuffer();a&&(a._i=i,a._j=r,a._w=o.size.w,a._h=o.size.h,a.id=o.id+"_bb",e.appendChild(a))}}return e},removeBackBuffer:function(){if(this._transitionElement){for(var e=this.transitionendEvents.length-1;e>=0;--e)OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[e],this._removeBackBuffer);delete this._transitionElement}this.backBuffer&&(this.backBuffer.parentNode&&this.backBuffer.parentNode.removeChild(this.backBuffer),this.backBuffer=null,this.backBufferResolution=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||this.moveGriddedTiles()},setTileSize:function(e){this.singleTile&&(e=this.map.getSize(),e.h=parseInt(e.h*this.ratio,10),e.w=parseInt(e.w*this.ratio,10)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[e])},getTilesBounds:function(){var e=null,t=this.grid.length;if(t){var i=this.grid[t-1][0].bounds,n=this.grid[0].length*i.getWidth(),r=this.grid.length*i.getHeight();e=new OpenLayers.Bounds(i.left,i.bottom,i.left+n,i.bottom+r)}return e},initSingleTile:function(e){this.events.triggerEvent("retile");var t=e.getCenterLonLat(),i=e.getWidth()*this.ratio,n=e.getHeight()*this.ratio,r=new OpenLayers.Bounds(t.lon-i/2,t.lat-n/2,t.lon+i/2,t.lat+n/2),s=this.map.getLayerPxFromLonLat({lon:r.left,lat:r.top});this.grid.length||(this.grid[0]=[]);var o=this.grid[0][0];o?o.moveTo(r,s):(o=this.addTile(r,s),this.addTileMonitoringHooks(o),o.draw(),this.grid[0][0]=o),this.removeExcessTiles(1,1),this.gridResolution=this.getServerResolution()},calculateGridLayout:function(e,t,i){var n=i*this.tileSize.w,r=i*this.tileSize.h,s=e.left-t.lon,o=Math.floor(s/n)-this.buffer,a=this.rowSign,l=a*(t.lat-e.top+r),u=Math[~a?"floor":"ceil"](l/r)-this.buffer*a;return{tilelon:n,tilelat:r,startcol:o,startrow:u}},getTileOrigin:function(){var e=this.tileOrigin;if(!e){var t=this.getMaxExtent(),i={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];e=new OpenLayers.LonLat(t[i[0]],t[i[1]])}return e},getTileBoundsForGridIndex:function(e,t){var i=this.getTileOrigin(),n=this.gridLayout,r=n.tilelon,s=n.tilelat,o=n.startcol,a=n.startrow,l=this.rowSign;return new OpenLayers.Bounds(i.lon+(o+t)*r,i.lat-(a+e*l)*s*l,i.lon+(o+t+1)*r,i.lat-(a+(e-1)*l)*s*l)},initGriddedTiles:function(e){this.events.triggerEvent("retile");var t=this.map.getSize(),i=this.getTileOrigin(),n=this.map.getResolution(),r=this.getServerResolution(),s=n/r,o={w:this.tileSize.w/s,h:this.tileSize.h/s},a=Math.ceil(t.h/o.h)+2*this.buffer+1,l=Math.ceil(t.w/o.w)+2*this.buffer+1,u=this.calculateGridLayout(e,i,r);this.gridLayout=u;var h=u.tilelon,c=u.tilelat,p=this.map.layerContainerOriginPx.x,d=this.map.layerContainerOriginPx.y,f=this.getTileBoundsForGridIndex(0,0),m=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(f.left,f.top));m.x=Math.round(m.x)-p,m.y=Math.round(m.y)-d;var g=[],y=this.map.getCenter(),v=0;do{var b=this.grid[v];b||(b=[],this.grid.push(b));var _=0;do{f=this.getTileBoundsForGridIndex(v,_);var w=m.clone();w.x=w.x+_*Math.round(o.w),w.y=w.y+v*Math.round(o.h);var x=b[_];x?x.moveTo(f,w,!1):(x=this.addTile(f,w),this.addTileMonitoringHooks(x),b.push(x));var L=f.getCenterLonLat();g.push({tile:x,distance:Math.pow(L.lon-y.lon,2)+Math.pow(L.lat-y.lat,2)}),_+=1}while(f.right<=e.right+h*this.buffer||l>_);v+=1}while(f.bottom>=e.bottom-c*this.buffer||a>v);this.removeExcessTiles(v,_);var n=this.getServerResolution();this.gridResolution=n,g.sort(function(e,t){return e.distance-t.distance});for(var O=0,C=g.length;C>O;++O)g[O].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(e,t){var i=new this.tileClass(this,t,e,null,this.tileSize,this.tileOptions);return this.events.triggerEvent("addtile",{tile:i}),i},addTileMonitoringHooks:function(e){var t="olTileReplacing";e.onLoadStart=function(){this.loading===!1&&(this.loading=!0,this.events.triggerEvent("loadstart")),this.events.triggerEvent("tileloadstart",{tile:e}),this.numLoadingTiles++,!this.singleTile&&this.backBuffer&&this.gridResolution===this.backBufferResolution&&OpenLayers.Element.addClass(e.getTile(),t)},e.onLoadEnd=function(i){this.numLoadingTiles--;var n="unload"===i.type;if(this.events.triggerEvent("tileloaded",{tile:e,aborted:n}),!this.singleTile&&!n&&this.backBuffer&&this.gridResolution===this.backBufferResolution){var r=e.getTile();if("none"===OpenLayers.Element.getStyle(r,"display")){var s=document.getElementById(e.id+"_bb");s&&s.parentNode.removeChild(s)}OpenLayers.Element.removeClass(r,t)}if(0===this.numLoadingTiles){if(this.backBuffer)if(0===this.backBuffer.childNodes.length)this.removeBackBuffer();else{this._transitionElement=n?this.div.lastChild:e.imgDiv;for(var o=this.transitionendEvents,a=o.length-1;a>=0;--a)OpenLayers.Event.observe(this._transitionElement,o[a],this._removeBackBuffer);this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}this.loading=!1,this.events.triggerEvent("loadend")}},e.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:e})},e.events.on({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},removeTileMonitoringHooks:function(e){e.unload(),e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},moveGriddedTiles:function(){for(var e=this.buffer+1;;){var t=this.grid[0][0],i={x:t.position.x+this.map.layerContainerOriginPx.x,y:t.position.y+this.map.layerContainerOriginPx.y},n=this.getServerResolution()/this.map.getResolution(),r={w:Math.round(this.tileSize.w*n),h:Math.round(this.tileSize.h*n)};if(i.x>-r.w*(e-1))this.shiftColumn(!0,r);else if(i.x<-r.w*e)this.shiftColumn(!1,r);else if(i.y>-r.h*(e-1))this.shiftRow(!0,r);else{if(!(i.y<-r.h*e))break;this.shiftRow(!1,r)}}},shiftRow:function(e,t){var i=this.grid,n=e?0:i.length-1,r=e?-1:1,s=this.rowSign,o=this.gridLayout;o.startrow+=r*s;for(var a=i[n],l=i[e?"pop":"shift"](),u=0,h=l.length;h>u;u++){var c=l[u],p=a[u].position.clone();p.y+=t.h*r,c.moveTo(this.getTileBoundsForGridIndex(n,u),p)}i[e?"unshift":"push"](l)},shiftColumn:function(e,t){var i=this.grid,n=e?0:i[0].length-1,r=e?-1:1,s=this.gridLayout;s.startcol+=r;for(var o=0,a=i.length;a>o;o++){var l=i[o],u=l[n].position.clone(),h=l[e?"pop":"shift"]();u.x+=t.w*r,h.moveTo(this.getTileBoundsForGridIndex(o,n),u),l[e?"unshift":"push"](h)}},removeExcessTiles:function(e,t){for(var i,n;this.grid.length>e;){var r=this.grid.pop();for(i=0,n=r.length;n>i;i++){var s=r[i];this.destroyTile(s)}}for(i=0,n=this.grid.length;n>i;i++)for(;this.grid[i].length>t;){var r=this.grid[i],s=r.pop();this.destroyTile(s)}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(e){var t=this.maxExtent,i=this.getResolution(),n=i*this.tileSize.w,r=i*this.tileSize.h,s=this.getLonLatFromViewPortPx(e),o=t.left+n*Math.floor((s.lon-t.left)/n),a=t.bottom+r*Math.floor((s.lat-t.bottom)/r);return new OpenLayers.Bounds(o,a,o+n,a+r)},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(e,t,i){(i&&i.sphericalMercator||this.sphericalMercator)&&(i=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},i)),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e||this.name,t||this.url,{},i])},clone:function(e){return null==e&&(e=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},getURL:function(e){var t=this.getXYZ(e),i=this.url;if(OpenLayers.Util.isArray(i)){var n=""+t.x+t.y+t.z;i=this.selectUrl(n,i)}return OpenLayers.String.format(i,t)},getXYZ:function(e){var t=this.getServerResolution(),i=Math.round((e.left-this.maxExtent.left)/(t*this.tileSize.w)),n=Math.round((this.maxExtent.top-e.top)/(t*this.tileSize.h)),r=this.getServerZoom();if(this.wrapDateLine){var s=Math.pow(2,r);i=(i%s+s)%s}return{x:i,y:n,z:r}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"}),OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())),e=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e])},CLASS_NAME:"OpenLayers.Layer.OSM"}),OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(e,t){this.container=OpenLayers.Util.getElement(e),OpenLayers.Util.extend(this,t)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(e,t){if(this.extent=e.clone(),this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/i);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(i)}return t&&(this.resolution=null),!0},setSize:function(e){this.size=e.clone(),this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution(),this.resolution},drawFeature:function(e,t){if(null==t&&(t=e.style),e.geometry){var i=e.geometry.getBounds();if(i){var n;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(n=this.map.getMaxExtent()),i.intersectsBounds(this.extent,{worldBounds:n})?this.calculateFeatureDx(i,n):t={display:"none"};var r=this.drawGeometry(e.geometry,t,e.id);if("none"!=t.display&&t.label&&r!==!1){var s=e.geometry.getCentroid();if(t.labelXOffset||t.labelYOffset){var o=isNaN(t.labelXOffset)?0:t.labelXOffset,a=isNaN(t.labelYOffset)?0:t.labelYOffset,l=this.getResolution();s.move(o*l,a*l)}this.drawText(e.id,t,s)}else this.removeText(e.id);return r}}},calculateFeatureDx:function(e,t){if(this.featureDx=0,t){var i=t.getWidth(),n=(this.extent.left+this.extent.right)/2,r=(e.left+e.right)/2,s=Math.round((r-n)/i);this.featureDx=s*i}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0,i=e.length;i>t;++t){var n=e[t];this.eraseGeometry(n.geometry,n.id),this.removeText(n.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(e){var t=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);return e.stroke===!1&&(delete t.strokeWidth,delete t.strokeColor),e.fill===!1&&delete t.fillColor,OpenLayers.Util.extend(t,e),t},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"},OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},setExtent:function(){return OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),!1},eraseGeometry:function(e,t){this.eraseFeatures(this.features[t][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(e){this.size=e.clone();var t=this.root;if(t.style.width=e.w+"px",t.style.height=e.h+"px",t.width=e.w,t.height=e.h,this.resolution=null,this.hitDetection){var i=this.hitCanvas;i.style.width=e.w+"px",i.style.height=e.h+"px",i.width=e.w,i.height=e.h}},drawFeature:function(e,t){var i;if(e.geometry){t=this.applyDefaultSymbolizer(t||e.style);var n,r=e.geometry.getBounds();this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(n=this.map.getMaxExtent());var s=r&&r.intersectsBounds(this.extent,{worldBounds:n});i="none"!==t.display&&!!r&&s,i?this.features[e.id]=[e,t]:delete this.features[e.id],this.pendingRedraw=!0}return this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1),i},drawGeometry:function(e,t,i){var n=e.CLASS_NAME;if("OpenLayers.Geometry.Collection"!=n&&"OpenLayers.Geometry.MultiPoint"!=n&&"OpenLayers.Geometry.MultiLineString"!=n&&"OpenLayers.Geometry.MultiPolygon"!=n)switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(e,t,i);break;case"OpenLayers.Geometry.LineString":this.drawLineString(e,t,i);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(e,t,i);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(e,t,i);break;default:}else for(var r=0;e.components.length>r;r++)this.drawGeometry(e.components[r],t,i)},drawExternalGraphic:function(e,t,i){var n=new Image,r=t.title||t.graphicTitle;r&&(n.title=r);var s=t.graphicWidth||t.graphicHeight,o=t.graphicHeight||t.graphicWidth;s=s?s:2*t.pointRadius,o=o?o:2*t.pointRadius;var a=void 0!=t.graphicXOffset?t.graphicXOffset:-(.5*s),l=void 0!=t.graphicYOffset?t.graphicYOffset:-(.5*o),u=t.graphicOpacity||t.fillOpacity,h=function(){if(this.features[i]){var t=this.getLocalXY(e),r=t[0],h=t[1];if(!isNaN(r)&&!isNaN(h)){var c=0|r+a,p=0|h+l,d=this.canvas;d.globalAlpha=u;var f=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);d.drawImage(n,c*f,p*f,s*f,o*f),this.hitDetection&&(this.setHitContextStyle("fill",i),this.hitContext.fillRect(c,p,s,o))}}};n.onload=OpenLayers.Function.bind(h,this),n.src=t.externalGraphic},drawNamedSymbol:function(e,t,i){var n,r,s,o,a,l,u,h,c,p=Math.PI/180,d=OpenLayers.Renderer.symbol[t.graphicName];if(!d)throw Error(t.graphicName+" is not a valid symbol name");if(d.length&&!(2>d.length)){var f=this.getLocalXY(e),m=f[0],g=f[1];if(!isNaN(m)&&!isNaN(g)){if(this.canvas.lineCap="round",this.canvas.lineJoin="round",this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round"),t.graphicName in this.cachedSymbolBounds)l=this.cachedSymbolBounds[t.graphicName];else{for(l=new OpenLayers.Bounds,a=0;d.length>a;a+=2)l.extend(new OpenLayers.LonLat(d[a],d[a+1]));this.cachedSymbolBounds[t.graphicName]=l}if(this.canvas.save(),this.hitDetection&&this.hitContext.save(),this.canvas.translate(m,g),this.hitDetection&&this.hitContext.translate(m,g),h=p*t.rotation,isNaN(h)||(this.canvas.rotate(h),this.hitDetection&&this.hitContext.rotate(h)),u=2*t.pointRadius/Math.max(l.getWidth(),l.getHeight()),this.canvas.scale(u,u),this.hitDetection&&this.hitContext.scale(u,u),s=l.getCenterLonLat().lon,o=l.getCenterLonLat().lat,this.canvas.translate(-s,-o),this.hitDetection&&this.hitContext.translate(-s,-o),c=t.strokeWidth,t.strokeWidth=c/u,t.fill!==!1){for(this.setCanvasStyle("fill",t),this.canvas.beginPath(),a=0;d.length>a;a+=2)n=d[a],r=d[a+1],0==a&&this.canvas.moveTo(n,r),this.canvas.lineTo(n,r);if(this.canvas.closePath(),this.canvas.fill(),this.hitDetection){for(this.setHitContextStyle("fill",i,t),this.hitContext.beginPath(),a=0;d.length>a;a+=2)n=d[a],r=d[a+1],0==a&&this.canvas.moveTo(n,r),this.hitContext.lineTo(n,r);this.hitContext.closePath(),this.hitContext.fill()}}if(t.stroke!==!1){for(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),a=0;d.length>a;a+=2)n=d[a],r=d[a+1],0==a&&this.canvas.moveTo(n,r),this.canvas.lineTo(n,r);if(this.canvas.closePath(),this.canvas.stroke(),this.hitDetection){for(this.setHitContextStyle("stroke",i,t,u),this.hitContext.beginPath(),a=0;d.length>a;a+=2)n=d[a],r=d[a+1],0==a&&this.hitContext.moveTo(n,r),this.hitContext.lineTo(n,r);this.hitContext.closePath(),this.hitContext.stroke()}}t.strokeWidth=c,this.canvas.restore(),this.hitDetection&&this.hitContext.restore(),this.setCanvasStyle("reset")}}},setCanvasStyle:function(e,t){"fill"===e?(this.canvas.globalAlpha=t.fillOpacity,this.canvas.fillStyle=t.fillColor):"stroke"===e?(this.canvas.globalAlpha=t.strokeOpacity,this.canvas.strokeStyle=t.strokeColor,this.canvas.lineWidth=t.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(e){var t=Number(e.split("_").pop())+1;t>=16777216&&(this.hitOverflow=t-16777215,t=t%16777216+1);var i="000000"+t.toString(16),n=i.length;return i="#"+i.substring(n-6,n)},setHitContextStyle:function(e,t,i,n){var r=this.featureIdToHex(t);"fill"==e?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=r):"stroke"==e?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=r,n===void 0?this.hitContext.lineWidth=i.strokeWidth+2:isNaN(n)||(this.hitContext.lineWidth=i.strokeWidth+2/n)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(e,t,i){if(t.graphic!==!1)if(t.externalGraphic)this.drawExternalGraphic(e,t,i);else if(t.graphicName&&"circle"!=t.graphicName)this.drawNamedSymbol(e,t,i);else{var n=this.getLocalXY(e),r=n[0],s=n[1];if(!isNaN(r)&&!isNaN(s)){var o=2*Math.PI,a=t.pointRadius;t.fill!==!1&&(this.setCanvasStyle("fill",t),this.canvas.beginPath(),this.canvas.arc(r,s,a,0,o,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",i,t),this.hitContext.beginPath(),this.hitContext.arc(r,s,a,0,o,!0),this.hitContext.fill())),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.canvas.beginPath(),this.canvas.arc(r,s,a,0,o,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",i,t),this.hitContext.beginPath(),this.hitContext.arc(r,s,a,0,o,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(e,t,i){t=OpenLayers.Util.applyDefaults({fill:!1},t),this.drawLinearRing(e,t,i)},drawLinearRing:function(e,t,i){t.fill!==!1&&(this.setCanvasStyle("fill",t),this.renderPath(this.canvas,e,t,i,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",i,t),this.renderPath(this.hitContext,e,t,i,"fill"))),t.stroke!==!1&&(this.setCanvasStyle("stroke",t),this.renderPath(this.canvas,e,t,i,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",i,t),this.renderPath(this.hitContext,e,t,i,"stroke"))),this.setCanvasStyle("reset")},renderPath:function(e,t,i,n,r){var s=t.components,o=s.length;e.beginPath();var a=this.getLocalXY(s[0]),l=a[0],u=a[1];if(!isNaN(l)&&!isNaN(u)){e.moveTo(a[0],a[1]);for(var h=1;o>h;++h){var c=this.getLocalXY(s[h]);e.lineTo(c[0],c[1])}"fill"===r?e.fill():e.stroke()}},drawPolygon:function(e,t,i){var n=e.components,r=n.length;this.drawLinearRing(n[0],t,i);for(var s=1;r>s;++s)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(n[s],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},t),i),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(n[s],OpenLayers.Util.applyDefaults({fill:!1},t),i)},drawText:function(e,t){var i=this.getLocalXY(e);this.setCanvasStyle("reset"),this.canvas.fillStyle=t.fontColor,this.canvas.globalAlpha=t.fontOpacity||1;var n=[t.fontStyle?t.fontStyle:"normal","normal",t.fontWeight?t.fontWeight:"normal",t.fontSize?t.fontSize:"1em",t.fontFamily?t.fontFamily:"sans-serif"].join(" "),r=t.label.split("\n"),s=r.length;if(this.canvas.fillText){this.canvas.font=n,this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]]||"center",this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]]||"middle";var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];null==o&&(o=-.5);var a=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;i[1]+=a*o*(s-1);for(var l=0;s>l;l++)t.labelOutlineWidth&&(this.canvas.save(),this.canvas.globalAlpha=t.labelOutlineOpacity||t.fontOpacity||1,this.canvas.strokeStyle=t.labelOutlineColor,this.canvas.lineWidth=t.labelOutlineWidth,this.canvas.strokeText(r[l],i[0],i[1]+a*l+1),this.canvas.restore()),this.canvas.fillText(r[l],i[0],i[1]+a*l)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=n;var u=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];null==u&&(u=-.5);var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];null==o&&(o=-.5);var a=this.canvas.mozMeasureText("xx");i[1]+=a*(1+o*s);for(var l=0;s>l;l++){var h=i[0]+u*this.canvas.mozMeasureText(r[l]),c=i[1]+l*a;this.canvas.translate(h,c),this.canvas.mozDrawText(r[l]),this.canvas.translate(-h,-c)}}this.setCanvasStyle("reset")},getLocalXY:function(e){var t=this.getResolution(),i=this.extent,n=(e.x-this.featureDx)/t+-i.left/t,r=i.top/t-e.y/t;return[n,r]},clear:function(){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.features={},this.hitDetection&&this.hitContext.clearRect(0,0,t,e)},getFeatureIdFromEvent:function(e){var t,i;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging){var n=e.xy,r=0|n.x,s=0|n.y,o=this.hitContext.getImageData(r,s,1,1).data;if(255===o[3]){var a=o[2]+256*(o[1]+256*o[0]);if(a){t="OpenLayers_Feature_Vector_"+(a-1+this.hitOverflow);try{i=this.features[t][0]}catch(l){}}}}return i},eraseFeatures:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=0;e.length>t;++t)delete this.features[e[t].id];this.redraw()},redraw:function(){if(!this.locked){var e=this.root.height,t=this.root.width;this.canvas.clearRect(0,0,t,e),this.hitDetection&&this.hitContext.clearRect(0,0,t,e);var i,n,r,s=[],o=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var a in this.features)this.features.hasOwnProperty(a)&&(i=this.features[a][0],n=i.geometry,this.calculateFeatureDx(n.getBounds(),o),r=this.features[a][1],this.drawGeometry(n,r,i.id),r.label&&s.push([i,r]));for(var l,u=0,h=s.length;h>u;++u)l=s[u],this.drawText(l[0].geometry.getCentroid(),l[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"},OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},OpenLayers.Renderer.Canvas.drawImageScaleFactor=null,OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,touch:!1,initialize:function(e,t,i){OpenLayers.Util.extend(this,i),this.control=e,this.callbacks=t;var n=this.map||e.map;n&&this.setMap(n),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(e){this.map=e},checkModifiers:function(e){if(null==this.keyMask)return!0;var t=(e.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(e.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(e.altKey?OpenLayers.Handler.MOD_ALT:0)|(e.metaKey?OpenLayers.Handler.MOD_META:0);return t==this.keyMask},activate:function(){if(this.active)return!1;for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,t=0,i=e.length;i>t;t++)this[e[t]]&&this.register(e[t],this[e[t]]);return this.active=!0,!0},deactivate:function(){if(!this.active)return!1;for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,t=0,i=e.length;i>t;t++)this[e[t]]&&this.unregister(e[t],this[e[t]]);return this.touch=!1,this.active=!1,!0},startTouch:function(){if(!this.touch){this.touch=!0;for(var e=["mousedown","mouseup","mousemove","click","dblclick","mouseout"],t=0,i=e.length;i>t;t++)this[e[t]]&&this.unregister(e[t],this[e[t]])}},callback:function(e,t){e&&this.callbacks[e]&&this.callbacks[e].apply(this.control,t)},register:function(e,t){this.map.events.registerPriority(e,this,t),this.map.events.registerPriority(e,this,this.setEvent)},unregister:function(e,t){this.map.events.unregister(e,this,t),this.map.events.unregister(e,this,this.setEvent)},setEvent:function(e){return this.evt=e,!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,OpenLayers.Handler.MOD_META=8,OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(){if(OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.documentDrag===!0){var e=this;this._docMove=function(t){e.mousemove({xy:{x:t.clientX,y:t.clientY},element:document})},this._docUp=function(t){e.mouseup({xy:{x:t.clientX,y:t.clientY}})}}},dragstart:function(e){var t=!0;return this.dragging=!1,this.checkModifiers(e)&&(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))?(this.started=!0,this.start=e.xy,this.last=e.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(e),this.callback("down",[e.xy]),OpenLayers.Event.preventDefault(e),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,t=!this.stopDown):(this.started=!1,this.start=null,this.last=null),t},dragmove:function(e){return this.lastMoveEvt=e,!this.started||this.timeoutId||e.xy.x==this.last.x&&e.xy.y==this.last.y||(this.documentDrag===!0&&this.documentEvents&&(e.element===document?(this.adjustXY(e),this.setEvent(e)):this.removeDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(e),this.callback("move",[e.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=e.xy),!0},dragend:function(e){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(e),this.removeDocumentEvents());var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(e),this.callback("up",[e.xy]),t&&this.callback("done",[e.xy]),document.onselectstart=this.oldOnselectstart}return!0},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(e){return this.dragstart(e)},touchstart:function(e){return this.startTouch(),this.dragstart(e)},mousemove:function(e){return this.dragmove(e)},touchmove:function(e){return this.dragmove(e)},removeTimeout:function(){this.timeoutId=null,this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(e){return this.dragend(e)},touchend:function(e){return e.xy=this.last,this.dragend(e)},mouseout:function(e){if(this.started&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv))if(this.documentDrag===!0)this.addDocumentEvents();else{var t=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(e),this.callback("out",[]),t&&this.callback("done",[e.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(){return this.start==this.last},activate:function(){var e=!1;
return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.dragging=!1,this.start=null,this.last=null,e=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")),e},adjustXY:function(e){var t=OpenLayers.Util.pagePosition(this.map.viewPortDiv);e.xy.x-=t[0],e.xy.y-=t[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown"),this.documentEvents=!0,OpenLayers.Event.observe(document,"mousemove",this._docMove),OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents=!1,OpenLayers.Event.stopObserving(document,"mousemove",this._docMove),OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"}),OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate(),this.eventListener=null,OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=this.observeElement||document;for(var e=0,t=this.KEY_EVENTS.length;t>e;e++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[e],this.eventListener);return!0}return!1},deactivate:function(){var e=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var t=0,i=this.KEY_EVENTS.length;i>t;t++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[t],this.eventListener);e=!0}return e},handleKeyEvent:function(e){this.checkModifiers(e)&&this.callback(e.type,[e])},CLASS_NAME:"OpenLayers.Handler.Keyboard"}),OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:!1,geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(e,t){t=t||{},this.layer=e,this.vertices=[],this.virtualVertices=[],this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,t.vertexRenderIntent)),this.virtualStyle.fillOpacity=.3,this.virtualStyle.strokeOpacity=.3,this.deleteCodes=[46,68],this.mode=OpenLayers.Control.ModifyFeature.RESHAPE,OpenLayers.Control.prototype.initialize.apply(this,[t]),OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var i={down:function(){this.vertex=null;var e=this.layer.getFeatureFromEvent(this.handlers.drag.evt);e?this.dragStart(e):this.clickout&&(this._unselect=this.feature)},move:function(e){delete this._unselect,this.vertex&&this.dragVertex(this.vertex,e)},up:function(){this.handlers.drag.stopDown=!1,this._unselect&&(this.unselectFeature(this._unselect),delete this._unselect)},done:function(){this.vertex&&this.dragComplete(this.vertex)}},n={documentDrag:this.documentDrag,stopDown:!1},r={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,r),drag:new OpenLayers.Handler.Drag(this,i,n)}},destroy:function(){this.map&&this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.handlers.keyboard.activate()&&this.handlers.drag.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var e=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.moveLayerBack(),this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.handlers.drag.deactivate(),this.handlers.keyboard.deactivate();var t=this.feature;t&&t.geometry&&t.layer&&this.unselectFeature(t),e=!0}return e},beforeSelectFeature:function(e){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:e})},selectFeature:function(e){if(!(this.feature===e||this.geometryTypes&&-1==OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME))){this.beforeSelectFeature(e)!==!1&&(this.feature&&this.unselectFeature(this.feature),this.feature=e,this.layer.selectedFeatures.push(e),this.layer.drawFeature(e,"select"),this.modified=!1,this.resetVertices(),this.onModificationStart(this.feature));var t=e.modified;!e.geometry||t&&t.geometry||(this._originalGeometry=e.geometry.clone())}},unselectFeature:function(e){this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[],this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle),this.layer.drawFeature(this.feature,"default"),this.feature=null,OpenLayers.Util.removeItem(this.layer.selectedFeatures,e),this.onModificationEnd(e),this.layer.events.triggerEvent("afterfeaturemodified",{feature:e,modified:this.modified}),this.modified=!1},dragStart:function(e){var t="OpenLayers.Geometry.Point"==e.geometry.CLASS_NAME;this.standalone||(e._sketch||!t)&&e._sketch||(this.toggle&&this.feature===e&&(this._unselect=e),this.selectFeature(e)),(e._sketch||t)&&(this.vertex=e,this.handlers.drag.stopDown=!0)},dragVertex:function(e,t){var i=this.map.getLonLatFromViewPortPx(t),n=e.geometry;n.move(i.lon-n.x,i.lat-n.y),this.modified=!0,"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t}):(e._index?(e.geometry.parent.addComponent(e.geometry,e._index),delete e._index,OpenLayers.Util.removeItem(this.virtualVertices,e),this.vertices.push(e)):e==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):e!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:e.geometry,feature:this.feature,pixel:t}),this.virtualVertices.length>0&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:"select")),this.layer.drawFeature(e)},dragComplete:function(){this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var e=this.feature;e.modified=OpenLayers.Util.extend(e.modified,{geometry:this._originalGeometry}),delete this._originalGeometry}},resetVertices:function(){this.vertices.length>0&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]),this.virtualVertices.length>0&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null),this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(e){var t=e.keyCode;if(this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,t)){var i=this.layer.getFeatureFromEvent(this.handlers.drag.evt);i&&-1!=OpenLayers.Util.indexOf(this.vertices,i)&&!this.handlers.drag.dragging&&i.geometry.parent&&(i.geometry.parent.removeComponent(i.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:i.geometry,feature:this.feature,pixel:e.xy}),this.layer.drawFeature(this.feature,this.standalone?void 0:"select"),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))}},collectVertices:function(){function e(i){var n,r,s,o;if("OpenLayers.Geometry.Point"==i.CLASS_NAME)r=new OpenLayers.Feature.Vector(i),r._sketch=!0,r.renderIntent=t.vertexRenderIntent,t.vertices.push(r);else{var a=i.components.length;for("OpenLayers.Geometry.LinearRing"==i.CLASS_NAME&&(a-=1),n=0;a>n;++n)s=i.components[n],"OpenLayers.Geometry.Point"==s.CLASS_NAME?(r=new OpenLayers.Feature.Vector(s),r._sketch=!0,r.renderIntent=t.vertexRenderIntent,t.vertices.push(r)):e(s);if(t.createVertices&&"OpenLayers.Geometry.MultiPoint"!=i.CLASS_NAME)for(n=0,o=i.components.length;o-1>n;++n){var l=i.components[n],u=i.components[n+1];if("OpenLayers.Geometry.Point"==l.CLASS_NAME&&"OpenLayers.Geometry.Point"==u.CLASS_NAME){var h=(l.x+u.x)/2,c=(l.y+u.y)/2,p=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(h,c),null,t.virtualStyle);p.geometry.parent=i,p._index=n+1,p._sketch=!0,t.virtualVertices.push(p)}}}}this.vertices=[],this.virtualVertices=[];var t=this;e.call(this,this.feature.geometry),this.layer.addFeatures(this.virtualVertices,{silent:!0}),this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var e=this.feature.geometry,t=e.getBounds().getCenterLonLat(),i=new OpenLayers.Geometry.Point(t.lon,t.lat),n=new OpenLayers.Feature.Vector(i);i.move=function(t,i){OpenLayers.Geometry.Point.prototype.move.call(this,t,i),e.move(t,i)},n._sketch=!0,this.dragHandle=n,this.dragHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var e=this.feature.geometry,t=e.getBounds(),i=t.getCenterLonLat(),n=new OpenLayers.Geometry.Point(i.lon,i.lat),r=new OpenLayers.Geometry.Point(t.right,t.bottom),s=new OpenLayers.Feature.Vector(r),o=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,a=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,l=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;r.move=function(t,i){OpenLayers.Geometry.Point.prototype.move.call(this,t,i);var r=this.x-n.x,s=this.y-n.y,u=r-t,h=s-i;if(l){var c=Math.atan2(h,u),p=Math.atan2(s,r),d=p-c;d*=180/Math.PI,e.rotate(d,n)}if(o){var f,m;if(a)f=s/h,m=r/u/f;else{var g=Math.sqrt(u*u+h*h),y=Math.sqrt(r*r+s*s);f=y/g}e.resize(f,n,m)}},s._sketch=!0,this.radiusHandle=s,this.radiusHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(e){this.handlers.drag.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(e){("removelayer"==e.type||"order"==e.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var e=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(e)},moveLayerBack:function(){var e=this.layer.getZIndex()-1;e>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(e):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}),OpenLayers.Control.ModifyFeature.RESHAPE=1,OpenLayers.Control.ModifyFeature.RESIZE=2,OpenLayers.Control.ModifyFeature.ROTATE=4,OpenLayers.Control.ModifyFeature.DRAG=8,OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677,.14929107084870338,.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(e){e=OpenLayers.Util.applyDefaults({sphericalMercator:!0},e);var t=e.name||"Bing "+(e.type||this.type),i=[t,null,e];OpenLayers.Layer.XYZ.prototype.initialize.apply(this,i),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions),this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_"),window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var e=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),t=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(e),i=document.createElement("script");i.type="text/javascript",i.src=t,i.id=this._callbackId,document.getElementsByTagName("head")[0].appendChild(i)},initLayer:function(){var e=this.metadata.resourceSets[0].resources[0],t=e.imageUrl.replace("{quadkey}","${quadkey}");t=t.replace("{culture}",this.culture),t=t.replace(this.protocolRegex,this.protocol),this.url=[];for(var i=0;e.imageUrlSubdomains.length>i;++i)this.url.push(t.replace("{subdomain}",e.imageUrlSubdomains[i]));this.addOptions({maxResolution:Math.min(this.serverResolutions[e.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(e.zoomMax+1-e.zoomMin,this.numZoomLevels)},!0),this.isBaseLayer||this.redraw(),this.updateAttribution()},getURL:function(e){if(this.url){for(var t=this.getXYZ(e),i=t.x,n=t.y,r=t.z,s=[],o=r;o>0;--o){var a="0",l=1<<o-1;0!=(i&l)&&a++,0!=(n&l)&&(a++,a++),s.push(a)}var u=s.join(""),h=this.selectUrl(""+i+n+r,this.url);return OpenLayers.String.format(h,{quadkey:u})}},updateAttribution:function(){var e=this.metadata;if(e.resourceSets&&this.map&&this.map.center){var t,i,n,r,s,o,a,l=e.resourceSets[0].resources[0],u=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),h=l.imageryProviders||[],c=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),p="";for(i=0,n=h.length;n>i;++i)for(t=h[i],r=0,s=t.coverageAreas.length;s>r;++r)a=t.coverageAreas[r],o=OpenLayers.Bounds.fromArray(a.bbox,!0),u.intersectsBounds(o)&&a.zoomMax>=c&&c>=a.zoomMin&&(p+=t.attribution+" ");var d=e.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:d,copyrights:p}),this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.updateAttribution)},clone:function(e){return null==e&&(e=new OpenLayers.Layer.Bing(this.options)),e=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution),OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"}),OpenLayers.Layer.Bing.processMetadata=function(e){this.metadata=e,this.initLayer();var t=document.getElementById(this._callbackId);t.parentNode.removeChild(t),window[this._callbackId]=void 0,delete this._callbackId},OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:!0,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(e){if(this.map&&this.checkModifiers(e)){for(var t=!1,i=!1,n=!1,r=OpenLayers.Event.element(e);null!=r&&!n&&!t;){if(!t)try{var s;if(r.currentStyle)s=r.currentStyle.overflow;else{var o=document.defaultView.getComputedStyle(r,null);s=o.getPropertyValue("overflow")}t=s&&"auto"==s||"scroll"==s}catch(a){}if(!i&&(i=OpenLayers.Element.hasClass(r,"olScrollable"),!i))for(var l=0,u=this.map.layers.length;u>l;l++){var h=this.map.layers[l];if(r==h.div||r==h.pane){i=!0;break}}n=r==this.map.div,r=r.parentNode}if(!t&&n){if(i){var c=0;if(e.wheelDelta?(c=e.wheelDelta,0===c%160&&(c=.75*c),c/=120):e.detail&&(c=-(e.detail/Math.abs(e.detail))),this.delta+=c,window.clearTimeout(this._timeoutId),this.interval&&Math.abs(this.delta)<this.maxDelta){var p=OpenLayers.Util.extend({},e);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(p)},this),this.interval)}else this.wheelZoom(e)}OpenLayers.Event.stop(e)}}},wheelZoom:function(e){var t=this.delta;this.delta=0,t&&(e.xy=this.map.events.getMousePosition(e),0>t?this.callback("down",[e,this.cumulative?Math.max(-this.maxDelta,t):-1]):this.callback("up",[e,this.cumulative?Math.min(this.maxDelta,t):1]))},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var e=this.wheelListener;return OpenLayers.Event.observe(window,"DOMMouseScroll",e),OpenLayers.Event.observe(window,"mousewheel",e),OpenLayers.Event.observe(document,"mousewheel",e),!0}return!1},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var e=this.wheelListener;return OpenLayers.Event.stopObserving(window,"DOMMouseScroll",e),OpenLayers.Event.stopObserving(window,"mousewheel",e),OpenLayers.Event.stopObserving(document,"mousewheel",e),!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(e,t){for(var i,n,r,s,o,a=null,l=t&&t.mutual,u=[],h=[e],c=0,p=this.components.length;p>c;++c){n=this.components[c],s=!1;for(var d=0;h.length>d;++d)if(i=n.split(h[d],t)){if(l){r=i[0];for(var f=0,m=r.length;m>f;++f)0===f&&u.length?u[u.length-1].addComponent(r[f]):u.push(new OpenLayers.Geometry.MultiLineString([r[f]]));s=!0,i=i[1]}if(i.length){i.unshift(d,1),Array.prototype.splice.apply(h,i);break}}s||(u.length?u[u.length-1].addComponent(n.clone()):u=[new OpenLayers.Geometry.MultiLineString(n.clone())])}return u&&u.length>1?s=!0:u=[],h&&h.length>1?o=!0:h=[],(s||o)&&(a=l?[u,h]:h),a},splitWith:function(e,t){var i,n,r,s,o,a,l,u=null,h=t&&t.mutual;if(e instanceof OpenLayers.Geometry.LineString){l=[],a=[e];for(var c=0,p=this.components.length;p>c;++c){o=!1,n=this.components[c];for(var d=0;a.length>d;++d)if(i=a[d].split(n,t)){h&&(r=i[0],r.length&&(r.unshift(d,1),Array.prototype.splice.apply(a,r),d+=r.length-2),i=i[1],0===i.length&&(i=[n.clone()]));for(var f=0,m=i.length;m>f;++f)0===f&&l.length?l[l.length-1].addComponent(i[f]):l.push(new OpenLayers.Geometry.MultiLineString([i[f]]));o=!0}o||(l.length?l[l.length-1].addComponent(n.clone()):l=[new OpenLayers.Geometry.MultiLineString([n.clone()])])}}else u=e.split(this);return a&&a.length>1?s=!0:a=[],l&&l.length>1?o=!0:l=[],(s||o)&&(u=h?[a,l]:l),u},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e},destroy:function(){},read:function(){throw Error("Read not implemented.")},write:function(){throw Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"}),OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify)}(),read:function(json,filter){function walk(e,t){if(t&&"object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(t[i]=walk(i,t[i]));return filter(e,t)}var object;if(this.nativeJSON)object=JSON.parse(json,filter);else try{/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(object=eval("("+json+")"),"function"==typeof filter&&(object=walk("",object)))}catch(e){}return this.keepData&&(this.data=object),object},write:function(e,t){this.pretty=!!t;var i=null,n=typeof e;if(this.serialize[n])try{i=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[n].apply(this,[e])}catch(r){OpenLayers.Console.error("Trouble serializing: "+r)}return i},writeIndent:function(){var e=[];if(this.pretty)for(var t=0;this.level>t;++t)e.push(this.indent);return e.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(e){if(null==e)return"null";if(e.constructor==Date)return this.serialize.date.apply(this,[e]);if(e.constructor==Array)return this.serialize.array.apply(this,[e]);var t=["{"];this.level+=1;var i,n,r,s=!1;for(i in e)e.hasOwnProperty(i)&&(n=OpenLayers.Format.JSON.prototype.write.apply(this,[i,this.pretty]),r=OpenLayers.Format.JSON.prototype.write.apply(this,[e[i],this.pretty]),null!=n&&null!=r&&(s&&t.push(","),t.push(this.writeNewline(),this.writeIndent(),n,":",this.writeSpace(),r),s=!0));return this.level-=1,t.push(this.writeNewline(),this.writeIndent(),"}"),t.join("")},array:function(e){var t,i=["["];this.level+=1;for(var n=0,r=e.length;r>n;++n)t=OpenLayers.Format.JSON.prototype.write.apply(this,[e[n],this.pretty]),null!=t&&(n>0&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),t));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"]"),i.join("")},string:function(e){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,i){var n=t[i];return n?n:(n=i.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'"':'"'+e+'"'},number:function(e){return isFinite(e)?e+"":"null"},"boolean":function(e){return e+""},date:function(e){function t(e){return 10>e?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"}),OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(e){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")),OpenLayers.Format.prototype.initialize.apply(this,[e]),this.namespaces=OpenLayers.Util.extend({},this.namespaces),this.namespaceAlias={};for(var t in this.namespaces)this.namespaceAlias[this.namespaces[t]]=t},destroy:function(){this.xmldom=null,OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(e,t){this.namespaces[e]=t,this.namespaceAlias[t]=e},read:function(e){var t=e.indexOf("<");t>0&&(e=e.substring(t));var i=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var t;return t=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom,t.loadXML(e),t},this),function(){return(new DOMParser).parseFromString(e,"text/xml")},function(){var t=new XMLHttpRequest;return t.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),t.overrideMimeType&&t.overrideMimeType("text/xml"),t.send(null),t.responseXML});return this.keepData&&(this.data=i),i},write:function(e){var t;if(this.xmldom)t=e.xml;else{var i=new XMLSerializer;if(1==e.nodeType){var n=document.implementation.createDocument("","",null);n.importNode&&(e=n.importNode(e,!0)),n.appendChild(e),t=i.serializeToString(n)}else t=i.serializeToString(e)}return t},createElementNS:function(e,t){var i;return i=this.xmldom?"string"==typeof e?this.xmldom.createNode(1,t,e):this.xmldom.createNode(1,t,""):document.createElementNS(e,t)},createDocumentFragment:function(){var e;return e=this.xmldom?this.xmldom.createDocumentFragment():document.createDocumentFragment()},createTextNode:function(e){var t;return"string"!=typeof e&&(e+=""),t=this.xmldom?this.xmldom.createTextNode(e):document.createTextNode(e)},getElementsByTagNameNS:function(e,t,i){var n=[];if(e.getElementsByTagNameNS)n=e.getElementsByTagNameNS(t,i);else for(var r,s,o=e.getElementsByTagName("*"),a=0,l=o.length;l>a;++a)r=o[a],s=r.prefix?r.prefix+":"+i:i,("*"==i||s==r.nodeName)&&("*"==t||t==r.namespaceURI)&&n.push(r);return n},getAttributeNodeNS:function(e,t,i){var n=null;if(e.getAttributeNodeNS)n=e.getAttributeNodeNS(t,i);else for(var r,s,o=e.attributes,a=0,l=o.length;l>a;++a)if(r=o[a],r.namespaceURI==t&&(s=r.prefix?r.prefix+":"+i:i,s==r.nodeName)){n=r;break}return n},getAttributeNS:function(e,t,i){var n="";if(e.getAttributeNS)n=e.getAttributeNS(t,i)||"";else{var r=this.getAttributeNodeNS(e,t,i);r&&(n=r.nodeValue)}return n},getChildValue:function(e,t){var i=t||"";if(e)for(var n=e.firstChild;n;n=n.nextSibling)switch(n.nodeType){case 3:case 4:i+=n.nodeValue}return i},isSimpleContent:function(e){for(var t=!0,i=e.firstChild;i;i=i.nextSibling)if(1===i.nodeType){t=!1;break}return t},contentType:function(e){for(var t=!1,i=!1,n=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,r=e.firstChild;r;r=r.nextSibling){switch(r.nodeType){case 1:i=!0;break;case 8:break;default:t=!0}if(i&&t)break}if(i&&t)n=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(i)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(t)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return n},hasAttributeNS:function(e,t,i){var n=!1;return n=e.hasAttributeNS?e.hasAttributeNS(t,i):!!this.getAttributeNodeNS(e,t,i)},setAttributeNS:function(e,t,i,n){if(e.setAttributeNS)e.setAttributeNS(t,i,n);else{if(!this.xmldom)throw"setAttributeNS not implemented";if(t){var r=e.ownerDocument.createNode(2,i,t);r.nodeValue=n,e.setAttributeNode(r)}else e.setAttribute(i,n)}},createElementNSPlus:function(e,t){t=t||{};var i=t.uri||this.namespaces[t.prefix];if(!i){var n=e.indexOf(":");i=this.namespaces[e.substring(0,n)]}i||(i=this.namespaces[this.defaultPrefix]);var r=this.createElementNS(i,e);t.attributes&&this.setAttributes(r,t.attributes);var s=t.value;return null!=s&&r.appendChild(this.createTextNode(s)),r},setAttributes:function(e,t){var i,n;for(var r in t)null!=t[r]&&t[r].toString&&(i=""+t[r],n=this.namespaces[r.substring(0,r.indexOf(":"))]||null,this.setAttributeNS(e,n,r,i))},readNode:function(e,t){t||(t={});var i=this.readers[e.namespaceURI?this.namespaceAlias[e.namespaceURI]:this.defaultPrefix];if(i){var n=e.localName||e.nodeName.split(":").pop(),r=i[n]||i["*"];r&&r.apply(this,[e,t])}return t},readChildNodes:function(e,t){t||(t={});for(var i,n=e.childNodes,r=0,s=n.length;s>r;++r)i=n[r],1==i.nodeType&&this.readNode(i,t);return t},writeNode:function(e,t,i){var n,r,s=e.indexOf(":");s>0?(n=e.substring(0,s),r=e.substring(s+1)):(n=i?this.namespaceAlias[i.namespaceURI]:this.defaultPrefix,r=e);var o=this.writers[n][r].apply(this,[t]);return i&&i.appendChild(o),o},getChildEl:function(e,t,i){return e&&this.getThisOrNextEl(e.firstChild,t,i)},getNextEl:function(e,t,i){return e&&this.getThisOrNextEl(e.nextSibling,t,i)},getThisOrNextEl:function(e,t,i){e:for(var n=e;n;n=n.nextSibling)switch(n.nodeType){case 1:if(!(t&&t!==(n.localName||n.nodeName.split(":").pop())||i&&i!==n.namespaceURI))break e;n=null;break e;case 3:if(/^\s*$/.test(n.nodeValue))break;case 4:case 6:case 12:case 10:case 11:n=null;break e}return n||null},lookupNamespaceURI:function(e,t){var i=null;if(e)if(e.lookupNamespaceURI)i=e.lookupNamespaceURI(t);else e:switch(e.nodeType){case 1:if(null!==e.namespaceURI&&e.prefix===t){i=e.namespaceURI;break e}var n=e.attributes.length;if(n)for(var r,s=0;n>s;++s){if(r=e.attributes[s],"xmlns"===r.prefix&&r.name==="xmlns:"+t){i=r.value||null;break e}if("xmlns"===r.name&&null===t){i=r.value||null;break e}}i=this.lookupNamespaceURI(e.parentNode,t);break e;case 2:i=this.lookupNamespaceURI(e.ownerElement,t);break e;case 9:i=this.lookupNamespaceURI(e.documentElement,t);break e;case 6:case 12:case 10:case 11:break e;default:i=this.lookupNamespaceURI(e.parentNode,t)}return i},getXMLDoc:function(){return OpenLayers.Format.XML.document||this.xmldom||(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"))),OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"}),OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3},OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype),OpenLayers.Format.XML.document=null,OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var t=e.documentElement,i={exceptionReport:null};return t&&(this.readChildNodes(e,i),null===i.exceptionReport&&(i=(new OpenLayers.Format.OWSCommon).read(e))),i},readers:{ogc:{ServiceExceptionReport:function(e,t){t.exceptionReport={exceptions:[]},this.readChildNodes(e,t.exceptionReport)},ServiceException:function(e,t){var i={code:e.getAttribute("code"),locator:e.getAttribute("locator"),text:this.getChildValue(e)};t.exceptions.push(i)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"}),OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:!1,name:null,stringifyOutput:!1,parser:null,initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]);var t=this.CLASS_NAME;this.name=t.substring(t.lastIndexOf(".")+1)},getVersion:function(e,t){var i;return e?(i=this.version,i||(i=e.getAttribute("version"),i||(i=this.defaultVersion))):i=t&&t.version||this.version||this.defaultVersion,i},getParser:function(e){e=e||this.defaultVersion;var t=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=e){var i=OpenLayers.Format[this.name]["v"+e.replace(/\./g,"_")+t];if(!i&&(""!==t&&this.allowFallback&&(t="",i=OpenLayers.Format[this.name]["v"+e.replace(/\./g,"_")]),!i))throw"Can't find a "+this.name+" parser for version "+e+t;this.parser=new i(this.options)}return this.parser},write:function(e,t){var i=this.getVersion(null,t);this.parser=this.getParser(i);var n=this.parser.write(e,t);return this.stringifyOutput===!1?n:OpenLayers.Format.XML.prototype.write.apply(this,[n])},read:function(e,t){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));var i=e.documentElement,n=this.getVersion(i);this.parser=this.getParser(n);var r=this.parser.read(e,t),s=this.parser.errorProperty||null;if(null!==s&&void 0===r[s]){var o=new OpenLayers.Format.OGCExceptionReport;r.error=o.read(e)}return r.version=n,r},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"}),OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,t,i){this.layer=e,this.lonlat=t,this.data=null!=i?i:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")
},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup),null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,null!=this.marker&&(this.destroyMarker(this.marker),this.marker=null),null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var e=!1;if(null!=this.layer&&null!=this.layer.map){var t=this.layer.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},createMarker:function(){return null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(e){if(null!=this.lonlat){if(!this.popup){var t=this.marker?this.marker.icon:null,i=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new i(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,t,e)}null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,t,i){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,t]),this.lonlat=null,this.geometry=e?e:null,this.state=null,this.attributes={},t&&(this.attributes=OpenLayers.Util.extend(this.attributes,t)),this.style=i?i:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,this.modified=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(e){var t=!1;if(this.layer&&this.layer.map){var i=this.layer.map.getExtent();if(e){var n=this.geometry.getBounds();t=i.intersectsBounds(n)}else{var r=i.toGeometry();t=r.intersects(this.geometry)}}return t},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(e,t,i){var n=!1;return this.geometry&&(n=this.geometry.atPoint(e,t,i)),n},destroyPopup:function(){},move:function(e){if(!this.layer||!this.geometry.move)return void 0;var t;t="OpenLayers.LonLat"==e.CLASS_NAME?this.layer.getViewPortPxFromLonLat(e):e;var i=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),n=this.layer.map.getResolution();return this.geometry.move(n*(t.x-i.x),n*(i.y-t.y)),this.layer.drawFeature(this),i},toState:function(e){if(e==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=e;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(e==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=e}else if(e==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=e}else e==OpenLayers.State.UNKNOWN&&(this.state=e)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}},OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(e,t){OpenLayers.Util.extend(this,t),this.rules=[],t&&t.rules&&this.addRules(t.rules),this.setDefaultStyle(e||OpenLayers.Feature.Vector.style["default"]),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;t>e;e++)this.rules[e].destroy(),this.rules[e]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(e){for(var t,i=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),e),n=this.rules,r=[],s=!1,o=0,a=n.length;a>o;o++){t=n[o];var l=t.evaluate(e);l&&(t instanceof OpenLayers.Rule&&t.elseFilter?r.push(t):(s=!0,this.applySymbolizer(t,i,e)))}if(0==s&&r.length>0){s=!0;for(var o=0,a=r.length;a>o;o++)this.applySymbolizer(r[o],i,e)}return n.length>0&&0==s&&(i.display="none"),null!=i.label&&"string"!=typeof i.label&&(i.label=i.label+""),i},applySymbolizer:function(e,t,i){var n=i.geometry?this.getSymbolizerPrefix(i.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],r=e.symbolizer[n]||e.symbolizer;if(this.defaultsPerSymbolizer===!0){var s=this.defaultStyle;OpenLayers.Util.applyDefaults(r,{pointRadius:s.pointRadius}),(r.stroke===!0||r.graphic===!0)&&OpenLayers.Util.applyDefaults(r,{strokeWidth:s.strokeWidth,strokeColor:s.strokeColor,strokeOpacity:s.strokeOpacity,strokeDashstyle:s.strokeDashstyle,strokeLinecap:s.strokeLinecap}),(r.fill===!0||r.graphic===!0)&&OpenLayers.Util.applyDefaults(r,{fillColor:s.fillColor,fillOpacity:s.fillOpacity}),r.graphic===!0&&OpenLayers.Util.applyDefaults(r,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(t,r),i)},createLiterals:function(e,t){var i=OpenLayers.Util.extend({},t.attributes||t.data);OpenLayers.Util.extend(i,this.context);for(var n in this.propertyStyles)e[n]=OpenLayers.Style.createLiteral(e[n],i,t,n);return e},findPropertyStyles:function(){var e={},t=this.defaultStyle;this.addPropertyStyles(e,t);for(var i,n,r=this.rules,s=0,o=r.length;o>s;s++){i=r[s].symbolizer;for(var a in i){if(n=i[a],"object"!=typeof n){this.addPropertyStyles(e,i);break}this.addPropertyStyles(e,n)}}return e},addPropertyStyles:function(e,t){var i;for(var n in t)i=t[n],"string"==typeof i&&i.match(/\$\{\w+\}/)&&(e[n]=!0);return e},addRules:function(e){Array.prototype.push.apply(this.rules,e),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(e){this.defaultStyle=e,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(e){for(var t=OpenLayers.Style.SYMBOLIZER_PREFIXES,i=0,n=t.length;n>i;i++)if(-1!=e.CLASS_NAME.indexOf(t[i]))return t[i]},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,i=this.rules.length;i>t;++t)e.rules.push(this.rules[t].clone())}e.context=this.context&&OpenLayers.Util.extend({},this.context);var n=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(n,e)},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(e,t,i,n){return"string"==typeof e&&-1!=e.indexOf("${")&&(e=OpenLayers.String.format(e,t,[i,n]),e=isNaN(e)||!e?e:parseFloat(e)),e},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"],OpenLayers.Filter=OpenLayers.Class({initialize:function(e){OpenLayers.Util.extend(this,e)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){var e;return e=OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"}),OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(e){this.fids=[],OpenLayers.Filter.prototype.initialize.apply(this,[e])},evaluate:function(e){for(var t=0,i=this.fids.length;i>t;t++){var n=e.fid||e.id;if(n==this.fids[t])return!0}return!1},clone:function(){var e=new OpenLayers.Filter.FeatureId;return OpenLayers.Util.extend(e,this),e.fids=this.fids.slice(),e},CLASS_NAME:"OpenLayers.Filter.FeatureId"}),OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(e){this.filters=[],OpenLayers.Filter.prototype.initialize.apply(this,[e])},destroy:function(){this.filters=null,OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(e){var t,i;switch(this.type){case OpenLayers.Filter.Logical.AND:for(t=0,i=this.filters.length;i>t;t++)if(0==this.filters[t].evaluate(e))return!1;return!0;case OpenLayers.Filter.Logical.OR:for(t=0,i=this.filters.length;i>t;t++)if(1==this.filters[t].evaluate(e))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(e)}return void 0},clone:function(){for(var e=[],t=0,i=this.filters.length;i>t;++t)e.push(this.filters[t].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:e})},CLASS_NAME:"OpenLayers.Filter.Logical"}),OpenLayers.Filter.Logical.AND="&&",OpenLayers.Filter.Logical.OR="||",OpenLayers.Filter.Logical.NOT="!",OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(e){OpenLayers.Filter.prototype.initialize.apply(this,[e]),this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===e.matchCase&&(this.matchCase=null)},evaluate:function(e){e instanceof OpenLayers.Feature.Vector&&(e=e.attributes);var t,i=!1,n=e[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:t=this.value,i=this.matchCase||"string"!=typeof n||"string"!=typeof t?n==t:n.toUpperCase()==t.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:t=this.value,i=this.matchCase||"string"!=typeof n||"string"!=typeof t?n!=t:n.toUpperCase()!=t.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:i=this.value>n;break;case OpenLayers.Filter.Comparison.GREATER_THAN:i=n>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:i=this.value>=n;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:i=n>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:i=n>=this.lowerBoundary&&this.upperBoundary>=n;break;case OpenLayers.Filter.Comparison.LIKE:var r=RegExp(this.value,"gi");i=r.test(n);break;case OpenLayers.Filter.Comparison.IS_NULL:i=null===n}return i},value2regex:function(e,t,i){if("."==e)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");return e=e?e:"*",t=t?t:".",i=i?i:"!",this.value=this.value.replace(RegExp("\\"+i+"(.|$)","g"),"\\$1"),this.value=this.value.replace(RegExp("\\"+t,"g"),"."),this.value=this.value.replace(RegExp("\\"+e,"g"),".*"),this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+e),this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+t),this.value},regex2value:function(){var e=this.value;return e=e.replace(/!/g,"!!"),e=e.replace(/(\\)?\\\./g,function(e,t){return t?e:"!."}),e=e.replace(/(\\)?\\\*/g,function(e,t){return t?e:"!*"}),e=e.replace(/\\\\/g,"\\"),e=e.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"}),OpenLayers.Filter.Comparison.EQUAL_TO="==",OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=",OpenLayers.Filter.Comparison.LESS_THAN="<",OpenLayers.Filter.Comparison.GREATER_THAN=">",OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=",OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=",OpenLayers.Filter.Comparison.BETWEEN="..",OpenLayers.Filter.Comparison.LIKE="~",OpenLayers.Filter.Comparison.IS_NULL="NULL",OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"}),OpenLayers.Format.WFST=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Format.WFST.DEFAULTS);var t=OpenLayers.Format.WFST["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported WFST version: "+e.version;return new t(e)},OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"},OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(e){var t=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(e.geometry){var i=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(i=this.value.toGeometry()),e.geometry.intersects(i)&&(t=!0)}break;default:throw Error("evaluate is not implemented for this filter type.")}return t},clone:function(){var e=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(e)},CLASS_NAME:"OpenLayers.Filter.Spatial"}),OpenLayers.Filter.Spatial.BBOX="BBOX",OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS",OpenLayers.Filter.Spatial.DWITHIN="DWITHIN",OpenLayers.Filter.Spatial.WITHIN="WITHIN",OpenLayers.Filter.Spatial.CONTAINS="CONTAINS",OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(e){this.stateName={},this.stateName[OpenLayers.State.INSERT]="wfs:Insert",this.stateName[OpenLayers.State.UPDATE]="wfs:Update",this.stateName[OpenLayers.State.DELETE]="wfs:Delete",OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},getSrsName:function(e,t){var i=t&&t.srsName;return i||(i=e&&e.layer?e.layer.projection.getCode():this.srsName),i},read:function(e,t){t=t||{},OpenLayers.Util.applyDefaults(t,{output:"features"}),"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var i={};return e&&this.readNode(e,i,!0),i.features&&"features"===t.output&&(i=i.features),i},readers:{wfs:{FeatureCollection:function(e,t){t.features=[],this.readChildNodes(e,t)}}},write:function(e,t){var i=this.writeNode("wfs:Transaction",{features:e,options:t}),n=this.schemaLocationAttr();return n&&this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",n),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{wfs:{GetFeature:function(e){var t=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:e&&e.handle,outputFormat:e&&e.outputFormat,maxFeatures:e&&e.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(e)}});if("string"==typeof this.featureType)this.writeNode("Query",e,t);else for(var i=0,n=this.featureType.length;n>i;i++)e.featureType=this.featureType[i],this.writeNode("Query",e,t);return t},Transaction:function(e){e=e||{};var t,i,n=e.options||{},r=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:n.handle}}),s=e.features;if(s){n.multi===!0&&OpenLayers.Util.extend(this.geometryTypes,{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":this.multiCurve===!0?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":this.multiSurface===!0?"MultiSurface":"MultiPolygon"});var o,a;for(t=0,i=s.length;i>t;++t)a=s[t],o=this.stateName[a.state],o&&this.writeNode(o,{feature:a,options:n},r);n.multi===!0&&this.setGeometryTypes()}if(n.nativeElements)for(t=0,i=n.nativeElements.length;i>t;++t)this.writeNode("wfs:Native",n.nativeElements[t],r);return r},Native:function(e){var t=this.createElementNSPlus("wfs:Native",{attributes:{vendorId:e.vendorId,safeToIgnore:e.safeToIgnore},value:e.value});return t},Insert:function(e){var t=e.feature,i=e.options,n=this.createElementNSPlus("wfs:Insert",{attributes:{handle:i&&i.handle}});return this.srsName=this.getSrsName(t),this.writeNode("feature:_typeName",t,n),n},Update:function(e){var t=e.feature,i=e.options,n=this.createElementNSPlus("wfs:Update",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var r=t.modified;null===this.geometryName||r&&void 0===r.geometry||(this.srsName=this.getSrsName(t),this.writeNode("Property",{name:this.geometryName,value:t.geometry},n));for(var s in t.attributes)void 0===t.attributes[s]||r&&r.attributes&&(!r.attributes||void 0===r.attributes[s])||this.writeNode("Property",{name:s,value:t.attributes[s]},n);return this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[t.fid]}),n),n},Property:function(e){var t=this.createElementNSPlus("wfs:Property");return this.writeNode("Name",e.name,t),null!==e.value&&this.writeNode("Value",e.value,t),t},Name:function(e){return this.createElementNSPlus("wfs:Name",{value:e})},Value:function(e){var t;if(e instanceof OpenLayers.Geometry){t=this.createElementNSPlus("wfs:Value");var i=this.writeNode("feature:_geometry",e).firstChild;t.appendChild(i)}else t=this.createElementNSPlus("wfs:Value",{value:e});return t},Delete:function(e){var t=e.feature,i=e.options,n=this.createElementNSPlus("wfs:Delete",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});return this.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[t.fid]}),n),n}}},schemaLocationAttr:function(e){e=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},e);var t=OpenLayers.Util.extend({},this.schemaLocations);e.schema&&(t[e.featurePrefix]=e.schema);var i,n=[];for(var r in t)i=this.namespaces[r],i&&n.push(i+" "+t[r]);var s=n.join(" ")||void 0;return s},setFilterProperty:function(e){if(e.filters)for(var t=0,i=e.filters.length;i>t;++t)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,e.filters[t]);else e instanceof OpenLayers.Filter.Spatial&&!e.property&&(e.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"}),OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,i=this.components.length;i>t;t++)e-=Math.abs(this.components[t].getArea())}return e},getGeodesicArea:function(e){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getGeodesicArea(e));for(var i=1,n=this.components.length;n>i;i++)t-=Math.abs(this.components[i].getGeodesicArea(e))}return t},containsPoint:function(e){var t=this.components.length,i=!1;if(t>0&&(i=this.components[0].containsPoint(e),1!==i&&i&&t>1))for(var n,r=1;t>r;++r)if(n=this.components[r].containsPoint(e)){i=1===n?1:!1;break}return i},intersects:function(e){var t,i,n=!1;if("OpenLayers.Geometry.Point"==e.CLASS_NAME)n=this.containsPoint(e);else if("OpenLayers.Geometry.LineString"==e.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==e.CLASS_NAME){for(t=0,i=this.components.length;i>t&&!(n=e.intersects(this.components[t]));++t);if(!n)for(t=0,i=e.components.length;i>t&&!(n=this.containsPoint(e.components[t]));++t);}else for(t=0,i=e.components.length;i>t&&!(n=this.intersects(e.components[t]));++t);if(!n&&"OpenLayers.Geometry.Polygon"==e.CLASS_NAME){var r=this.components[0];for(t=0,i=r.components.length;i>t&&!(n=e.containsPoint(r.components[t]));++t);}return n},distanceTo:function(e,t){var i,n=!(t&&t.edge===!1);return i=!n&&this.intersects(e)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[e,t])},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(e,t,i,n){var r=Math.PI*(1/i-.5);n&&(r+=n/180*Math.PI);for(var s,o,a,l=[],u=0;i>u;++u)s=r+2*u*Math.PI/i,o=e.x+t*Math.cos(s),a=e.y+t*Math.sin(s),l.push(new OpenLayers.Geometry.Point(o,a));var h=new OpenLayers.Geometry.LinearRing(l);return new OpenLayers.Geometry.Polygon([h])},OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"}),OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(e){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var t=this.getElementsByTagNameNS(e.documentElement,this.gmlns,this.featureName),i=[],n=0;t.length>n;n++){var r=this.parseFeature(t[n]);r&&i.push(r)}return i},parseFeature:function(e){for(var t,i,n,r,s=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"],o=0;s.length>o;++o)if(t=s[o],i=this.getElementsByTagNameNS(e,this.gmlns,t),i.length>0){if(r=this.parseGeometry[t.toLowerCase()],!r)throw new TypeError("Unsupported geometry type: "+t);n=r.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&n.transform(this.externalProjection,this.internalProjection);break}var a,l=this.getElementsByTagNameNS(e,this.gmlns,"Box");for(o=0;l.length>o;++o){var u=l[o],h=this.parseGeometry.box.apply(this,[u]),c=u.parentNode,p=c.localName||c.nodeName.split(":").pop();"boundedBy"===p?a=h:n=h.toGeometry()}var d;this.extractAttributes&&(d=this.parseAttributes(e));var f=new OpenLayers.Feature.Vector(n,d);f.bounds=a,f.gml={featureType:e.firstChild.nodeName.split(":")[1],featureNS:e.firstChild.namespaceURI,featureNSPrefix:e.firstChild.prefix};for(var m,g=e.firstChild;g&&(1!=g.nodeType||!(m=g.getAttribute("fid")||g.getAttribute("id")));)g=g.nextSibling;return f.fid=m,f},parseGeometry:{point:function(e){var t,i,n=[],t=this.getElementsByTagNameNS(e,this.gmlns,"pos");if(t.length>0&&(i=t[0].firstChild.nodeValue,i=i.replace(this.regExes.trimSpace,""),n=i.split(this.regExes.splitSpace)),0==n.length&&(t=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),t.length>0&&(i=t[0].firstChild.nodeValue,i=i.replace(this.regExes.removeSpace,""),n=i.split(","))),0==n.length&&(t=this.getElementsByTagNameNS(e,this.gmlns,"coord"),t.length>0)){var r=this.getElementsByTagNameNS(t[0],this.gmlns,"X"),s=this.getElementsByTagNameNS(t[0],this.gmlns,"Y");r.length>0&&s.length>0&&(n=[r[0].firstChild.nodeValue,s[0].firstChild.nodeValue])}return 2==n.length&&(n[2]=null),this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2])},multipoint:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Point"),i=[];if(t.length>0)for(var n,r=0;t.length>r;++r)n=this.parseGeometry.point.apply(this,[t[r]]),n&&i.push(n);return new OpenLayers.Geometry.MultiPoint(i)},linestring:function(e,t){var i,n,r=[],s=[];if(i=this.getElementsByTagNameNS(e,this.gmlns,"posList"),i.length>0){n=this.getChildValue(i[0]),n=n.replace(this.regExes.trimSpace,""),r=n.split(this.regExes.splitSpace);for(var o,a,l,u,h=parseInt(i[0].getAttribute("dimension")),c=0;r.length/h>c;++c)o=c*h,a=r[o],l=r[o+1],u=2==h?null:r[o+2],this.xy?s.push(new OpenLayers.Geometry.Point(a,l,u)):s.push(new OpenLayers.Geometry.Point(l,a,u))}if(0==r.length&&(i=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),i.length>0)){n=this.getChildValue(i[0]),n=n.replace(this.regExes.trimSpace,""),n=n.replace(this.regExes.trimComma,",");for(var p=n.split(this.regExes.splitSpace),c=0;p.length>c;++c)r=p[c].split(","),2==r.length&&(r[2]=null),this.xy?s.push(new OpenLayers.Geometry.Point(r[0],r[1],r[2])):s.push(new OpenLayers.Geometry.Point(r[1],r[0],r[2]))}var d=null;return 0!=s.length&&(d=t?new OpenLayers.Geometry.LinearRing(s):new OpenLayers.Geometry.LineString(s)),d},multilinestring:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LineString"),i=[];if(t.length>0)for(var n,r=0;t.length>r;++r)n=this.parseGeometry.linestring.apply(this,[t[r]]),n&&i.push(n);return new OpenLayers.Geometry.MultiLineString(i)},polygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"LinearRing"),i=[];if(t.length>0)for(var n,r=0;t.length>r;++r)n=this.parseGeometry.linestring.apply(this,[t[r],!0]),n&&i.push(n);return new OpenLayers.Geometry.Polygon(i)},multipolygon:function(e){var t=this.getElementsByTagNameNS(e,this.gmlns,"Polygon"),i=[];if(t.length>0)for(var n,r=0;t.length>r;++r)n=this.parseGeometry.polygon.apply(this,[t[r]]),n&&i.push(n);return new OpenLayers.Geometry.MultiPolygon(i)},envelope:function(e){var t,i,n=[],r=this.getElementsByTagNameNS(e,this.gmlns,"lowerCorner");if(r.length>0){var s=[];if(r.length>0&&(t=r[0].firstChild.nodeValue,t=t.replace(this.regExes.trimSpace,""),s=t.split(this.regExes.splitSpace)),2==s.length&&(s[2]=null),this.xy)var o=new OpenLayers.Geometry.Point(s[0],s[1],s[2]);else var o=new OpenLayers.Geometry.Point(s[1],s[0],s[2])}var a=this.getElementsByTagNameNS(e,this.gmlns,"upperCorner");if(a.length>0){var s=[];if(a.length>0&&(t=a[0].firstChild.nodeValue,t=t.replace(this.regExes.trimSpace,""),s=t.split(this.regExes.splitSpace)),2==s.length&&(s[2]=null),this.xy)var l=new OpenLayers.Geometry.Point(s[0],s[1],s[2]);else var l=new OpenLayers.Geometry.Point(s[1],s[0],s[2])}if(o&&l){n.push(new OpenLayers.Geometry.Point(o.x,o.y)),n.push(new OpenLayers.Geometry.Point(l.x,o.y)),n.push(new OpenLayers.Geometry.Point(l.x,l.y)),n.push(new OpenLayers.Geometry.Point(o.x,l.y)),n.push(new OpenLayers.Geometry.Point(o.x,o.y));var u=new OpenLayers.Geometry.LinearRing(n);i=new OpenLayers.Geometry.Polygon([u])}return i},box:function(e){var t,i,n=this.getElementsByTagNameNS(e,this.gmlns,"coordinates"),r=null,s=null;return n.length>0&&(t=n[0].firstChild.nodeValue,i=t.split(" "),2==i.length&&(r=i[0].split(","),s=i[1].split(","))),null!==r&&null!==s?new OpenLayers.Bounds(parseFloat(r[0]),parseFloat(r[1]),parseFloat(s[0]),parseFloat(s[1])):void 0}},parseAttributes:function(e){for(var t,i,n,r,s,o,a,l={},u=e.firstChild;u;){if(1==u.nodeType){for(t=u.childNodes,i=0;t.length>i;++i)n=t[i],1==n.nodeType&&(r=n.childNodes,1==r.length?(s=r[0],(3==s.nodeType||4==s.nodeType)&&(o=n.prefix?n.nodeName.split(":")[1]:n.nodeName,a=s.nodeValue.replace(this.regExes.trimSpace,""),l[o]=a)):l[n.nodeName.split(":").pop()]=null);break}u=u.nextSibling}return l},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),i=0;e.length>i;i++)t.appendChild(this.createFeatureXML(e[i]));return OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFeatureXML:function(e){var t=e.geometry,i=this.buildGeometryNode(t),n=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);n.appendChild(i);var r=this.createElementNS(this.gmlns,"gml:"+this.featureName),s=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName),o=e.fid||e.id;s.setAttribute("fid",o),s.appendChild(n);for(var a in e.attributes){var l=this.createTextNode(e.attributes[a]),u=a.substring(a.lastIndexOf(":")+1),h=this.createElementNS(this.featureNS,this.featurePrefix+":"+u);h.appendChild(l),s.appendChild(h)}return r.appendChild(s),r},buildGeometryNode:function(e){this.externalProjection&&this.internalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t=e.CLASS_NAME,i=t.substring(t.lastIndexOf(".")+1),n=this.buildGeometry[i.toLowerCase()];return n.apply(this,[e])},buildGeometry:{point:function(e){var t=this.createElementNS(this.gmlns,"gml:Point");return t.appendChild(this.buildCoordinatesNode(e)),t},multipoint:function(e){for(var t,i,n=this.createElementNS(this.gmlns,"gml:MultiPoint"),r=e.components,s=0;r.length>s;s++)t=this.createElementNS(this.gmlns,"gml:pointMember"),i=this.buildGeometry.point.apply(this,[r[s]]),t.appendChild(i),n.appendChild(t);return n},linestring:function(e){var t=this.createElementNS(this.gmlns,"gml:LineString");return t.appendChild(this.buildCoordinatesNode(e)),t},multilinestring:function(e){for(var t,i,n=this.createElementNS(this.gmlns,"gml:MultiLineString"),r=e.components,s=0;r.length>s;++s)t=this.createElementNS(this.gmlns,"gml:lineStringMember"),i=this.buildGeometry.linestring.apply(this,[r[s]]),t.appendChild(i),n.appendChild(t);return n},linearring:function(e){var t=this.createElementNS(this.gmlns,"gml:LinearRing");return t.appendChild(this.buildCoordinatesNode(e)),t},polygon:function(e){for(var t,i,n,r=this.createElementNS(this.gmlns,"gml:Polygon"),s=e.components,o=0;s.length>o;++o)n=0==o?"outerBoundaryIs":"innerBoundaryIs",t=this.createElementNS(this.gmlns,"gml:"+n),i=this.buildGeometry.linearring.apply(this,[s[o]]),t.appendChild(i),r.appendChild(t);return r},multipolygon:function(e){for(var t,i,n=this.createElementNS(this.gmlns,"gml:MultiPolygon"),r=e.components,s=0;r.length>s;++s)t=this.createElementNS(this.gmlns,"gml:polygonMember"),i=this.buildGeometry.polygon.apply(this,[r[s]]),t.appendChild(i),n.appendChild(t);return n},bounds:function(e){var t=this.createElementNS(this.gmlns,"gml:Box");return t.appendChild(this.buildCoordinatesNode(e)),t}},buildCoordinatesNode:function(e){var t=this.createElementNS(this.gmlns,"gml:coordinates");t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," ");var i=[];if(e instanceof OpenLayers.Bounds)i.push(e.left+","+e.bottom),i.push(e.right+","+e.top);else for(var n=e.components?e.components:[e],r=0;n.length>r;r++)i.push(n[r].x+","+n[r].y);var s=this.createTextNode(i.join(" "));return t.appendChild(s),t},CLASS_NAME:"OpenLayers.Format.GML"}),OpenLayers.Format.GML||(OpenLayers.Format.GML={}),OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e]),this.setGeometryTypes(),e&&e.featureNS&&this.setNamespace("feature",e.featureNS),this.singleFeatureType=!e||"string"==typeof e.featureType},read:function(e){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);
var t=[];if(this.readNode(e,{features:t},!0),0==t.length){var i=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMember");if(i.length)for(var n=0,r=i.length;r>n;++n)this.readNode(i[n],{features:t},!0);else{var i=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMembers");i.length&&this.readNode(i[0],{features:t},!0)}}return t},readNode:function(e,t,i){return i===!0&&this.autoConfig===!0&&(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null),this.featureNS||e.prefix in this.namespaces||e.parentNode.namespaceURI!=this.namespaces.gml||!this.regExes.featureMember.test(e.parentNode.nodeName)||(this.featureType=e.nodeName.split(":").pop(),this.setNamespace("feature",e.namespaceURI),this.featureNS=e.namespaceURI,this.autoConfig=!0),OpenLayers.Format.XML.prototype.readNode.apply(this,[e,t])},readers:{gml:{_inherit:function(){},featureMember:function(e,t){this.readChildNodes(e,t)},featureMembers:function(e,t){this.readChildNodes(e,t)},name:function(e,t){t.name=this.getChildValue(e)},boundedBy:function(e,t){var i={};this.readChildNodes(e,i),i.components&&i.components.length>0&&(t.bounds=i.components[0])},Point:function(e,t){var i={points:[]};this.readChildNodes(e,i),t.components||(t.components=[]),t.components.push(i.points[0])},coordinates:function(e,t){var i=this.getChildValue(e).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");for(var n,r=i.split(this.regExes.splitSpace),s=r.length,o=Array(s),a=0;s>a;++a)n=r[a].split(","),o[a]=this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2]);t.points=o},coord:function(e,t){var i={};this.readChildNodes(e,i),t.points||(t.points=[]),t.points.push(new OpenLayers.Geometry.Point(i.x,i.y,i.z))},X:function(e,t){t.x=this.getChildValue(e)},Y:function(e,t){t.y=this.getChildValue(e)},Z:function(e,t){t.z=this.getChildValue(e)},MultiPoint:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiPoint(i.components)]},pointMember:function(e,t){this.readChildNodes(e,t)},LineString:function(e,t){var i={};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.LineString(i.points))},MultiLineString:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiLineString(i.components)]},lineStringMember:function(e,t){this.readChildNodes(e,t)},Polygon:function(e,t){var i={outer:null,inner:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),i.inner.unshift(i.outer),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.Polygon(i.inner))},LinearRing:function(e,t){var i={};this.readers.gml._inherit.apply(this,[e,i]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.LinearRing(i.points)]},MultiPolygon:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.MultiPolygon(i.components)]},polygonMember:function(e,t){this.readChildNodes(e,t)},GeometryCollection:function(e,t){var i={components:[]};this.readers.gml._inherit.apply(this,[e,i,t]),this.readChildNodes(e,i),t.components=[new OpenLayers.Geometry.Collection(i.components)]},geometryMember:function(e,t){this.readChildNodes(e,t)}},feature:{"*":function(e,t){var i,n=e.localName||e.nodeName.split(":").pop();t.features?this.singleFeatureType||-1===OpenLayers.Util.indexOf(this.featureType,n)?n===this.featureType&&(i="_typeName"):i="_typeName":0==e.childNodes.length||1==e.childNodes.length&&3==e.firstChild.nodeType?this.extractAttributes&&(i="_attribute"):i="_geometry",i&&this.readers.feature[i].apply(this,[e,t])},_typeName:function(e,t){var i={components:[],attributes:{}};this.readChildNodes(e,i),i.name&&(i.attributes.name=i.name);var n=new OpenLayers.Feature.Vector(i.components[0],i.attributes);this.singleFeatureType||(n.type=e.nodeName.split(":").pop(),n.namespace=e.namespaceURI);var r=e.getAttribute("fid")||this.getAttributeNS(e,this.namespaces.gml,"id");r&&(n.fid=r),this.internalProjection&&this.externalProjection&&n.geometry&&n.geometry.transform(this.externalProjection,this.internalProjection),i.bounds&&(n.bounds=i.bounds),t.features.push(n)},_geometry:function(e,t){this.geometryName||(this.geometryName=e.nodeName.split(":").pop()),this.readChildNodes(e,t)},_attribute:function(e,t){var i=e.localName||e.nodeName.split(":").pop(),n=this.getChildValue(e);t.attributes[i]=n}},wfs:{FeatureCollection:function(e,t){this.readChildNodes(e,t)}}},write:function(e){var t;t=OpenLayers.Util.isArray(e)?"featureMembers":"featureMember";var i=this.writeNode("gml:"+t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:{featureMember:function(e){var t=this.createElementNSPlus("gml:featureMember");return this.writeNode("feature:_typeName",e,t),t},MultiPoint:function(e){for(var t=this.createElementNSPlus("gml:MultiPoint"),i=e.components||[e],n=0,r=i.length;r>n;++n)this.writeNode("pointMember",i[n],t);return t},pointMember:function(e){var t=this.createElementNSPlus("gml:pointMember");return this.writeNode("Point",e,t),t},MultiLineString:function(e){for(var t=this.createElementNSPlus("gml:MultiLineString"),i=e.components||[e],n=0,r=i.length;r>n;++n)this.writeNode("lineStringMember",i[n],t);return t},lineStringMember:function(e){var t=this.createElementNSPlus("gml:lineStringMember");return this.writeNode("LineString",e,t),t},MultiPolygon:function(e){for(var t=this.createElementNSPlus("gml:MultiPolygon"),i=e.components||[e],n=0,r=i.length;r>n;++n)this.writeNode("polygonMember",i[n],t);return t},polygonMember:function(e){var t=this.createElementNSPlus("gml:polygonMember");return this.writeNode("Polygon",e,t),t},GeometryCollection:function(e){for(var t=this.createElementNSPlus("gml:GeometryCollection"),i=0,n=e.components.length;n>i;++i)this.writeNode("geometryMember",e.components[i],t);return t},geometryMember:function(e){var t=this.createElementNSPlus("gml:geometryMember"),i=this.writeNode("feature:_geometry",e);return t.appendChild(i.firstChild),t}},feature:{_typeName:function(e){var t=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:e.fid}});e.geometry&&this.writeNode("feature:_geometry",e.geometry,t);for(var i in e.attributes){var n=e.attributes[i];null!=n&&this.writeNode("feature:_attribute",{name:i,value:n},t)}return t},_geometry:function(e){this.externalProjection&&this.internalProjection&&(e=e.clone().transform(this.internalProjection,this.externalProjection));var t=this.createElementNSPlus("feature:"+this.geometryName),i=this.geometryTypes[e.CLASS_NAME],n=this.writeNode("gml:"+i,e,t);return this.srsName&&n.setAttribute("srsName",this.srsName),t},_attribute:function(e){return this.createElementNSPlus("feature:"+e.name,{value:e.value})}},wfs:{FeatureCollection:function(e){for(var t=this.createElementNSPlus("wfs:FeatureCollection"),i=0,n=e.length;n>i;++i)this.writeNode("gml:featureMember",e[i],t);return t}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"}),OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(e){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[e])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(e,t){var i={};this.readChildNodes(e,i),t.outer=i.components[0]},innerBoundaryIs:function(e,t){var i={};this.readChildNodes(e,i),t.inner.push(i.components[0])},Box:function(e,t){var i={};this.readChildNodes(e,i),t.components||(t.components=[]);var n=i.points[0],r=i.points[1];t.components.push(new OpenLayers.Bounds(n.x,n.y,r.x,r.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(e){var t;t=OpenLayers.Util.isArray(e)?"wfs:FeatureCollection":"gml:featureMember";var i=this.writeNode(t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(e){var t=this.createElementNSPlus("gml:Point");return this.writeNode("coordinates",[e],t),t},coordinates:function(e){for(var t,i=e.length,n=Array(i),r=0;i>r;++r)t=e[r],n[r]=this.xy?t.x+","+t.y:t.y+","+t.x,void 0!=t.z&&(n[r]+=","+t.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==i?n[0]:n.join(" ")})},LineString:function(e){var t=this.createElementNSPlus("gml:LineString");return this.writeNode("coordinates",e.components,t),t},Polygon:function(e){var t=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",e.components[0],t);for(var i=1;e.components.length>i;++i)this.writeNode("innerBoundaryIs",e.components[i],t);return t},outerBoundaryIs:function(e){var t=this.createElementNSPlus("gml:outerBoundaryIs");return this.writeNode("LinearRing",e,t),t},innerBoundaryIs:function(e){var t=this.createElementNSPlus("gml:innerBoundaryIs");return this.writeNode("LinearRing",e,t),t},LinearRing:function(e){var t=this.createElementNSPlus("gml:LinearRing");return this.writeNode("coordinates",e.components,t),t},Box:function(e){var t=this.createElementNSPlus("gml:Box");return this.writeNode("coordinates",[{x:e.left,y:e.bottom},{x:e.right,y:e.top}],t),this.srsName&&t.setAttribute("srsName",this.srsName),t}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"}),OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"}),OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:function(){return"toISOString"in Date.prototype?function(e){return e.toISOString()}:function(e){var t;return t=isNaN(e.getTime())?"Invalid Date":e.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(e.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(e.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(e.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(e.getUTCMinutes(),2)+":"+OpenLayers.Number.zeroPad(e.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(e.getUTCMilliseconds(),3)+"Z"}}(),parse:function(e){var t,i=e.match(this.dateRegEx);if(i&&(i[1]||i[7])){var n=parseInt(i[1],10)||0,r=parseInt(i[2],10)-1||0,s=parseInt(i[3],10)||1;t=new Date(Date.UTC(n,r,s));var o=i[7];if(o){var a=parseInt(i[4],10),l=parseInt(i[5],10),u=parseFloat(i[6]),h=0|u,c=Math.round(1e3*(u-h));if(t.setUTCHours(a,l,h,c),"Z"!==o){var p=parseInt(o,10),d=parseInt(i[8],10)||0,f=-1e3*(60*60*p+60*d);t=new Date(t.getTime()+f)}}}else t=new Date("invalid");return t}},OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(e){OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){var t={};return this.readers.ogc.Filter.apply(this,[e,t]),t.filter},readers:{ogc:{_expression:function(e){for(var t,i="",n=e.firstChild;n;n=n.nextSibling)switch(n.nodeType){case 1:t=this.readNode(n),t.property?i+="${"+t.property+"}":void 0!==t.value&&(i+=t.value);break;case 3:case 4:i+=n.nodeValue}return i},Filter:function(e,t){var i={fids:[],filters:[]};this.readChildNodes(e,i),i.fids.length>0?t.filter=new OpenLayers.Filter.FeatureId({fids:i.fids}):i.filters.length>0&&(t.filter=i.filters[0])},FeatureId:function(e,t){var i=e.getAttribute("fid");i&&t.fids.push(i)},And:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(e,i),t.filters.push(i)},Or:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(e,i),t.filters.push(i)},Not:function(e,t){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLessThan:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsGreaterThan:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLessThanOrEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsGreaterThanOrEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsBetween:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(e,i),t.filters.push(i)},Literal:function(e,t){t.value=OpenLayers.String.numericIf(this.getChildValue(e),!0)},PropertyName:function(e,t){t.property=this.getChildValue(e)},LowerBoundary:function(e,t){t.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,e),!0)},UpperBoundary:function(e,t){t.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,e),!0)},Intersects:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(e,t){this.readSpatial(e,t,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(e,t){t.distance=parseInt(this.getChildValue(e)),t.distanceUnits=e.getAttribute("units")},Function:function(){},PropertyIsNull:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL});this.readChildNodes(e,i),t.filters.push(i)}}},readSpatial:function(e,t,i){var n=new OpenLayers.Filter.Spatial({type:i});this.readChildNodes(e,n),n.value=n.components[0],delete n.components,t.filters.push(n)},encodeLiteral:function(e){return e instanceof Date&&(e=OpenLayers.Date.toISOString(e)),e},writeOgcExpression:function(e,t){return e instanceof OpenLayers.Filter.Function?this.writeNode("Function",e,t):this.writeNode("Literal",e,t),t},write:function(e){return this.writers.ogc.Filter.apply(this,[e])},writers:{ogc:{Filter:function(e){var t=this.createElementNSPlus("ogc:Filter");return this.writeNode(this.getFilterType(e),e,t),t},_featureIds:function(e){for(var t=this.createDocumentFragment(),i=0,n=e.fids.length;n>i;++i)this.writeNode("ogc:FeatureId",e.fids[i],t);return t},FeatureId:function(e){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:e}})},And:function(e){for(var t,i=this.createElementNSPlus("ogc:And"),n=0,r=e.filters.length;r>n;++n)t=e.filters[n],this.writeNode(this.getFilterType(t),t,i);return i},Or:function(e){for(var t,i=this.createElementNSPlus("ogc:Or"),n=0,r=e.filters.length;r>n;++n)t=e.filters[n],this.writeNode(this.getFilterType(t),t,i);return i},Not:function(e){var t=this.createElementNSPlus("ogc:Not"),i=e.filters[0];return this.writeNode(this.getFilterType(i),i,t),t},PropertyIsLessThan:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLessThan");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsGreaterThan:function(e){var t=this.createElementNSPlus("ogc:PropertyIsGreaterThan");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsLessThanOrEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsGreaterThanOrEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsBetween:function(e){var t=this.createElementNSPlus("ogc:PropertyIsBetween");return this.writeNode("PropertyName",e,t),this.writeNode("LowerBoundary",e,t),this.writeNode("UpperBoundary",e,t),t},PropertyName:function(e){return this.createElementNSPlus("ogc:PropertyName",{value:e.property})},Literal:function(e){var t=this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral;return this.createElementNSPlus("ogc:Literal",{value:t(e)})},LowerBoundary:function(e){var t=this.createElementNSPlus("ogc:LowerBoundary");return this.writeOgcExpression(e.lowerBoundary,t),t},UpperBoundary:function(e){var t=this.createElementNSPlus("ogc:UpperBoundary");return this.writeNode("Literal",e.upperBoundary,t),t},INTERSECTS:function(e){return this.writeSpatial(e,"Intersects")},WITHIN:function(e){return this.writeSpatial(e,"Within")},CONTAINS:function(e){return this.writeSpatial(e,"Contains")},DWITHIN:function(e){var t=this.writeSpatial(e,"DWithin");return this.writeNode("Distance",e,t),t},Distance:function(e){return this.createElementNSPlus("ogc:Distance",{attributes:{units:e.distanceUnits},value:e.distance})},Function:function(e){for(var t=this.createElementNSPlus("ogc:Function",{attributes:{name:e.name}}),i=e.params,n=0,r=i.length;r>n;n++)this.writeOgcExpression(i[n],t);return t},PropertyIsNull:function(e){var t=this.createElementNSPlus("ogc:PropertyIsNull");return this.writeNode("PropertyName",e,t),t}}},getFilterType:function(e){var t=this.filterMap[e.type];if(!t)throw"Filter writing not supported for rule type: "+e.type;return t},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",NULL:"PropertyIsNull",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"}),OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(e){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[e])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsNotEqualTo:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(e,i),t.filters.push(i)},PropertyIsLike:function(e,t){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(e,i);var n=e.getAttribute("wildCard"),r=e.getAttribute("singleChar"),s=e.getAttribute("escape");i.value2regex(n,r,s),t.filters.push(i)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsNotEqualTo:function(e){var t=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");return this.writeNode("PropertyName",e,t),this.writeOgcExpression(e.value,t),t},PropertyIsLike:function(e){var t=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});return this.writeNode("PropertyName",e,t),this.writeNode("Literal",e.regex2value(),t),t},BBOX:function(e){var t=this.createElementNSPlus("ogc:BBOX");e.property&&this.writeNode("PropertyName",e,t);var i=this.writeNode("gml:Box",e.value,t);return e.projection&&i.setAttribute("srsName",e.projection),t}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(e,t){var i=this.createElementNSPlus("ogc:"+t);if(this.writeNode("PropertyName",e,i),e.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",e.value,i);else{var n;n=e.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",e.value).firstChild:this.writeNode("gml:Box",e.value),e.projection&&n.setAttribute("srsName",e.projection),i.appendChild(n)}return i},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"}),OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(e){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[e]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[e])},readNode:function(){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(e,t){t.insertIds=[],t.success=!1,this.readChildNodes(e,t)},InsertResult:function(e,t){var i={fids:[]};this.readChildNodes(e,i),t.insertIds=t.insertIds.concat(i.fids)},TransactionResult:function(e,t){this.readChildNodes(e,t)},Status:function(e,t){this.readChildNodes(e,t)},SUCCESS:function(e,t){t.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(e){e=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},e);var t=e.featurePrefix,i=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(t?t+":":"")+e.featureType}});if(e.srsNameInQuery&&e.srsName&&i.setAttribute("srsName",e.srsName),e.featureNS&&i.setAttribute("xmlns:"+t,e.featureNS),e.propertyNames)for(var n=0,r=e.propertyNames.length;r>n;n++)this.writeNode("ogc:PropertyName",{property:e.propertyNames[n]},i);return e.filter&&(this.setFilterProperty(e.filter),this.writeNode("ogc:Filter",e.filter,i)),i}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"}),OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(e){this.compare=e?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.clear()},insert:function(e){this.exists(e)&&this.remove(e);var t=e.id;this.determineZIndex(e);for(var i,n=-1,r=this.order.length;r-n>1;){i=parseInt((n+r)/2);var s=this.compare(this,e,OpenLayers.Util.getElement(this.order[i]));s>0?n=i:r=i}return this.order.splice(r,0,t),this.indices[t]=this.getZIndex(e),this.getNextElement(r)},remove:function(e){var t=e.id,i=OpenLayers.Util.indexOf(this.order,t);if(i>=0)if(this.order.splice(i,1),delete this.indices[t],this.order.length>0){var n=this.order[this.order.length-1];this.maxZIndex=this.indices[n]}else this.maxZIndex=0},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(e){return null!=this.indices[e.id]},getZIndex:function(e){return e._style.graphicZIndex},determineZIndex:function(e){var t=e._style.graphicZIndex;null==t?(t=this.maxZIndex,e._style.graphicZIndex=t):t>this.maxZIndex&&(this.maxZIndex=t)},getNextElement:function(e){var t=e+1;if(this.order.length>t){var i=OpenLayers.Util.getElement(this.order[t]);return void 0==i&&(i=this.getNextElement(t)),i}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,t,i){var n=e.getZIndex(t),r=0;if(i){var s=e.getZIndex(i);r=n-s}return r},Z_ORDER_DRAWING_ORDER:function(e,t,i){var n=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,i);return i&&0==n&&(n=1),n},Z_ORDER_Y_ORDER:function(e,t,i){var n=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,i);if(i&&0===n){var r=i._boundsBottom-t._boundsBottom;n=0===r?1:r}return n}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),t&&(t.zIndexing||t.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(t.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var e,t=this.vectorRoot;if(t)for(;e=t.firstChild;)t.removeChild(e);if(t=this.textRoot)for(;e=t.firstChild;)t.removeChild(e);this.indexer&&this.indexer.clear()},setExtent:function(e,t){var i=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),n=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var r,s=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/s),o=this.map.getMaxExtent();o.right>e.left&&o.right<e.right?r=!0:o.left>e.left&&o.left<e.right&&(r=!1),(r!==this.rightOfDateLine||t)&&(i=!1,this.xOffset=r===!0?o.getWidth()/n:0),this.rightOfDateLine=r}return i},getNodeType:function(){},drawGeometry:function(e,t,i){var n=e.CLASS_NAME,r=!0;if("OpenLayers.Geometry.Collection"==n||"OpenLayers.Geometry.MultiPoint"==n||"OpenLayers.Geometry.MultiLineString"==n||"OpenLayers.Geometry.MultiPolygon"==n){for(var s=0,o=e.components.length;o>s;s++)r=this.drawGeometry(e.components[s],t,i)&&r;return r}r=!1;var a=!1;if("none"!=t.display&&(t.backgroundGraphic?this.redrawBackgroundNode(e.id,e,t,i):a=!0,r=this.redrawNode(e.id,e,t,i)),0==r){var l=document.getElementById(e.id);l&&(l._style.backgroundGraphic&&(a=!0),l.parentNode.removeChild(l))}if(a){var l=document.getElementById(e.id+this.BACKGROUND_ID_SUFFIX);l&&l.parentNode.removeChild(l)}return r},redrawNode:function(e,t,i,n){i=this.applyDefaultSymbolizer(i);var r=this.nodeFactory(e,this.getNodeType(t,i));r._featureId=n,r._boundsBottom=t.getBounds().bottom,r._geometryClass=t.CLASS_NAME,r._style=i;var s=this.drawGeometryNode(r,t,i);if(s===!1)return!1;if(r=s.node,this.indexer){var o=this.indexer.insert(r);o?this.vectorRoot.insertBefore(r,o):this.vectorRoot.appendChild(r)}else r.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(r);return this.postDraw(r),s.complete},redrawBackgroundNode:function(e,t,i){var n=OpenLayers.Util.extend({},i);return n.externalGraphic=n.backgroundGraphic,n.graphicXOffset=n.backgroundXOffset,n.graphicYOffset=n.backgroundYOffset,n.graphicZIndex=n.backgroundGraphicZIndex,n.graphicWidth=n.backgroundWidth||n.graphicWidth,n.graphicHeight=n.backgroundHeight||n.graphicHeight,n.backgroundGraphic=null,n.backgroundXOffset=null,n.backgroundYOffset=null,n.backgroundGraphicZIndex=null,this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,t,n,null)},drawGeometryNode:function(e,t,i){i=i||e._style;var n,r={isFilled:void 0===i.fill?!0:i.fill,isStroked:void 0===i.stroke?!!i.strokeWidth:i.stroke};switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":i.graphic===!1&&(r.isFilled=!1,r.isStroked=!1),n=this.drawPoint(e,t);break;case"OpenLayers.Geometry.LineString":r.isFilled=!1,n=this.drawLineString(e,t);break;case"OpenLayers.Geometry.LinearRing":n=this.drawLinearRing(e,t);break;case"OpenLayers.Geometry.Polygon":n=this.drawPolygon(e,t);break;case"OpenLayers.Geometry.Rectangle":n=this.drawRectangle(e,t);break;default:}return e._options=r,0!=n?{node:this.setStyle(e,i,r,t),complete:n}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(e){var t=document.getElementById(e+this.LABEL_ID_SUFFIX);t&&this.textRoot.removeChild(t);var i=document.getElementById(e+this.LABEL_OUTLINE_SUFFIX);i&&this.textRoot.removeChild(i)},getFeatureIdFromEvent:function(e){var t=e.target,i=t&&t.correspondingUseElement,n=i?i:t||e.srcElement;return n._featureId},eraseGeometry:function(e,t){if("OpenLayers.Geometry.MultiPoint"==e.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==e.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==e.CLASS_NAME||"OpenLayers.Geometry.Collection"==e.CLASS_NAME)for(var i=0,n=e.components.length;n>i;i++)this.eraseGeometry(e.components[i],t);else{var r=OpenLayers.Util.getElement(e.id);if(r&&r.parentNode&&(r.geometry&&(r.geometry.destroy(),r.geometry=null),r.parentNode.removeChild(r),this.indexer&&this.indexer.remove(r),r._style.backgroundGraphic)){var s=e.id+this.BACKGROUND_ID_SUFFIX,o=OpenLayers.Util.getElement(s);o&&o.parentNode&&o.parentNode.removeChild(o)}}},nodeFactory:function(e,t){var i=OpenLayers.Util.getElement(e);return i?this.nodeTypeCompare(i,t)||(i.parentNode.removeChild(i),i=this.nodeFactory(e,t)):i=this.createNode(t,e),i},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(e){var t=this.root;e.root.parentNode==this.rendererRoot&&(t=e.root),t.parentNode.removeChild(t),e.rendererRoot.appendChild(t)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(e){return"circle"!=e&&!!e},CLASS_NAME:"OpenLayers.Renderer.Elements"}),OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.controls=[],this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var e,t=this.controls.length-1;t>=0;t--)e=this.controls[t],e.events&&e.events.un({activate:this.iconOn,deactivate:this.iconOff}),e.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var e,t=0,i=this.controls.length;i>t;t++)e=this.controls[t],(e===this.defaultControl||this.saveState&&this.activeState[e.id])&&e.activate();return this.saveState===!0&&(this.defaultControl=null),this.redraw(),!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var e,t=0,i=this.controls.length;i>t;t++)e=this.controls[t],this.activeState[e.id]=e.deactivate();return this.redraw(),!0}return!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick),this.addControlsToMap(this.controls),this.div
},redraw:function(){for(var e=this.div.childNodes.length,t=e-1;t>=0;t--)this.div.removeChild(this.div.childNodes[t]);if(this.div.innerHTML="",this.active)for(var t=0,i=this.controls.length;i>t;t++)this.div.appendChild(this.controls[t].panel_div)},activateControl:function(e){if(!this.active)return!1;if(e.type==OpenLayers.Control.TYPE_BUTTON)return e.trigger(),void 0;if(e.type==OpenLayers.Control.TYPE_TOGGLE)return e.active?e.deactivate():e.activate(),void 0;if(this.allowDepress&&e.active)e.deactivate();else{for(var t,i=0,n=this.controls.length;n>i;i++)t=this.controls[i],t==e||t.type!==OpenLayers.Control.TYPE_TOOL&&null!=t.type||t.deactivate();e.activate()}},addControls:function(e){OpenLayers.Util.isArray(e)||(e=[e]),this.controls=this.controls.concat(e);for(var t=0,i=e.length;i>t;t++){var n=e[t],r=this.createControlMarkup(n);OpenLayers.Element.addClass(r,n.displayClass+"ItemInactive"),OpenLayers.Element.addClass(r,"olButton"),""==n.title||r.title||(r.title=n.title),n.panel_div=r}this.map&&(this.addControlsToMap(e),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(e){for(var t,i=0,n=e.length;n>i;i++)t=e[i],t.autoActivate===!0?(t.autoActivate=!1,this.map.addControl(t),t.autoActivate=!0):(this.map.addControl(t),t.deactivate()),t.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var e=this.panel_div,t=RegExp("\\b("+this.displayClass+"Item)Inactive\\b");e.className=e.className.replace(t,"$1Active")},iconOff:function(){var e=this.panel_div,t=RegExp("\\b("+this.displayClass+"Item)Active\\b");e.className=e.className.replace(t,"$1Inactive")},onButtonClick:function(e){for(var t=this.controls,i=e.buttonElement,n=t.length-1;n>=0;--n)if(t[n].panel_div===i){this.activateControl(t[n]);break}},getControlsBy:function(e,t){var i="function"==typeof t.test,n=OpenLayers.Array.filter(this.controls,function(n){return n[e]==t||i&&t.test(n[e])});return n},getControlsByName:function(e){return this.getControlsBy("name",e)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},CLASS_NAME:"OpenLayers.Control.Panel"}),OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(e){OpenLayers.Util.extend(this,e),this.options=e,this.active=!1},destroy:function(){this.deactivate(),this.layer=null,this.options=null},setLayer:function(e){this.layer=e},activate:function(){return this.active?!1:(this.active=!0,!0)},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"}),OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){var e=OpenLayers.Strategy.prototype.activate.apply(this,arguments);return e&&(this.layer.events.on({refresh:this.load,scope:this}),1==this.layer.visibility||this.preload?this.load():this.layer.events.on({visibilitychanged:this.load,scope:this})),e},deactivate:function(){var e=OpenLayers.Strategy.prototype.deactivate.call(this);return e&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this}),e},load:function(e){var t=this.layer;t.events.triggerEvent("loadstart",{filter:t.filter}),t.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:t.filter,scope:this},e)),t.events.un({visibilitychanged:this.load,scope:this})},merge:function(e){var t=this.layer;t.destroyFeatures();var i=e.features;if(i&&i.length>0){var n=t.projection,r=t.map.getProjectionObject();if(!r.equals(n))for(var s,o=0,a=i.length;a>o;++o)s=i[o].geometry,s&&s.transform(n,r);t.addFeatures(i)}t.events.triggerEvent("loadend",{response:e})},CLASS_NAME:"OpenLayers.Strategy.Fixed"}),OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"−",zoomOutId:"olZoomOutLink",draw:function(){var e=OpenLayers.Control.prototype.draw.apply(this),t=this.getOrCreateLinks(e),i=t.zoomIn,n=t.zoomOut,r=this.map.events;return n.parentNode!==e&&(r=this.events,r.attachToElement(n.parentNode)),r.register("buttonclick",this,this.onZoomClick),this.zoomInLink=i,this.zoomOutLink=n,e},getOrCreateLinks:function(e){var t=document.getElementById(this.zoomInId),i=document.getElementById(this.zoomOutId);return t||(t=document.createElement("a"),t.href="#zoomIn",t.appendChild(document.createTextNode(this.zoomInText)),t.className="olControlZoomIn",e.appendChild(t)),OpenLayers.Element.addClass(t,"olButton"),i||(i=document.createElement("a"),i.href="#zoomOut",i.appendChild(document.createTextNode(this.zoomOutText)),i.className="olControlZoomOut",e.appendChild(i)),OpenLayers.Element.addClass(i,"olButton"),{zoomIn:t,zoomOut:i}},onZoomClick:function(e){var t=e.buttonElement;t===this.zoomInLink?this.map.zoomIn():t===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick),delete this.zoomInLink,delete this.zoomOutLink,OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"}),OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(e){e=e||{},OpenLayers.Util.extend(this,e),this.options=e},mergeWithDefaultFilter:function(e){var t;return t=e&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,e]}):e||this.defaultFilter||void 0},destroy:function(){this.options=null,this.format=null},read:function(e){e=e||{},e.filter=this.mergeWithDefaultFilter(e.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(e,t,i){return OpenLayers.Function.bind(function(){e.apply(this,[t,i])},this)},CLASS_NAME:"OpenLayers.Protocol"}),OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(e){OpenLayers.Util.extend(this,e)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"}),OpenLayers.Protocol.Response.SUCCESS=1,OpenLayers.Protocol.Response.FAILURE=0,OpenLayers.Protocol.WFS=function(e){e=OpenLayers.Util.applyDefaults(e,OpenLayers.Protocol.WFS.DEFAULTS);var t=OpenLayers.Protocol.WFS["v"+e.version.replace(/\./g,"_")];if(!t)throw"Unsupported WFS version: "+e.version;return new t(e)},OpenLayers.Protocol.WFS.fromWMSLayer=function(e,t){var i,n,r=e.params.LAYERS,s=(OpenLayers.Util.isArray(r)?r[0]:r).split(":");s.length>1&&(n=s[0]),i=s.pop();var o={url:e.url,featureType:i,featurePrefix:n,srsName:e.projection&&e.projection.getCode()||e.map&&e.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(t,o))},OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"},OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=[]},destroy:function(){this.clearMarkers(),this.markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=0,i=this.markers.length;i>t;t++)this.markers[t].setOpacity(this.opacity)}},moveTo:function(e,t){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),t||!this.drawn){for(var i=0,n=this.markers.length;n>i;i++)this.drawMarker(this.markers[i]);this.drawn=!0}},addMarker:function(e){this.markers.push(e),1>this.opacity&&e.setOpacity(this.opacity),this.map&&this.map.getExtent()&&(e.map=this.map,this.drawMarker(e))},removeMarker:function(e){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,e),e.erase())},clearMarkers:function(){if(null!=this.markers)for(;this.markers.length>0;)this.removeMarker(this.markers[0])},drawMarker:function(e){var t=this.map.getLayerPxFromLonLat(e.lonlat);if(null==t)e.display(!1);else if(e.isDrawn())e.icon&&e.icon.moveTo(t);else{var i=e.draw(t);this.div.appendChild(i)}},getDataExtent:function(){var e=null;if(this.markers&&this.markers.length>0)for(var e=new OpenLayers.Bounds,t=0,i=this.markers.length;i>t;t++){var n=this.markers[t];e.extend(n.lonlat)}return e},CLASS_NAME:"OpenLayers.Layer.Markers"}),OpenLayers.ProxyHost="",OpenLayers.Request||(OpenLayers.Request={}),OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(e,t){var i=0!==e.indexOf("http"),n=!i&&e.match(this.URL_SPLIT_REGEX);if(n){var r=window.location;i=n[1]==r.protocol&&n[3]==r.hostname;var s=n[4],o=r.port;(80!=s&&""!=s||"80"!=o&&""!=o)&&(i=i&&s==o)}return i||t&&(e="function"==typeof t?t(e):t+encodeURIComponent(e)),e},issue:function(e){var t=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});e=e||{},e.headers=e.headers||{},e=OpenLayers.Util.applyDefaults(e,t),e.headers=OpenLayers.Util.applyDefaults(e.headers,t.headers);var i,n=!1;for(i in e.headers)e.headers.hasOwnProperty(i)&&"x-requested-with"===i.toLowerCase()&&(n=!0);n===!1&&(e.headers["X-Requested-With"]="XMLHttpRequest");var r=new OpenLayers.Request.XMLHttpRequest,s=OpenLayers.Util.urlAppend(e.url,OpenLayers.Util.getParameterString(e.params||{}));s=OpenLayers.Request.makeSameOrigin(s,e.proxy),r.open(e.method,s,e.async,e.user,e.password);for(var o in e.headers)r.setRequestHeader(o,e.headers[o]);var a=this.events,l=this;return r.onreadystatechange=function(){if(r.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var t=a.triggerEvent("complete",{request:r,config:e,requestUrl:s});t!==!1&&l.runCallbacks({request:r,config:e,requestUrl:s})}},e.async===!1?r.send(e.data):window.setTimeout(function(){0!==r.readyState&&r.send(e.data)},0),r},runCallbacks:function(e){var t,i=e.request,n=e.config,r=n.scope?OpenLayers.Function.bind(n.callback,n.scope):n.callback;n.success&&(t=n.scope?OpenLayers.Function.bind(n.success,n.scope):n.success);var s;n.failure&&(s=n.scope?OpenLayers.Function.bind(n.failure,n.scope):n.failure),"file:"==OpenLayers.Util.createUrlObject(n.url).protocol&&i.responseText&&(i.status=200),r(i),(!i.status||i.status>=200&&300>i.status)&&(this.events.triggerEvent("success",e),t&&t(i)),i.status&&(200>i.status||i.status>=300)&&(this.events.triggerEvent("failure",e),s&&s(i))},GET:function(e){return e=OpenLayers.Util.extend(e,{method:"GET"}),OpenLayers.Request.issue(e)},POST:function(e){return e=OpenLayers.Util.extend(e,{method:"POST"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},PUT:function(e){return e=OpenLayers.Util.extend(e,{method:"PUT"}),e.headers=e.headers?e.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(e.headers)||(e.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(e)},DELETE:function(e){return e=OpenLayers.Util.extend(e,{method:"DELETE"}),OpenLayers.Request.issue(e)},HEAD:function(e){return e=OpenLayers.Util.extend(e,{method:"HEAD"}),OpenLayers.Request.issue(e)},OPTIONS:function(e){return e=OpenLayers.Util.extend(e,{method:"OPTIONS"}),OpenLayers.Request.issue(e)}}),function(){function e(){this._object=a&&!h?new a:new window.ActiveXObject("Microsoft.XMLHTTP"),this._listeners=[]}function t(){return new e}function i(e){if(e._object.send(e._data),l&&!e._async)for(e.readyState=t.OPENED,s(e);e.readyState<t.DONE;)if(e.readyState++,n(e),e._aborted)return}function n(e){t.onreadystatechange&&t.onreadystatechange.apply(e),e.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function r(e){var t=e.responseXML,i=e.responseText;return u&&i&&t&&!t.documentElement&&e.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(i)),t&&(u&&0!=t.parseError||!t.documentElement||t.documentElement&&"parsererror"==t.documentElement.tagName)?null:t}function s(e){try{e.responseText=e._object.responseText}catch(t){}try{e.responseXML=r(e._object)}catch(t){}try{e.status=e._object.status}catch(t){}try{e.statusText=e._object.statusText}catch(t){}}function o(e){e._object.onreadystatechange=new window.Function}var a=window.XMLHttpRequest,l=!!window.controllers,u=window.document.all&&!window.opera,h=u&&window.navigator.userAgent.match(/MSIE 7.0/);t.prototype=e.prototype,l&&a.wrapped&&(t.wrapped=a.wrapped),t.UNSENT=0,t.OPENED=1,t.HEADERS_RECEIVED=2,t.LOADING=3,t.DONE=4,t.prototype.readyState=t.UNSENT,t.prototype.responseText="",t.prototype.responseXML=null,t.prototype.status=0,t.prototype.statusText="",t.prototype.priority="NORMAL",t.prototype.onreadystatechange=null,t.onreadystatechange=null,t.onopen=null,t.onsend=null,t.onabort=null,t.prototype.open=function(e,i,r,a,h){delete this._headers,3>arguments.length&&(r=!0),this._async=r;var c,p=this,d=this.readyState;u&&r&&(c=function(){d!=t.DONE&&(o(p),p.abort())},window.attachEvent("onunload",c)),t.onopen&&t.onopen.apply(this,arguments),arguments.length>4?this._object.open(e,i,r,a,h):arguments.length>3?this._object.open(e,i,r,a):this._object.open(e,i,r),this.readyState=t.OPENED,n(this),this._object.onreadystatechange=function(){if(!l||r){if(p.readyState=p._object.readyState,s(p),p._aborted)return p.readyState=t.UNSENT,void 0;p.readyState==t.DONE&&(delete p._data,o(p),u&&r&&window.detachEvent("onunload",c)),d!=p.readyState&&n(p),d=p.readyState}}},t.prototype.send=function(e){t.onsend&&t.onsend.apply(this,arguments),arguments.length||(e=null),e&&e.nodeType&&(e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")),this._data=e,i(this)},t.prototype.abort=function(){t.onabort&&t.onabort.apply(this,arguments),this.readyState>t.UNSENT&&(this._aborted=!0),this._object.abort(),o(this),this.readyState=t.UNSENT,delete this._data},t.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},t.prototype.getResponseHeader=function(e){return this._object.getResponseHeader(e)},t.prototype.setRequestHeader=function(e,t){return this._headers||(this._headers={}),this._headers[e]=t,this._object.setRequestHeader(e,t)},t.prototype.addEventListener=function(e,t,i){for(var n,r=0;n=this._listeners[r];r++)if(n[0]==e&&n[1]==t&&n[2]==i)return;this._listeners.push([e,t,i])},t.prototype.removeEventListener=function(e,t,i){for(var n,r=0;(n=this._listeners[r])&&(n[0]!=e||n[1]!=t||n[2]!=i);r++);n&&this._listeners.splice(r,1)},t.prototype.dispatchEvent=function(e){var t={type:e.type,target:this,currentTarget:this,eventPhase:2,bubbles:e.bubbles,cancelable:e.cancelable,timeStamp:e.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};"readystatechange"==t.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[t]);for(var i,n=0;i=this._listeners[n];n++)i[0]!=t.type||i[2]||(i[1].handleEvent||i[1]).apply(this,[t])},t.prototype.toString=function(){return"[object XMLHttpRequest]"},t.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(e,t){t||(t=[]),e.__func=this,e.__func(t[0],t[1],t[2],t[3],t[4]),delete e.__func}),OpenLayers.Request||(OpenLayers.Request={}),OpenLayers.Request.XMLHttpRequest=t}(),OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(e){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g},this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(e){this.features=[],this.styles={},this.fetched={};var t={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(e,t)},parseData:function(e,t){"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e]));for(var i=["Link","NetworkLink","Style","StyleMap","Placemark"],n=0,r=i.length;r>n;++n){var s=i[n],o=this.getElementsByTagNameNS(e,"*",s);if(0!=o.length)switch(s.toLowerCase()){case"link":case"networklink":this.parseLinks(o,t);break;case"style":this.extractStyles&&this.parseStyles(o,t);break;case"stylemap":this.extractStyles&&this.parseStyleMaps(o,t);break;case"placemark":this.parseFeatures(o,t)}}return this.features},parseLinks:function(e,t){if(t.depth>=this.maxDepth)return!1;var i=OpenLayers.Util.extend({},t);i.depth++;for(var n=0,r=e.length;r>n;n++){var s=this.parseProperty(e[n],"*","href");if(s&&!this.fetched[s]){this.fetched[s]=!0;var o=this.fetchLink(s);o&&this.parseData(o,i)}}},fetchLink:function(e){var t=OpenLayers.Request.GET({url:e,async:!1});return t?t.responseText:void 0},parseStyles:function(e,t){for(var i=0,n=e.length;n>i;i++){var r=this.parseStyle(e[i]);if(r){var s=(t.styleBaseUrl||"")+"#"+r.id;this.styles[s]=r}}},parseKmlColor:function(e){var t=null;if(e){var i=e.match(this.regExes.kmlColor);i&&(t={color:"#"+i[4]+i[3]+i[2],opacity:parseInt(i[1],16)/255})}return t},parseStyle:function(e){for(var t,i,n={},r=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],s=0,o=r.length;o>s;++s)if(t=r[s],i=this.getElementsByTagNameNS(e,"*",t)[0])switch(t.toLowerCase()){case"linestyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.strokeColor=l.color,n.strokeOpacity=l.opacity);var u=this.parseProperty(i,"*","width");u&&(n.strokeWidth=u);break;case"polystyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.fillOpacity=l.opacity,n.fillColor=l.color);var h=this.parseProperty(i,"*","fill");"0"==h&&(n.fillColor="none");var c=this.parseProperty(i,"*","outline");"0"==c&&(n.strokeWidth="0");break;case"iconstyle":var p=parseFloat(this.parseProperty(i,"*","scale")||1),u=32*p,d=32*p,f=this.getElementsByTagNameNS(i,"*","Icon")[0];if(f){var m=this.parseProperty(f,"*","href");if(m){var g=this.parseProperty(f,"*","w"),y=this.parseProperty(f,"*","h"),v="http://maps.google.com/mapfiles/kml";!OpenLayers.String.startsWith(m,v)||g||y||(g=64,y=64,p/=2),g=g||y,y=y||g,g&&(u=parseInt(g)*p),y&&(d=parseInt(y)*p);var b=m.match(this.regExes.kmlIconPalette);if(b){var _=b[1],w=b[2],x=this.parseProperty(f,"*","x"),L=this.parseProperty(f,"*","y"),O=x?x/32:0,C=L?7-L/32:7,E=8*C+O;m="http://maps.google.com/mapfiles/kml/pal"+_+"/icon"+E+w}n.graphicOpacity=1,n.externalGraphic=m}}var S=this.getElementsByTagNameNS(i,"*","hotSpot")[0];if(S){var x=parseFloat(S.getAttribute("x")),L=parseFloat(S.getAttribute("y")),k=S.getAttribute("xunits");"pixels"==k?n.graphicXOffset=-x*p:"insetPixels"==k?n.graphicXOffset=-u+x*p:"fraction"==k&&(n.graphicXOffset=-u*x);var T=S.getAttribute("yunits");"pixels"==T?n.graphicYOffset=-d+L*p+1:"insetPixels"==T?n.graphicYOffset=-(L*p)+1:"fraction"==T&&(n.graphicYOffset=-d*(1-L)+1)}n.graphicWidth=u,n.graphicHeight=d;break;case"balloonstyle":var P=OpenLayers.Util.getXmlNodeValue(i);P&&(n.balloonStyle=P.replace(this.regExes.straightBracket,"${$1}"));break;case"labelstyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.fontColor=l.color,n.fontOpacity=l.opacity);break;default:}!n.strokeColor&&n.fillColor&&(n.strokeColor=n.fillColor);var q=e.getAttribute("id");return q&&n&&(n.id=q),n},parseStyleMaps:function(e,t){for(var i=0,n=e.length;n>i;i++)for(var r=e[i],s=this.getElementsByTagNameNS(r,"*","Pair"),o=r.getAttribute("id"),a=0,l=s.length;l>a;a++){var u=s[a],h=this.parseProperty(u,"*","key"),c=this.parseProperty(u,"*","styleUrl");c&&"normal"==h&&(this.styles[(t.styleBaseUrl||"")+"#"+o]=this.styles[(t.styleBaseUrl||"")+c])}},parseFeatures:function(e,t){for(var i=[],n=0,r=e.length;r>n;n++){var s=e[n],o=this.parseFeature.apply(this,[s]);if(!o)throw"Bad Placemark: "+n;if(this.extractStyles&&o.attributes&&o.attributes.styleUrl&&(o.style=this.getStyle(o.attributes.styleUrl,t)),this.extractStyles){var a=this.getElementsByTagNameNS(s,"*","Style")[0];if(a){var l=this.parseStyle(a);l&&(o.style=OpenLayers.Util.extend(o.style,l))}}if(this.extractTracks){var u=this.getElementsByTagNameNS(s,this.namespaces.gx,"Track");if(u&&u.length>0){var h=u[0],c={features:[],feature:o};this.readNode(h,c),c.features.length>0&&i.push.apply(i,c.features)}}else i.push(o)}this.features=this.features.concat(i)},readers:{kml:{when:function(e,t){t.whens.push(OpenLayers.Date.parse(this.getChildValue(e)))},_trackPointAttribute:function(e,t){var i=e.nodeName.split(":").pop();t.attributes[i].push(this.getChildValue(e))}},gx:{Track:function(e,t){var i={whens:[],points:[],angles:[]};if(this.trackAttributes){var n;i.attributes={};for(var r=0,s=this.trackAttributes.length;s>r;++r)n=this.trackAttributes[r],i.attributes[n]=[],n in this.readers.kml||(this.readers.kml[n]=this.readers.kml._trackPointAttribute)}if(this.readChildNodes(e,i),i.whens.length!==i.points.length)throw Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:coord ("+i.points.length+") elements.");var o=i.angles.length>0;if(o&&i.whens.length!==i.angles.length)throw Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:angles ("+i.angles.length+") elements.");for(var a,l,u,r=0,s=i.whens.length;s>r;++r){if(a=t.feature.clone(),a.fid=t.feature.fid||t.feature.id,l=i.points[r],a.geometry=l,"z"in l&&(a.attributes.altitude=l.z),this.internalProjection&&this.externalProjection&&a.geometry.transform(this.externalProjection,this.internalProjection),this.trackAttributes)for(var h=0,c=this.trackAttributes.length;c>h;++h){var n=this.trackAttributes[h];a.attributes[n]=i.attributes[n][r]}a.attributes.when=i.whens[r],a.attributes.trackId=t.feature.id,o&&(u=i.angles[r],a.attributes.heading=parseFloat(u[0]),a.attributes.tilt=parseFloat(u[1]),a.attributes.roll=parseFloat(u[2])),t.features.push(a)}},coord:function(e,t){var i=this.getChildValue(e),n=i.replace(this.regExes.trimSpace,"").split(/\s+/),r=new OpenLayers.Geometry.Point(n[0],n[1]);n.length>2&&(r.z=parseFloat(n[2])),t.points.push(r)},angles:function(e,t){var i=this.getChildValue(e),n=i.replace(this.regExes.trimSpace,"").split(/\s+/);t.angles.push(n)}}},parseFeature:function(e){for(var t,i,n,r,s=["MultiGeometry","Polygon","LineString","Point"],o=0,a=s.length;a>o;++o)if(t=s[o],this.internalns=e.namespaceURI?e.namespaceURI:this.kmlns,i=this.getElementsByTagNameNS(e,this.internalns,t),i.length>0){var r=this.parseGeometry[t.toLowerCase()];if(!r)throw new TypeError("Unsupported geometry type: "+t);n=r.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&n.transform(this.externalProjection,this.internalProjection);break}var l;this.extractAttributes&&(l=this.parseAttributes(e));var u=new OpenLayers.Feature.Vector(n,l),h=e.getAttribute("id")||e.getAttribute("name");return null!=h&&(u.fid=h),u},getStyle:function(e,t){var i=OpenLayers.Util.removeTail(e),n=OpenLayers.Util.extend({},t);if(n.depth++,n.styleBaseUrl=i,!this.styles[e]&&!OpenLayers.String.startsWith(e,"#")&&n.depth<=this.maxDepth&&!this.fetched[i]){var r=this.fetchLink(i);r&&this.parseData(r,n)}var s=OpenLayers.Util.extend({},this.styles[e]);return s},parseGeometry:{point:function(e){var t=this.getElementsByTagNameNS(e,this.internalns,"coordinates"),i=[];if(t.length>0){var n=t[0].firstChild.nodeValue;n=n.replace(this.regExes.removeSpace,""),i=n.split(",")}var r=null;if(!(i.length>1))throw"Bad coordinate string: "+n;return 2==i.length&&(i[2]=null),r=new OpenLayers.Geometry.Point(i[0],i[1],i[2])},linestring:function(e,t){var i=this.getElementsByTagNameNS(e,this.internalns,"coordinates"),n=null;if(i.length>0){var r=this.getChildValue(i[0]);r=r.replace(this.regExes.trimSpace,""),r=r.replace(this.regExes.trimComma,",");for(var s,o,a=r.split(this.regExes.splitSpace),l=a.length,u=Array(l),h=0;l>h;++h){if(s=a[h].split(","),o=s.length,!(o>1))throw"Bad LineString point coordinates: "+a[h];2==s.length&&(s[2]=null),u[h]=new OpenLayers.Geometry.Point(s[0],s[1],s[2])}if(!l)throw"Bad LineString coordinates: "+r;n=t?new OpenLayers.Geometry.LinearRing(u):new OpenLayers.Geometry.LineString(u)}return n},polygon:function(e){var t=this.getElementsByTagNameNS(e,this.internalns,"LinearRing"),i=t.length,n=Array(i);if(i>0)for(var r,s=0,o=t.length;o>s;++s){if(r=this.parseGeometry.linestring.apply(this,[t[s],!0]),!r)throw"Bad LinearRing geometry: "+s;n[s]=r}return new OpenLayers.Geometry.Polygon(n)},multigeometry:function(e){for(var t,i,n=[],r=e.childNodes,s=0,o=r.length;o>s;++s)if(t=r[s],1==t.nodeType){var a=t.prefix?t.nodeName.split(":")[1]:t.nodeName,i=this.parseGeometry[a.toLowerCase()];i&&n.push(i.apply(this,[t]))}return new OpenLayers.Geometry.Collection(n)}},parseAttributes:function(e){var t={},i=e.getElementsByTagName("ExtendedData");i.length&&(t=this.parseExtendedData(i[0]));for(var n,r,s,o=e.childNodes,a=0,l=o.length;l>a;++a)if(n=o[a],1==n.nodeType&&(r=n.childNodes,r.length>=1&&3>=r.length)){var s;switch(r.length){case 1:s=r[0];break;case 2:var u=r[0],h=r[1];s=3==u.nodeType||4==u.nodeType?u:h;break;case 3:default:s=r[1]}if(3==s.nodeType||4==s.nodeType){var c=n.prefix?n.nodeName.split(":")[1]:n.nodeName,p=OpenLayers.Util.getXmlNodeValue(s);p&&(p=p.replace(this.regExes.trimSpace,""),t[c]=p)}}return t},parseExtendedData:function(e){var t,i,n,r,s={},o=e.getElementsByTagName("Data");for(t=0,i=o.length;i>t;t++){n=o[t],r=n.getAttribute("name");var a={},l=n.getElementsByTagName("value");if(l.length&&(a.value=this.getChildValue(l[0])),this.kvpAttributes)s[r]=a.value;else{var u=n.getElementsByTagName("displayName");u.length&&(a.displayName=this.getChildValue(u[0])),s[r]=a}}var h=e.getElementsByTagName("SimpleData");for(t=0,i=h.length;i>t;t++){var a={};n=h[t],r=n.getAttribute("name"),a.value=this.getChildValue(n),this.kvpAttributes?s[r]=a.value:(a.displayName=r,s[r]=a)}return s},parseProperty:function(e,t,i){var n,r=this.getElementsByTagNameNS(e,t,i);try{n=OpenLayers.Util.getXmlNodeValue(r[0])}catch(s){n=null}return n},write:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var t=this.createElementNS(this.kmlns,"kml"),i=this.createFolderXML(),n=0,r=e.length;r>n;++n)i.appendChild(this.createPlacemarkXML(e[n]));return t.appendChild(i),OpenLayers.Format.XML.prototype.write.apply(this,[t])},createFolderXML:function(){var e=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var t=this.createElementNS(this.kmlns,"name"),i=this.createTextNode(this.foldersName);t.appendChild(i),e.appendChild(t)}if(this.foldersDesc){var n=this.createElementNS(this.kmlns,"description"),r=this.createTextNode(this.foldersDesc);n.appendChild(r),e.appendChild(n)}return e},createPlacemarkXML:function(e){var t=this.createElementNS(this.kmlns,"name"),i=e.style&&e.style.label?e.style.label:e.id,n=e.attributes.name||i;t.appendChild(this.createTextNode(n));var r=this.createElementNS(this.kmlns,"description"),s=e.attributes.description||this.placemarksDesc;r.appendChild(this.createTextNode(s));var o=this.createElementNS(this.kmlns,"Placemark");null!=e.fid&&o.setAttribute("id",e.fid),o.appendChild(t),o.appendChild(r);var a=this.buildGeometryNode(e.geometry);if(o.appendChild(a),e.attributes){var l=this.buildExtendedData(e.attributes);l&&o.appendChild(l)}return o},buildGeometryNode:function(e){var t=e.CLASS_NAME,i=t.substring(t.lastIndexOf(".")+1),n=this.buildGeometry[i.toLowerCase()],r=null;return n&&(r=n.apply(this,[e])),r},buildGeometry:{point:function(e){var t=this.createElementNS(this.kmlns,"Point");return t.appendChild(this.buildCoordinatesNode(e)),t},multipoint:function(e){return this.buildGeometry.collection.apply(this,[e])},linestring:function(e){var t=this.createElementNS(this.kmlns,"LineString");return t.appendChild(this.buildCoordinatesNode(e)),t},multilinestring:function(e){return this.buildGeometry.collection.apply(this,[e])},linearring:function(e){var t=this.createElementNS(this.kmlns,"LinearRing");return t.appendChild(this.buildCoordinatesNode(e)),t},polygon:function(e){for(var t,i,n,r=this.createElementNS(this.kmlns,"Polygon"),s=e.components,o=0,a=s.length;a>o;++o)n=0==o?"outerBoundaryIs":"innerBoundaryIs",t=this.createElementNS(this.kmlns,n),i=this.buildGeometry.linearring.apply(this,[s[o]]),t.appendChild(i),r.appendChild(t);return r},multipolygon:function(e){return this.buildGeometry.collection.apply(this,[e])},collection:function(e){for(var t,i=this.createElementNS(this.kmlns,"MultiGeometry"),n=0,r=e.components.length;r>n;++n)t=this.buildGeometryNode.apply(this,[e.components[n]]),t&&i.appendChild(t);return i}},buildCoordinatesNode:function(e){var t,i=this.createElementNS(this.kmlns,"coordinates"),n=e.components;if(n){for(var r,s=n.length,o=Array(s),a=0;s>a;++a)r=n[a],o[a]=this.buildCoordinates(r);t=o.join(" ")}else t=this.buildCoordinates(e);var l=this.createTextNode(t);return i.appendChild(l),i},buildCoordinates:function(e){return this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection)),e.x+","+e.y},buildExtendedData:function(e){var t=this.createElementNS(this.kmlns,"ExtendedData");for(var i in e)if(e[i]&&"name"!=i&&"description"!=i&&"styleUrl"!=i){var n=this.createElementNS(this.kmlns,"Data");n.setAttribute("name",i);var r=this.createElementNS(this.kmlns,"value");if("object"==typeof e[i]){if(e[i].value&&r.appendChild(this.createTextNode(e[i].value)),e[i].displayName){var s=this.createElementNS(this.kmlns,"displayName");s.appendChild(this.getXMLDoc().createCDATASection(e[i].displayName)),n.appendChild(s)}}else r.appendChild(this.createTextNode(e[i]));n.appendChild(r),t.appendChild(n)}return this.isSimpleContent(t)?null:t},CLASS_NAME:"OpenLayers.Format.KML"}),OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(e){OpenLayers.Protocol.prototype.initialize.apply(this,[e]),e.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))),!e.geometryName&&parseFloat(this.format.version)>1&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options||{});var t=new OpenLayers.Protocol.Response({requestType:"read"}),i=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",e)]);return t.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,t,e),params:e.params,headers:e.headers,data:i}),t},setFeatureType:function(e){this.featureType=e,this.format.featureType=e},setGeometryName:function(e){this.geometryName=e,this.format.geometryName=e},handleRead:function(e,t){if(t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options),t.callback){var i=e.priv;if(i.status>=200&&300>i.status){var n=this.parseResponse(i,t.readOptions);n&&n.success!==!1?(t.readOptions&&"object"==t.readOptions.output?OpenLayers.Util.extend(e,n):e.features=n,e.code=OpenLayers.Protocol.Response.SUCCESS):(e.code=OpenLayers.Protocol.Response.FAILURE,e.error=n)
}else e.code=OpenLayers.Protocol.Response.FAILURE;t.callback.call(t.scope,e)}},parseResponse:function(e,t){var i=e.responseXML;if(i&&i.documentElement||(i=e.responseText),!i||0>=i.length)return null;var n=null!==this.readFormat?this.readFormat.read(i):this.format.read(i,t);if(!this.featureNS){var r=this.readFormat||this.format;this.featureNS=r.featureNS,r.autoConfig=!1,this.geometryName||this.setGeometryName(r.geometryName)}return n},commit:function(e,t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options);var i=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:e});return i.priv=OpenLayers.Request.POST({url:t.url,headers:t.headers,data:this.format.write(e,t),callback:this.createCallback(this.handleCommit,i,t)}),i},handleCommit:function(e,t){if(t.callback){var i=e.priv,n=i.responseXML;n&&n.documentElement||(n=i.responseText);var r=this.format.read(n)||{};e.insertIds=r.insertIds||[],r.success?e.code=OpenLayers.Protocol.Response.SUCCESS:(e.code=OpenLayers.Protocol.Response.FAILURE,e.error=r),t.callback.call(t.scope,e)}},filterDelete:function(e,t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options),new OpenLayers.Protocol.Response({requestType:"commit"});var i=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}}),n=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(t.featureNS?this.featurePrefix+":":"")+t.featureType}});t.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,t.featureNS);var r=this.format.writeNode("ogc:Filter",e);n.appendChild(r),i.appendChild(n);var s=OpenLayers.Format.XML.prototype.write.apply(this.format,[i]);return OpenLayers.Request.POST({url:this.url,callback:t.callback||function(){},data:s})},abort:function(e){e&&e.priv.abort()},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"}),OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(e,t,i,n){OpenLayers.Handler.prototype.initialize.apply(this,[e,i,n]),this.layer=t},touchstart:function(e){return this.startTouch(),OpenLayers.Event.isMultiTouch(e)?!0:this.mousedown(e)},touchmove:function(e){OpenLayers.Event.preventDefault(e)},mousedown:function(e){return(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))&&(this.down=e.xy),this.handle(e)?!this.stopDown:!0},mouseup:function(e){return this.up=e.xy,this.handle(e)?!this.stopUp:!0},click:function(e){return this.handle(e)?!this.stopClick:!0},mousemove:function(e){return this.callbacks.over||this.callbacks.out?(this.handle(e),!0):!0},dblclick:function(e){return!this.handle(e)},geometryTypeMatches:function(e){return null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,e.geometry.CLASS_NAME)>-1},handle:function(e){this.feature&&!this.feature.layer&&(this.feature=null);var t=e.type,i=!1,n=!!this.feature,r="click"==t||"dblclick"==t||"touchstart"==t;if(this.feature=this.layer.getFeatureFromEvent(e),this.feature&&!this.feature.layer&&(this.feature=null),this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null),this.feature){"touchstart"===t&&OpenLayers.Event.preventDefault(e);var s=this.feature!=this.lastFeature;this.geometryTypeMatches(this.feature)?(n&&s?(this.lastFeature&&this.triggerCallback(t,"out",[this.lastFeature]),this.triggerCallback(t,"in",[this.feature])):(!n||r)&&this.triggerCallback(t,"in",[this.feature]),this.lastFeature=this.feature,i=!0):(this.lastFeature&&(n&&s||r)&&this.triggerCallback(t,"out",[this.lastFeature]),this.feature=null)}else this.lastFeature&&(n||r)&&this.triggerCallback(t,"out",[this.lastFeature]);return i},triggerCallback:function(e,t,i){var n=this.EVENTMAP[e][t];if(n)if("click"==e&&this.up&&this.down){var r=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));this.clickTolerance>=r&&this.callback(n,i),this.up=this.down=null}else this.callback(n,i)},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.feature=null,this.lastFeature=null,this.down=null,this.up=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),e=!0),e},handleMapEvents:function(e){("removelayer"==e.type||"order"==e.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var e=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(e)},moveLayerBack:function(){var e=this.layer.getZIndex()-1;e>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(e):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"}),OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(e,t){if(this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])},e instanceof OpenLayers.Style)this.styles["default"]=e,this.styles.select=e,this.styles.temporary=e,this.styles["delete"]=e;else if("object"==typeof e)for(var i in e)if(e[i]instanceof OpenLayers.Style)this.styles[i]=e[i];else{if("object"!=typeof e[i]){this.styles["default"]=new OpenLayers.Style(e),this.styles.select=new OpenLayers.Style(e),this.styles.temporary=new OpenLayers.Style(e),this.styles["delete"]=new OpenLayers.Style(e);break}this.styles[i]=new OpenLayers.Style(e[i])}OpenLayers.Util.extend(this,t)},destroy:function(){for(var e in this.styles)this.styles[e].destroy();this.styles=null},createSymbolizer:function(e,t){e||(e=new OpenLayers.Feature.Vector),this.styles[t]||(t="default"),e.renderIntent=t;var i={};return this.extendDefault&&"default"!=t&&(i=this.styles["default"].createSymbolizer(e)),OpenLayers.Util.extend(i,this.styles[t].createSymbolizer(e))},addUniqueValueRules:function(e,t,i,n){var r=[];for(var s in i)r.push(new OpenLayers.Rule({symbolizer:i[s],context:n,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:t,value:s})}));this.styles[e].addRules(r)},CLASS_NAME:"OpenLayers.StyleMap"}),OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(){if(OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.renderer&&this.renderer.supported()||this.assignRenderer(),this.renderer&&this.renderer.supported()||(this.renderer=null,this.displayError()),this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={},this.strategies)for(var e=0,t=this.strategies.length;t>e;e++)this.strategies[e].setLayer(this)},destroy:function(){if(this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoDestroy&&e.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){null==e&&(e=new OpenLayers.Layer.Vector(this.name,this.getOptions())),e=OpenLayers.Layer.prototype.clone.apply(this,[e]);for(var t=this.features,i=t.length,n=Array(i),r=0;i>r;++r)n[r]=t[r].clone();return e.features=n,e},refresh:function(e){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",e)},assignRenderer:function(){for(var e=0,t=this.renderers.length;t>e;e++){var i=this.renderers[e],n="function"==typeof i?i:OpenLayers.Renderer[i];if(n&&n.prototype.supported()){this.renderer=new n(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(){if(OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.renderer){this.renderer.map=this.map;var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoActivate&&e.activate()}},removeMap:function(){if(this.drawn=!1,this.strategies){var e,t,i;for(t=0,i=this.strategies.length;i>t;t++)e=this.strategies[t],e.autoActivate&&e.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var e=this.map.getSize();e.w=e.w*this.ratio,e.h=e.h*this.ratio,this.renderer.setSize(e)},moveTo:function(e,t,i){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var n=!0;if(!i){this.renderer.root.style.visibility="hidden";var r=this.map.getSize(),s=r.w,o=r.h,a=s/2*this.ratio-s/2,l=o/2*this.ratio-o/2;a+=this.map.layerContainerOriginPx.x,a=-Math.round(a),l+=this.map.layerContainerOriginPx.y,l=-Math.round(l),this.div.style.left=a+"px",this.div.style.top=l+"px";var u=this.map.getExtent().scale(this.ratio);if(n=this.renderer.setExtent(u,t),this.renderer.root.style.visibility="visible",OpenLayers.IS_GECKO===!0&&(this.div.scrollLeft=this.div.scrollLeft),!t&&n)for(var h in this.unrenderedFeatures){var c=this.unrenderedFeatures[h];this.drawFeature(c)}}if(!this.drawn||t||!n){this.drawn=!0;for(var c,h=0,p=this.features.length;p>h;h++)this.renderer.locked=h!==p-1,c=this.features[h],this.drawFeature(c)}},display:function(){OpenLayers.Layer.prototype.display.apply(this,arguments);var e=this.div.style.display;e!=this.renderer.root.style.display&&(this.renderer.root.style.display=e)},addFeatures:function(e,t){OpenLayers.Util.isArray(e)||(e=[e]);var i=!t||!t.silent;if(i){var n={features:e},r=this.events.triggerEvent("beforefeaturesadded",n);if(r===!1)return;e=n.features}for(var s=[],o=0,a=e.length;a>o;o++){this.renderer.locked=o!=e.length-1?!0:!1;var l=e[o];if(this.geometryType&&!(l.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);if(l.layer=this,!l.style&&this.style&&(l.style=OpenLayers.Util.extend({},this.style)),i){if(this.events.triggerEvent("beforefeatureadded",{feature:l})===!1)continue;this.preFeatureInsert(l)}s.push(l),this.features.push(l),this.drawFeature(l),i&&(this.events.triggerEvent("featureadded",{feature:l}),this.onFeatureInsert(l))}i&&this.events.triggerEvent("featuresadded",{features:s})},removeFeatures:function(e,t){if(e&&0!==e.length){if(e===this.features)return this.removeAllFeatures(t);OpenLayers.Util.isArray(e)||(e=[e]),e===this.selectedFeatures&&(e=e.slice());var i=!t||!t.silent;i&&this.events.triggerEvent("beforefeaturesremoved",{features:e});for(var n=e.length-1;n>=0;n--){this.renderer.locked=0!=n&&e[n-1].geometry?!0:!1;var r=e[n];delete this.unrenderedFeatures[r.id],i&&this.events.triggerEvent("beforefeatureremoved",{feature:r}),this.features=OpenLayers.Util.removeItem(this.features,r),r.layer=null,r.geometry&&this.renderer.eraseFeatures(r),-1!=OpenLayers.Util.indexOf(this.selectedFeatures,r)&&OpenLayers.Util.removeItem(this.selectedFeatures,r),i&&this.events.triggerEvent("featureremoved",{feature:r})}i&&this.events.triggerEvent("featuresremoved",{features:e})}},removeAllFeatures:function(e){var t=!e||!e.silent,i=this.features;t&&this.events.triggerEvent("beforefeaturesremoved",{features:i});for(var n,r=i.length-1;r>=0;r--)n=i[r],t&&this.events.triggerEvent("beforefeatureremoved",{feature:n}),n.layer=null,t&&this.events.triggerEvent("featureremoved",{feature:n});this.renderer.clear(),this.features=[],this.unrenderedFeatures={},this.selectedFeatures=[],t&&this.events.triggerEvent("featuresremoved",{features:i})},destroyFeatures:function(e,t){var i=void 0==e;if(i&&(e=this.features),e){this.removeFeatures(e,t);for(var n=e.length-1;n>=0;n--)e[n].destroy()}},drawFeature:function(e,t){if(this.drawn){if("object"!=typeof t){t||e.state!==OpenLayers.State.DELETE||(t="delete");var i=t||e.renderIntent;t=e.style||this.style,t||(t=this.styleMap.createSymbolizer(e,i))}var n=this.renderer.drawFeature(e,t);n===!1||null===n?this.unrenderedFeatures[e.id]=e:delete this.unrenderedFeatures[e.id]}},eraseFeatures:function(e){this.renderer.eraseFeatures(e)},getFeatureFromEvent:function(e){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var t=null,i=this.renderer.getFeatureIdFromEvent(e);return i&&(t="string"==typeof i?this.getFeatureById(i):i),t},getFeatureBy:function(e,t){for(var i=null,n=0,r=this.features.length;r>n;++n)if(this.features[n][e]==t){i=this.features[n];break}return i},getFeatureById:function(e){return this.getFeatureBy("id",e)},getFeatureByFid:function(e){return this.getFeatureBy("fid",e)},getFeaturesByAttribute:function(e,t){var i,n,r=this.features.length,s=[];for(i=0;r>i;i++)n=this.features[i],n&&n.attributes&&n.attributes[e]===t&&s.push(n);return s},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var e=null,t=this.features;if(t&&t.length>0)for(var i=null,n=0,r=t.length;r>n;n++)i=t[n].geometry,i&&(null===e&&(e=new OpenLayers.Bounds),e.extend(i.getBounds()));return e},CLASS_NAME:"OpenLayers.Layer.Vector"}),OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(e){for(var t,i=this.layers,n=0;i.length>n;n++)if(t=i[n].getFeatureFromEvent(e))return t},setMap:function(e){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),this.collectRoots(),e.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(e){e.events.unregister("changelayer",this,this.handleChangeLayer),this.resetRoots(),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var e,t=0;this.map.layers.length>t;++t)e=this.map.layers[t],-1!=OpenLayers.Util.indexOf(this.layers,e)&&e.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var e,t=0;this.layers.length>t;++t)e=this.layers[t],this.renderer&&e.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(e.renderer)},handleChangeLayer:function(e){var t=e.layer;"order"==e.property&&-1!=OpenLayers.Util.indexOf(this.layers,t)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"}),OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(e,t){OpenLayers.Control.prototype.initialize.apply(this,[t]),null===this.scope&&(this.scope=this),this.initLayer(e);var i={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(i.over=this.overFeature,i.out=this.outFeature),this.callbacks=OpenLayers.Util.extend(i,this.callbacks),this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})},this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(e){OpenLayers.Util.isArray(e)?(this.layers=e,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:e})):this.layer=e},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.layers&&this.layer.destroy()},activate:function(){return this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate()),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer)),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(e){var t,i,n,r,s=this.layers||[this.layer];for(n=0;s.length>n;++n)if(t=s[n],r=0,null!=t.selectedFeatures)for(;t.selectedFeatures.length>r;)i=t.selectedFeatures[r],e&&e.except==i?++r:this.unselect(i)},clickFeature:function(e){if(!this.hover){var t=OpenLayers.Util.indexOf(e.layer.selectedFeatures,e)>-1;t?this.toggleSelect()?this.unselect(e):this.multipleSelect()||this.unselectAll({except:e}):(this.multipleSelect()||this.unselectAll({except:e}),this.select(e))}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(e){var t=e.layer;this.hover&&(this.highlightOnly?this.highlight(e):-1==OpenLayers.Util.indexOf(t.selectedFeatures,e)&&this.select(e))},outFeature:function(e){if(this.hover)if(this.highlightOnly){if(e._lastHighlighter==this.id)if(e._prevHighlighter&&e._prevHighlighter!=this.id){delete e._lastHighlighter;var t=this.map.getControl(e._prevHighlighter);t&&t.highlight(e)}else this.unhighlight(e)}else this.unselect(e)},highlight:function(e){var t=e.layer,i=this.events.triggerEvent("beforefeaturehighlighted",{feature:e});if(i!==!1){e._prevHighlighter=e._lastHighlighter,e._lastHighlighter=this.id;var n=this.selectStyle||this.renderIntent;t.drawFeature(e,n),this.events.triggerEvent("featurehighlighted",{feature:e})}},unhighlight:function(e){var t=e.layer;void 0==e._prevHighlighter?delete e._lastHighlighter:e._prevHighlighter==this.id?delete e._prevHighlighter:(e._lastHighlighter=e._prevHighlighter,delete e._prevHighlighter),t.drawFeature(e,e.style||e.layer.style||"default"),this.events.triggerEvent("featureunhighlighted",{feature:e})},select:function(e){var t=this.onBeforeSelect.call(this.scope,e),i=e.layer;t!==!1&&(t=i.events.triggerEvent("beforefeatureselected",{feature:e}),t!==!1&&(i.selectedFeatures.push(e),this.highlight(e),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=i.selectedFeatures[0]),i.events.triggerEvent("featureselected",{feature:e}),this.onSelect.call(this.scope,e)))},unselect:function(e){var t=e.layer;this.unhighlight(e),OpenLayers.Util.removeItem(t.selectedFeatures,e),t.events.triggerEvent("featureunselected",{feature:e}),this.onUnselect.call(this.scope,e)},selectBox:function(e){if(e instanceof OpenLayers.Bounds){var t=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),i=this.map.getLonLatFromPixel({x:e.right,y:e.top}),n=new OpenLayers.Bounds(t.lon,t.lat,i.lon,i.lat);this.multipleSelect()||this.unselectAll();var r=this.multiple;this.multiple=!0;var s=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:s});for(var o,a=0;s.length>a;++a){o=s[a];for(var l=0,u=o.features.length;u>l;++l){var h=o.features[l];h.getVisibility()&&(null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME)>-1)&&n.toGeometry().intersects(h.geometry)&&-1==OpenLayers.Util.indexOf(o.selectedFeatures,h)&&this.select(h)}}this.multiple=r,this.events.triggerEvent("boxselectionend",{layers:s})}},setMap:function(e){this.handlers.feature.setMap(e),this.box&&this.handlers.box.setMap(e),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(e){var t=this.active;this.unselectAll(),this.deactivate(),this.layers&&(this.layer.destroy(),this.layers=null),this.initLayer(e),this.handlers.feature.layer=this.layer,t&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"}),OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(e,t,i){i&&i.layerOptions&&i.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments))return!1;var e=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);return this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,e),this.map.addLayer(this.layer),!0},createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.callback("create",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.cancel(),null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1)),this.layer=null,!0):!1},destroyFeature:function(e){!this.layer||!e&&this.persist||this.layer.destroyFeatures(),this.point=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>1&&this.layer.features[0].destroy()},finalize:function(e){var t=e?"cancel":"done";this.mouseDown=!1,this.lastDown=null,this.lastUp=null,this.lastTouchPx=null,this.callback(t,[this.geometryClone()]),this.destroyFeature(e)},cancel:function(){this.finalize(!0)},click:function(e){return OpenLayers.Event.stop(e),!1},dblclick:function(e){return OpenLayers.Event.stop(e),!1},modifyFeature:function(e){this.point||this.createFeature(e);var t=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=t.lon,this.point.geometry.y=t.lat,this.callback("modify",[this.point.geometry,this.point,!1]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var e=this.point&&this.point.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPoint([e])),e},geometryClone:function(){var e=this.getGeometry();return e&&e.clone()},mousedown:function(e){return this.down(e)},touchstart:function(e){return this.startTouch(),this.lastTouchPx=e.xy,this.down(e)},mousemove:function(e){return this.move(e)},touchmove:function(e){return this.lastTouchPx=e.xy,this.move(e)},mouseup:function(e){return this.up(e)},touchend:function(e){return e.xy=this.lastTouchPx,this.up(e)},down:function(e){return this.mouseDown=!0,this.lastDown=e.xy,this.touch||this.modifyFeature(e.xy),this.stoppedDown=this.stopDown,!this.stopDown},move:function(e){return this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(e.xy),!0},up:function(e){return this.mouseDown=!1,this.stoppedDown=this.stopDown,this.checkModifiers(e)?this.lastUp&&this.lastUp.equals(e.xy)?!0:this.lastDown&&this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(e.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=e.xy,this.finalize(),!this.stopUp):!0:!0},mouseout:function(e){OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(e,t,i){var n=!0;if(null!=i&&e&&t){var r=e.distanceTo(t);r>i&&(n=!1)}return n},CLASS_NAME:"OpenLayers.Handler.Point"}),OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(e){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,e),this.line=null},destroyPersistedFeature:function(){var e=this.layer;e&&e.features.length>2&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(e){this.layer.removeFeatures([this.point]);var t=this.layer.getLonLatFromViewPortPx(e);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.layer.addFeatures([this.point]),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature(),delete this.redoStack},insertXY:function(e,t){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(e,t),this.getCurrentPointIndex()),this.drawFeature(),delete this.redoStack},insertDeltaXY:function(e,t){var i=this.getCurrentPointIndex()-1,n=this.line.geometry.components[i];!n||isNaN(n.x)||isNaN(n.y)||this.insertXY(n.x+e,n.y+t)},insertDirectionLength:function(e,t){e*=Math.PI/180;var i=t*Math.cos(e),n=t*Math.sin(e);this.insertDeltaXY(i,n)},insertDeflectionLength:function(e,t){var i=this.getCurrentPointIndex()-1;if(i>0){var n=this.line.geometry.components[i],r=this.line.geometry.components[i-1],s=Math.atan2(n.y-r.y,n.x-r.x);this.insertDirectionLength(180*s/Math.PI+e,t)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var e=this.line.geometry,t=e.components,i=this.getCurrentPointIndex()-1,n=t[i],r=e.removeComponent(n);if(r){if(this.touch&&i>0){t=e.components;var s=t[i-1],o=this.getCurrentPointIndex(),a=t[o];a.x=s.x,a.y=s.y}this.redoStack||(this.redoStack=[]),this.redoStack.push(n),this.drawFeature()}return r},redo:function(){var e=this.redoStack&&this.redoStack.pop();return e&&(this.line.geometry.addComponent(e,this.getCurrentPointIndex()),this.drawFeature()),!!e},freehandMode:function(e){return this.freehandToggle&&e[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(e,t){this.line||this.createFeature(e);var i=this.layer.getLonLatFromViewPortPx(e);this.point.geometry.x=i.lon,this.point.geometry.y=i.lat,this.callback("modify",[this.point.geometry,this.getSketch(),t]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var e=this.line&&this.line.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiLineString([e])),e},touchstart:function(e){return this.timerId&&this.passesTolerance(this.lastTouchPx,e.xy,this.doubleTouchTolerance)?(this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1):(this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300),OpenLayers.Handler.Point.prototype.touchstart.call(this,e))},down:function(e){var t=this.stopDown;return this.freehandMode(e)&&(t=!0,this.touch&&(this.modifyFeature(e.xy,!!this.lastUp),OpenLayers.Event.stop(e))),this.touch||this.lastDown&&this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)||this.modifyFeature(e.xy,!!this.lastUp),this.mouseDown=!0,this.lastDown=e.xy,this.stoppedDown=t,!t},move:function(e){return this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(e.xy),!1):(this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(e.xy,!!this.lastUp),!0)},up:function(e){return!this.mouseDown||this.lastUp&&this.lastUp.equals(e.xy)||(this.stoppedDown&&this.freehandMode(e)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,e.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(e.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),this.addPoint(e.xy),this.lastUp=e.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry())),this.stoppedDown=this.stopDown,this.mouseDown=!1,!this.stopUp},finishGeometry:function(){var e=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},dblclick:function(e){return this.freehandMode(e)||this.finishGeometry(),!1},CLASS_NAME:"OpenLayers.Handler.Path"}),OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this}),this.updateAttribution(),this.div},updateAttribution:function(){var e=[];if(this.map&&this.map.layers){for(var t=0,i=this.map.layers.length;i>t;t++){var n=this.map.layers[t];n.attribution&&n.getVisibility()&&-1===OpenLayers.Util.indexOf(e,n.attribution)&&e.push(n.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:e.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"}),OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(e){OpenLayers.Util.extend(this,e)},begin:function(){OpenLayers.Animation.stop(this.timerId),this.timerId=void 0,this.points=[]},update:function(e){this.points.unshift({xy:e,tick:(new Date).getTime()}),this.points.length>this.nbPoints&&this.points.pop()},end:function(e){for(var t,i,n=(new Date).getTime(),r=0,s=this.points.length;s>r&&(i=this.points[r],!(n-i.tick>this.delay));r++)t=i;if(t){var o=(new Date).getTime()-t.tick,a=Math.sqrt(Math.pow(e.x-t.xy.x,2)+Math.pow(e.y-t.xy.y,2)),l=a/o;if(!(0==l||this.threshold>l)){var u=Math.asin((e.y-t.xy.y)/a);return t.xy.x<=e.x&&(u=Math.PI-u),{speed:l,theta:u}}}},move:function(e,t){var i=e.speed,n=Math.cos(e.theta),r=-Math.sin(e.theta),s=(new Date).getTime(),o=0,a=0,l=function(){if(null!=this.timerId){var e=(new Date).getTime()-s,l=-this.deceleration*Math.pow(e,2)/2+i*e,u=l*n,h=l*r,c={};c.end=!1;var p=-this.deceleration*e+i;0>=p&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,c.end=!0),c.x=u-o,c.y=h-a,o=u,a=h,t(c.x,c.y,c.end)}};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(l,this))},CLASS_NAME:"OpenLayers.Kinetic"}),OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})
},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(e){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(e)},startBox:function(){this.callback("start",[]),this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999}),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(e){var t=this.dragHandler.start.x,i=this.dragHandler.start.y,n=Math.abs(t-e.x),r=Math.abs(i-e.y),s=this.getBoxOffsets();this.zoomBox.style.width=n+s.width+1+"px",this.zoomBox.style.height=r+s.height+1+"px",this.zoomBox.style.left=(t>e.x?t-n-s.left:t-s.left)+"px",this.zoomBox.style.top=(i>e.y?i-r-s.top:i-s.top)+"px"},endBox:function(e){var t;if(Math.abs(this.dragHandler.start.x-e.x)>5||Math.abs(this.dragHandler.start.y-e.y)>5){var i=this.dragHandler.start,n=Math.min(i.y,e.y),r=Math.max(i.y,e.y),s=Math.min(i.x,e.x),o=Math.max(i.x,e.x);t=new OpenLayers.Bounds(s,r,o,n)}else t=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[t])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxOffsets=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var e=document.createElement("div");e.style.position="absolute",e.style.border="1px solid black",e.style.width="3px",document.body.appendChild(e);var t=3==e.clientWidth;document.body.removeChild(e);var i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:i,right:n,top:r,bottom:s,width:t===!1?i+n:0,height:t===!1?r+s:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"}),OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t,i=e.getCenterPixel();if(this.out){var n=e.right-e.left,r=e.bottom-e.top,s=Math.min(this.map.size.h/r,this.map.size.w/n),o=this.map.getExtent(),a=this.map.getLonLatFromPixel(i),l=a.lon-o.getWidth()/2*s,u=a.lon+o.getWidth()/2*s,h=a.lat-o.getHeight()/2*s,c=a.lat+o.getHeight()/2*s;t=new OpenLayers.Bounds(l,h,u,c)}else{var p=this.map.getLonLatFromPixel({x:e.left,y:e.bottom}),d=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(p.lon,p.lat,d.lon,d.lat)}var f=this.map.getZoom(),m=this.map.getSize(),g={x:m.w/2,y:m.h/2},y=this.map.getZoomForExtent(t),v=this.map.getResolution(),b=this.map.getResolutionForZoom(y);if(v==b)this.map.setCenter(this.map.getLonLatFromPixel(i));else{var _={x:(v*i.x-b*g.x)/(v-b),y:(v*i.y-b*g.y)/(v-b)};this.map.zoomTo(y,_)}f==this.map.getZoom()&&1==this.alwaysZoom&&this.map.zoomTo(f+(this.out?-1:1))}else this.zoomOnClick&&(this.out?this.map.zoomTo(this.map.getZoom()-1,e):this.map.zoomTo(this.map.getZoom()+1,e))},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:0,documentDrag:!1,kinetic:null,enableKinetic:!0,kineticInterval:10,draw:function(){if(this.enableKinetic&&OpenLayers.Kinetic){var e={interval:this.kineticInterval};"object"==typeof this.enableKinetic&&(e=OpenLayers.Util.extend(e,this.enableKinetic)),this.kinetic=new OpenLayers.Kinetic(e)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(e){this.kinetic&&this.kinetic.update(e),this.panned=!0,this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!0,animate:!1})},panMapDone:function(e){if(this.panned){var t=null;if(this.kinetic&&(t=this.kinetic.end(e)),this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!t,animate:!1}),t){var i=this;this.kinetic.move(t,function(e,t,n){i.map.pan(e,t,{dragging:!n,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"}),OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(e){return this.startTouch(),this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},touchmove:function(e){return this.last=this.getEventInfo(e),!0},touchend:function(e){return this.down&&(e.xy=this.last.xy,e.lastTouches=this.last.touches,this.handleSingle(e),this.down=null),!0},mousedown:function(e){return this.down=this.getEventInfo(e),this.last=this.getEventInfo(e),!0},mouseup:function(e){var t=!0;return this.checkModifiers(e)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(e)&&(t=this.rightclick(e)),t},rightclick:function(e){if(this.passesTolerance(e)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[e]),!this.stopDouble;var t=this["double"]?OpenLayers.Util.extend({},e):this.callback("rightclick",[e]),i=OpenLayers.Function.bind(this.delayedRightCall,this,t);this.rightclickTimerId=window.setTimeout(i,this.delay)}return!this.stopSingle},delayedRightCall:function(e){this.rightclickTimerId=null,e&&this.callback("rightclick",[e])},click:function(e){return this.last||(this.last=this.getEventInfo(e)),this.handleSingle(e),!this.stopSingle},dblclick:function(e){return this.handleDouble(e),!this.stopDouble},handleDouble:function(e){this.passesDblclickTolerance(e)&&(this["double"]&&this.callback("dblclick",[e]),this.clearTimer())},handleSingle:function(e){if(this.passesTolerance(e))if(null!=this.timerId)this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.preventDefault(e),this.handleDouble(e)),this.last.touches&&2===this.last.touches.length||this.clearTimer();else{this.first=this.getEventInfo(e);var t=this.single?OpenLayers.Util.extend({},e):null;this.queuePotentialClick(t)}},queuePotentialClick:function(e){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)},passesTolerance:function(e){var t=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(t=this.pixelTolerance>=this.down.xy.distanceTo(e.xy),t&&this.touch&&this.down.touches.length===this.last.touches.length))for(var i=0,n=this.down.touches.length;n>i;++i)if(this.getTouchDistance(this.down.touches[i],this.last.touches[i])>this.pixelTolerance){t=!1;break}return t},getTouchDistance:function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},passesDblclickTolerance:function(){var e=!0;return this.down&&this.first&&(e=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance),e},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(e){this.timerId=null,e&&this.callback("click",[e])},getEventInfo:function(e){var t;if(e.touches){var i=e.touches.length;t=Array(i);for(var n,r=0;i>r;r++)n=e.touches[r],t[r]={clientX:n.olClientX,clientY:n.olClientY}}return{xy:e.xy,touches:t}},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,this.first=null,this.last=null,e=!0),e},CLASS_NAME:"OpenLayers.Handler.Click"}),OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,this.pinchZoom&&this.pinchZoom.destroy(),this.pinchZoom=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate(),this.pinchZoom&&this.pinchZoom.activate(),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.pinchZoom&&this.pinchZoom.deactivate(),this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var e={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},t={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw();var i=this.map.fractionalZoom?{}:{cumulative:!1,interval:50,maxDelta:6};this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(i,this.mouseWheelOptions)),OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(e){e.lastTouches&&2==e.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(e){this.map.zoomTo(this.map.zoom+1,e.xy)},defaultDblRightClick:function(e){this.map.zoomTo(this.map.zoom-1,e.xy)},wheelChange:function(e,t){this.map.fractionalZoom||(t=Math.round(t));var i=this.map.getZoom(),n=i+t;n=Math.max(n,0),n=Math.min(n,this.map.getNumZoomLevels()),n!==i&&this.map.zoomTo(n,e.xy)},wheelUp:function(e,t){this.wheelChange(e,t||1)},wheelDown:function(e,t){this.wheelChange(e,t||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(e,t,i,n){var r=[];i=OpenLayers.Util.upperCaseObject(i),parseFloat(i.VERSION)>=1.3&&!i.EXCEPTIONS&&(i.EXCEPTIONS="INIMAGE"),r.push(e,t,i,n),OpenLayers.Layer.Grid.prototype.initialize.apply(this,r),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),!this.noMagic&&this.params.TRANSPARENT&&"true"==(""+this.params.TRANSPARENT).toLowerCase()&&(null!=n&&n.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!!(this.yx[e]||OpenLayers.Projection.defaults[e]&&OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize(),i={},n=this.reverseAxisOrder();i.BBOX=this.encodeBBOX?e.toBBOX(null,n):e.toArray(n),i.WIDTH=t.w,i.HEIGHT=t.h;var r=this.getFullRequestString(i);return r},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),i=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,i)},getFullRequestString:function(e){var t=this.map.getProjectionObject(),i=this.projection&&this.projection.equals(t)?this.projection.getCode():t.getCode(),n="none"==i?null:i;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=n:this.params.SRS=n,"boolean"==typeof this.params.TRANSPARENT&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},inValidRange:function(e,t,i){var n=e+(i?0:this.translationParameters.x),r=t+(i?0:this.translationParameters.y);return n>=-this.MAX_PIXEL&&this.MAX_PIXEL>=n&&r>=-this.MAX_PIXEL&&this.MAX_PIXEL>=r},setExtent:function(e,t){var i=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),n=this.getResolution(),r=-e.left/n,s=e.top/n;if(t){this.left=r,this.top=s;var o="0 0 "+this.size.w+" "+this.size.h;return this.rendererRoot.setAttributeNS(null,"viewBox",o),this.translate(this.xOffset,0),!0}var a=this.translate(r-this.left+this.xOffset,s-this.top);return a||this.setExtent(e,!0),i&&a},translate:function(e,t){if(this.inValidRange(e,t,!0)){var i="";return(e||t)&&(i="translate("+e+","+t+")"),this.root.setAttributeNS(null,"transform",i),this.translationParameters={x:e,y:t},!0}return!1},setSize:function(){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,t){var i=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i=t.externalGraphic?"image":this.isComplexSymbol(t.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":i="rect";break;case"OpenLayers.Geometry.LineString":i="polyline";break;case"OpenLayers.Geometry.LinearRing":i="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="path";break;default:}return i},setStyle:function(e,t,i){t=t||e._style,i=i||e._options;var n=t.title||t.graphicTitle;if(n){e.setAttributeNS(null,"title",n);var r=e.getElementsByTagName("title");if(r.length>0)r[0].firstChild.textContent=n;else{var s=this.nodeFactory(null,"title");s.textContent=n,e.appendChild(s)}}var o,a=parseFloat(e.getAttributeNS(null,"r")),l=1;if("OpenLayers.Geometry.Point"==e._geometryClass&&a){if(e.style.visibility="",t.graphic===!1)e.style.visibility="hidden";else if(t.externalGraphic){o=this.getPosition(e),t.graphicWidth&&t.graphicHeight&&e.setAttributeNS(null,"preserveAspectRatio","none");var u=t.graphicWidth||t.graphicHeight,h=t.graphicHeight||t.graphicWidth;u=u?u:2*t.pointRadius,h=h?h:2*t.pointRadius;var c=void 0!=t.graphicXOffset?t.graphicXOffset:-(.5*u),p=void 0!=t.graphicYOffset?t.graphicYOffset:-(.5*h),d=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",(o.x+c).toFixed()),e.setAttributeNS(null,"y",(o.y+p).toFixed()),e.setAttributeNS(null,"width",u),e.setAttributeNS(null,"height",h),e.setAttributeNS(this.xlinkns,"xlink:href",t.externalGraphic),e.setAttributeNS(null,"style","opacity: "+d),e.onclick=OpenLayers.Event.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var f=3*t.pointRadius,m=2*f,g=this.importSymbol(t.graphicName);o=this.getPosition(e),l=3*this.symbolMetrics[g.id][0]/m;var y=e.parentNode,v=e.nextSibling;y&&y.removeChild(e),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(g.firstChild.cloneNode(!0)),e.setAttributeNS(null,"viewBox",g.getAttributeNS(null,"viewBox")),e.setAttributeNS(null,"width",m),e.setAttributeNS(null,"height",m),e.setAttributeNS(null,"x",o.x-f),e.setAttributeNS(null,"y",o.y-f),v?y.insertBefore(e,v):y&&y.appendChild(e)}else e.setAttributeNS(null,"r",t.pointRadius);var b=t.rotation;if((void 0!==b||void 0!==e._rotation)&&o)if(e._rotation=b,b|=0,"svg"!==e.nodeName)e.setAttributeNS(null,"transform","rotate("+b+" "+o.x+" "+o.y+")");else{var _=this.symbolMetrics[g.id];e.firstChild.setAttributeNS(null,"transform","rotate("+b+" "+_[1]+" "+_[2]+")")}}return i.isFilled?(e.setAttributeNS(null,"fill",t.fillColor),e.setAttributeNS(null,"fill-opacity",t.fillOpacity)):e.setAttributeNS(null,"fill","none"),i.isStroked?(e.setAttributeNS(null,"stroke",t.strokeColor),e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),e.setAttributeNS(null,"stroke-width",t.strokeWidth*l),e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round"),e.setAttributeNS(null,"stroke-linejoin","round"),t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,l))):e.setAttributeNS(null,"stroke","none"),t.pointerEvents&&e.setAttributeNS(null,"pointer-events",t.pointerEvents),null!=t.cursor&&e.setAttributeNS(null,"cursor",t.cursor),e},dashStyle:function(e,t){var i=e.strokeWidth*t,n=e.strokeDashstyle;switch(n){case"solid":return"none";case"dot":return[1,4*i].join();case"dash":return[4*i,4*i].join();case"dashdot":return[4*i,4*i,1,4*i].join();case"longdash":return[8*i,4*i].join();case"longdashdot":return[8*i,4*i,1,4*i].join();default:return OpenLayers.String.trim(n).replace(/\s+/g,",")}},createNode:function(e,t){var i=document.createElementNS(this.xmlns,e);return t&&i.setAttributeNS(null,"id",t),i},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){var e=this.nodeFactory(this.container.id+"_svgRoot","svg");return e.style.display="block",e},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(e),e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,i){var n=this.getResolution(),r=(t.x-this.featureDx)/n+this.left,s=this.top-t.y/n;return this.inValidRange(r,s)?(e.setAttributeNS(null,"cx",r),e.setAttributeNS(null,"cy",s),e.setAttributeNS(null,"r",i),e):!1},drawLineString:function(e,t){var i=this.getComponentsString(t.components);return i.path?(e.setAttributeNS(null,"points",i.path),i.complete?e:null):!1},drawLinearRing:function(e,t){var i=this.getComponentsString(t.components);return i.path?(e.setAttributeNS(null,"points",i.path),i.complete?e:null):!1},drawPolygon:function(e,t){for(var i,n,r="",s=!0,o=!0,a=0,l=t.components.length;l>a;a++)r+=" M",i=this.getComponentsString(t.components[a].components," "),n=i.path,n?(r+=" "+n,o=i.complete&&o):s=!1;return r+=" z",s?(e.setAttributeNS(null,"d",r),e.setAttributeNS(null,"fill-rule","evenodd"),o?e:null):!1},drawRectangle:function(e,t){var i=this.getResolution(),n=(t.x-this.featureDx)/i+this.left,r=this.top-t.y/i;return this.inValidRange(n,r)?(e.setAttributeNS(null,"x",n),e.setAttributeNS(null,"y",r),e.setAttributeNS(null,"width",t.width/i),e.setAttributeNS(null,"height",t.height/i),e):!1},drawText:function(e,t,i){var n=!!t.labelOutlineWidth;if(n){var r=OpenLayers.Util.extend({},t);r.fontColor=r.labelOutlineColor,r.fontStrokeColor=r.labelOutlineColor,r.fontStrokeWidth=t.labelOutlineWidth,t.labelOutlineOpacity&&(r.fontOpacity=t.labelOutlineOpacity),delete r.labelOutlineWidth,this.drawText(e,r,i)}var s=this.getResolution(),o=(i.x-this.featureDx)/s+this.left,a=i.y/s-this.top,l=n?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,u=this.nodeFactory(e+l,"text");u.setAttributeNS(null,"x",o),u.setAttributeNS(null,"y",-a),t.fontColor&&u.setAttributeNS(null,"fill",t.fontColor),t.fontStrokeColor&&u.setAttributeNS(null,"stroke",t.fontStrokeColor),t.fontStrokeWidth&&u.setAttributeNS(null,"stroke-width",t.fontStrokeWidth),t.fontOpacity&&u.setAttributeNS(null,"opacity",t.fontOpacity),t.fontFamily&&u.setAttributeNS(null,"font-family",t.fontFamily),t.fontSize&&u.setAttributeNS(null,"font-size",t.fontSize),t.fontWeight&&u.setAttributeNS(null,"font-weight",t.fontWeight),t.fontStyle&&u.setAttributeNS(null,"font-style",t.fontStyle),t.labelSelect===!0?(u.setAttributeNS(null,"pointer-events","visible"),u._featureId=e):u.setAttributeNS(null,"pointer-events","none");var h=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;u.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[h[0]]||"middle"),OpenLayers.IS_GECKO===!0&&u.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[h[1]]||"central");for(var c=t.label.split("\n"),p=c.length;u.childNodes.length>p;)u.removeChild(u.lastChild);for(var d=0;p>d;d++){var f=this.nodeFactory(e+l+"_tspan_"+d,"tspan");if(t.labelSelect===!0&&(f._featureId=e,f._geometry=i,f._geometryClass=i.CLASS_NAME),OpenLayers.IS_GECKO===!1&&f.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[h[1]]||"-35%"),f.setAttribute("x",o),0==d){var m=OpenLayers.Renderer.SVG.LABEL_VFACTOR[h[1]];null==m&&(m=-.5),f.setAttribute("dy",m*(p-1)+"em")}else f.setAttribute("dy","1em");f.textContent=""===c[d]?" ":c[d],f.parentNode||u.appendChild(f)}u.parentNode||this.textRoot.appendChild(u)},getComponentsString:function(e,t){for(var i,n,r=[],s=!0,o=e.length,a=[],l=0;o>l;l++)n=e[l],r.push(n),i=this.getShortString(n),i?a.push(i):(l>0&&this.getShortString(e[l-1])&&a.push(this.clipLine(e[l],e[l-1])),o-1>l&&this.getShortString(e[l+1])&&a.push(this.clipLine(e[l],e[l+1])),s=!1);return{path:a.join(t||","),complete:s}},clipLine:function(e,t){if(t.equals(e))return"";var i,n=this.getResolution(),r=this.MAX_PIXEL-this.translationParameters.x,s=this.MAX_PIXEL-this.translationParameters.y,o=(t.x-this.featureDx)/n+this.left,a=this.top-t.y/n,l=(e.x-this.featureDx)/n+this.left,u=this.top-e.y/n;return(-r>l||l>r)&&(i=(u-a)/(l-o),l=0>l?-r:r,u=a+(l-o)*i),(-s>u||u>s)&&(i=(l-o)/(u-a),u=0>u?-s:s,l=o+(u-a)*i),l+","+u},getShortString:function(e){var t=this.getResolution(),i=(e.x-this.featureDx)/t+this.left,n=this.top-e.y/t;return this.inValidRange(i,n)?i+","+n:!1},getPosition:function(e){return{x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))}},importSymbol:function(e){this.defs||(this.defs=this.createDefs());var t=this.container.id+"-"+e,i=document.getElementById(t);if(null!=i)return i;var n=OpenLayers.Renderer.symbol[e];if(!n)throw Error(e+" is not a valid symbol name");var r=this.nodeFactory(t,"symbol"),s=this.nodeFactory(null,"polygon");r.appendChild(s);for(var o,a,l=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),u=[],h=0;n.length>h;h+=2)o=n[h],a=n[h+1],l.left=Math.min(l.left,o),l.bottom=Math.min(l.bottom,a),l.right=Math.max(l.right,o),l.top=Math.max(l.top,a),u.push(o,",",a);s.setAttributeNS(null,"points",u.join(" "));var c=l.getWidth(),p=l.getHeight(),d=[l.left-c,l.bottom-p,3*c,3*p];return r.setAttributeNS(null,"viewBox",d.join(" ")),this.symbolMetrics[t]=[Math.max(c,p),l.getCenterLonLat().lon,l.getCenterLonLat().lat],this.defs.appendChild(r),r},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var i=e.target;t=i.parentNode&&i!=this.rendererRoot?i.parentNode._featureId:void 0}return t},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG.preventDefault=function(e){OpenLayers.Event.preventDefault(e)},OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y),OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),this.removeButtons(),this.buttons=null,this.position=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(e){OpenLayers.Control.prototype.draw.apply(this,arguments),e=this.position,this.buttons=[];var t={w:18,h:18},i=new OpenLayers.Pixel(e.x+t.w/2,e.y);return this._addButton("panup","north-mini.png",i,t),e.y=i.y+t.h,this._addButton("panleft","west-mini.png",e,t),this._addButton("panright","east-mini.png",e.add(t.w,0),t),this._addButton("pandown","south-mini.png",i.add(0,2*t.h),t),this._addButton("zoomin","zoom-plus-mini.png",i.add(0,3*t.h+5),t),this._addButton("zoomworld","zoom-world-mini.png",i.add(0,4*t.h+5),t),this._addButton("zoomout","zoom-minus-mini.png",i.add(0,5*t.h+5),t),this.div},_addButton:function(e,t,i,n){var r=OpenLayers.Util.getImageLocation(t),s=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+e,i,n,r,"absolute");return s.style.cursor="pointer",this.div.appendChild(s),s.action=e,s.className="olButton",this.buttons.push(s),s},_removeButton:function(e){this.div.removeChild(e),OpenLayers.Util.removeItem(this.buttons,e)},removeButtons:function(){for(var e=this.buttons.length-1;e>=0;--e)this._removeButton(this.buttons[e])},onButtonClick:function(e){var t=e.buttonElement;switch(t.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(e){return this.slideRatio?this.map.getSize()[e]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(e,t,i,n){this.url=e,this.size=t||{w:20,h:20},this.offset=i||{x:-(this.size.w/2),y:-(this.size.h/2)},this.calculateOffset=n;var r=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(r)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(e){null!=e&&(this.size=e),this.draw()},setUrl:function(e){null!=e&&(this.url=e),this.draw()},draw:function(e){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(e),this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,e)},moveTo:function(e){null!=e&&(this.px=e),null!=this.imageDiv&&(null==this.px?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(e){this.imageDiv.style.display=e?"":"none"},isDrawn:function(){var e=this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType;return e},CLASS_NAME:"OpenLayers.Icon"}),OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(e,t){this.lonlat=e;var i=t?t:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=i:(this.icon.url=i.url,this.icon.size=i.size,this.icon.offset=i.offset,this.icon.calculateOffset=i.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase(),this.map=null,this.events.destroy(),this.events=null,null!=this.icon&&(this.icon.destroy(),this.icon=null)},draw:function(e){return this.icon.draw(e)},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(e){null!=e&&null!=this.icon&&this.icon.moveTo(e),this.lonlat=this.map.getLonLatFromLayerPx(e)},isDrawn:function(){var e=this.icon&&this.icon.isDrawn();return e},onScreen:function(){var e=!1;if(this.map){var t=this.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},inflate:function(e){this.icon&&this.icon.setSize({w:this.icon.size.w*e,h:this.icon.size.h*e})},setOpacity:function(e){this.icon.setOpacity(e)},setUrl:function(e){this.icon.setUrl(e)},display:function(e){this.icon.display(e)},CLASS_NAME:"OpenLayers.Marker"}),OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})},OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(e,t,i){t=t?t:"FeatureCollection";var n=null,r=null;if(r="string"==typeof e?OpenLayers.Format.JSON.prototype.read.apply(this,[e,i]):e){if("string"!=typeof r.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+e);else if(this.isValidType(r,t))switch(t){case"Geometry":try{n=this.parseGeometry(r)}catch(s){OpenLayers.Console.error(s)}break;case"Feature":try{n=this.parseFeature(r),n.type="Feature"}catch(s){OpenLayers.Console.error(s)}break;case"FeatureCollection":switch(n=[],r.type){case"Feature":try{n.push(this.parseFeature(r))}catch(s){n=null,OpenLayers.Console.error(s)}break;case"FeatureCollection":for(var o=0,a=r.features.length;a>o;++o)try{n.push(this.parseFeature(r.features[o]))}catch(s){n=null,OpenLayers.Console.error(s)}break;default:try{var l=this.parseGeometry(r);n.push(new OpenLayers.Feature.Vector(l))}catch(s){n=null,OpenLayers.Console.error(s)}}}}else OpenLayers.Console.error("Bad JSON: "+e);return n},isValidType:function(e,t){var i=!1;switch(t){case"Geometry":-1==OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)?OpenLayers.Console.error("Unsupported geometry type: "+e.type):i=!0;break;case"FeatureCollection":i=!0;break;default:e.type==t?i=!0:OpenLayers.Console.error("Cannot convert types from "+e.type+" to "+t)}return i},parseFeature:function(e){var t,i,n,r;n=e.properties?e.properties:{},r=e.geometry&&e.geometry.bbox||e.bbox;try{i=this.parseGeometry(e.geometry)}catch(s){throw s}return t=new OpenLayers.Feature.Vector(i,n),r&&(t.bounds=OpenLayers.Bounds.fromArray(r)),e.id&&(t.fid=e.id),t},parseGeometry:function(e){if(null==e)return null;var t,i=!1;if("GeometryCollection"==e.type){if(!OpenLayers.Util.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;for(var n=e.geometries.length,r=Array(n),s=0;n>s;++s)r[s]=this.parseGeometry.apply(this,[e.geometries[s]]);t=new OpenLayers.Geometry.Collection(r),i=!0}else{if(!OpenLayers.Util.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(o){throw o}}return this.internalProjection&&this.externalProjection&&!i&&t.transform(this.externalProjection,this.internalProjection),t
},parseCoords:{point:function(e){if(0==this.ignoreExtraDims&&2!=e.length)throw"Only 2D points are supported: "+e;return new OpenLayers.Geometry.Point(e[0],e[1])},multipoint:function(e){for(var t=[],i=null,n=0,r=e.length;r>n;++n){try{i=this.parseCoords.point.apply(this,[e[n]])}catch(s){throw s}t.push(i)}return new OpenLayers.Geometry.MultiPoint(t)},linestring:function(e){for(var t=[],i=null,n=0,r=e.length;r>n;++n){try{i=this.parseCoords.point.apply(this,[e[n]])}catch(s){throw s}t.push(i)}return new OpenLayers.Geometry.LineString(t)},multilinestring:function(e){for(var t=[],i=null,n=0,r=e.length;r>n;++n){try{i=this.parseCoords.linestring.apply(this,[e[n]])}catch(s){throw s}t.push(i)}return new OpenLayers.Geometry.MultiLineString(t)},polygon:function(e){for(var t,i,n=[],r=0,s=e.length;s>r;++r){try{i=this.parseCoords.linestring.apply(this,[e[r]])}catch(o){throw o}t=new OpenLayers.Geometry.LinearRing(i.components),n.push(t)}return new OpenLayers.Geometry.Polygon(n)},multipolygon:function(e){for(var t=[],i=null,n=0,r=e.length;r>n;++n){try{i=this.parseCoords.polygon.apply(this,[e[n]])}catch(s){throw s}t.push(i)}return new OpenLayers.Geometry.MultiPolygon(t)},box:function(e){if(2!=e.length)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(e[0][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[0][1])])])}},write:function(e,t){var i={type:null};if(OpenLayers.Util.isArray(e)){i.type="FeatureCollection";var n=e.length;i.features=Array(n);for(var r=0;n>r;++r){var s=e[r];if(!s instanceof OpenLayers.Feature.Vector){var o="FeatureCollection only supports collections of features: "+s;throw o}i.features[r]=this.extract.feature.apply(this,[s])}}else 0==e.CLASS_NAME.indexOf("OpenLayers.Geometry")?i=this.extract.geometry.apply(this,[e]):e instanceof OpenLayers.Feature.Vector&&(i=this.extract.feature.apply(this,[e]),e.layer&&e.layer.projection&&(i.crs=this.createCRSObject(e)));return OpenLayers.Format.JSON.prototype.write.apply(this,[i,t])},createCRSObject:function(e){var t=""+e.layer.projection,i={};if(t.match(/epsg:/i)){var n=parseInt(t.substring(t.indexOf(":")+1));i=4326==n?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+n}}}return i},extract:{feature:function(e){var t=this.extract.geometry.apply(this,[e.geometry]),i={type:"Feature",properties:e.attributes,geometry:t};return null!=e.fid&&(i.id=e.fid),i},geometry:function(e){if(null==e)return null;this.internalProjection&&this.externalProjection&&(e=e.clone(),e.transform(this.internalProjection,this.externalProjection));var t,i=e.CLASS_NAME.split(".")[2],n=this.extract[i.toLowerCase()].apply(this,[e]);return t="Collection"==i?{type:"GeometryCollection",geometries:n}:{type:i,coordinates:n}},point:function(e){return[e.x,e.y]},multipoint:function(e){for(var t=[],i=0,n=e.components.length;n>i;++i)t.push(this.extract.point.apply(this,[e.components[i]]));return t},linestring:function(e){for(var t=[],i=0,n=e.components.length;n>i;++i)t.push(this.extract.point.apply(this,[e.components[i]]));return t},multilinestring:function(e){for(var t=[],i=0,n=e.components.length;n>i;++i)t.push(this.extract.linestring.apply(this,[e.components[i]]));return t},polygon:function(e){for(var t=[],i=0,n=e.components.length;n>i;++i)t.push(this.extract.linestring.apply(this,[e.components[i]]));return t},multipolygon:function(e){for(var t=[],i=0,n=e.components.length;n>i;++i)t.push(this.extract.polygon.apply(this,[e.components[i]]));return t},collection:function(e){for(var t=e.components.length,i=Array(t),n=0;t>n;++n)i[n]=this.extract.geometry.apply(this,[e.components[n]]);return i}},CLASS_NAME:"OpenLayers.Format.GeoJSON"}),OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},initialize:function(e,t,i){OpenLayers.Control.prototype.initialize.apply(this,[i]),this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(e,t){this.layer.events.triggerEvent("sketchmodified",{vertex:e,feature:t})},create:function(e,t){this.layer.events.triggerEvent("sketchstarted",{vertex:e,feature:t})}},this.callbacks),this.layer=e,this.handlerOptions=this.handlerOptions||{},this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:e.renderers,rendererOptions:e.rendererOptions}),"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);var n=this.layer.styleMap&&this.layer.styleMap.styles.temporary;n&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":n})})),this.handler=new t(this,this.callbacks,this.handlerOptions)},drawFeature:function(e){var t=new OpenLayers.Feature.Vector(e),i=this.layer.events.triggerEvent("sketchcomplete",{feature:t});i!==!1&&(t.state=OpenLayers.State.INSERT,this.layer.addFeatures([t]),this.featureAdded(t),this.events.triggerEvent("featureadded",{feature:t}))},insertXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertXY(e,t)},insertDeltaXY:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeltaXY(e,t)},insertDirectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDirectionLength(e,t)},insertDeflectionLength:function(e,t){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(e,t)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"}),OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(e){var t=!0;if(this.pinching=!1,OpenLayers.Event.isMultiTouch(e))this.started=!0,this.last=this.start={distance:this.getDistance(e.touches),delta:0,scale:1},this.callback("start",[e,this.start]),t=!this.stopDown;else{if(this.started)return!1;this.started=!1,this.start=null,this.last=null}return OpenLayers.Event.preventDefault(e),t},touchmove:function(e){if(this.started&&OpenLayers.Event.isMultiTouch(e)){this.pinching=!0;var t=this.getPinchData(e);this.callback("move",[e,t]),this.last=t,OpenLayers.Event.stop(e)}else if(this.started)return!1;return!0},touchend:function(e){return this.started&&!OpenLayers.Event.isMultiTouch(e)?(this.started=!1,this.pinching=!1,this.callback("done",[e,this.start,this.last]),this.start=null,this.last=null,!1):!0},activate:function(){var e=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,e=!0),e},deactivate:function(){var e=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.pinching=!1,this.start=null,this.last=null,e=!0),e},getDistance:function(e){var t=e[0],i=e[1];return Math.sqrt(Math.pow(t.olClientX-i.olClientX,2)+Math.pow(t.olClientY-i.olClientY,2))},getPinchData:function(e){var t=this.getDistance(e.touches),i=t/this.start.distance;return{distance:t,delta:this.last.distance-t,scale:i}},CLASS_NAME:"OpenLayers.Handler.Pinch"}),OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(e){var t=this.layer.getLonLatFromViewPortPx(e),i=new OpenLayers.Geometry.Point(t.lon,t.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])),this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var e,t,i=this.point.geometry,n=this.control.layer.features,r=n.length-1;r>=0;--r)if(e=n[r].geometry,(e instanceof OpenLayers.Geometry.Polygon||e instanceof OpenLayers.Geometry.MultiPolygon)&&e.intersects(i)){t=n[r],this.control.layer.removeFeatures([t],{silent:!0}),this.control.layer.events.registerPriority("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology),t.geometry.addComponent(this.line.geometry),this.polygon=t,this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(e){var t=e.vertex,i=this.line.geometry.components;if(!this.polygon.geometry.intersects(t)){var n=i[i.length-3];t.x=n.x,t.y=n.y}},finishGeometry:function(){var e=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[e]),this.removePoint(),this.finalize()},finalizeInteriorRing:function(){var e=this.line.geometry,t=0!==e.getArea();if(t){for(var i=this.polygon.geometry.components,n=i.length-2;n>=0;--n)if(e.intersects(i[n])){t=!1;break}if(t)e:for(var n=i.length-2;n>0;--n)for(var r=i[n].components,s=0,o=r.length;o>s;++s)if(e.containsPoint(r[s])){t=!1;break e}}return t?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(e),this.restoreFeature(),!1},cancel:function(){return this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0)),OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(e){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology),this.layer.removeFeatures([this.polygon],{silent:!0}),this.control.layer.addFeatures([this.polygon],{silent:!0}),this.drawingHole=!1,e||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(e){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,e),this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var e=this.polygon&&this.polygon.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiPolygon([e])),e},CLASS_NAME:"OpenLayers.Handler.Polygon"}),OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:"geolocation"in navigator,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.available&&!this.geolocation&&(this.geolocation=navigator.geolocation),this.geolocation?OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1:(this.events.triggerEvent("locationuncapable"),!1)},deactivate:function(){return this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(e){var t=new OpenLayers.LonLat(e.coords.longitude,e.coords.latitude).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(t),this.events.triggerEvent("locationupdated",{position:e,point:new OpenLayers.Geometry.Point(t.lon,t.lat)})},getCurrentLocation:function(){return!this.active||this.watch?!1:(this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions),!0)},failure:function(e){this.events.triggerEvent("locationfailed",{error:e})},CLASS_NAME:"OpenLayers.Control.Geolocate"}),OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.left="",this.div.top="",this.element=this.div),this.div},redraw:function(e){var t;if(null==e)return this.reset(),void 0;if(null==this.lastXy||Math.abs(e.xy.x-this.lastXy.x)>this.granularity||Math.abs(e.xy.y-this.lastXy.y)>this.granularity)return this.lastXy=e.xy,void 0;if(t=this.map.getLonLatFromPixel(e.xy)){this.displayProjection&&t.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=e.xy;var i=this.formatOutput(t);i!=this.element.innerHTML&&(this.element.innerHTML=i)}},reset:function(){null!=this.emptyString&&(this.element.innerHTML=this.emptyString)},formatOutput:function(e){var t=parseInt(this.numDigits),i=this.prefix+e.lon.toFixed(t)+this.separator+e.lat.toFixed(t)+this.suffix;return i},CLASS_NAME:"OpenLayers.Control.MousePosition"}),OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"}),OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,maximizeTitle:"",minimizeTitle:"",initialize:function(e){this.layers=[],this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,[e])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),0===this.layers.length){if(!this.map.baseLayer)return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;var e=this.map.baseLayer.clone();this.layers=[e]}if(this.element=document.createElement("div"),this.element.className=this.displayClass+"Element",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width=this.size.w+"px",this.mapDiv.style.height=this.size.h+"px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.element.appendChild(this.mapDiv),this.div.appendChild(this.element),this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var t=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,t,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton",this.maximizeTitle&&(this.maximizeDiv.title=this.maximizeTitle),this.div.appendChild(this.maximizeDiv);var t=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,t,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton",this.minimizeTitle&&(this.minimizeDiv.title=this.minimizeTitle),this.div.appendChild(this.minimizeDiv),this.minimizeControl()}return this.map.getExtent()&&this.update(),this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this}),this.maximized&&this.maximizeControl(),this.div},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(e){var t=this.handlers.drag.last.x-e.x,i=this.handlers.drag.last.y-e.y;if(0!=t||0!=i){var n=this.rectPxBounds.top,r=this.rectPxBounds.left,s=Math.abs(this.rectPxBounds.getHeight()),o=this.rectPxBounds.getWidth(),a=Math.max(0,n-i);a=Math.min(a,this.ovmap.size.h-this.hComp-s);var l=Math.max(0,r-t);l=Math.min(l,this.ovmap.size.w-this.wComp-o),this.setRectPxBounds(new OpenLayers.Bounds(l,a+s,l+o,a))}},mapDivClick:function(e){var t=this.rectPxBounds.getCenterPixel(),i=e.xy.x-t.x,n=e.xy.y-t.y,r=this.rectPxBounds.top,s=this.rectPxBounds.left,o=Math.abs(this.rectPxBounds.getHeight()),a=this.rectPxBounds.getWidth(),l=Math.max(0,r+n);l=Math.min(l,this.ovmap.size.h-o);var u=Math.max(0,s+i);u=Math.min(u,this.ovmap.size.w-a),this.setRectPxBounds(new OpenLayers.Bounds(u,l+o,u+a,l)),this.updateMapToRect()},onButtonClick:function(e){e.buttonElement===this.minimizeDiv?this.minimizeControl():e.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(e){this.element.style.display="",this.showToggle(!1),null!=e&&OpenLayers.Event.stop(e)},minimizeControl:function(e){this.element.style.display="none",this.showToggle(!0),null!=e&&OpenLayers.Event.stop(e)},showToggle:function(e){this.maximizeDiv&&(this.maximizeDiv.style.display=e?"":"none"),this.minimizeDiv&&(this.minimizeDiv.style.display=e?"none":"")},update:function(){null==this.ovmap&&this.createMap(),(this.autoPan||!this.isSuitableOverview())&&this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var e=this.map.getExtent(),t=this.map.getMaxExtent(),i=new OpenLayers.Bounds(Math.max(e.left,t.left),Math.max(e.bottom,t.bottom),Math.min(e.right,t.right),Math.min(e.top,t.top));this.ovmap.getProjection()!=this.map.getProjection()&&(i=i.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));var n=this.ovmap.getResolution()/this.map.getResolution();return n>this.minRatio&&this.maxRatio>=n&&this.ovmap.getExtent().containsBounds(i)},updateOverview:function(){var e=this.map.getResolution(),t=this.ovmap.getResolution(),i=t/e;i>this.maxRatio?t=this.minRatio*e:this.minRatio>=i&&(t=this.maxRatio*e);var n;this.ovmap.getProjection()!=this.map.getProjection()?(n=this.map.center.clone(),n.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):n=this.map.center,this.ovmap.setCenter(n,this.ovmap.getZoomForResolution(t*this.resolutionFactor)),this.updateRectToMap()},createMap:function(){var e=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);if(this.ovmap=new OpenLayers.Map(this.mapDiv,e),this.ovmap.viewPortDiv.appendChild(this.extentRectangle),OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2,this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap}),this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap}),this.handlers.click.activate(),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0),this.rectEvents.register("mouseover",this,function(){this.handlers.drag.active||this.map.dragging||this.handlers.drag.activate()}),this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()}),this.ovmap.getProjection()!=this.map.getProjection()){var t=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,i=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=t&&i?OpenLayers.INCHES_PER_UNIT[t]/OpenLayers.INCHES_PER_UNIT[i]:1}},updateRectToMap:function(){var e;e=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();var t=this.getRectBoundsFromMapBounds(e);t&&this.setRectPxBounds(t)},updateMapToRect:function(){var e=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(e=e.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())),this.map.panTo(e.getCenterLonLat())},setRectPxBounds:function(e){var t=Math.max(e.top,0),i=Math.max(e.left,0),n=Math.min(e.top+Math.abs(e.getHeight()),this.ovmap.size.h-this.hComp),r=Math.min(e.left+e.getWidth(),this.ovmap.size.w-this.wComp),s=Math.max(r-i,0),o=Math.max(n-t,0);if(this.minRectSize>s||this.minRectSize>o){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var a=i+s/2-this.minRectSize/2,l=t+o/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(l)+"px",this.extentRectangle.style.left=Math.round(a)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"}else this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(t)+"px",this.extentRectangle.style.left=Math.round(i)+"px",this.extentRectangle.style.height=Math.round(o)+"px",this.extentRectangle.style.width=Math.round(s)+"px";this.rectPxBounds=new OpenLayers.Bounds(Math.round(i),Math.round(n),Math.round(r),Math.round(t))},getRectBoundsFromMapBounds:function(e){var t=this.getOverviewPxFromLonLat({lon:e.left,lat:e.bottom}),i=this.getOverviewPxFromLonLat({lon:e.right,lat:e.top}),n=null;return t&&i&&(n=new OpenLayers.Bounds(t.x,t.y,i.x,i.y)),n},getMapBoundsFromRectBounds:function(e){var t=this.getLonLatFromOverviewPx({x:e.left,y:e.bottom}),i=this.getLonLatFromOverviewPx({x:e.right,y:e.top});return new OpenLayers.Bounds(t.lon,t.lat,i.lon,i.lat)},getLonLatFromOverviewPx:function(e){var t=this.ovmap.size,i=this.ovmap.getResolution(),n=this.ovmap.getExtent().getCenterLonLat(),r=e.x-t.w/2,s=e.y-t.h/2;return{lon:n.lon+r*i,lat:n.lat-s*i}},getOverviewPxFromLonLat:function(e){var t=this.ovmap.getResolution(),i=this.ovmap.getExtent();return i?{x:Math.round(1/t*(e.lon-i.left)),y:Math.round(1/t*(i.top-e.lat))}:void 0},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:!0,preserveCenter:!1,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(e){var t=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):e.xy;this.pinchOrigin=t,this.currentCenter=t},pinchMove:function(e,t){var i=t.scale,n=this.map.layerContainerOriginPx,r=this.pinchOrigin,s=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):e.xy,o=Math.round(n.x+s.x-r.x+(i-1)*(n.x-r.x)),a=Math.round(n.y+s.y-r.y+(i-1)*(n.y-r.y));this.map.applyTransform(o,a,i),this.currentCenter=s},pinchDone:function(e,t,i){this.map.applyTransform();var n=this.map.getZoomForResolution(this.map.getResolution()/i.scale,!0);if(n!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var r=this.map.getResolutionForZoom(n),s=this.map.getLonLatFromPixel(this.pinchOrigin),o=this.currentCenter,a=this.map.getSize();s.lon+=r*(a.w/2-o.x),s.lat-=r*(a.h/2-o.y),this.map.div.clientWidth=this.map.div.clientWidth,this.map.setCenter(s,n)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"}),OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var e={click:this.defaultClick,dblclick:this.defaultDblClick},t=OpenLayers.Util.extend({"double":!0,stopDouble:!0,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,e,t),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.dragPan.draw(),this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(e){e.lastTouches&&2==e.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(e){this.map.zoomTo(this.map.zoom+1,e.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"}),OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(e){if(e=e||{},this.params={},this.headers={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments),!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var t=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(e,i){return t.write(e,i)}}},destroy:function(){this.params=null,this.headers=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments),e=e||{},e.params=OpenLayers.Util.applyDefaults(e.params,this.options.params),e=OpenLayers.Util.applyDefaults(e,this.options),e.filter&&this.filterToParams&&(e.params=this.filterToParams(e.filter,e.params));var t=void 0!==e.readWithPOST?e.readWithPOST:this.readWithPOST,i=new OpenLayers.Protocol.Response({requestType:"read"});if(t){var n=e.headers||{};n["Content-Type"]="application/x-www-form-urlencoded",i.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,i,e),data:OpenLayers.Util.getParameterString(e.params),headers:n})}else i.priv=OpenLayers.Request.GET({url:e.url,callback:this.createCallback(this.handleRead,i,e),params:e.params,headers:e.headers});return i},handleRead:function(e,t){this.handleResponse(e,t)},create:function(e,t){t=OpenLayers.Util.applyDefaults(t,this.options);var i=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"create"});return i.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleCreate,i,t),headers:t.headers,data:this.format.write(e)}),i},handleCreate:function(e,t){this.handleResponse(e,t)},update:function(e,t){t=t||{};var i=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var n=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"update"}),r=this.updateWithPOST?"POST":"PUT";return n.priv=OpenLayers.Request[r]({url:i,callback:this.createCallback(this.handleUpdate,n,t),headers:t.headers,data:this.format.write(e)}),n},handleUpdate:function(e,t){this.handleResponse(e,t)},"delete":function(e,t){t=t||{};var i=t.url||e.url||this.options.url+"/"+e.fid;t=OpenLayers.Util.applyDefaults(t,this.options);var n=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"delete"}),r=this.deleteWithPOST?"POST":"DELETE",s={url:i,callback:this.createCallback(this.handleDelete,n,t),headers:t.headers};return this.deleteWithPOST&&(s.data=this.format.write(e)),n.priv=OpenLayers.Request[r](s),n},handleDelete:function(e,t){this.handleResponse(e,t)},handleResponse:function(e,t){var i=e.priv;t.callback&&(i.status>=200&&300>i.status?("delete"!=e.requestType&&(e.features=this.parseFeatures(i)),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,t.callback.call(t.scope,e))},parseFeatures:function(e){var t=e.responseXML;return t&&t.documentElement||(t=e.responseText),!t||0>=t.length?null:this.format.read(t)},commit:function(e,t){function i(e){for(var t=e.features?e.features.length:0,i=Array(t),r=0;t>r;++r)i[r]=e.features[r].fid;f.insertIds=i,n.apply(this,[e])}function n(e){this.callUserCallback(e,t),d=d&&e.success(),s++,s>=p&&t.callback&&(f.code=d?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,t.callback.apply(t.scope,[f]))}t=OpenLayers.Util.applyDefaults(t,this.options);var r=[],s=0,o={};o[OpenLayers.State.INSERT]=[],o[OpenLayers.State.UPDATE]=[],o[OpenLayers.State.DELETE]=[];for(var a,l,u=[],h=0,c=e.length;c>h;++h)a=e[h],l=o[a.state],l&&(l.push(a),u.push(a));var p=(o[OpenLayers.State.INSERT].length>0?1:0)+o[OpenLayers.State.UPDATE].length+o[OpenLayers.State.DELETE].length,d=!0,f=new OpenLayers.Protocol.Response({reqFeatures:u}),m=o[OpenLayers.State.INSERT];m.length>0&&r.push(this.create(m,OpenLayers.Util.applyDefaults({callback:i,scope:this},t.create))),m=o[OpenLayers.State.UPDATE];for(var h=m.length-1;h>=0;--h)r.push(this.update(m[h],OpenLayers.Util.applyDefaults({callback:n,scope:this},t.update)));m=o[OpenLayers.State.DELETE];for(var h=m.length-1;h>=0;--h)r.push(this["delete"](m[h],OpenLayers.Util.applyDefaults({callback:n,scope:this},t["delete"])));return r},abort:function(e){e&&e.priv.abort()},callUserCallback:function(e,t){var i=t[e.requestType];i&&i.callback&&i.callback.call(i.scope,e)},CLASS_NAME:"OpenLayers.Protocol.HTTP"}),OpenLayers.TileManager=OpenLayers.Class({cacheSize:256,tilesPerFrame:2,frameDelay:16,moveDelay:100,zoomDelay:200,maps:null,tileQueueId:null,tileQueue:null,tileCache:null,tileCacheIndex:null,initialize:function(e){OpenLayers.Util.extend(this,e),this.maps=[],this.tileQueueId={},this.tileQueue={},this.tileCache={},this.tileCacheIndex=[]},addMap:function(e){if(!this._destroyed&&OpenLayers.Layer.Grid){this.maps.push(e),this.tileQueue[e.id]=[];for(var t=0,i=e.layers.length;i>t;++t)this.addLayer({layer:e.layers[t]});e.events.on({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})}},removeMap:function(e){if(!this._destroyed&&OpenLayers.Layer.Grid){if(window.clearTimeout(this.tileQueueId[e.id]),e.layers)for(var t=0,i=e.layers.length;i>t;++t)this.removeLayer({layer:e.layers[t]});
e.events&&e.events.un({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this}),delete this.tileQueue[e.id],delete this.tileQueueId[e.id],OpenLayers.Util.removeItem(this.maps,e)}},move:function(e){this.updateTimeout(e.object,this.moveDelay,!0)},zoomEnd:function(e){this.updateTimeout(e.object,this.zoomDelay)},changeLayer:function(e){("visibility"===e.property||"params"===e.property)&&this.updateTimeout(e.object,0)},addLayer:function(e){var t=e.layer;if(t instanceof OpenLayers.Layer.Grid){t.events.on({addtile:this.addTile,retile:this.clearTileQueue,scope:this});var i,n,r;for(i=t.grid.length-1;i>=0;--i)for(n=t.grid[i].length-1;n>=0;--n)r=t.grid[i][n],this.addTile({tile:r}),r.url&&!r.imgDiv&&this.manageTileCache({object:r})}},removeLayer:function(e){var t=e.layer;if(t instanceof OpenLayers.Layer.Grid&&(this.clearTileQueue({object:t}),t.events&&t.events.un({addtile:this.addTile,retile:this.clearTileQueue,scope:this}),t.grid)){var i,n,r;for(i=t.grid.length-1;i>=0;--i)for(n=t.grid[i].length-1;n>=0;--n)r=t.grid[i][n],this.unloadTile({object:r})}},updateTimeout:function(e,t,i){window.clearTimeout(this.tileQueueId[e.id]);var n=this.tileQueue[e.id];(!i||n.length)&&(this.tileQueueId[e.id]=window.setTimeout(OpenLayers.Function.bind(function(){this.drawTilesFromQueue(e),n.length&&this.updateTimeout(e,this.frameDelay)},this),t))},addTile:function(e){e.tile instanceof OpenLayers.Tile.Image?e.tile.events.on({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this}):this.removeLayer({layer:e.tile.layer})},unloadTile:function(e){var t=e.object;t.events.un({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this}),OpenLayers.Util.removeItem(this.tileQueue[t.layer.map.id],t)},queueTileDraw:function(e){var t=e.object,i=!1,n=t.layer,r=n.getURL(t.bounds),s=this.tileCache[r];if(s&&"olTileImage"!==s.className&&(delete this.tileCache[r],OpenLayers.Util.removeItem(this.tileCacheIndex,r),s=null),n.url&&(n.async||!s)){var o=this.tileQueue[n.map.id];~OpenLayers.Util.indexOf(o,t)||o.push(t),i=!0}return!i},drawTilesFromQueue:function(e){for(var t=this.tileQueue[e.id],i=this.tilesPerFrame,n=e.zoomTween&&e.zoomTween.playing;!n&&t.length&&i;)t.shift().draw(!0),--i},manageTileCache:function(e){var t=e.object,i=this.tileCache[t.url];i&&(i.parentNode&&OpenLayers.Element.hasClass(i.parentNode,"olBackBuffer")&&(i.parentNode.removeChild(i),i.id=null),i.parentNode||(i.style.visibility="hidden",i.style.opacity=0,t.setImage(i),OpenLayers.Util.removeItem(this.tileCacheIndex,t.url),this.tileCacheIndex.push(t.url)))},addToCache:function(e){var t=e.object;this.tileCache[t.url]||OpenLayers.Element.hasClass(t.imgDiv,"olImageLoadError")||(this.tileCacheIndex.length>=this.cacheSize&&(delete this.tileCache[this.tileCacheIndex[0]],this.tileCacheIndex.shift()),this.tileCache[t.url]=t.imgDiv,this.tileCacheIndex.push(t.url))},clearTileQueue:function(e){for(var t=e.object,i=this.tileQueue[t.map.id],n=i.length-1;n>=0;--n)i[n].layer===t&&i.splice(n,1)},destroy:function(){for(var e=this.maps.length-1;e>=0;--e)this.removeMap(this.maps[e]);this.maps=null,this.tileQueue=null,this.tileQueueId=null,this.tileCache=null,this.tileCacheIndex=null,this._destroyed=!0}});var qq=function(e){"use strict";return{hide:function(){return e.style.display="none",this},attach:function(t,i){return e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i),function(){qq(e).detach(t,i)}},detach:function(t,i){return e.removeEventListener?e.removeEventListener(t,i,!1):e.attachEvent&&e.detachEvent("on"+t,i),this},contains:function(t){return t?e===t?!0:e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e)):!1},insertBefore:function(t){return t.parentNode.insertBefore(e,t),this},remove:function(){return e.parentNode.removeChild(e),this},css:function(t){if(null==e.style)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return null!=t.opacity&&"string"!=typeof e.style.opacity&&e.filters!==void 0&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t),this},hasClass:function(t){var i=RegExp("(^| )"+t+"( |$)");return i.test(e.className)},addClass:function(t){return qq(e).hasClass(t)||(e.className+=" "+t),this},removeClass:function(t){var i=RegExp("(^| )"+t+"( |$)");return e.className=e.className.replace(i," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){var i,n=[];return e.querySelectorAll?e.querySelectorAll("."+t):(i=e.getElementsByTagName("*"),qq.each(i,function(e,i){qq(i).hasClass(t)&&n.push(i)}),n)},children:function(){for(var t=[],i=e.firstChild;i;)1===i.nodeType&&t.push(i),i=i.nextSibling;return t},setText:function(t){return e.innerText=t,e.textContent=t,this},clearText:function(){return qq(e).setText("")},hasAttribute:function(t){var i;return e.hasAttribute?e.hasAttribute(t)?null==/^false$/i.exec(e.getAttribute(t)):!1:(i=e[t],void 0===i?!1:null==/^false$/i.exec(i))}}};(function(){"use strict";qq.log=function(e,t){window.console&&(t&&"info"!==t?window.console[t]?window.console[t](e):window.console.log("<"+t+"> "+e):window.console.log(e))},qq.isObject=function(e){return e&&!e.nodeType&&"[object Object]"===Object.prototype.toString.call(e)},qq.isFunction=function(e){return"function"==typeof e},qq.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)||e&&window.ArrayBuffer&&e.buffer&&e.buffer.constructor===ArrayBuffer},qq.isItemList=function(e){return"[object DataTransferItemList]"===Object.prototype.toString.call(e)},qq.isNodeList=function(e){return"[object NodeList]"===Object.prototype.toString.call(e)||e.item&&e.namedItem},qq.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},qq.trimStr=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},qq.format=function(e){var t=Array.prototype.slice.call(arguments,1),i=e,n=i.indexOf("{}");return qq.each(t,function(e,t){var r=i.substring(0,n),s=i.substring(n+2);return i=r+t+s,n=i.indexOf("{}",n+t.length),0>n?!1:void 0}),i},qq.isFile=function(e){return window.File&&"[object File]"===Object.prototype.toString.call(e)},qq.isFileList=function(e){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(e)},qq.isFileOrInput=function(e){return qq.isFile(e)||qq.isInput(e)},qq.isInput=function(e){return window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(e)&&e.type&&"file"===e.type.toLowerCase()?!0:e.tagName&&"input"===e.tagName.toLowerCase()&&e.type&&"file"===e.type.toLowerCase()?!0:!1},qq.isBlob=function(e){return window.Blob&&"[object Blob]"===Object.prototype.toString.call(e)},qq.isXhrUploadSupported=function(){var e=document.createElement("input");return e.type="file",void 0!==e.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&qq.createXhrInstance().upload!==void 0},qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return qq.log("Neither XHR or ActiveX are supported!","error"),null}},qq.isFolderDropSupported=function(e){return e.items&&e.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){return!qq.android()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)},qq.sliceBlob=function(e,t,i){var n=e.slice||e.mozSlice||e.webkitSlice;return n.call(e,t,i)},qq.arrayBufferToHex=function(e){var t="",i=new Uint8Array(e);return qq.each(i,function(e,i){var n=i.toString(16);2>n.length&&(n="0"+n),t+=n}),t},qq.readBlobToHex=function(e,t,i){var n=qq.sliceBlob(e,t,t+i),r=new FileReader,s=new qq.Promise;return r.onload=function(){s.success(qq.arrayBufferToHex(r.result))},r.readAsArrayBuffer(n),s},qq.extend=function(e,t,i){return qq.each(t,function(t,n){i&&qq.isObject(n)?(void 0===e[t]&&(e[t]={}),qq.extend(e[t],n,!0)):e[t]=n}),e},qq.override=function(e,t){var i={},n=t(i);return qq.each(n,function(t,n){void 0!==e[t]&&(i[t]=e[t]),e[t]=n}),e},qq.indexOf=function(e,t,i){if(e.indexOf)return e.indexOf(t,i);i=i||0;var n=e.length;for(0>i&&(i+=n);n>i;i+=1)if(e.hasOwnProperty(i)&&e[i]===t)return i;return-1},qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),i="x"==e?t:8|3&t;return i.toString(16)})},qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")},qq.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")},qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")},qq.ie11=function(){return-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11")},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.opera=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Opera")},qq.firefox=function(){return!qq.ie11()&&-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},qq.ios7=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")},qq.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var i=e.firstChild;return e.removeChild(i),i}}(),qq.each=function(e,t){var i,n;if(e)if(window.Storage&&e.constructor===window.Storage)for(i=0;e.length>i&&(n=t(e.key(i),e.getItem(e.key(i))),n!==!1);i++);else if(qq.isArray(e)||qq.isItemList(e)||qq.isNodeList(e))for(i=0;e.length>i&&(n=t(i,e[i]),n!==!1);i++);else if(qq.isString(e))for(i=0;e.length>i&&(n=t(i,e.charAt(i)),n!==!1);i++);else for(i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&(n=t(i,e[i]),n===!1))break},qq.bind=function(e,t){if(qq.isFunction(e)){var i=Array.prototype.slice.call(arguments,2);return function(){var n=qq.extend([],i);return arguments.length&&(n=n.concat(Array.prototype.slice.call(arguments))),e.apply(t,n)}}throw Error("first parameter must be a function!")},qq.obj2url=function(e,t,i){var n=[],r="&",s=function(e,i){var r=t?/\[\]$/.test(t)?t:t+"["+i+"]":i;"undefined"!==r&&"undefined"!==i&&n.push("object"==typeof e?qq.obj2url(e,r,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(r)+"="+encodeURIComponent(e()):encodeURIComponent(r)+"="+encodeURIComponent(e))};return!i&&t?(r=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",n.push(t),n.push(qq.obj2url(e))):"[object Array]"===Object.prototype.toString.call(e)&&e!==void 0?qq.each(e,function(e,t){s(t,e)}):e!==void 0&&null!==e&&"object"==typeof e?qq.each(e,function(e,t){s(t,e)}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(e)),t?n.join(r):n.join(r).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(e,t,i){return t||(t=new FormData),qq.each(e,function(e,n){e=i?i+"["+e+"]":e,qq.isObject(n)?qq.obj2FormData(n,t,e):qq.isFunction(n)?t.append(e,n()):t.append(e,n)}),t},qq.obj2Inputs=function(e,t){var i;return t||(t=document.createElement("form")),qq.obj2FormData(e,{append:function(e,n){i=document.createElement("input"),i.setAttribute("name",e),i.setAttribute("value",n),t.appendChild(i)}}),t},qq.setCookie=function(e,t,i){var n=new Date,r="";i&&(n.setTime(n.getTime()+1e3*60*60*24*i),r="; expires="+n.toGMTString()),document.cookie=e+"="+t+r+"; path=/"},qq.getCookie=function(e){var t,i=e+"=",n=document.cookie.split(";");return qq.each(n,function(e,n){for(var r=n;" "==r.charAt(0);)r=r.substring(1,r.length);return 0===r.indexOf(i)?(t=r.substring(i.length,r.length),!1):void 0}),t},qq.getCookieNames=function(e){var t=document.cookie.split(";"),i=[];return qq.each(t,function(t,n){n=qq.trimStr(n);var r=n.indexOf("=");n.match(e)&&i.push(n.substr(0,r))}),i},qq.deleteCookie=function(e){qq.setCookie(e,"",-1)},qq.areCookiesEnabled=function(){var e=1e5*Math.random(),t="qqCookieTest:"+e;return qq.setCookie(t,1),qq.getCookie(t)?(qq.deleteCookie(t),!0):!1},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.getExtension=function(e){var t=e.lastIndexOf(".")+1;return t>0?e.substr(t,e.length-t):void 0},qq.getFilename=function(e){return qq.isInput(e)?e.value.replace(/.*(\/|\\)/,""):qq.isFile(e)&&null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name},qq.DisposeSupport=function(){var e=[];return{dispose:function(){var t;do t=e.shift(),t&&t();while(t)},attach:function(){var e=arguments;this.addDisposer(qq(e[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){e.push(t)}}}})(),function(){"use strict";qq.Error=function(e){this.message=e},qq.Error.prototype=Error()}(),qq.version="4.2.1",qq.supportedFeatures=function(){"use strict";function e(){var e,t=!0;try{e=document.createElement("input"),e.type="file",qq(e).hide(),e.disabled&&(t=!1)}catch(i){t=!1}return t}function t(){return(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/)}function i(){return(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/)}function n(){if(window.XMLHttpRequest){var e=qq.createXhrInstance();return void 0!==e.withCredentials}return!1}function r(){return void 0!==window.XDomainRequest}function s(){return n()?!0:r()}function o(){return void 0!==document.createElement("input").webkitdirectory}var a,l,u,h,c,p,d,f,m,g,y,v;return a=e(),l=a&&qq.isXhrUploadSupported(),u=l&&t(),h=l&&qq.isFileChunkingSupported(),c=l&&h&&qq.areCookiesEnabled(),p=l&&i(),d=a&&(void 0!==window.postMessage||l),m=n(),f=r(),g=s(),y=o(),v=l&&void 0!==window.FileReader,{uploading:a,ajaxUploading:l,fileDrop:l,folderDrop:u,chunking:h,resume:c,uploadCustomHeaders:l,uploadNonMultipart:l,itemSizeValidation:l,uploadViaPaste:p,progressBar:l,uploadCors:d,deleteFileCorsXhr:m,deleteFileCorsXdr:f,deleteFileCors:g,canDetermineSize:l,folderSelection:y,imagePreviews:v,imageValidation:v,pause:h}}(),qq.Promise=function(){"use strict";var e,t,i=[],n=[],r=[],s=0;qq.extend(this,{then:function(r,o){return 0===s?(r&&i.push(r),o&&n.push(o)):-1===s?o&&o.apply(null,t):r&&r.apply(null,e),this},done:function(i){return 0===s?r.push(i):i.apply(null,void 0===t?e:t),this},success:function(){return s=1,e=arguments,i.length&&qq.each(i,function(t,i){i.apply(null,e)}),r.length&&qq.each(r,function(t,i){i.apply(null,e)}),this},failure:function(){return s=-1,t=arguments,n.length&&qq.each(n,function(e,i){i.apply(null,t)}),r.length&&qq.each(r,function(e,i){i.apply(null,t)}),this}})},qq.UploadButton=function(e){"use strict";function t(){var e=document.createElement("input");return e.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,n),s.multiple&&e.setAttribute("multiple",""),s.folders&&qq.supportedFeatures.folderSelection&&e.setAttribute("webkitdirectory",""),s.acceptFiles&&e.setAttribute("accept",s.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",s.name),qq(e).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),s.element.appendChild(e),r.attach(e,"change",function(){s.onChange(e)}),r.attach(e,"mouseover",function(){qq(s.element).addClass(s.hoverClass)}),r.attach(e,"mouseout",function(){qq(s.element).removeClass(s.hoverClass)}),r.attach(e,"focus",function(){qq(s.element).addClass(s.focusClass)}),r.attach(e,"blur",function(){qq(s.element).removeClass(s.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}var i,n,r=new qq.DisposeSupport,s={element:null,multiple:!1,acceptFiles:null,folders:!1,name:"qqfile",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(s,e),n=qq.getUniqueId(),qq(s.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),i=t(),qq.extend(this,{getInput:function(){return i},getButtonId:function(){return n},setMultiple:function(e){e!==s.multiple&&(e?i.setAttribute("multiple",""):i.removeAttribute("multiple"))},setAcceptFiles:function(e){e!==s.acceptFiles&&i.setAttribute("accept",e)},reset:function(){i.parentNode&&qq(i).remove(),qq(s.element).removeClass(s.focusClass),i=t()}})},qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id",qq.UploadData=function(e){"use strict";function t(e){if(qq.isArray(e)){var t=[];return qq.each(e,function(e,i){t.push(r[i])}),t}return r[e]}function i(e){if(qq.isArray(e)){var t=[];return qq.each(e,function(e,i){t.push(r[s[i]])}),t}return r[s[e]]}function n(e){var t=[],i=[].concat(e);return qq.each(i,function(e,i){var n=o[i];void 0!==n&&qq.each(n,function(e,i){t.push(r[i])})}),t}var r=[],s={},o={};qq.extend(this,{addFile:function(t,i,n,a){a=a||qq.status.SUBMITTING;var l=r.push({name:i,originalName:i,uuid:t,size:n,status:a})-1;return r[l].id=l,s[t]=l,void 0===o[a]&&(o[a]=[]),o[a].push(l),e.onStatusChange(l,null,a),l},retrieve:function(e){return qq.isObject(e)&&r.length?void 0!==e.id?t(e.id):void 0!==e.uuid?i(e.uuid):e.status?n(e.status):void 0:qq.extend([],r,!0)},reset:function(){r=[],s={},o={}},setStatus:function(t,i){var n=r[t].status,s=qq.indexOf(o[n],t);o[n].splice(s,1),r[t].status=i,void 0===o[i]&&(o[i]=[]),o[i].push(t),e.onStatusChange(t,n,i)},uuidChanged:function(e,t){var i=r[e].uuid;r[e].uuid=t,s[t]=e,delete s[i]},updateName:function(e,t){r[e].name=t}})},qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={log:function(e,t){!this._options.debug||t&&"info"!==t?t&&"info"!==t&&qq.log("[FineUploader "+qq.version+"] "+e,t):qq.log("[FineUploader "+qq.version+"] "+e)},setParams:function(e,t){null==t?this._options.request.params=e:this._paramsStore.setParams(e,t)},setDeleteFileParams:function(e,t){null==t?this._options.deleteFile.params=e:this._deleteFileParamsStore.setParams(e,t)},setEndpoint:function(e,t){null==t?this._options.request.endpoint=e:this._endpointStore.setEndpoint(e,t)},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getNetUploads:function(){return this._netUploaded},uploadStoredFiles:function(){var e;if(0===this._storedIds.length)this._itemError("noFilesError");else for(;this._storedIds.length;)e=this._storedIds.shift(),this._handler.upload(e)},clearStoredFiles:function(){this._storedIds=[]},retry:function(e){return this._manualRetry(e)},cancel:function(e){this._handler.cancel(e)},cancelAll:function(){var e=[],t=this;qq.extend(e,this._storedIds),qq.each(e,function(e,i){t.cancel(i)}),this._handler.cancelAll()},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],qq.each(this._buttons,function(e,t){t.reset()}),this._paramsStore.reset(),this._endpointStore.reset(),this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData.reset(),this._buttonIdsForFileIds=[],this._pasteHandler&&this._pasteHandler.reset(),this._options.session.refreshOnReset&&this._refreshSessionData()},addFiles:function(e,t,i){var n,r,s,o=[];if(e){for(qq.isFileList(e)||(e=[].concat(e)),n=0;e.length>n;n+=1)if(r=e[n],qq.isFileOrInput(r))if(qq.isInput(r)&&qq.supportedFeatures.ajaxUploading)for(s=0;r.files.length>s;s++)this._handleNewFile(r.files[s],o);else this._handleNewFile(r,o);else this.log(r+" is not a File or INPUT element!  Ignoring!","warn");this.log("Received "+o.length+" files or inputs."),this._prepareItemsForUpload(o,t,i)}},addBlobs:function(e,t,i){if(e){var n=[].concat(e),r=[],s=this;qq.each(n,function(e,t){var i;qq.isBlob(t)&&!qq.isFileOrInput(t)?i={blob:t,name:s._options.blobs.defaultName}:qq.isObject(t)&&t.blob&&t.name?i=t:s.log("addBlobs: entry at index "+e+" is not a Blob or a BlobData object","error"),i&&s._handleNewFile(i,r)}),this._prepareItemsForUpload(r,t,i)}else this.log("undefined or non-array parameter passed into addBlobs","error")},getUuid:function(e){return this._uploadData.retrieve({id:e}).uuid},setUuid:function(e,t){return this._uploadData.uuidChanged(e,t)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(e){return this._uploadData.retrieve({id:e}).size},getName:function(e){return this._uploadData.retrieve({id:e}).name},setName:function(e,t){this._uploadData.updateName(e,t)},getFile:function(e){return this._handler.getFile(e)},deleteFile:function(e){this._onSubmitDelete(e)},setDeleteFileEndpoint:function(e,t){null==t?this._options.deleteFile.endpoint=e:this._deleteFileEndpointStore.setEndpoint(e,t)},doesExist:function(e){return this._handler.isValid(e)},getUploads:function(e){return this._uploadData.retrieve(e)},getButton:function(e){return this._getButton(this._buttonIdsForFileIds[e])},drawThumbnail:function(e,t,i,n){if(this._imageGenerator){var r=this._thumbnailUrls[e],s={scale:i>0,maxSize:i>0?i:null};return!n&&qq.supportedFeatures.imagePreviews&&(r=this.getFile(e)),null==r?(new qq.Promise).failure(t,"File or URL not found."):this._imageGenerator.generate(r,t,s)}},pauseUpload:function(e){var t=this._uploadData.retrieve({id:e});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],t.status)>=0){if(this._handler.pause(e))return this._uploadData.setStatus(e,qq.status.PAUSED),!0;qq.log(qq.format("Unable to pause file ID {} ({}).",e,this.getName(e)),"error")}else qq.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",e,this.getName(e)),"error");return!1},continueUpload:function(e){var t=this._uploadData.retrieve({id:e});return qq.supportedFeatures.pause&&this._options.chunking.enabled?t.status===qq.status.PAUSED?(qq.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",e,this.getName(e))),this._handler.upload(e)||this._uploadData.setStatus(e,qq.status.QUEUED),!0):(qq.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",e,this.getName(e)),"error"),!1):!1},getRemainingAllowedItems:function(){var e=this._options.validation.itemLimit;return e>0?this._options.validation.itemLimit-this._netUploadedOrQueued:null}},qq.basePrivateApi={_refreshSessionData:function(){var e=this,t=this._options.session;qq.Session&&null!=this._options.session.endpoint&&(this._session||(qq.extend(t,this._options.cors),t.log=qq.bind(this.log,this),t.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(t)),setTimeout(function(){e._session.refresh().then(function(t,i){e._options.callbacks.onSessionRequestComplete(t,!0,i)},function(t,i){e._options.callbacks.onSessionRequestComplete(t,!1,i)})},0))},_addCannedFile:function(e){var t=this._uploadData.addFile(e.uuid,e.name,e.size,qq.status.UPLOAD_SUCCESSFUL);return e.deleteFileEndpoint&&this.setDeleteFileEndpoint(e.deleteFileEndpoint,t),e.deleteFileParams&&this.setDeleteFileParams(e.deleteFileParams,t),e.thumbnailUrl&&(this._thumbnailUrls[t]=e.thumbnailUrl),this._netUploaded++,this._netUploadedOrQueued++,t},_handleNewFile:function(e,t){var i,n=-1,r=qq.getUniqueId(),s=qq.getFilename(e);e.size>=0?n=e.size:e.blob&&(n=e.blob.size),i=this._uploadData.addFile(r,s,n),this._handler.add(i,e),this._netUploadedOrQueued++,t.push({id:i,file:e})},_generateExtraButtonSpecs:function(){var e=this;this._extraButtonSpecs={},qq.each(this._options.extraButtons,function(t,i){var n=i.multiple,r=qq.extend({},e._options.validation,!0),s=qq.extend({},i);void 0===n&&(n=e._options.multiple),s.validation&&qq.extend(r,i.validation,!0),qq.extend(s,{multiple:n,validation:r},!0),e._initExtraButton(s)})},_initExtraButton:function(e){var t=this._createUploadButton({element:e.element,multiple:e.multiple,accept:e.validation.acceptFiles,folders:e.folders,allowedExtensions:e.validation.allowedExtensions});this._extraButtonSpecs[t.getButtonId()]=e},_getButtonId:function(e){var t,i;if(e&&!e.blob&&!qq.isBlob(e)){if(qq.isFile(e))return e.qqButtonId;if("input"===e.tagName.toLowerCase()&&"file"===e.type.toLowerCase())return e.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(t=e.getElementsByTagName("input"),qq.each(t,function(e,t){return"file"===t.getAttribute("type")?(i=t,!1):void 0}),i)return i.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_annotateWithButtonId:function(e,t){qq.isFile(e)&&(e.qqButtonId=this._getButtonId(t))},_getButton:function(e){var t=this._extraButtonSpecs[e];return t?t.element:e===this._defaultButtonId?this._options.button:void 0},_handleCheckedCallback:function(e){var t=this,i=e.callback();return i instanceof qq.Promise?(this.log(e.name+" - waiting for "+e.name+" promise to be fulfilled for "+e.identifier),i.then(function(i){t.log(e.name+" promise success for "+e.identifier),e.onSuccess(i)},function(){e.onFailure?(t.log(e.name+" promise failure for "+e.identifier),e.onFailure()):t.log(e.name+" promise failure for "+e.identifier)})):(i!==!1?e.onSuccess(i):e.onFailure?(this.log(e.name+" - return value was 'false' for "+e.identifier+".  Invoking failure callback."),e.onFailure()):this.log(e.name+" - return value was 'false' for "+e.identifier+".  Will not proceed."),i)},_createUploadButton:function(e){function t(){return qq.supportedFeatures.ajaxUploading?qq.ios7()&&i._isAllowedExtension(r,".mov")?!1:void 0===e.multiple?i._options.multiple:e.multiple:!1}var i=this,n=e.accept||this._options.validation.acceptFiles,r=e.allowedExtensions||this._options.validation.allowedExtensions,s=new qq.UploadButton({element:e.element,folders:e.folders,name:this._options.request.inputName,multiple:t(),acceptFiles:n,onChange:function(e){i._onInputChange(e)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){s.dispose()}),i._buttons.push(s),s},_createUploadHandler:function(e,t){var i=this,n={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,demoMode:this._options.demoMode,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(i.log,i),onProgress:function(e,t,n,r){i._onProgress(e,t,n,r),i._options.callbacks.onProgress(e,t,n,r)},onComplete:function(e,t,n,r){var s=i._onComplete(e,t,n,r);s instanceof qq.Promise?s.done(function(){i._options.callbacks.onComplete(e,t,n,r)}):i._options.callbacks.onComplete(e,t,n,r)},onCancel:function(e,t){return i._handleCheckedCallback({name:"onCancel",callback:qq.bind(i._options.callbacks.onCancel,i,e,t),onSuccess:qq.bind(i._onCancel,i,e,t),identifier:e})},onUpload:function(e,t){i._onUpload(e,t),i._options.callbacks.onUpload(e,t)},onUploadChunk:function(e,t,n){i._onUploadChunk(e,n),i._options.callbacks.onUploadChunk(e,t,n)},onUploadChunkSuccess:function(){i._options.callbacks.onUploadChunkSuccess.apply(i,arguments)},onResume:function(e,t,n){return i._options.callbacks.onResume(e,t,n)},onAutoRetry:function(){return i._onAutoRetry.apply(i,arguments)},onUuidChanged:function(e,t){i.log("Server requested UUID change from '"+i.getUuid(e)+"' to '"+t+"'"),i.setUuid(e,t)},getName:qq.bind(i.getName,i),getUuid:qq.bind(i.getUuid,i),getSize:qq.bind(i.getSize,i)};return qq.each(this._options.request,function(e,t){n[e]=t}),e&&qq.each(e,function(e,t){n[e]=t}),new qq.UploadHandler(n,t)},_createDeleteHandler:function(){var e=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:qq.bind(e.log,e),onDelete:function(t){e._onDelete(t),e._options.callbacks.onDelete(t)},onDeleteComplete:function(t,i,n){e._onDeleteComplete(t,i,n),e._options.callbacks.onDeleteComplete(t,i,n)}})},_createPasteHandler:function(){var e=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(e.log,e),pasteReceived:function(t){e._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(e._options.callbacks.onPasteReceived,e,t),onSuccess:qq.bind(e._handlePasteSuccess,e,t),identifier:"pasted image"})}}})},_createUploadDataTracker:function(){var e=this;return new qq.UploadData({getName:function(t){return e.getName(t)},getUuid:function(t){return e.getUuid(t)},getSize:function(t){return e.getSize(t)},onStatusChange:function(t,i,n){e._onUploadStatusChange(t,i,n),e._options.callbacks.onStatusChange(t,i,n)}})},_onUploadStatusChange:function(e,t,i){i===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[e])},_handlePasteSuccess:function(e,t){var i=e.type.split("/")[1],n=t;null==n&&(n=this._options.paste.defaultName),n+="."+i,this.addBlobs({name:n,blob:e})},_preventLeaveInProgress:function(){var e=this;this._disposeSupport.attach(window,"beforeunload",function(t){return e.getInProgress()?(t=t||window.event,t.returnValue=e._options.messages.onLeave,e._options.messages.onLeave):void 0})},_onSubmit:function(){},_onProgress:function(){},_onComplete:function(e,t,i,n){return i.success?(i.thumbnailUrl&&(this._thumbnailUrls[e]=i.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(e,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.UPLOAD_FAILED)),this._maybeParseAndSendUploadError(e,t,i,n),i.success?!0:!1},_onCancel:function(e){this._netUploadedOrQueued--,clearTimeout(this._retryTimeouts[e]);var t=qq.indexOf(this._storedIds,e);!this._options.autoUpload&&t>=0&&this._storedIds.splice(t,1),this._uploadData.setStatus(e,qq.status.CANCELED)},_isDeletePossible:function(){return qq.DeleteFileAjaxRequester&&this._options.deleteFile.enabled?this._options.cors.expected?qq.supportedFeatures.deleteFileCorsXhr?!0:qq.supportedFeatures.deleteFileCorsXdr&&this._options.cors.allowXdr?!0:!1:!0:!1},_onSubmitDelete:function(e,t,i){var n,r=this.getUuid(e);return t&&(n=qq.bind(t,this,e,r,i)),this._isDeletePossible()?this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,e),onSuccess:n||qq.bind(this._deleteHandler.sendDelete,this,e,r,i),identifier:e}):(this.log("Delete request ignored for ID "+e+", delete feature is disabled or request not possible "+"due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onDelete:function(e){this._uploadData.setStatus(e,qq.status.DELETING)},_onDeleteComplete:function(e,t,i){var n=this.getName(e);i?(this._uploadData.setStatus(e,qq.status.DELETE_FAILED),this.log("Delete request for '"+n+"' has failed.","error"),void 0===t.withCredentials?this._options.callbacks.onError(e,n,"Delete request failed",t):this._options.callbacks.onError(e,n,"Delete request failed with response code "+t.status,t)):(this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(e),this._uploadData.setStatus(e,qq.status.DELETED),this.log("Delete request for '"+n+"' has succeeded."))},_onUpload:function(e){this._uploadData.setStatus(e,qq.status.UPLOADING)},_onUploadChunk:function(){},_onInputChange:function(e){var t;if(qq.supportedFeatures.ajaxUploading){for(t=0;e.files.length>t;t++)this._annotateWithButtonId(e.files[t],e);this.addFiles(e.files)}else e.value.length>0&&this.addFiles(e);qq.each(this._buttons,function(e,t){t.reset()})},_onBeforeAutoRetry:function(e,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")
},_onAutoRetry:function(e,t,i,n,r){var s=this;return s._preventRetries[e]=i[s._options.retry.preventRetryResponseProperty],s._shouldAutoRetry(e,t,i)?(s._maybeParseAndSendUploadError.apply(s,arguments),s._options.callbacks.onAutoRetry(e,t,s._autoRetries[e]+1),s._onBeforeAutoRetry(e,t),s._retryTimeouts[e]=setTimeout(function(){s.log("Retrying "+t+"..."),s._autoRetries[e]++,s._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),r?r(e):s._handler.retry(e)},1e3*s._options.retry.autoAttemptDelay),!0):void 0},_shouldAutoRetry:function(e){var t=this._uploadData.retrieve({id:e});return!this._preventRetries[e]&&this._options.retry.enableAuto&&t.status!==qq.status.PAUSED?(void 0===this._autoRetries[e]&&(this._autoRetries[e]=0),this._autoRetries[e]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(e){var t=this._options.validation.itemLimit;if(this._preventRetries[e])return this.log("Retries are forbidden for id "+e,"warn"),!1;if(this._handler.isValid(e)){var i=this.getName(e);return this._options.callbacks.onManualRetry(e,i)===!1?!1:t>0&&this._netUploadedOrQueued+1>t?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+i+"' (id: "+e+")..."),!0)}return this.log("'"+e+"' is not a valid file ID","error"),!1},_manualRetry:function(e,t){return this._onBeforeManualRetry(e)?(this._netUploadedOrQueued++,this._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),t?t(e):this._handler.retry(e),!0):void 0},_maybeParseAndSendUploadError:function(e,t,i,n){if(!i.success)if(n&&200!==n.status&&!i.error)this._options.callbacks.onError(e,t,"XHR returned response code "+n.status,n);else{var r=i.error?i.error:this._options.text.defaultResponseError;this._options.callbacks.onError(e,t,r,n)}},_prepareItemsForUpload:function(e,t,i){var n=this._getValidationDescriptors(e),r=this._getButtonId(e[0].file),s=this._getButton(r);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,n,s),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,n,e,t,i,s),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,e),identifier:"batch validation"})},_upload:function(e,t,i){var n=this.getName(e);t&&this.setParams(t,e),i&&this.setEndpoint(i,e),this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,e,n),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,e,n),onFailure:qq.bind(this._fileOrBlobRejected,this,e,n),identifier:e})},_onSubmitCallbackSuccess:function(e){var t;t=qq.supportedFeatures.ajaxUploading?this._handler.getFile(e).qqButtonId:this._getButtonId(this._handler.getInput(e)),t&&(this._buttonIdsForFileIds[e]=t),this._onSubmit.apply(this,arguments),this._uploadData.setStatus(e,qq.status.SUBMITTED),this._onSubmitted.apply(this,arguments),this._options.callbacks.onSubmitted.apply(this,arguments),this._options.autoUpload?this._handler.upload(e)||this._uploadData.setStatus(e,qq.status.QUEUED):this._storeForLater(e)},_onSubmitted:function(){},_storeForLater:function(e){this._storedIds.push(e)},_onValidateBatchCallbackSuccess:function(e,t,i,n,r){var s,o=this._options.validation.itemLimit,a=this._netUploadedOrQueued;0===o||o>=a?t.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,e[0],r),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,t,0,i,n),onFailure:qq.bind(this._onValidateCallbackFailure,this,t,0,i,n),identifier:"Item '"+t[0].file.name+"', size: "+t[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(t),s=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,a).replace(/\{itemLimit\}/g,o),this._batchError(s))},_onValidateBatchCallbackFailure:function(e){var t=this;qq.each(e,function(e,i){t._fileOrBlobRejected(i.id)})},_onValidateCallbackSuccess:function(e,t,i,n){var r=this,s=t+1,o=this._getValidationDescriptor(e[t].file);this._validateFileOrBlobData(e[t],o).then(function(){r._upload(e[t].id,i,n),r._maybeProcessNextItemAfterOnValidateCallback(!0,e,s,i,n)},function(){r._maybeProcessNextItemAfterOnValidateCallback(!1,e,s,i,n)})},_onValidateCallbackFailure:function(e,t,i,n){var r=t+1;this._fileOrBlobRejected(e[0].id,e[0].file.name),this._maybeProcessNextItemAfterOnValidateCallback(!1,e,r,i,n)},_maybeProcessNextItemAfterOnValidateCallback:function(e,t,i,n,r){var s=this;if(t.length>i)if(e||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var e=s._getValidationDescriptor(t[i].file);s._handleCheckedCallback({name:"onValidate",callback:qq.bind(s._options.callbacks.onValidate,s,t[i].file),onSuccess:qq.bind(s._onValidateCallbackSuccess,s,t,i,n,r),onFailure:qq.bind(s._onValidateCallbackFailure,s,t,i,n,r),identifier:"Item '"+e.name+"', size: "+e.size})},0);else if(!e)for(;t.length>i;i++)s._fileOrBlobRejected(t[i].id)},_validateFileOrBlobData:function(e,t){var i=this,n=e.file,r=t.name,s=t.size,o=this._getButtonId(n),a=this._getValidationBase(o),l=new qq.Promise;return l.then(function(){},function(){i._fileOrBlobRejected(e.id,r)}),qq.isFileOrInput(n)&&!this._isAllowedExtension(a.allowedExtensions,r)?(this._itemError("typeError",r,n),l.failure()):0===s?(this._itemError("emptyError",r,n),l.failure()):s&&a.sizeLimit&&s>a.sizeLimit?(this._itemError("sizeError",r,n),l.failure()):s&&a.minSizeLimit>s?(this._itemError("minSizeError",r,n),l.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(n)?new qq.ImageValidation(n,qq.bind(i.log,i)).validate(a.image).then(l.success,function(e){i._itemError(e+"ImageError",r,n),l.failure()}):l.success(),l)},_fileOrBlobRejected:function(e){this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.REJECTED)},_itemError:function(e,t,i){function n(e,t){o=o.replace(e,t)}var r,s,o=this._options.messages[e],a=[],l=[].concat(t),u=l[0],h=this._getButtonId(i),c=this._getValidationBase(h);return qq.each(c.allowedExtensions,function(e,t){qq.isString(t)&&a.push(t)}),r=a.join(", ").toLowerCase(),n("{file}",this._options.formatFileName(u)),n("{extensions}",r),n("{sizeLimit}",this._formatSize(c.sizeLimit)),n("{minSizeLimit}",this._formatSize(c.minSizeLimit)),s=o.match(/(\{\w+\})/g),null!==s&&qq.each(s,function(e,t){n(t,l[e])}),this._options.callbacks.onError(null,u,o,void 0),o},_batchError:function(e){this._options.callbacks.onError(null,null,e,void 0)},_isAllowedExtension:function(e,t){var i=!1;return e.length?(qq.each(e,function(e,n){if(qq.isString(n)){var r=RegExp("\\."+n+"$","i");if(null!=t.match(r))return i=!0,!1}}),i):!0},_formatSize:function(e){var t=-1;do e/=1e3,t++;while(e>999);return Math.max(e,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_wrapCallbacks:function(){var e,t;e=this,t=function(t,i,n){var r;try{return i.apply(e,n)}catch(s){r=s.message||""+s,e.log("Caught exception in '"+t+"' callback - "+r,"error")}};for(var i in this._options.callbacks)(function(){var n,r;n=i,r=e._options.callbacks[n],e._options.callbacks[n]=function(){return t(n,r,arguments)}})()},_parseFileOrBlobDataName:function(e){var t;return t=qq.isFileOrInput(e)?e.value?e.value.replace(/.*(\/|\\)/,""):null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name:e.name},_parseFileOrBlobDataSize:function(e){var t;return qq.isFileOrInput(e)?void 0===e.value&&(t=null!==e.fileSize&&void 0!==e.fileSize?e.fileSize:e.size):t=e.blob.size,t},_getValidationDescriptor:function(e){var t={},i=this._parseFileOrBlobDataName(e),n=this._parseFileOrBlobDataSize(e);return t.name=i,void 0!==n&&(t.size=n),t},_getValidationDescriptors:function(e){var t=this,i=[];return qq.each(e,function(e,n){i.push(t._getValidationDescriptor(n.file))}),i},_createParamsStore:function(e){var t={},i=this;return{setParams:function(e,i){var n={};qq.extend(n,e),t[i]=n},getParams:function(n){var r={};return null!=n&&t[n]?qq.extend(r,t[n]):qq.extend(r,i._options[e].params),r},remove:function(e){return delete t[e]},reset:function(){t={}}}},_createEndpointStore:function(e){var t={},i=this;return{setEndpoint:function(e,i){t[i]=e},getEndpoint:function(n){return null!=n&&t[n]?t[n]:i._options[e].endpoint},remove:function(e){return delete t[e]},reset:function(){t={}}}},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var e="image/*;capture=camera",t=this._options.camera.button,i=t?this._getButtonId(t):this._defaultButtonId,n=this._options;i&&i!==this._defaultButtonId&&(n=this._extraButtonSpecs[i]),n.multiple=!1,null===n.validation.acceptFiles?n.validation.acceptFiles=e:n.validation.acceptFiles+=","+e,qq.each(this._buttons,function(e,t){return t.getButtonId()===i?(t.setMultiple(n.multiple),t.setAcceptFiles(n.acceptFiles),!1):void 0})}},_getValidationBase:function(e){var t=this._extraButtonSpecs[e];return t?t.validation:this._options.validation}}}(),function(){"use strict";qq.FineUploaderBasic=function(e){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",filenameParam:"qqfilename"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0}},callbacks:{onSubmit:function(){},onSubmitted:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onResume:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){},onPasteReceived:function(){},onStatusChange:function(){},onSessionRequestComplete:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(e){return void 0!==e&&e.length>33&&(e=e.slice(0,19)+"..."+e.slice(-14)),e},text:{defaultResponseError:"Upload failure reason unknown",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0}},qq.extend(this._options,e,!0),this._buttons=[],this._extraButtonSpecs={},this._buttonIdsForFileIds=[],this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData=this._createUploadDataTracker(),this._paramsStore=this._createParamsStore("request"),this._deleteFileParamsStore=this._createParamsStore("deleteFile"),this._endpointStore=this._createEndpointStore("request"),this._deleteFileEndpointStore=this._createEndpointStore("deleteFile"),this._handler=this._createUploadHandler(),this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler(),this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button}).getButtonId()),this._generateExtraButtonSpecs(),this._handleCameraAccess(),this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():qq.log("Paste support module not found","info")),this._preventLeaveInProgress(),this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this)),this._refreshSessionData()},qq.FineUploaderBasic.prototype=qq.basePublicApi,qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}(),qq.AjaxRequester=function(e){"use strict";function t(){return qq.indexOf(["GET","POST","HEAD"],w.method)>=0}function i(){var e=!1;return qq.each(e,function(t,i){return 0>qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],i)?(e=!0,!1):void 0}),e}function n(e){return w.cors.expected&&void 0===e.withCredentials}function r(){var e;return(window.XMLHttpRequest||window.ActiveXObject)&&(e=qq.createXhrInstance(),void 0===e.withCredentials&&(e=new XDomainRequest)),e}function s(e,t){var i=_[e].xhr;return i||t||(i=w.cors.expected?r():qq.createXhrInstance(),_[e].xhr=i),i}function o(e){var t,i=qq.indexOf(b,e),n=w.maxConnections;delete _[e],b.splice(i,1),b.length>=n&&n>i&&(t=b[n-1],u(t))}function a(e,t){var i=s(e),r=w.method,a=t===!0;o(e),a?y(r+" request for "+e+" has failed","error"):n(i)||m(i.status)||(a=!0,y(r+" request for "+e+" has failed - response code "+i.status,"error")),w.onComplete(e,i,a)}function l(e){var t,i=_[e].additionalParams,n=w.mandatedParams;return w.paramsStore.getParams&&(t=w.paramsStore.getParams(e)),i&&qq.each(i,function(e,i){t=t||{},t[e]=i}),n&&qq.each(n,function(e,i){t=t||{},t[e]=i}),t}function u(e){var t,i=s(e),r=w.method,o=l(e),a=_[e].payload;w.onSend(e),t=h(e,o),n(i)?(i.onload=p(e),i.onerror=d(e)):i.onreadystatechange=c(e),i.open(r,t,!0),w.cors.expected&&w.cors.sendCredentials&&!n(i)&&(i.withCredentials=!0),f(e),y("Sending "+r+" request for "+e),a?i.send(a):v||!o?i.send():o&&w.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?i.send(qq.obj2url(o,"")):o&&w.contentType.toLowerCase().indexOf("application/json")>=0?i.send(JSON.stringify(o)):i.send(o)}function h(e,t){var i=w.endpointStore.getEndpoint(e),n=_[e].addToPath;return void 0!=n&&(i+="/"+n),v&&t?qq.obj2url(t,i):i}function c(e){return function(){4===s(e).readyState&&a(e)}}function p(e){return function(){a(e)}}function d(e){return function(){a(e,!0)}}function f(e){var r=s(e),o=w.customHeaders,a=_[e].additionalHeaders||{},l=w.method,u={};n(r)||(w.allowXRequestedWithAndCacheControl&&(w.cors.expected&&t()&&!i(o)||(r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Cache-Control","no-cache"))),!w.contentType||"POST"!==l&&"PUT"!==l||r.setRequestHeader("Content-Type",w.contentType),qq.extend(u,o),qq.extend(u,a),qq.each(u,function(e,t){r.setRequestHeader(e,t)}))}function m(e){return qq.indexOf(w.successfulResponseCodes[w.method],e)>=0}function g(e,t,i,n,r){_[e]={addToPath:t,additionalParams:i,additionalHeaders:n,payload:r};var s=b.push(e);w.maxConnections>=s&&u(e)}var y,v,b=[],_=[],w={validMethods:["POST"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],POST:[200,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){}};if(qq.extend(w,e),y=w.log,0>qq.indexOf(w.validMethods,w.method))throw Error("'"+w.method+"' is not a supported method for this type of request!");v="GET"===w.method||"DELETE"===w.method,qq.extend(this,{initTransport:function(e){var t,i,n,r;return{withPath:function(e){return t=e,this},withParams:function(e){return i=e,this},withHeaders:function(e){return n=e,this},withPayload:function(e){return r=e,this},send:function(){g(e,t,i,n,r)}}}})},qq.UploadHandler=function(e,t){"use strict";function i(e){var t,i=qq.indexOf(l,e),n=s.maxConnections;i>=0&&(l.splice(i,1),l.length>=n&&n>i&&(t=l[n-1],a.upload(t)))}function n(e){o("Cancelling "+e),s.paramsStore.remove(e),i(e)}function r(){var e=t?qq[t]:qq,n=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";a=new e["UploadHandler"+n](s,{onUploadComplete:i,onUuidChanged:s.onUuidChanged,getName:s.getName,getUuid:s.getUuid,getSize:s.getSize,log:o})}var s,o,a,l=[];s={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},filenameParam:"qqfilename",cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize",chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onUploadChunkSuccess:function(){},onAutoRetry:function(){},onResume:function(){},onUuidChanged:function(){},getName:function(){}},qq.extend(s,e),o=s.log,qq.extend(this,{add:function(){return a.add.apply(this,arguments)},upload:function(e){var t=l.push(e);return s.maxConnections>=t?(a.upload(e),!0):!1},retry:function(e){var t=qq.indexOf(l,e);return t>=0?a.upload(e,!0):this.upload(e)},cancel:function(e){var t=a.cancel(e);t instanceof qq.Promise?t.then(function(){n(e)}):t!==!1&&n(e)},cancelAll:function(){var e=this,t=[];qq.extend(t,l),qq.each(t,function(t,i){e.cancel(i)}),l=[]},getFile:function(e){return a.getFile?a.getFile(e):void 0},getInput:function(e){return a.getInput?a.getInput(e):void 0},reset:function(){o("Resetting upload handler"),this.cancelAll(),l=[],a.reset()},expunge:function(e){return this.isValid(e)?a.expunge(e):void 0},isValid:function(e){return a.isValid(e)},getResumableFilesData:function(){return a.getResumableFilesData?a.getResumableFilesData():[]},getThirdPartyFileId:function(e){return a.getThirdPartyFileId&&this.isValid(e)?a.getThirdPartyFileId(e):void 0},pause:function(e){return a.pause&&this.isValid(e)&&a.pause(e)?(i(e),!0):void 0}}),r()},qq.UploadHandlerFormApi=function(e,t,i){"use strict";function n(t){delete u[t],delete p[t],c&&(clearTimeout(h[t]),delete h[t],b.stopReceivingMessages(t));var i=document.getElementById(e.getIframeName(t));i&&(i.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(i).remove())}function r(t,i){var n=t.id,r=o(n),s=y(r);l[s]=i,u[r]=qq(t).attach("load",function(){p[r].input&&(v("Received iframe load event for CORS upload request (iframe name "+n+")"),h[n]=setTimeout(function(){var e="No valid message received from loaded iframe for iframe name "+n;v(e,"error"),i({error:e})},1e3))}),b.receiveMessage(n,function(t){v("Received the following window message: '"+t+"'");var i,r=o(n),s=e.parseJsonResponse(r,t),a=s.uuid;a&&l[a]?(v("Handling response for iframe name "+n),clearTimeout(h[n]),delete h[n],e.detachLoadEvent(n),i=l[a],delete l[a],b.stopReceivingMessages(n),i(s)):a||v("'"+t+"' does not contain a UUID - ignoring.")})}function s(e){var t=qq.toElement("<iframe src='javascript:false;' name='"+e+"' />");return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t}function o(e){return e.split("_")[0]}var a=qq.getUniqueId(),l={},u={},h={},c=t.isCors,p=t.fileState,d=t.inputName,f=i.onCancel,m=i.onUuidChanged,g=i.getName,y=i.getUuid,v=i.log,b=new qq.WindowReceiveMessage({log:v});qq.extend(e,{getIframeName:function(e){return e+"_"+a},createIframe:function(t){var i=e.getIframeName(t);return s(i)},parseJsonResponse:function(e,t){var i;try{i=qq.parseJson(t),void 0!==i.newUuid&&m(e,i.newUuid)}catch(n){v("Error when attempting to parse iframe upload response ("+n.message+")","error"),i={}}return i},initFormForUpload:function(e){var t=e.method,i=e.endpoint,n=e.params,r=e.paramsInBody,s=e.targetName,o=qq.toElement("<form method='"+t+"' enctype='multipart/form-data'></form>"),a=i;return r?qq.obj2Inputs(n,o):a=qq.obj2url(n,i),o.setAttribute("action",a),o.setAttribute("target",s),o.style.display="none",document.body.appendChild(o),o},attachLoadEvent:function(e,t){var i;c?r(e,t):u[e.id]=qq(e).attach("load",function(){if(v("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return}catch(n){v("Error when attempting to access iframe during handling of upload response ("+n.message+")","error"),i={success:!1}}t(i)}})},detachLoadEvent:function(e){void 0!==u[e]&&(u[e](),delete u[e])}}),qq.extend(this,{add:function(e,t){p[e]={input:t},t.setAttribute("name",d),t.parentNode&&qq(t).remove()},getInput:function(e){return p[e].input},isValid:function(e){return void 0!==p[e]&&void 0!==p[e].input},reset:function(){p.length=0},expunge:function(e){return n(e)},cancel:function(e){var t=f(e,g(e));return t instanceof qq.Promise?t.then(function(){this.expunge(e)}):t!==!1?(this.expunge(e),!0):!1},upload:function(){}})},qq.UploadHandlerXhrApi=function(e,t,i){"use strict";function n(e,t,i){return e.slice?e.slice(t,i):e.mozSlice?e.mozSlice(t,i):e.webkitSlice?e.webkitSlice(t,i):void 0}var r=this,s=t.fileState,o=t.chunking,a=i.onUpload,l=i.onCancel,u=(i.onUuidChanged,i.getName),h=i.getSize,c=i.log;qq.extend(e,{createXhr:function(e){var t=qq.createXhrInstance();return s[e].xhr=t,t},getTotalChunks:function(e){if(o){var t=h(e),i=o.partSize;return Math.ceil(t/i)}},getChunkData:function(t,i){var s=o.partSize,a=h(t),l=r.getFile(t),u=s*i,c=u+s>=a?a:u+s,p=e.getTotalChunks(t);return{part:i,start:u,end:c,count:p,blob:n(l,u,c),size:c-u}},getChunkDataForCallback:function(e){return{partIndex:e.part,startByte:e.start+1,endByte:e.end,totalParts:e.count}}}),qq.extend(this,{add:function(e,t){if(qq.isFile(t))s[e]={file:t};else{if(!qq.isBlob(t.blob))throw Error("Passed obj is not a File or BlobData (in qq.UploadHandlerXhr)");s[e]={blobData:t}}},getFile:function(e){return s[e]?s[e].file||s[e].blobData.blob:void 0},isValid:function(e){return void 0!==s[e]},reset:function(){s.length=0},expunge:function(e){var t=s[e].xhr;t&&(t.onreadystatechange=null,t.abort()),delete s[e]},upload:function(e,t){return s[e]&&delete s[e].paused,a(e,t)},cancel:function(e){var t=l(e,u(e));return t instanceof qq.Promise?t.then(function(){this.expunge(e)}):t!==!1?(this.expunge(e),!0):!1},pause:function(e){var t=s[e].xhr;return t?(c(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",e,u(e))),s[e].paused=!0,t.abort(),!0):void 0}})},qq.WindowReceiveMessage=function(e){"use strict";var t={log:function(){}},i={};qq.extend(t,e),qq.extend(this,{receiveMessage:function(e,t){var n=function(e){t(e.data)};window.postMessage?i[e]=qq(window).attach("message",n):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(e){if(window.postMessage){var t=i[e];t&&t()}}})},function(){"use strict";qq.uiPublicApi={clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments),this._templating.clearFiles()},addExtraDropzone:function(e){this._dnd&&this._dnd.setupExtraDropzone(e)},removeExtraDropzone:function(e){return this._dnd?this._dnd.removeDropzone(e):void 0},getItemByFileId:function(e){return this._templating.getFileContainer(e)},reset:function(){this._parent.prototype.reset.apply(this,arguments),this._templating.reset(),!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId()),this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop()),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0,this._setupClickAndEditEventHandlers()},pauseUpload:function(e){var t=this._parent.prototype.pauseUpload.apply(this,arguments);return t&&this._templating.uploadPaused(e),t},continueUpload:function(e){var t=this._parent.prototype.continueUpload.apply(this,arguments);return t&&this._templating.uploadContinued(e),t},getId:function(e){return this._templating.getFileId(e)},getDropTarget:function(e){var t=this.getFile(e);return t.qqDropTarget}},qq.uiPrivateApi={_getButton:function(e){var t=this._parent.prototype._getButton.apply(this,arguments);return t||e===this._defaultButtonId&&(t=this._templating.getButton()),t},_removeFileItem:function(e){this._templating.removeFile(e)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent(),this._focusinEventSupported=!qq.firefox(),this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var e=this,t=this._options.dragAndDrop.extraDropzones,i=this._templating,n=i.getDropZone();return n&&t.push(n),new qq.DragAndDrop({dropZoneElements:t,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){i.showDropProcessing()},processingDroppedFilesComplete:function(t,n){i.hideDropProcessing(),qq.each(t,function(e,t){t.qqDropTarget=n}),t&&e.addFiles(t,null,null)},dropError:function(t,i){e._itemError(t,i)},dropLog:function(t,i){e.log(t,i)}}})},_bindFileButtonsClickEvent:function(){var e=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(t,i){e.log(t,i)},onDeleteFile:function(t){e.deleteFile(t)},onCancel:function(t){e.cancel(t)},onRetry:function(t){qq(e._templating.getFileContainer(t)).removeClass(e._classes.retryable),e.retry(t)},onPause:function(t){e.pauseUpload(t)},onContinue:function(t){e.continueUpload(t)},onGetName:function(t){return e.getName(t)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var e=this,t=this._templating;return{templating:t,log:function(t,i){e.log(t,i)},onGetUploadStatus:function(t){return e.getUploads({id:t}).status},onGetName:function(t){return e.getName(t)},onSetName:function(i,n){var r=e._options.formatFileName(n);t.updateFilename(i,r),e.setName(i,n)},onEditingStatusChange:function(e,i){var n=qq(t.getEditInput(e)),r=qq(t.getFileContainer(e));i?(n.addClass("qq-editing"),t.hideFilename(e),t.hideEditIcon(e)):(n.removeClass("qq-editing"),t.showFilename(e),t.showEditIcon(e)),r.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(e,t,i){this._parent.prototype._onUploadStatusChange.apply(this,arguments),this._isEditFilenameEnabled()&&this._templating.getFileContainer(e)&&i!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(e),this._templating.hideEditIcon(e))},_bindFilenameInputFocusInEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(e)},_bindFilenameInputFocusEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(e)},_bindFilenameClickEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(e)},_storeForLater:function(e){this._parent.prototype._storeForLater.apply(this,arguments),this._templating.hideSpinner(e)},_onSubmit:function(e,t){this._parent.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onSubmitted:function(e){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(e),this._templating.showEditIcon(e),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(e)))},_onProgress:function(e,t,i,n){this._parent.prototype._onProgress.apply(this,arguments),this._templating.updateProgress(e,i,n),i===n?(this._templating.hideCancel(e),this._templating.hidePause(e),this._templating.setStatusText(e,this._options.text.waitingForResponse),this._displayFileSize(e)):this._displayFileSize(e,i,n)},_onComplete:function(e,t,i){function n(t){s.setStatusText(e),qq(s.getFileContainer(e)).removeClass(o._classes.retrying),s.hideProgress(e),(!o._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&s.hideCancel(e),s.hideSpinner(e),t.success?o._markFileAsSuccessful(e):(qq(s.getFileContainer(e)).addClass(o._classes.fail),o._templating.isRetryPossible()&&!o._preventRetries[e]&&qq(s.getFileContainer(e)).addClass(o._classes.retryable),o._controlFailureTextDisplay(e,t))}var r=this._parent.prototype._onComplete.apply(this,arguments),s=this._templating,o=this;return r instanceof qq.Promise?r.done(function(e){n(e)}):n(i),r},_markFileAsSuccessful:function(e){var t=this._templating;this._isDeletePossible()&&t.showDeleteButton(e),qq(t.getFileContainer(e)).addClass(this._classes.success),this._maybeUpdateThumbnail(e)},_onUpload:function(e){var t=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(e),t},_onUploadChunk:function(e,t){this._parent.prototype._onUploadChunk.apply(this,arguments),t.partIndex>0&&this._templating.allowPause(e)},_onCancel:function(e){this._parent.prototype._onCancel.apply(this,arguments),this._removeFileItem(e)},_onBeforeAutoRetry:function(e){var t,i,n;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments),this._showCancelLink(e),this._options.retry.showAutoRetryNote&&(t=this._autoRetries[e]+1,i=this._options.retry.maxAutoAttempts,n=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,t),n=n.replace(/\{maxAuto\}/g,i),this._templating.setStatusText(e,n),qq(this._templating.getFileContainer(e)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(e){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(e),qq(this._templating.getFileContainer(e)).removeClass(this._classes.fail),this._templating.setStatusText(e),this._templating.showSpinner(e),this._showCancelLink(e),!0):(qq(this._templating.getFileContainer(e)).addClass(this._classes.retryable),!1)},_onSubmitDelete:function(e){var t=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,e,t)},_onSubmitDeleteSuccess:function(){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(e,t,i){this._parent.prototype._onDeleteComplete.apply(this,arguments),this._templating.hideSpinner(e),i?(this._templating.setStatusText(e,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(e)):this._removeFileItem(e)},_sendDeleteRequest:function(e){this._templating.hideDeleteButton(e),this._templating.showSpinner(e),this._templating.setStatusText(e,this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(e){var t,i=this.getName(e),n=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,i),r=(this.getUuid(e),arguments),s=this;t=this._options.showConfirm(n),t instanceof qq.Promise?t.then(function(){s._sendDeleteRequest.apply(s,r)}):t!==!1&&s._sendDeleteRequest.apply(s,r)},_addToList:function(e,t,i){var n,r=0;this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(r=this._filesInBatchAddedToUi-1),n={index:r}),i||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(this._handler.cancelAll(),this._clearList())),this._templating.addFile(e,this._options.formatFileName(t),n),i?this._thumbnailUrls[e]&&this._templating.updateThumbnail(e,this._thumbnailUrls[e],!0):this._templating.generatePreview(e,this.getFile(e)),this._filesInBatchAddedToUi+=1,this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading&&this._displayFileSize(e)
},_clearList:function(){this._templating.clearFiles(),this.clearStoredFiles()},_displayFileSize:function(e,t,i){var n=this.getSize(e),r=this._formatSize(n);n>=0&&(void 0!==t&&void 0!==i&&(r=this._formatProgress(t,i)),this._templating.updateSize(e,r))},_formatProgress:function(e,t){function i(e,t){n=n.replace(e,t)}var n=this._options.text.formatProgress;return i("{percent}",Math.round(100*(e/t))),i("{total_size}",this._formatSize(t)),n},_controlFailureTextDisplay:function(e,t){var i,n,r,s,o;i=this._options.failedUploadTextDisplay.mode,n=this._options.failedUploadTextDisplay.maxChars,r=this._options.failedUploadTextDisplay.responseProperty,"custom"===i?(s=t[r],s?s.length>n&&(o=s.substring(0,n)+"..."):(s=this._options.text.failUpload,this.log("'"+r+"' is not a valid property on the server response.","warn")),this._templating.setStatusText(e,o||s),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(e,s)):"default"===i?this._templating.setStatusText(e,this._options.text.failUpload):"none"!==i&&this.log("failedUploadTextDisplay.mode value of '"+i+"' is not valid","warn")},_showTooltip:function(e,t){this._templating.getFileContainer(e).title=t},_showCancelLink:function(e){(!this._options.disableCancelForFormUploads||qq.supportedFeatures.ajaxUploading)&&this._templating.showCancel(e)},_itemError:function(){var e=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(e)},_batchError:function(e){this._parent.prototype._batchError.apply(this,arguments),this._options.showMessage(e)},_setupPastePrompt:function(){var e=this;this._options.callbacks.onPasteReceived=function(){var t=e._options.paste.namePromptMessage,i=e._options.paste.defaultName;return e._options.showPrompt(t,i)}},_fileOrBlobRejected:function(){this._totalFilesInBatch-=1,this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(e){this._totalFilesInBatch=e.length,this._filesInBatchAddedToUi=0,this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(e){var t=this._thumbnailUrls[e];this._templating.updateThumbnail(e,t)},_addCannedFile:function(){var e=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(e,this.getName(e),!0),this._templating.hideSpinner(e),this._templating.hideCancel(e),this._markFileAsSuccessful(e),e}}}(),qq.FineUploader=function(e,t){"use strict";this._parent=t?qq[t].FineUploaderBasic:qq.FineUploaderBasic,this._parent.apply(this,arguments),qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[]},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null}},showMessage:function(e){setTimeout(function(){window.alert(e)},0)},showConfirm:function(e){return window.confirm(e)},showPrompt:function(e,t){return window.prompt(e,t)}},!0),qq.extend(this._options,e,!0),this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text}),!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._templating.renderFailure(this._options.messages.unsupportedBrowser):(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton()}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():qq.log("Paste support module not found.","info")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0)},qq.extend(qq.FineUploader.prototype,qq.basePublicApi),qq.extend(qq.FineUploader.prototype,qq.basePrivateApi),qq.extend(qq.FineUploader.prototype,qq.uiPublicApi),qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi),qq.Templating=function(e){"use strict";function t(){var e,t,i,n,r,s,o,a,l;if(O("Parsing template"),null==z.templateIdOrEl)throw Error("You MUST specify either a template element or ID!");if(qq.isString(z.templateIdOrEl)){if(e=document.getElementById(z.templateIdOrEl),null===e)throw Error(qq.format("Cannot find template script at ID '{}'!",z.templateIdOrEl));t=e.innerHTML}else{if(void 0===z.templateIdOrEl.innerHTML)throw Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");t=z.templateIdOrEl.innerHTML}if(t=qq.trimStr(t),n=document.createElement("div"),n.appendChild(qq.toElement(t)),z.button&&(s=qq(n).getByClass(B.button)[0],s&&qq(s).remove()),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(l=qq(n).getByClass(B.dropProcessing)[0],l&&qq(l).remove()),o=qq(n).getByClass(B.drop)[0],o&&!qq.DragAndDrop&&(qq.log("DnD module unavailable.","info"),qq(o).remove()),o&&!qq.supportedFeatures.fileDrop&&qq(o).hasAttribute(D)&&qq(o).css({display:"none"}),a=qq(n).getByClass(B.thumbnail)[0],P?a&&(R=parseInt(a.getAttribute(I)),R=R>0?R:null,q=qq(a).hasAttribute(A)):a&&qq(a).remove(),P=P&&a,C=qq(n).getByClass(B.editFilenameInput).length>0,E=qq(n).getByClass(B.retry).length>0,i=qq(n).getByClass(B.list)[0],null==i)throw Error("Could not find the file list container in the template!");return r=i.innerHTML,i.innerHTML="",O("Template parsing complete"),{template:qq.trimStr(n.innerHTML),fileTemplate:qq.trimStr(r)}}function i(e){return qq(T).getByClass(F+e)[0]}function n(e,t){return qq(e).getByClass(t)[0]}function r(e,t){var i=T,n=i.firstChild;t>0&&(n=qq(i).children()[t].nextSibling),i.insertBefore(e,n)}function s(e){return n(i(e),B.cancel)}function o(e){return n(i(e),B.pause)}function a(e){return n(i(e),B.continueButton)}function l(e){return n(i(e),B.progressBarContainer)||n(i(e),B.progressBar)}function u(e){return n(i(e),B.spinner)}function h(e){return n(i(e),B.editNameIcon)}function c(e){return n(i(e),B.size)}function p(e){return n(i(e),B.deleteButton)}function d(e){return n(i(e),B.retry)}function f(e){return n(i(e),B.file)}function m(){return n(k,B.dropProcessing)}function g(e){return P&&n(i(e),B.thumbnail)}function y(e){e&&qq(e).addClass(z.classes.hide)}function v(e){e&&qq(e).removeClass(z.classes.hide)}function b(e,t){var i=l(e);i&&!qq(i).hasClass(B.progressBar)&&(i=qq(i).getByClass(B.progressBar)[0]),i&&qq(i).css({width:t+"%"})}function _(){var e=z.placeholders.thumbnailNotAvailable,t=z.placeholders.waitingForThumbnail,i={maxSize:R,scale:q};P&&(e?z.imageGenerator.generate(e,new Image,i).then(function(e){U.success(e)},function(){U.failure(),O("Problem loading 'not available' placeholder image at "+e,"error")}):U.failure(),t?z.imageGenerator.generate(t,new Image,i).then(function(e){H.success(e)},function(){H.failure(),O("Problem loading 'waiting for thumbnail' placeholder image at "+t,"error")}):H.failure())}function w(e){H.then(function(t){L(t,e),null==e.getAttribute("src")&&(e.src=t.src,v(e))},function(){y(e)})}function x(e,t){var i=j[e]||(new qq.Promise).failure();U.then(function(n){i.then(function(){delete j[e]},function(){L(n,t),t.src=n.src,v(t),delete j[e]})})}function L(e,t){var i=e.style.maxWidth,n=e.style.maxHeight;n&&i&&!t.style.maxWidth&&!t.style.maxHeight&&qq(t).css({maxWidth:i,maxHeight:n})}var O,C,E,S,k,T,P,q,N="qq-file-id",F="qq-file-id-",I="qq-max-size",A="qq-server-scale",D="qq-hide-dropzone",M=!1,R=-1,z={log:null,templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},B={button:"qq-upload-button-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},j={},U=new qq.Promise,H=new qq.Promise;qq.extend(z,e),O=z.log,k=z.containerEl,P=void 0!==z.imageGenerator,S=t(),_(),qq.extend(this,{render:function(){O("Rendering template in DOM."),k.innerHTML=S.template,y(m()),T=z.fileContainerEl||n(k,B.list),O("Template rendering complete")},renderFailure:function(e){var t=qq.toElement(e);k.innerHTML="",k.appendChild(t)},reset:function(){this.render()},clearFiles:function(){T.innerHTML=""},disableCancel:function(){M=!0},addFile:function(e,t,i){var s=qq.toElement(S.fileTemplate),u=n(s,B.file);qq(s).addClass(F+e),u&&qq(u).setText(t),s.setAttribute(N,e),i?r(s,i.index):T.appendChild(s),y(l(e)),y(c(e)),y(p(e)),y(d(e)),y(o(e)),y(a(e)),M&&this.hideCancel(e)},removeFile:function(e){qq(i(e)).remove()},getFileId:function(e){var t=e;if(t){for(;null==t.getAttribute(N);)t=t.parentNode;return parseInt(t.getAttribute(N))}},getFileList:function(){return T},markFilenameEditable:function(e){var t=f(e);t&&qq(t).addClass(z.classes.editable)},updateFilename:function(e,t){var i=f(e);i&&qq(i).setText(t)},hideFilename:function(e){y(f(e))},showFilename:function(e){v(f(e))},isFileName:function(e){return qq(e).hasClass(B.file)},getButton:function(){return z.button||n(k,B.button)},hideDropProcessing:function(){y(m())},showDropProcessing:function(){v(m())},getDropZone:function(){return n(k,B.drop)},isEditFilenamePossible:function(){return C},isRetryPossible:function(){return E},getFileContainer:function(e){return i(e)},showEditIcon:function(e){var t=h(e);t&&qq(t).addClass(z.classes.editable)},hideEditIcon:function(e){var t=h(e);t&&qq(t).removeClass(z.classes.editable)},isEditIcon:function(e){return qq(e).hasClass(B.editNameIcon)},getEditInput:function(e){return n(i(e),B.editFilenameInput)},isEditInput:function(e){return qq(e).hasClass(B.editFilenameInput)},updateProgress:function(e,t,i){var n,r=l(e);r&&(n=Math.round(100*(t/i)),t===i?y(r):v(r),b(e,n))},hideProgress:function(e){var t=l(e);t&&y(t)},resetProgress:function(e){b(e,0)},showCancel:function(e){if(!M){var t=s(e);t&&qq(t).removeClass(z.classes.hide)}},hideCancel:function(e){y(s(e))},isCancel:function(e){return qq(e).hasClass(B.cancel)},allowPause:function(e){v(o(e)),y(a(e))},uploadPaused:function(e){this.setStatusText(e,z.text.paused),this.allowContinueButton(e),y(u(e))},hidePause:function(e){y(o(e))},isPause:function(e){return qq(e).hasClass(B.pause)},isContinueButton:function(e){return qq(e).hasClass(B.continueButton)},allowContinueButton:function(e){v(a(e)),y(o(e))},uploadContinued:function(e){this.setStatusText(e,""),this.allowPause(e),v(u(e))},showDeleteButton:function(e){v(p(e))},hideDeleteButton:function(e){y(p(e))},isDeleteButton:function(e){return qq(e).hasClass(B.deleteButton)},isRetry:function(e){return qq(e).hasClass(B.retry)},updateSize:function(e,t){var i=c(e);i&&(v(i),qq(i).setText(t))},setStatusText:function(e,t){var r=n(i(e),B.statusText);r&&(null==t?qq(r).clearText():qq(r).setText(t))},hideSpinner:function(e){y(u(e))},showSpinner:function(e){v(u(e))},generatePreview:function(e,t){var i=g(e),n={maxSize:R,scale:!0,orient:!0};if(qq.supportedFeatures.imagePreviews){if(j[e]=new qq.Promise,i)return w(i),z.imageGenerator.generate(t,i,n).then(function(){v(i),j[e].success()},function(){j[e].failure(),z.placeholders.waitUntilUpdate||x(e,i)})}else i&&w(i)},updateThumbnail:function(e,t,i){var n=g(e),r={maxSize:R,scale:q};if(n){if(t)return i&&w(n),z.imageGenerator.generate(t,n,r).then(function(){v(n)},function(){x(e,n)});x(e,n)}}})},qq.UploadHandlerForm=function(e,t){"use strict";function i(e,t){var i;try{var n=t.contentDocument||t.contentWindow.document,r=n.body.innerHTML;h("converting iframe's innerHTML to JSON"),h("innerHTML = "+r),r&&r.match(/^<pre/i)&&(r=n.body.firstChild.firstChild.nodeValue),i=c.parseJsonResponse(e,r)}catch(s){h("Error when attempting to parse form upload response ("+s.message+")","error"),i={success:!1}}return i}function n(t,i){var n=e.paramsStore.getParams(t),r=e.demoMode?"GET":"POST",s=e.endpointStore.getEndpoint(t),o=a(t);return n[e.uuidName]=l(t),n[e.filenameParam]=o,c.initFormForUpload({method:r,endpoint:s,params:n,paramsInBody:e.paramsInBody,targetName:i.name})}var r=[],s=t.onUploadComplete,o=t.onUuidChanged,a=t.getName,l=t.getUuid,u=s,h=t.log,c={};qq.extend(this,new qq.UploadHandlerFormApi(c,{fileState:r,isCors:e.cors.expected,inputName:e.inputName},{onCancel:e.onCancel,onUuidChanged:o,getName:a,getUuid:l,log:h})),qq.extend(this,{upload:function(t){var s,o=r[t].input,l=a(t),p=c.createIframe(t);if(!o)throw Error("file with passed id was not added, or already uploaded or canceled");e.onUpload(t,a(t)),s=n(t,p),s.appendChild(o),c.attachLoadEvent(p,function(n){h("iframe loaded");var r=n?n:i(t,p);c.detachLoadEvent(t),e.cors.expected||qq(p).remove(),(r.success||!e.onAutoRetry(t,l,r))&&(e.onComplete(t,l,r),u(t))}),h("Sending upload request for "+t),s.submit(),qq(s).remove()}})},qq.UploadHandlerXhr=function(e,t){"use strict";function i(){return null===e.resume.id||void 0===e.resume.id||qq.isFunction(e.resume.id)||qq.isObject(e.resume.id)?void 0:e.resume.id}function n(t,i,n){var r=I(t),s=N(t);i[e.chunking.paramNames.partIndex]=n.part,i[e.chunking.paramNames.partByteOffset]=n.start,i[e.chunking.paramNames.chunkSize]=n.size,i[e.chunking.paramNames.totalParts]=n.count,i[e.totalFileSizeName]=r,B&&(i[e.filenameParam]=s)}function r(t){t[e.resume.paramNames.resuming]=!0}function s(t,i,n,r){var s=new FormData,o=e.demoMode?"GET":"POST",a=e.endpointStore.getEndpoint(r),l=a,u=N(r),h=I(r);return t[e.uuidName]=F(r),t[e.filenameParam]=u,B&&(t[e.totalFileSizeName]=h),e.paramsInBody||(B||(t[e.inputName]=u),l=qq.obj2url(t,a)),i.open(o,l,!0),e.cors.expected&&e.cors.sendCredentials&&(i.withCredentials=!0),B?(e.paramsInBody&&qq.obj2FormData(t,s),s.append(e.inputName,n),s):n}function o(t,i){var n=e.customHeaders,r=D[t].file||D[t].blobData.blob;i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Cache-Control","no-cache"),B||(i.setRequestHeader("Content-Type","application/octet-stream"),i.setRequestHeader("X-Mime-Type",r.type)),qq.each(n,function(e,t){i.setRequestHeader(e,t)})}function a(t,i,n){var r=N(t),s=I(t);D[t].attemptingResume=!1,e.onProgress(t,r,s,s),e.onComplete(t,r,i,n),D[t]&&delete D[t].xhr,P(t)}function l(t){var i,a,l=D[t].remainingChunkIdxs[0],h=j.getChunkData(t,l),c=j.createXhr(t),p=I(t),d=N(t);void 0===D[t].loaded&&(D[t].loaded=0),z&&D[t].file&&b(t,h),c.onreadystatechange=v(t,c),c.upload.onprogress=function(i){if(i.lengthComputable){var n=i.loaded+D[t].loaded,r=u(t,l,i.total);e.onProgress(t,d,n,r)}},e.onUploadChunk(t,d,j.getChunkDataForCallback(h)),a=e.paramsStore.getParams(t),n(t,a,h),D[t].attemptingResume&&r(a),i=s(a,c,h.blob,t),o(t,c),A("Sending chunked upload request for item "+t+": bytes "+(h.start+1)+"-"+h.end+" of "+p),c.send(i)}function u(e,t,i){var n=j.getChunkData(e,t),r=n.size,s=i-r,o=I(e),a=n.count,l=D[e].initialRequestOverhead,u=s-l;return D[e].lastRequestOverhead=s,0===t?(D[e].lastChunkIdxProgress=0,D[e].initialRequestOverhead=s,D[e].estTotalRequestsSize=o+a*s):D[e].lastChunkIdxProgress!==t&&(D[e].lastChunkIdxProgress=t,D[e].estTotalRequestsSize+=u),D[e].estTotalRequestsSize}function h(e){return B?D[e].lastRequestOverhead:0}function c(t,i,n){var r=D[t].remainingChunkIdxs.shift(),s=j.getChunkData(t,r);D[t].attemptingResume=!1,D[t].loaded+=s.size+h(t),e.onUploadChunkSuccess(t,j.getChunkDataForCallback(s),i,n),D[t].remainingChunkIdxs.length>0?l(t):(z&&_(t),a(t,i,n))}function p(e,t){return 200!==e.status||!t.success||t.reset}function d(e,t){var i;try{A(qq.format("Received response status {} with body: {}",t.status,t.responseText)),i=qq.parseJson(t.responseText),void 0!==i.newUuid&&q(e,i.newUuid)}catch(n){A("Error when attempting to parse xhr response text ("+n.message+")","error"),i={}}return i}function f(e){A("Server has ordered chunking effort to be restarted on next attempt for item ID "+e,"error"),z&&(_(e),D[e].attemptingResume=!1),D[e].remainingChunkIdxs=[],delete D[e].loaded,delete D[e].estTotalRequestsSize,delete D[e].initialRequestOverhead}function m(e){D[e].attemptingResume=!1,A("Server has declared that it cannot handle resume for item ID "+e+" - starting from the first chunk","error"),f(e),U.upload(e,!0)}function g(t,i,n){var r=N(t);e.onAutoRetry(t,r,i,n)||a(t,i,n)}function y(e,t){var i,n=D[e],r=n&&n.attemptingResume,s=n&&n.paused;n&&!s&&(A("xhr - server response received for "+e),A("responseText = "+t.responseText),i=d(e,t),p(t,i)?(i.reset&&f(e),r&&i.reset?m(e):g(e,i,t)):R?c(e,i,t):a(e,i,t))}function v(e,t){return function(){4===t.readyState&&y(e,t)}}function b(t,i){var n=F(t),r=D[t].loaded,s=D[t].initialRequestOverhead,o=D[t].estTotalRequestsSize,a=x(t),l=n+M+i.part+M+r+M+s+M+o,u=e.resume.cookiesExpireIn;qq.setCookie(a,l,u)}function _(e){if(D[e].file){var t=x(e);qq.deleteCookie(t)}}function w(e){var t,i,n,r,s,o,a=qq.getCookie(x(e)),l=N(e);if(a){if(t=a.split(M),5===t.length)return i=t[0],n=parseInt(t[1],10),r=parseInt(t[2],10),s=parseInt(t[3],10),o=parseInt(t[4],10),{uuid:i,part:n,lastByteSent:r,initialRequestOverhead:s,estTotalRequestsSize:o};A("Ignoring previously stored resume/chunk cookie for "+l+" - old cookie format","warn")}}function x(t){var i,n=N(t),r=I(t),s=e.chunking.partSize;return i="qqfilechunk"+M+encodeURIComponent(n)+M+r+M+s,void 0!==T&&(i+=M+T),i}function L(e,t){var i;for(i=j.getTotalChunks(e)-1;i>=t;i-=1)D[e].remainingChunkIdxs.unshift(i);l(e)}function O(e,t,i,n){i=n.part,D[e].loaded=n.lastByteSent,D[e].estTotalRequestsSize=n.estTotalRequestsSize,D[e].initialRequestOverhead=n.initialRequestOverhead,D[e].attemptingResume=!0,A("Resuming "+t+" at partition index "+i),L(e,i)}function C(t,i,n){var r,s=N(t),o=j.getChunkData(t,i.part);r=e.onResume(t,s,j.getChunkDataForCallback(o)),r instanceof qq.Promise?(A("Waiting for onResume promise to be fulfilled for "+t),r.then(function(){O(t,s,n,i)},function(){A("onResume promise fulfilled - failure indicated.  Will not resume."),L(t,n)})):r!==!1?O(t,s,n,i):(A("onResume callback returned false.  Will not resume."),L(t,n))}function E(e,t){var i,n=0;D[e].remainingChunkIdxs&&0!==D[e].remainingChunkIdxs.length?l(e):(D[e].remainingChunkIdxs=[],z&&!t&&D[e].file?(i=w(e),i?C(e,i,n):L(e,n)):L(e,n))}function S(t){var i,n,r,a=D[t].file||D[t].blobData.blob,l=N(t);D[t].loaded=0,i=j.createXhr(t),i.upload.onprogress=function(i){i.lengthComputable&&(D[t].loaded=i.loaded,e.onProgress(t,l,i.loaded,i.total))},i.onreadystatechange=v(t,i),n=e.paramsStore.getParams(t),r=s(n,i,a,t),o(t,i),A("Sending upload request for "+t),i.send(r)}function k(t,i){var n=N(t);U.isValid(t)&&(e.onUpload(t,n),R?E(t,i):S(t))}var T,P=t.onUploadComplete,q=t.onUuidChanged,N=t.getName,F=t.getUuid,I=t.getSize,A=t.log,D=[],M="|",R=e.chunking.enabled&&qq.supportedFeatures.chunking,z=e.resume.enabled&&R&&qq.supportedFeatures.resume,B=e.forceMultipart||e.paramsInBody,j={},U=this;T=i(),qq.extend(this,new qq.UploadHandlerXhrApi(j,{fileState:D,chunking:R?e.chunking:null},{onUpload:k,onCancel:e.onCancel,onUuidChanged:q,getName:N,getSize:I,getUuid:F,log:A})),qq.override(this,function(t){return{add:function(e){var i;return t.add.apply(this,arguments),z&&(i=w(e),i&&q(e,i.uuid)),e},getResumableFilesData:function(){var t=[],i=[];return R&&z?(t=void 0===T?qq.getCookieNames(RegExp("^qqfilechunk\\"+M+".+\\"+M+"\\d+\\"+M+e.chunking.partSize+"=")):qq.getCookieNames(RegExp("^qqfilechunk\\"+M+".+\\"+M+"\\d+\\"+M+e.chunking.partSize+"\\"+M+T+"=")),qq.each(t,function(e,t){var n=t.split(M),r=qq.getCookie(t).split(M);i.push({name:decodeURIComponent(n[1]),size:n[2],uuid:r[0],partIdx:r[1]})}),i):[]},expunge:function(e){z&&_(e),t.expunge(e)}}})},qq.PasteSupport=function(e){"use strict";function t(e){return e.type&&0===e.type.indexOf("image/")}function i(){qq(r.targetElement).attach("paste",function(e){var i=e.clipboardData;i&&qq.each(i.items,function(e,i){if(t(i)){var n=i.getAsFile();r.callbacks.pasteReceived(n)}})})}function n(){s&&s()}var r,s;r={targetElement:null,callbacks:{log:function(){},pasteReceived:function(){}}},qq.extend(r,e),i(),qq.extend(this,{reset:function(){n()}})},qq.DragAndDrop=function(e){"use strict";function t(e,t){var i=Array.prototype.slice.call(e);l.callbacks.dropLog("Grabbed "+e.length+" dropped files."),t.dropDisabled(!1),l.callbacks.processingDroppedFilesComplete(i,t.getElement())}function i(e){var t,n=new qq.Promise;return e.isFile?e.file(function(e){p.push(e),n.success()},function(t){l.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+t.code+".","error"),n.failure()}):e.isDirectory&&(t=e.createReader(),t.readEntries(function(e){var t=e.length;qq.each(e,function(e,r){i(r).done(function(){t-=1,0===t&&n.success()})}),e.length||n.success()},function(t){l.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+t.code+".","error"),n.failure()})),n}function n(e,t){var n=[],r=new qq.Promise;return l.callbacks.processingDroppedFiles(),t.dropDisabled(!0),e.files.length>1&&!l.allowMultipleItems?(l.callbacks.processingDroppedFilesComplete([]),l.callbacks.dropError("tooManyFilesError",""),t.dropDisabled(!1),r.failure()):(p=[],qq.isFolderDropSupported(e)?qq.each(e.items,function(e,t){var s=t.webkitGetAsEntry();s&&(s.isFile?p.push(t.getAsFile()):n.push(i(s).done(function(){n.pop(),0===n.length&&r.success()})))}):p=e.files,0===n.length&&r.success()),r}function r(e){var i=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:u,element:e,onEnter:function(t){qq(e).addClass(l.classes.dropActive),t.stopPropagation()},onLeaveNotDescendants:function(){qq(e).removeClass(l.classes.dropActive)},onDrop:function(e){n(e.dataTransfer,i).done(function(){t(p,i)})}});return d.addDisposer(function(){i.dispose()}),qq(e).hasAttribute(h)&&qq(e).hide(),c.push(i),i}function s(e){var t;return qq.each(e.dataTransfer.types,function(e,i){return"Files"===i?(t=!0,!1):void 0}),t}function o(e){return(qq.chrome()||qq.safari()&&qq.windows())&&0==e.clientX&&0==e.clientY||qq.firefox()&&!e.relatedTarget}function a(){var e=l.dropZoneElements;qq.each(e,function(t,i){var n=r(i);!e.length||qq.ie()&&!qq.ie10()||d.attach(document,"dragenter",function(t){!n.dropDisabled()&&s(t)&&qq.each(e,function(e,t){t instanceof HTMLElement&&qq(t).css({display:"block"})})})}),d.attach(document,"dragleave",function(t){o(t)&&qq.each(e,function(e,t){qq(t).hasAttribute(h)&&qq(t).hide()})}),d.attach(document,"drop",function(t){qq.each(e,function(e,t){qq(t).hasAttribute(h)&&qq(t).hide()}),t.preventDefault()}),d.attach(document,u,function(){qq.each(l.dropZoneElements,function(e,t){qq(t).hasAttribute(h)&&qq(t).hide(),qq(t).removeClass(l.classes.dropActive)})})}var l,u="qq-hidezones",h="qq-hide-dropzone",c=[],p=[],d=new qq.DisposeSupport;l={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks},qq.extend(l,e,!0),a(),qq.extend(this,{setupExtraDropzone:function(e){l.dropZoneElements.push(e),r(e)},removeDropzone:function(e){var t,i=l.dropZoneElements;for(t in i)if(i[t]===e)return i.splice(t,1)},dispose:function(){d.dispose(),qq.each(c,function(e,t){t.dispose()})}})},qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(){},dropError:function(e,t){qq.log("Drag & drop error code '"+e+" with these specifics: '"+t+"'","error")},dropLog:function(e,t){qq.log(e,t)}}},qq.UploadDropZone=function(e){"use strict";function t(){return qq.safari()||qq.firefox()&&qq.windows()}function i(){h||(t?c.attach(document,"dragover",function(e){e.preventDefault()}):c.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),h=!0)}function n(e){if(qq.ie()&&!qq.ie10())return!1;var t,i=e.dataTransfer,n=qq.safari();return t=qq.ie10()||qq.ie11()?!0:"none"!==i.effectAllowed,i&&t&&(i.files||!n&&i.types.contains&&i.types.contains("Files"))}function r(e){return void 0!==e&&(u=e),u}function s(){function e(){t=document.createEvent("Event"),t.initEvent(a.HIDE_ZONES_EVENT_NAME,!0,!0)}var t;if(window.CustomEvent)try{t=new CustomEvent(a.HIDE_ZONES_EVENT_NAME)}catch(i){e()}else e();document.dispatchEvent(t)}function o(){c.attach(l,"dragover",function(e){if(n(e)){var t=qq.ie()||qq.ie11()?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy",e.stopPropagation(),e.preventDefault()}}),c.attach(l,"dragenter",function(e){if(!r()){if(!n(e))return;a.onEnter(e)}}),c.attach(l,"dragleave",function(e){if(n(e)){a.onLeave(e);var t=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(t)||a.onLeaveNotDescendants(e)}}),c.attach(l,"drop",function(e){if(!r()){if(!n(e))return;e.preventDefault(),e.stopPropagation(),a.onDrop(e),s()}})}var a,l,u,h,c=new qq.DisposeSupport;a={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}},qq.extend(a,e),l=a.element,i(),o(),qq.extend(this,{dropDisabled:function(e){return r(e)},dispose:function(){c.dispose()},getElement:function(){return l}})},qq.DeleteFileAjaxRequester=function(e){"use strict";function t(){return"POST"===n.method.toUpperCase()?{_method:"DELETE"}:{}}var i,n={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};qq.extend(n,e),i=new qq.AjaxRequester({validMethods:["POST","DELETE"],method:n.method,endpointStore:n.endpointStore,paramsStore:n.paramsStore,mandatedParams:t(),maxConnections:n.maxConnections,customHeaders:n.customHeaders,demoMode:n.demoMode,log:n.log,onSend:n.onDelete,onComplete:n.onDeleteComplete,cors:n.cors}),qq.extend(this,{sendDelete:function(e,t,r){var s=r||{};n.log("Submitting delete file request for "+e),"DELETE"===n.method?i.initTransport(e).withPath(t).withParams(s).send():(s[n.uuidParamName]=t,i.initTransport(e).withParams(s).send())}})},function(){function e(e){var t=e.naturalWidth,i=e.naturalHeight;if(t*i>1048576){var n=document.createElement("canvas");n.width=n.height=1;var r=n.getContext("2d");return r.drawImage(e,-t+1,0),0===r.getImageData(0,0,1,1).data[3]}return!1}function t(e,t,i){var n=document.createElement("canvas");n.width=1,n.height=i;var r=n.getContext("2d");r.drawImage(e,0,0);for(var s=r.getImageData(0,0,1,i).data,o=0,a=i,l=i;l>o;){var u=s[4*(l-1)+3];0===u?a=l:o=l,l=a+o>>1}var h=l/i;return 0===h?1:h}function i(e,t,i){var r=document.createElement("canvas"),s=t.mime||"image/jpeg";return n(e,r,t,i),r.toDataURL(s,t.quality||.8)}function n(i,n,s,o){var a=i.naturalWidth,l=i.naturalHeight,u=s.width,h=s.height,c=n.getContext("2d");if(c.save(),r(n,u,h,s.orientation),qq.ios()){var p=e(i);p&&(a/=2,l/=2);var d=1024,f=document.createElement("canvas");f.width=f.height=d;for(var m=f.getContext("2d"),g=o?t(i,a,l):1,y=Math.ceil(d*u/a),v=Math.ceil(d*h/l/g),b=0,_=0;l>b;){for(var w=0,x=0;a>w;)m.clearRect(0,0,d,d),m.drawImage(i,-w,-b),c.drawImage(f,0,0,d,d,x,_,y,v),w+=d,x+=y;b+=d,_+=v}c.restore(),f=m=null}else c.drawImage(i,0,0,u,h)}function r(e,t,i,n){switch(n){case 5:case 6:case 7:case 8:e.width=i,e.height=t;break;default:e.width=t,e.height=i}var r=e.getContext("2d");switch(n){case 2:r.translate(t,0),r.scale(-1,1);break;case 3:r.translate(t,i),r.rotate(Math.PI);break;case 4:r.translate(0,i),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-i);break;case 7:r.rotate(.5*Math.PI),r.translate(t,-i),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-t,0);break;default:}}function s(e,t){if(window.Blob&&e instanceof Blob){var i=new Image,n=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!n)throw Error("No createObjectURL function found to create blob url");i.src=n.createObjectURL(e),this.blob=e,e=i}if(!e.naturalWidth&&!e.naturalHeight){var r=this;e.onload=function(){var e=r.imageLoadListeners;if(e){r.imageLoadListeners=null;for(var t=0,i=e.length;i>t;t++)e[t]()}},e.onerror=t,this.imageLoadListeners=[]}this.srcImage=e}s.prototype.render=function(e,t){if(this.imageLoadListeners){var r=this;return this.imageLoadListeners.push(function(){r.render(e,t)}),void 0}t=t||{};var s=this.srcImage.naturalWidth,o=this.srcImage.naturalHeight,a=t.width,l=t.height,u=t.maxWidth,h=t.maxHeight,c=!this.blob||"image/jpeg"===this.blob.type;a&&!l?l=o*a/s<<0:l&&!a?a=s*l/o<<0:(a=s,l=o),u&&a>u&&(a=u,l=o*a/s<<0),h&&l>h&&(l=h,a=s*l/o<<0);var p={width:a,height:l};for(var d in t)p[d]=t[d];var f=e.tagName.toLowerCase();"img"===f?e.src=i(this.srcImage,p,c):"canvas"===f&&n(this.srcImage,e,p,c),"function"==typeof this.onrender&&this.onrender(e)},"function"==typeof define&&define.amd?define([],function(){return s}):this.MegaPixImage=s}(),qq.ImageGenerator=function(e){"use strict";function t(e){return"img"===e.tagName.toLowerCase()}function i(e){return"canvas"===e.tagName.toLowerCase()}function n(){return void 0!==(new Image).crossOrigin}function r(){var e=document.createElement("canvas");return e.getContext&&e.getContext("2d")}function s(e){var t=e.split("/"),i=t[t.length-1],n=qq.getExtension(i);switch(n=n&&n.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function o(e){var t,i,n,r=document.createElement("a");return r.href=e,t=r.protocol,n=r.port,i=r.hostname,t.toLowerCase()!==window.location.protocol.toLowerCase()?!0:i.toLowerCase()!==window.location.hostname.toLowerCase()?!0:n===window.location.port||qq.ie()?!1:!0}function a(t,i){t.onload=function(){t.onload=null,t.onerror=null,i.success(t)},t.onerror=function(){t.onload=null,t.onerror=null,e("Problem drawing thumbnail!","error"),i.failure(t,"Problem drawing thumbnail!")}}function l(e,t){var i=e.getContext("2d"),n=i.drawImage;i.drawImage=function(){n.apply(this,arguments),t.success(e),i.drawImage=n}}function u(n,r){var s=t(n)||i(n);return t(n)?a(n,r):i(n)?l(n,r):(r.failure(n),e(qq.format("Element container of type {} is not supported!",n.tagName),"error")),s}function h(t,i,n){var r=new qq.Promise,s=new qq.Identify(t,e),o=n.maxSize,a=function(){i.onerror=null,i.onload=null,e("Could not render preview, file may be too large!","error"),r.failure(i,"Browser cannot render image!")
};return s.isPreviewable().then(function(n){var s=new qq.Exif(t,e),l=new MegaPixImage(t,a);u(i,r)&&s.parse().then(function(e){var t=e.Orientation;l.render(i,{maxWidth:o,maxHeight:o,orientation:t,mime:n})},function(t){e(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",t)),l.render(i,{maxWidth:o,maxHeight:o,mime:n})})},function(){e("Not previewable"),r.failure(i,"Not previewable")}),r}function c(e,t,i,n){var r=new Image,a=new qq.Promise;u(r,a),o(e)&&(r.crossOrigin="anonymous"),r.src=e,a.then(function(){u(t,i);var o=new MegaPixImage(r);o.render(t,{maxWidth:n,maxHeight:n,mime:s(e)})})}function p(e,t,i,n){u(t,i),qq(t).css({maxWidth:n+"px",maxHeight:n+"px"}),t.src=e}function d(e,s,a){var l=new qq.Promise,h=a.scale,d=h?a.maxSize:null;return h&&t(s)?r()?o(e)&&!n()?p(e,s,l,d):c(e,s,l,d):p(e,s,l,d):i(s)?c(e,s,l,d):u(s,l)&&(s.src=e),l}qq.extend(this,{generate:function(t,i,n){return qq.isString(t)?(e("Attempting to update thumbnail based on server response."),d(t,i,n||{})):(e("Attempting to draw client-side image preview."),h(t,i,n||{}))}}),this._testing={},this._testing.isImg=t,this._testing.isCanvas=i,this._testing.isCrossOrigin=o,this._testing.determineMimeOfFileName=s},qq.Exif=function(e,t){"use strict";function i(e){for(var t=0,i=0;e.length>0;)t+=parseInt(e.substring(0,2),16)*Math.pow(2,i),e=e.substring(2,e.length),i+=8;return t}function n(t,i){var r=t,s=i;return void 0===r&&(r=2,s=new qq.Promise),qq.readBlobToHex(e,r,4).then(function(e){var t=/^ffe([0-9])/.exec(e);if(t)if("1"!==t[1]){var i=parseInt(e.slice(4,8),16);n(r+i+2,s)}else s.success(r);else s.failure("No EXIF header to be found!")}),s}function r(){var t=new qq.Promise;return qq.readBlobToHex(e,0,6).then(function(e){0!==e.indexOf("ffd8")?t.failure("Not a valid JPEG!"):n().then(function(e){t.success(e)},function(e){t.failure(e)})}),t}function s(t){var i=new qq.Promise;return qq.readBlobToHex(e,t+10,2).then(function(e){i.success("4949"===e)}),i}function o(t,n){var r=new qq.Promise;return qq.readBlobToHex(e,t+18,2).then(function(e){return n?r.success(i(e)):(r.success(parseInt(e,16)),void 0)}),r}function a(t,i){var n=t+20,r=12*i;return qq.readBlobToHex(e,n,r)}function l(e){for(var t=[],i=0;e.length>=i+24;)t.push(e.slice(i,i+24)),i+=24;return t}function u(e,t){var n=16,r=qq.extend([],h),s={};return qq.each(t,function(t,o){var a,l,u,h=o.slice(0,4),p=e?i(h):parseInt(h,16),d=r.indexOf(p);return d>=0&&(l=c[p].name,u=c[p].bytes,a=o.slice(n,n+2*u),s[l]=e?i(a):parseInt(a,16),r.splice(d,1)),0===r.length?!1:void 0}),s}var h=[274],c={274:{name:"Orientation",bytes:2}};qq.extend(this,{parse:function(){var i=new qq.Promise,n=function(e){t(qq.format("EXIF header parse failed: '{}' ",e)),i.failure(e)};return r().then(function(r){t(qq.format("Moving forward with EXIF header parsing for '{}'",void 0===e.name?"blob":e.name)),s(r).then(function(e){t(qq.format("EXIF Byte order is {} endian",e?"little":"big")),o(r,e).then(function(s){t(qq.format("Found {} APP1 directory entries",s)),a(r,s).then(function(n){var r=l(n),s=u(e,r);t("Successfully parsed some EXIF tags"),i.success(s)},n)},n)},n)},n),i}}),this._testing={},this._testing.parseLittleEndian=i},qq.Identify=function(e,t){"use strict";function i(e,t){var i=!1,n=[].concat(e);return qq.each(n,function(e,n){return 0===t.indexOf(n)?(i=!0,!1):void 0}),i}var n={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]};qq.extend(this,{isPreviewable:function(){var r=new qq.Promise,s=!1,o=void 0===e.name?"blob":e.name;return t(qq.format("Attempting to determine if {} can be rendered in this browser",o)),qq.readBlobToHex(e,0,4).then(function(e){qq.each(n,function(t,n){return i(n,e)?(("image/tiff"!==t||qq.safari())&&(s=!0,r.success(t)),!1):void 0}),t(qq.format("'{}' is {} able to be rendered in this browser",o,s?"":"NOT")),s||r.failure()}),r}})},qq.ImageValidation=function(e,t){"use strict";function i(e){var t=!1;return qq.each(e,function(e,i){return i>0?(t=!0,!1):void 0}),t}function n(){var i=new qq.Promise;return new qq.Identify(e,t).isPreviewable().then(function(){var n=new Image,r=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;r?(n.onerror=function(){t("Cannot determine dimensions for image.  May be too large.","error"),i.failure()},n.onload=function(){i.success({width:this.width,height:this.height})},n.src=r.createObjectURL(e)):(t("No createObjectURL function available to generate image URL!","error"),i.failure())},i.failure),i}function r(e,t){var i;return qq.each(e,function(e,n){if(n>0){var r=/(max|min)(Width|Height)/.exec(e),s=r[2].charAt(0).toLowerCase()+r[2].slice(1),o=t[s];switch(r[1]){case"min":if(n>o)return i=e,!1;break;case"max":if(o>n)return i=e,!1}}}),i}this.validate=function(e){var s=new qq.Promise;return t("Attempting to validate image."),i(e)?n().then(function(t){var i=r(e,t);i?s.failure(i):s.success()},s.success):s.success(),s}},qq.Session=function(e){"use strict";function t(e){return qq.isArray(e)?!0:(n.log("Session response is not an array.","error"),void 0)}function i(e,i,r,s){var o=!1;i=i&&t(e),i&&qq.each(e,function(e,t){if(null==t.uuid)o=!0,n.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",e),"error");else if(null==t.name)o=!0,n.log(qq.format("Session response item {} did not include a valid name - ignoring.",e),"error");else try{return n.addFileRecord(t),!0}catch(i){o=!0,n.log(i.message,"error")}return!1}),s[i&&!o?"success":"failure"](e,r)}var n={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(){},log:function(){}};qq.extend(n,e,!0),this.refresh=function(){var e=new qq.Promise,t=function(t,n,r){i(t,n,r,e)},r=qq.extend({},n),s=new qq.SessionAjaxRequester(qq.extend(r,{onComplete:t}));return s.queryServer(),e}},qq.SessionAjaxRequester=function(e){"use strict";function t(e,t,i){var r=null;if(null!=t.responseText)try{r=qq.parseJson(t.responseText)}catch(s){n.log("Problem parsing session response: "+s.message,"error"),i=!0}n.onComplete(r,!i,t)}var i,n={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(){},log:function(){}};qq.extend(n,e),i=new qq.AjaxRequester({validMethods:["GET"],method:"GET",endpointStore:{getEndpoint:function(){return n.endpoint}},customHeaders:n.customHeaders,log:n.log,onComplete:t,cors:n.cors}),qq.extend(this,{queryServer:function(){var e=qq.extend({},n.params);e.qqtimestamp=(new Date).getTime(),n.log("Session query request."),i.initTransport("sessionRefresh").withParams(e).send()}})},qq.UiEventHandler=function(e,t){"use strict";function i(e){n.attach(e,r.eventType,function(e){e=e||window.event;var t=e.target||e.srcElement;r.onHandled(t,e)})}var n=new qq.DisposeSupport,r={eventType:"click",attachTo:null,onHandled:function(){}};qq.extend(this,{addHandler:function(e){i(e)},dispose:function(){n.dispose()}}),qq.extend(t,{getFileIdFromItem:function(e){return e.qqFileId},getDisposeSupport:function(){return n}}),qq.extend(r,e),r.attachTo&&i(r.attachTo)},qq.FileButtonsClickHandler=function(e){"use strict";function t(e,t){qq.each(r,function(i,r){var s,o=i.charAt(0).toUpperCase()+i.slice(1);return n.templating["is"+o](e)?(s=n.templating.getFileId(e),qq.preventDefault(t),n.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",n.onGetName(s),s)),r(s),!1):void 0})}var i={},n={templating:null,log:function(){},onDeleteFile:function(){},onCancel:function(){},onRetry:function(){},onPause:function(){},onContinue:function(){},onGetName:function(){}},r={cancel:function(e){n.onCancel(e)},retry:function(e){n.onRetry(e)},deleteButton:function(e){n.onDeleteFile(e)},pause:function(e){n.onPause(e)},continueButton:function(e){n.onContinue(e)}};qq.extend(n,e),n.eventType="click",n.onHandled=t,n.attachTo=n.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(n,i))},qq.FilenameClickHandler=function(e){"use strict";function t(e,t){if(n.templating.isFileName(e)||n.templating.isEditIcon(e)){var r=n.templating.getFileId(e),s=n.onGetUploadStatus(r);s===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",n.onGetName(r),r)),qq.preventDefault(t),i.handleFilenameEdit(r,e,!0))}}var i={},n={templating:null,log:function(){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(){},onGetName:function(){}};qq.extend(n,e),n.eventType="click",n.onHandled=t,qq.extend(this,new qq.FilenameEditHandler(n,i))},qq.FilenameInputFocusInHandler=function(e,t){"use strict";function i(e){if(n.templating.isEditInput(e)){var i=n.templating.getFileId(e),r=n.onGetUploadStatus(i);r===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",n.onGetName(i),i)),t.handleFilenameEdit(i,e))}}var n={templating:null,onGetUploadStatus:function(){},log:function(){}};t||(t={}),n.eventType="focusin",n.onHandled=i,qq.extend(n,e),qq.extend(this,new qq.FilenameEditHandler(n,t))},qq.FilenameInputFocusHandler=function(e){"use strict";e.eventType="focus",e.attachTo=null,qq.extend(this,new qq.FilenameInputFocusInHandler(e,{}))},qq.FilenameEditHandler=function(e,t){"use strict";function i(e){var t=a.onGetName(e),i=t.lastIndexOf(".");return i>0&&(t=t.substr(0,i)),t}function n(e){var t=a.onGetName(e);return qq.getExtension(t)}function r(e,t){var i,r=e.value;void 0!==r&&qq.trimStr(r).length>0&&(i=n(t),void 0!==i&&(r=r+"."+i),a.onSetName(t,r)),a.onEditingStatusChange(t,!1)}function s(e,i){t.getDisposeSupport().attach(e,"blur",function(){r(e,i)})}function o(e,i){t.getDisposeSupport().attach(e,"keyup",function(t){var n=t.keyCode||t.which;13===n&&r(e,i)})}var a={templating:null,log:function(){},onGetUploadStatus:function(){},onGetName:function(){},onSetName:function(){},onEditingStatusChange:function(){}};qq.extend(a,e),a.attachTo=a.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(a,t)),qq.extend(t,{handleFilenameEdit:function(e,t,n){var r=a.templating.getEditInput(e);a.onEditingStatusChange(e,!0),r.value=i(e),n&&r.focus(),s(r,e),o(r,e)}})},function(e){"use strict";function t(e){if(e){var t=a(e),n=i(t);r(n),o(t,n)}return c}function i(e){var t=s("uploaderType"),i=s("endpointType");return t?(t=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),i?new qq[i]["FineUploader"+t](e):new qq["FineUploader"+t](e)):i?new qq[i].FineUploader(e):new qq.FineUploader(e)}function n(e,t){var i=c.data("fineuploader");return t?(void 0===i&&(i={}),i[e]=t,c.data("fineuploader",i),void 0):void 0===i?null:i[e]}function r(e){return n("uploader",e)}function s(e,t){return n(e,t)}function o(t,i){var n=t.callbacks={};e.each(i._options.callbacks,function(t,i){var r,s;r=/^on(\w+)/.exec(t)[1],r=r.substring(0,1).toLowerCase()+r.substring(1),s=c,n[t]=function(){var t,n,o=Array.prototype.slice.call(arguments),a=[];e.each(o,function(e,t){a.push(h(t))}),t=i.apply(this,o);try{n=s.triggerHandler(r,a)}catch(l){qq.log("Caught error in Fine Uploader jQuery event handler: "+l.message,"error")}return null!=t?t:n}}),i._options.callbacks=n}function a(t,i){var n,r;return n=void 0===i?"basic"!==t.uploaderType?{element:c[0]}:{}:i,e.each(t,function(t,i){e.inArray(t,p)>=0?s(t,i):i instanceof e?n[t]=i[0]:e.isPlainObject(i)?(n[t]={},a(i,n[t])):e.isArray(i)?(r=[],e.each(i,function(t,i){var n={};i instanceof e?e.merge(r,i):e.isPlainObject(i)?(a(i,n),r.push(n)):r.push(i)}),n[t]=r):n[t]=i}),void 0===i?n:void 0}function l(t){return"string"===e.type(t)&&!t.match(/^_/)&&void 0!==r()[t]}function u(e){var t,i=[],n=Array.prototype.slice.call(arguments,1);return a(n,i),t=r()[e].apply(r(),i),h(t)}function h(t){var i=t;return null==t||"object"!=typeof t||1!==t.nodeType&&9!==t.nodeType||!t.cloneNode||(i=e(t)),i}var c,p=["uploaderType","endpointType"];e.fn.fineUploader=function(i){var n=this,s=arguments,o=[];return this.each(function(a,h){if(c=e(h),r()&&l(i)){if(o.push(u.apply(n,s)),1===n.length)return!1}else"object"!=typeof i&&i?e.error("Method "+i+" does not exist on jQuery.fineUploader"):t.apply(n,s)}),1===o.length?o[0]:o.length>1?o:this}}(jQuery),function(e){"use strict";function t(e){e||(e={}),e.dropZoneElements=[l];var t=s(e);return r(t),n(new qq.DragAndDrop(t)),l}function i(e,t){var i=l.data(u);return t?(void 0===i&&(i={}),i[e]=t,l.data(u,i),void 0):void 0===i?null:i[e]}function n(e){return i("dndInstance",e)}function r(t){var i=t.callbacks={};new qq.FineUploaderBasic,e.each(new qq.DragAndDrop.callbacks,function(e){var t,n=e;t=l,i[e]=function(){var e=Array.prototype.slice.call(arguments),i=t.triggerHandler(n,e);return i}})}function s(t,i){var n,r;return n=void 0===i?{}:i,e.each(t,function(t,i){i instanceof e?n[t]=i[0]:e.isPlainObject(i)?(n[t]={},s(i,n[t])):e.isArray(i)?(r=[],e.each(i,function(t,i){i instanceof e?e.merge(r,i):r.push(i)}),n[t]=r):n[t]=i}),void 0===i?n:void 0}function o(t){return"string"===e.type(t)&&"dispose"===t&&void 0!==n()[t]}function a(e){var t=[],i=Array.prototype.slice.call(arguments,1);return s(i,t),n()[e].apply(n(),t)}var l,u="fineUploaderDnd";e.fn.fineUploaderDnd=function(i){var r=this,s=arguments,u=[];return this.each(function(h,c){if(l=e(c),n()&&o(i)){if(u.push(a.apply(r,s)),1===r.length)return!1}else"object"!=typeof i&&i?e.error("Method "+i+" does not exist in Fine Uploader's DnD module."):t.apply(r,s)}),1===u.length?u[0]:u.length>1?u:this}}(jQuery),require.register("application",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};a=t("controllers/structure-controller"),s=t("controllers/refresh-controller"),o=t("controllers/single-refresh-controller"),r=t("views/layout"),l=t("mediator"),u=t("routes"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.title="Mobilny Pośrednik",t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.initControllers(),"function"==typeof Object.freeze?Object.freeze(this):void 0},t.prototype.initLayout=function(){return this.layout=new r({title:this.title})},t.prototype.initControllers=function(){return new a,new s,new o},t.prototype.initMediator=function(){return l.online=!0,l.models={},l.collections={},l.schemas={},l.last_query={},l.info=[],l.viewed=[],l.server_url=l.online===!0?"http://mps.mobilnyposrednik.pl/":"http://localhost:8080/",console.log(l.server_url),l.upload_url=""+l.server_url+"v1/pliki",l.app_key="mp",l.app="4ba2b78a-5675-42d9-8aab-f65ecf3ce9ba",l.can_edit=function(e,t,i){return e?!0:t===i?!0:!1},l.gen_token=function(e){var t,i,n,r,s,o;return t=CryptoJS.HmacSHA256(e,l.app_key),i=t.toString(CryptoJS.enc.Hex),s=CryptoJS.HmacSHA256(e,l.models.user.get("user_pass")),o=s.toString(CryptoJS.enc.Hex),r=""+l.app+","+i+","+l.models.user.get("username")+"@"+l.models.user.get("company_name")+","+o,n=btoa(r)},l.seal()},t}(Chaplin.Application)}),require.register("controllers/agent-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("controllers/auth-controller"),a=t("views/agent-list-view"),o=t("views/agent-view"),r=t("models/agent-collection"),l=t("models/agent-model"),u=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return this.publishEvent("log:info","in agent list controller"),u.collections.agents=new r,u.collections.agents.fetch({data:e,beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę agentów ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new a({collection:u.collections.agents,template:"agent_list_view",filter:"agent_type",region:"content",controller:"agent_controller"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.add=function(e){var t=this;return u.models.user.fetch({success:function(){return t.publishEvent("log:info","in agentadd controller"),u.models.agent=new l,t.model=u.models.agent,t.model.fetch({beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Odświeżam formularz ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.can_edit=u.can_edit(u.models.user.get("is_admin"),1,0),u.models.user.update_db(),t.schema=localStorage.getObject("agent_schema"),t.model.schema=_.clone(t.schema),t.view=new o({form_name:"agent_form",model:t.model,can_edit:t.can_edit,edit_type:"add",region:"content"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})}})},t.prototype.show=function(e,t,i){var n=this;return this.publishEvent("log:info","in agent show controller"),console.log(e,t,i),u.models.user.fetch({success:function(){var t;return u.models.user.update_db(),_.isObject(null!=(t=u.collections.agents)?"function"==typeof t.get?t.get(e.id):void 0:void 0)?(n.publishEvent("log:info","in agent show Else"),n.model=u.collections.agents.get(e.id),console.log(u.models.user.get("is_admin"),n.model.get("id"),u.models.user.get("id")),n.edit_type="",u.models.user.get("id")===n.model.get("id")&&(n.edit_type="add"),n.can_edit=u.can_edit(u.models.user.get("is_admin"),n.model.get("id"),u.models.user.get("id")),n.schema=localStorage.getObject("agent_schema"),n.model.schema=_.clone(n.schema),n.publishEvent("tell_viewed",n.model.get_url()),n.view=new o({form_name:"agent_form",model:n.model,can_edit:n.can_edit,edit_type:n.edit_type,region:"content"})):(n.publishEvent("log:info","in agent show IF"),u.collections.agents=new r,u.collections.agents.fetch({data:e,beforeSend:function(){return n.publishEvent("loading_start")},success:function(){return n.publishEvent("log:info","data with "+e+" fetched ok"),n.publishEvent("loading_stop"),_.isObject(u.collections.agents.get(e.id))||(n.publishEvent("tell_user","Agent nie został znaleziony"),Chaplin.utils.redirectTo({url:"/agenci"})),n.publishEvent("log:info","in agent show controller fetch"),n.model=u.collections.agents.get(e.id),n.can_edit=u.can_edit(u.models.user.get("is_admin"),n.model.get("id"),u.models.user.get("id")),console.log("-------",n.can_edit),console.log(u.models.user.get("is_admin"),n.model.get("id"),u.models.user.get("id")),n.edit_type="",u.models.user.get("id")===n.model.get("id")&&(n.edit_type="add"),n.schema=localStorage.getObject("agent_schema"),n.model.schema=_.clone(n.schema),n.publishEvent("tell_viewed",n.model.get_url()),n.view=new o({form_name:"agent_form",model:n.model,can_edit:n.can_edit,edit_type:n.edit_type,region:"content"})},error:function(){return n.publishEvent("loading_stop"),n.publishEvent("server_error")}}))}})},t}(s)}),require.register("controllers/auth-controller",function(e,t,i){var n,r,s,o,a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("controllers/structure-controller"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.beforeAction=function(){var e;return t.__super__.beforeAction.apply(this,arguments),this.publishEvent("log:info","AuthController#beforeAction()"),this.publishEvent("log:info",window.location.pathname),this.publishEvent("log:info",null!=(e=s.models.user)?e.toJSON():void 0),_.isEmpty(s.models.user)?(s.redirectUrl=window.location.pathname,this.redirectTo({url:"login"})):void 0},t}(r),o=Backbone.sync,Backbone.sync=function(e,t,i){var n,r,s,a,l,u,h;return $.mobile.loading("show"),l=this,(null!=(h=Chaplin.mediator.models.user)?h.get("is_logged"):void 0)&&(t.urlRoot?(n=_.isFunction(t.urlRoot)?t.urlRoot():t.urlRoot,u=t.isNew()?n:""+n+"/"+t.id):u=t.url,_.isEmpty(i.data)||(s=$.param(i.data),u=""+u+"?"+s),r=Chaplin.mediator.gen_token(u),i.beforeSend=function(e){return e.setRequestHeader("X-Auth-Token",r)}),a=o.call(this,e,t,i),a.done(function(){return $.mobile.loading("hide")}),a.fail(function(e,t){return console.log(e,t),$.mobile.loading("hide"),l.publishEvent("tell_user","Błąd "+e+", "+t)})}}),require.register("controllers/base/controller",function(e,t,i){var n,r={}.hasOwnProperty,s=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,e),t}(Chaplin.Controller)}),require.register("controllers/bon-controller",function(e,t,i){var n,r,s,o,a,l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("controllers/auth-controller"),o=t("views/bon-view"),s=t("models/bon-model"),a=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.show=function(e,t,i){var n=this;return console.log(e,t,i),this.can_edit=a.can_edit(a.models.user.get("is_admin"),1,0),this.schema=localStorage.getObject("company_schema"),this.publishEvent("log:info","in bon show controller"),_.isObject(a.models.bon)?(a.models.bon.schema=_.clone(this.schema),this.view=new o({form_name:"bon_form",model:a.models.bon,can_edit:this.can_edit,region:"content"})):(a.models.bon=new s({id:e.id}),a.models.bon.schema=_.clone(this.schema),a.models.bon.fetch({beforeSend:function(){return n.publishEvent("loading_start"),n.publishEvent("tell_user","Ładuje ustawienia biura ...")},success:function(){return n.publishEvent("log:info","data with "+e+" fetched ok"),n.publishEvent("loading_stop"),n.view=new o({form_name:"bon_form",model:a.models.bon,can_edit:n.can_edit,region:"content"})},error:function(){return n.publishEvent("loading_stop"),n.publishEvent("server_error")}}))},t}(r)}),require.register("controllers/branch-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("controllers/auth-controller"),o=t("views/branch-list-view"),l=t("views/branch-view"),r=t("models/branch-collection"),a=t("models/branch-model"),u=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return this.publishEvent("log:info","in branch list controller"),u.collections.branches=new r,u.collections.branches.fetch({data:e,beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę oddziałów ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new o({collection:u.collections.branches,template:"branch_list_view",region:"content",controller:"branch_controller"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.add=function(){return this.publishEvent("log:info","in branchadd controller"),u.models.branch=new a,this.model=u.models.branch,this.schema=localStorage.getObject("branch_schema"),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),1,0),this.view=new l({form_name:"branch_form",model:this.model,can_edit:this.can_edit,region:"content"})},t.prototype.show=function(e){return this.publishEvent("log:info","in branch show controller"),_.isObject(u.collections.branches.get(e.id))||this.redirectTo({"/oddzialy":"/oddzialy"}),this.model=u.collections.branches.get(e.id),this.schema=localStorage.getObject("branch_schema"),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),1,0),this.publishEvent("tell_viewed",this.model.get_url()),this.view=new l({form_name:"branch_form",model:this.model,can_edit:this.can_edit,region:"content"})},t}(s)}),require.register("controllers/client-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};o=t("controllers/auth-controller"),a=t("views/client-list-view"),r=t("views/client-view"),s=t("models/client-collection"),l=t("models/client-model"),u=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return this.publishEvent("log:info","in client list controller"),u.collections.clients=new s,u.collections.clients.fetch({data:e,beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę klientów ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new a({collection:u.collections.clients,template:"client_list_view",region:"content"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.add=function(){return this.publishEvent("log:info","in clientadd controller"),u.models.client=new l,this.schema=localStorage.getObject("client_schema"),this.model=u.models.client,this.model.schema=_.clone(this.schema),this.view=new r({form_name:"client_form",model:this.model,can_edit:!0,edit_type:"add",region:"content"})},t.prototype.show=function(e){return this.publishEvent("log:info","in client show controller"),_.isObject(u.collections.clients.get(e.id))||this.redirectTo({"/klienci":"/klienci"}),this.schema=localStorage.getObject("client_schema"),this.model=u.collections.clients.get(e.id),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),this.model.get("agent"),u.models.user.get("id")),this.publishEvent("tell_viewed",this.model.get_url()),this.view=new r({form_name:"client_form",model:this.model,can_edit:this.can_edit,region:"content"})},t}(o)}),require.register("controllers/client-public-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};o=t("controllers/auth-controller"),a=t("views/client-public-list-view"),s=t("models/client-public-collection"),r=t("views/client-public-view"),l=t("models/client-model"),u=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return u.collections.clients_public=new s,u.collections.clients_public.fetch({beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę klientów ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new a({collection:u.collections.clients_public,template:"client_public_list_view",region:"content"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.show=function(e){return this.publishEvent("log:info","in client show controller"),_.isObject(u.collections.clients_public.get(e.id))||this.redirectTo({"/klienci-wspolni":"/klienci-wspolni"}),this.model=u.collections.clients_public.get(e.id),this.schema=localStorage.getObject("client_schema"),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),this.model.get("agent"),u.models.user.get("id")),this.view=new r({form_name:"client_form",model:this.model,can_edit:this.can_edit,delete_only:!0,region:"content"})},t}(o)}),require.register("controllers/export-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("controllers/auth-controller"),o=t("views/export-list-view"),l=t("views/export-view"),n=t("models/export-collection"),a=t("models/export-model"),u=t("mediator"),i.exports=s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return this.publishEvent("log:info","in client list controller"),u.collections.exports=new n,u.collections.exports.fetch({data:e,beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę eksportów ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new o({collection:u.collections.exports,template:"export_list_view",region:"content"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.add=function(){return this.publishEvent("log:info","in export controller"),u.models["export"]=new a,this.schema=localStorage.getObject("export_schema"),this.model=u.models["export"],this.model.schema=_.clone(this.schema),this.view=new l({form_name:"export_form",model:this.model,can_edit:!0,edit_type:"add",region:"content"})},t.prototype.show=function(e){return this.publishEvent("log:info","in export show controller"),_.isObject(u.collections.exports.get(e.id))||this.redirectTo({"/eksporty":"/eksporty"}),this.schema=localStorage.getObject("export_schema"),this.model=u.collections.exports.get(e.id),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),this.model.get("agent"),u.models.user.get("id")),this.publishEvent("tell_viewed",this.model.get_url()),this.view=new l({form_name:"export_form",model:this.model,can_edit:this.can_edit,region:"content"})},t}(r)}),require.register("controllers/graphic-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("controllers/auth-controller"),o=t("views/graphic-list-view"),l=t("views/graphic-view"),n=t("models/graphic-collection"),a=t("models/graphic-model"),u=t("mediator"),i.exports=s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e){var t=this;return this.publishEvent("log:info","in client list controller"),u.collections.graphics=new n,u.collections.graphics.fetch({data:e,beforeSend:function(){return t.publishEvent("loading_start"),t.publishEvent("tell_user","Ładuje listę grafik ...")},success:function(){return t.publishEvent("log:info","data with "+e+" fetched ok"),t.publishEvent("loading_stop"),t.view=new o({collection:u.collections.graphics,template:"graphic_list_view",region:"content"})},error:function(){return t.publishEvent("loading_stop"),t.publishEvent("server_error")}})},t.prototype.add=function(){return this.publishEvent("log:info","in graphic controller"),u.models.graphic=new a,this.schema=localStorage.getObject("graphic_schema"),this.model=u.models.graphic,this.model.schema=_.clone(this.schema),this.view=new l({form_name:"graphic_form",model:this.model,can_edit:!0,edit_type:"add",region:"content"})},t.prototype.show=function(e){return this.publishEvent("log:info","in graphic show controller"),_.isObject(u.collections.graphics.get(e.id))||this.redirectTo({"/grafiki":"/grafiki"}),this.schema=localStorage.getObject("graphic_schema"),this.model=u.collections.graphics.get(e.id),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),this.model.get("agent"),u.models.user.get("id")),this.publishEvent("tell_viewed",this.model.get_url()),this.view=new l({form_name:"graphic_form",model:this.model,can_edit:this.can_edit,region:"content"})
},t}(r)}),require.register("controllers/header-controller",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("controllers/base/controller"),s=t("views/header-view"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.view=new s},t}(n)}),require.register("controllers/home-controller",function(e,t,i){var n,r,s,o,a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("controllers/auth-controller"),s=t("views/home-page-view"),o=t("mediator"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.show=function(){return this.publishEvent("log:info","controller:home"),this.view=new s({region:"content"})},t}(n)}),require.register("controllers/iframe-controller",function(e,t,i){var n,r,s,o,a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("controllers/auth-controller"),s=t("views/iframe-view"),o=t("mediator"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.show=function(e){return this.publishEvent("log:info","controller:home"),this.view=new s({region:"content",template:e.template})},t}(n)}),require.register("controllers/listing-controller",function(e,t,i){var n,r,s,o,a,l,u,h={}.hasOwnProperty,c=function(e,t){function i(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("controllers/auth-controller"),s=t("views/listing-list-view"),n=t("models/listing-collection"),a=t("models/listing-model"),l=t("views/listing-view"),u=t("mediator"),i.exports=o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return c(t,e),t.prototype.list=function(e,t,i){var r,o=this;return this.publishEvent("log:info","in list property controller"+e+", "+t+", "+i),u.last_query=_.clone(i.query),r=i.query.category,u.collections.listings=new n,u.collections.listings.query_add(i.query),u.collections.listings.fetch({data:u.collections.listings.query,success:function(){return o.publishEvent("log:info","data with "+e+" fetched ok"),o.view=new s({collection:u.collections.listings,template:"listing_list_view",filter:"status",region:"content",listing_type:r,controller:"listing_controller"})},error:function(){return o.publishEvent("server_error")}})},t.prototype.add=function(e,t,i){var n,r;return this.publishEvent("log:info","in add property controller"),console.log(e,t,i),r=i.query.type,n=""+r+"_form",this.schema=localStorage.getObject(""+r+"_schema"),u.models.listing=new a,u.models.listing.schema=_.clone(this.schema),this.publishEvent("log:info","init view property controller"),this.view=new l({form_name:n,model:u.models.listing,listing_type:r,can_edit:!0,edit_type:"add",region:"content"}),this.publishEvent("log:info","after init view property controller")},t.prototype.show=function(e){var t,i,n,r,s,o,h=this;return this.publishEvent("log:info","in listing show controller"),s="/oferty?"+$.param(u.last_query),_.isObject(null!=(o=u.collections.listings)?o.get(e.id):void 0)?(this.model=u.collections.listings.get(e.id),t=_.invert(localStorage.getObject("categories")),i=t[this.model.get("category")],n=""+i+"_form",r=""+i+"_schema",this.schema=localStorage.getObject(r),this.model.schema=_.clone(this.schema),this.can_edit=u.can_edit(u.models.user.get("is_admin"),this.model.get("agent"),u.models.user.get("id")),this.publishEvent("tell_viewed",this.model.get_url()),this.view=new l({form_name:n,model:this.model,can_edit:this.can_edit,region:"content"})):(u.models.listing=new a,this.model=u.models.listing,this.model.set("id",e.id),this.model.fetch({success:function(){return h.publishEvent("log:info","data with "+e+" fetched ok"),t=_.invert(localStorage.getObject("categories")),i=t[h.model.get("category")],n=""+i+"_form",r=""+i+"_schema",h.schema=localStorage.getObject(r),h.model.schema=_.clone(h.schema),h.can_edit=u.can_edit(u.models.user.get("is_admin"),h.model.get("agent"),u.models.user.get("id")),h.publishEvent("tell_viewed",h.model.get_url()),h.view=new l({form_name:n,model:h.model,can_edit:h.can_edit,region:"content"})},error:function(){return h.publishEvent("server_error")}}))},t}(r)}),require.register("controllers/login-controller",function(e,t,i){var n,r,s,o,a,l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};o=t("controllers/structure-controller"),r=t("views/login-view"),s=t("models/login-model"),a=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.show=function(){return this.publishEvent("log:info","login controller"),a.models.user=new s,this.view=new r({region:"login"})},t}(o)}),require.register("controllers/refresh-controller",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("controllers/auth-controller"),r=t("models/refresh-model"),o=t("mediator"),i.exports=s=function(e){function t(){return this.refresh_dependencies=a(this.refresh_dependencies,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.initialize=function(){return this.subscribeEvent("refreshmodel",this.refresh_model),this.subscribeEvent("modelchanged",this.refresh_dependencies)},t.prototype.refresh_model=function(e,t){var i,n,s=this;return this.callback=t,i=e.split("/"),n={},n.model=i[0],n.type=i[1],this.model=new r,this.model.fetch({data:n,success:function(){return s.publishEvent("log:info","data with "+n.model+"_"+n.type+" fetched ok"),_.isObject(s.model.attributes[n.type][""+n.model+"_"+n.type])?(localStorage.setObject(""+n.model+"_"+n.type,s.model.attributes[n.type][""+n.model+"_"+n.type]),"function"==typeof s.callback?s.callback():void 0):void 0},error:function(){return s.publishEvent("tell_user","Brak połączenia z serwerem - formularze nie zostały odświerzone"),"function"==typeof s.callback?s.callback():void 0}})},t.prototype.refresh_dependencies=function(){var e;return e=this,async.series([function(t){return e.refresh_model("flat_rent/schema",t)},function(t){return e.refresh_model("flat_sell/schema",t)},function(t){return e.refresh_model("house_rent/schema",t)},function(t){return e.refresh_model("house_sell/schema",t)},function(t){return e.refresh_model("land_rent/schema",t)},function(t){return e.refresh_model("land_sell/schema",t)},function(t){return e.refresh_model("object_rent/schema",t)},function(t){return e.refresh_model("object_sell/schema",t)},function(t){return e.refresh_model("warehouse_rent/schema",t)},function(t){return e.refresh_model("warehouse_sell/schema",t)},function(t){return e.refresh_model("commercial_rent/schema",t)},function(t){return e.refresh_model("commercial_sell/schema",t)}])},t}(n)}),require.register("controllers/single-refresh-controller",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("controllers/auth-controller"),r=t("models/refresh-model"),o=t("mediator"),i.exports=s=function(e){function t(){return this.refresh_localstorage=a(this.refresh_localstorage,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.initialize=function(){return this.subscribeEvent("refresh_localstorage",this.refresh_localstorage)},t.prototype.refresh_localstorage=function(e){var t,i=this;return t={},t.model=e,t.type="data",this.model=new r,this.model.fetch({data:t,success:function(){return i.publishEvent("log:info","data with "+t.model+" "+t.type+" fetched ok"),_.isObject(i.model.attributes[t.model])?localStorage.setObject(""+t.model,i.model.attributes[t.model]):void 0},error:function(){return i.publishEvent("tell_user","Brak połączenia z serwerem - dane nie zostały odświerzone")}})},t}(n)}),require.register("controllers/structure-controller",function(e,t,i){var n,r,s,o,a,l,u,h,c,p,d,f,m={}.hasOwnProperty,g=function(e,t){function i(){this.constructor=e}for(var n in t)m.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},y=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};r=t("controllers/base/controller"),d=t("views/structure-view"),o=t("views/header-view"),s=t("views/footer-view"),h=t("views/footer-edit-view"),u=t("views/footer-list-view"),l=t("views/left-panel-view"),a=t("views/info-view"),n=t("views/confirm-view"),f=t("views/viewed-view"),c=t("views/popgeneric-view"),i.exports=p=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.beforeAction=function(e,t){var i,r,p,m;return this.publishEvent("log:info","StructureController start ------------"),this.compose("structure",d),this.compose("header",o,{region:"header"}),i=["listing#add","listing#show","client#add","client#show","client-public#show","branch#add","branch#show","agent#add","agent#show","bon#show","graphic#add","graphic#show","export#add","export#show"],r=["listing#list","client#list","client-public#list","branch#list","agent#list","bon#list","graphic#list","export#list"],p=t.name,y.call(i,p)>=0?this.compose("footer-nav",h,{region:"footer"}):(m=t.name,y.call(r,m)>=0?this.compose("footer-list",u,{region:"footer"}):this.compose("footer",s,{region:"footer"})),this.compose("panel-left",l),this.compose("info",a,{region:"info"}),this.compose("viewed",f,{region:"viewed"}),this.compose("confirm",n,{region:"confirm"}),this.compose("popgeneric",c,{region:"popgeneric"}),this.publishEvent("structureController:render"),this.publishEvent("log:info","structureController done ----------")},t}(r)}),require.register("initialize",function(e,t){var i,n;i=t("application"),n=t("routes"),$(function(){return new i({controllerSuffix:"-controller",pushState:!1,routes:n}),Storage.prototype.setObject=function(e,t){return this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t;return t=this.getItem(e),t&&JSON.parse(t)}})}),require.register("lib/support",function(e,t,i){var n,r,s;n=t("chaplin"),s=t("lib/utils"),r=s.beget(n.support),i.exports=r}),require.register("lib/utils",function(e,t,i){var n,r;n=t("chaplin"),r=n.utils.beget(n.utils),i.exports=r}),require.register("lib/view-helper",function(e,t){var i;i=t("mediator")}),require.register("mediator",function(e,t,i){var n;n=i.exports=Chaplin.mediator}),require.register("models/agent-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/agent-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/agenci",t}(Chaplin.Collection)}),require.register("models/agent-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/agenci",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={is_active:"1",is_active_func:function(){return this.get("is_active")?"tak":"nie"},is_admin_func:function(){return this.get("is_admin")?"tak":"nie"},agent_type_func:function(){switch(this.get("agent_type")){case 0:return"pośrednik";case 1:return"admin. nieruch.";case 2:return"menadzer";case 3:return"IT"}},branch_func:function(){return this.get("branch")?localStorage.getObject("branches")[""+this.get("branch")]:void 0}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["agent","agenci"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t}(Chaplin.Model)}),require.register("models/base/collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("chaplin"),s=t("models/base/model"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=s,t}(n.Collection)}),require.register("models/base/model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("chaplin"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t}(n.Model)}),require.register("models/bon-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/biura",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["biuro","biura"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t}(Chaplin.Model)}),require.register("models/branch-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/branch-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/oddzialy",t}(Chaplin.Collection)}),require.register("models/branch-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/oddzialy",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={is_main_func:function(){return this.get("is_main")?"tak":"nie"}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["oddział","oddzialy"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t}(Chaplin.Model)}),require.register("models/client-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/client-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/klienci",t}(Chaplin.Collection)}),require.register("models/client-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/klienci",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={is_private:"",client_type_func:function(){switch(this.get("client_type")){case 1:return"kupujący";case 2:return"sprzedający";case 3:return"wynajmujący";case 4:return"najemca"}},agent_func:function(){return localStorage.getObject("agents")[""+this.get("agent")]}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.initialize=function(){return this.on("change:surname",this.onChange),this.on("add",this.onAdd),this.on("remove",this.onRemove),this.on("destroy",this.onDestory)},t.prototype.onChange=function(){var e;return this.publishEvent("log:info","--> "+this.module_name[0]+" changed"),e=this,_.delay(function(){return e.publishEvent("modelchanged","client"),e.publishEvent("refresh_localstorage","clients")},30)},t.prototype.onAdd=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" add")},t.prototype.onDestroy=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" destroyed"),this.publishEvent("modelchanged","client")},t.prototype.onRemove=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" removed")},t.prototype.module_name=["klient","klienci"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t}(Chaplin.Model)}),require.register("models/client-public-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/client-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/klienci-wspolni",t}(Chaplin.Collection)}),require.register("models/export-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/export-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/eksporty",t}(Chaplin.Collection)}),require.register("models/export-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/eksporty",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={is_active:"1",is_active_func:function(){return this.get("is_active")?"tak":"nie"},branch_func:function(){return this.get("branch")?localStorage.getObject("branches")[""+this.get("branch")]:void 0},date_created_func:function(){var e;return"function"==typeof(e=this.get("date_created")).substr?e.substr(0,10):void 0},next_export_func:function(){switch(parseInt(this.get("next_export"))){case 0:return"Pełny";case 1:return"Przyrostowy"}}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["eksport","eksporty"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t.prototype.initialize=function(){return this.on("change:name",this.onChange),this.on("add",this.onAdd),this.on("remove",this.onRemove),this.on("destroy",this.onDestory)},t.prototype.onChange=function(){var e;return this.publishEvent("log:info","--> "+this.module_name[0]+" changed"),e=this,_.delay(function(){return e.publishEvent("modelchanged","client")},30)},t.prototype.onAdd=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" add")},t.prototype.onDestroy=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" destroyed"),this.publishEvent("modelchanged","client")},t.prototype.onRemove=function(){return this.publishEvent("log:info","--> "+this.module_name[0]+" removed")},t}(Chaplin.Model)}),require.register("models/graphic-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/graphic-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/grafiki",t}(Chaplin.Collection)}),require.register("models/graphic-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/grafiki",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={is_active:"1",opacity:"100",is_active_func:function(){return this.get("is_active")?"tak":"nie"},thumbnail_func:function(){var e,t,i;return i=this.get("resources"),_.isEmpty(i)||(t=i[0],"image"!==t.mime_type.split("/")[0])?void 0:(e=new Image,e.src="data:"+t.mime_type+";base64,"+t.thumbnail,e.outerHTML)},branch_func:function(){return this.get("branch")?localStorage.getObject("branches")[""+this.get("branch")]:void 0},image_type_func:function(){switch(parseInt(this.get("image_type"))){case 0:return"logo";case 1:return"znak wodny"}},position_func:function(){switch(parseInt(this.get("position"))){case 0:return"lewy górny";case 1:return"prawy górny";case 2:return"lewy dolny";case 3:return"prawy dolny"}}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["grafika","grafiki"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t}(Chaplin.Model)}),require.register("models/listing-collection",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("models/listing-model"),s=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.initialize=function(){return this.query={},this.query_add(this.query_defaults())},t.prototype.model=r,t.prototype.url=""+s.server_url+"v1/oferty",t.prototype.query_defaults=function(){return{branch:s.models.user.get("branch_id"),agent:s.models.user.get("id"),status:1}},t.prototype.query_add=function(e){return _.extend(this.query,e)},t.prototype.query_remove=function(e){return this.query=_.omit(this.query,e)},t}(Chaplin.Collection)}),require.register("models/listing-model",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.urlRoot=""+r.server_url+"v1/oferty",t.prototype.schema={},t.prototype.get=function(e){var t;return t=Backbone.Model.prototype.get.call(this,e),_.isFunction(t)?t.call(this):t},t.prototype.defaults={thumbnail_func:function(){var e,t,i;return i=this.get("resources"),_.isEmpty(i)||(t=i[0],"image"!==t.mime_type.split("/")[0])?void 0:(e=new Image,e.src="data:"+t.mime_type+";base64,"+t.thumbnail,e.outerHTML)},date_created_func:function(){var e;return"function"==typeof(e=this.get("date_created")).substr?e.substr(0,10):void 0},date_modyfied_func:function(){var e;return"function"==typeof(e=this.get("date_modyfied")).substr?e.substr(0,10):void 0},date_updated_func:function(){var e;return"function"==typeof(e=this.get("date_updated")).substr?e.substr(0,10):void 0},waluta_func:function(){return localStorage.getObject("choices")[""+this.get("waluta")]},agent_func:function(){return localStorage.getObject("agents")[""+this.get("agent")]},client_func:function(){return localStorage.getObject("clients")[""+this.get("client")]},rynek_func:function(){return localStorage.getObject("choices")[""+this.get("rynek")]},wylacznosc_func:function(){return this.get("wylacznosc")?"tak":"nie"},category_func:function(){return localStorage.getObject("categories_full")[""+this.get("category")]},status_func:function(){switch(this.get("status")){case 0:return"nieaktywna";case 1:return"aktywna";case 2:return"archiwalna";case 3:return"robocza";case 4:return"sprzedana";case 5:return"wynajęta";case 6:return"umowa przedwstępna";case 7:return"usunięta"}}},t.prototype.toJSON=function(){var e,t;return e={},t=Backbone.Model.prototype.toJSON.call(this),_.each(t,function(t,i){return e[i]=this.get(i)},this),e},t.prototype.module_name=["oferta","oferty"],t.prototype.get_url=function(){return"<a href='/"+this.module_name[1]+"/"+this.get("id")+"'>"+this.module_name[0].toUpperCase()+" #"+this.get("id")+"</a>"},t.prototype.initialize=function(){return this.on("change:agent",this.onChangeAgent),this.on("add",this.onAdd),this.on("remove",this.onRemove),this.on("destroy",this.onDestory)},t.prototype.onChangeAgent=function(e,t){return _.isUndefined(e.previous("agent"))?void 0:(console.log("--> model changed",e,t),e.save())},t}(Chaplin.Model)}),require.register("models/login-model",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return this.update_db=s(this.update_db,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.url=""+r.server_url+"v1/login",t.prototype.update_db=function(){var e,t,i,n;localStorage.clear(),i=this.get("schemas");for(e in i)t=i[e],localStorage.setObject(e,t);n=this.get("forms");for(e in n)t=n[e],localStorage.setObject(e,t);return localStorage.setObject("categories",this.get("categories")),localStorage.setObject("categories_full",this.get("categories_full")),localStorage.setObject("choices",this.get("choices")),localStorage.setObject("agents",this.get("agents")),localStorage.setObject("branches",this.get("branches")),localStorage.setObject("clients",this.get("clients")),localStorage.setObject("account",this.get("account")),localStorage.setObject("latest",this.get("latest")),localStorage.setObject("latest_modyfied",this.get("latest_modyfied")),localStorage.setObject("update_needed",this.get("update_needed")),localStorage.setObject("portals",this.get("portals")),this.set({is_logged:!0})},t}(Chaplin.Model)}),require.register("models/refresh-model",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return this.urlRoot=s(this.urlRoot,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.urlRoot=function(){return""+r.server_url+"v1/refresh"},t}(Chaplin.Model)}),require.register("routes",function(e,t,i){i.exports=function(e){return e("","home#show"),e("klienci/dodaj","client#add"),e("klienci","client#list"),e("klienci/:id","client#show"),e("klienci-wspolni","client-public#list"),e("klienci-wspolni/:id","client-public#show"),e("login","login#show"),e("biura/:id","bon#show"),e("oddzialy/dodaj","branch#add"),e("oddzialy","branch#list"),e("oddzialy/:id","branch#show"),e("agenci/dodaj","agent#add"),e("agenci","agent#list"),e("agenci/:id","agent#show"),e("oferty/dodaj","listing#add"),e("oferty","listing#list"),e("oferty/:id","listing#show"),e("iframe/:template","iframe#show"),e("grafiki","graphic#list"),e("grafiki/dodaj","graphic#add"),e("grafiki/:id","graphic#show"),e("eksporty","export#list"),e("eksporty/dodaj","export#add"),e("eksporty/:id","export#show")}}),require.register("views/agent-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: agent list afterRender()")},t}(r)}),require.register("views/agent-view",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("views/edit-view"),r=t("mediator"),i.exports=n=function(e){function t(){return this.attach=s(this.attach,this),this.back_action=s(this.back_action,this),this.delete_action=s(this.delete_action,this),this.save_action=s(this.save_action,this),this.initialize=s(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.publishEvent("log:info","edit vewq")},t.prototype.save_action=function(){var e=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return e.publishEvent("tell_user","Rekord "+e.model.get_url()+" zapisany"),e.model.id!==r.models.user.get("id")||e.model.get(["username"])===r.models.user.get("username")&&e.model.get(["password"])===r.models.user.get("user_pass")?Chaplin.utils.redirectTo({url:"/agenci"}):(e.publishEvent("log:info","password/username changed relogin required"),r.models.user.clear(),Chaplin.utils.redirectTo({url:"/login"}))
},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return r.collections.agents.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/agenci"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/agenci"})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),r.models.user.get("is_admin")===!1?$("[data-fields='is_admin'] select").slider("disable"):void 0},t}(n)}),require.register("views/autologin-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/base/view"),o=t("views/templates/login"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.login=a(this.login,this),this.initialize=a(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.autoRender=!0,t.prototype.template=o,t.prototype.id="login",t.prototype.attributes={"data-role":"popup","data-overlay-theme":"b","data-theme":"b","data-dismissible":"false",style:"max-width:400px;"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.model=s.models.user,this.template=o,this.delegate("click","#login-verification",this.login),this.on("addedToDOM",this.login)},t.prototype.login=function(){var e,t,i,n,r,o,a=this;return this.publishEvent("log:error","autologin------"),this.user="admin@novum",this.pass="admin",e=CryptoJS.HmacSHA256(this.model.url,s.app_key),t=e.toString(CryptoJS.enc.Hex),r=CryptoJS.HmacSHA256(this.model.url,this.pass),o=r.toString(CryptoJS.enc.Hex),n=""+s.app+","+t+","+this.user+","+o,i=btoa(n),this.model.fetch({headers:{"X-Auth-Token":i},success:function(){return a.publishEvent("log:info","login SUCCESS"),a.model.set({user_pass:a.pass}),a.model.set({company_name:a.user.split("@")[1]}),a.model.update_db(),$("#first-name-placeholder").text(a.model.get("first_name")||a.model.get("username")),$("#bon-config-link").attr("href","/biura/"+a.model.get("company_id")),$("#agent-config-link").attr("href","/agenci/"+a.model.get("id")),a.publishEvent("tell_user","Logowanie zakończone."),Chaplin.utils.redirectTo({url:""})},error:function(e,t){return null!=t.responseJSON?$(".login-error").text(t.responseJSON.title):$(".login-error").text("Brak kontaktu z serwerem"),a.publishEvent("log:info","login FAILED")}})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: login afterRender()")},t}(r)}),require.register("views/base/collection-view",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("chaplin"),s=t("views/base/view"),i.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.getTemplateFunction=s.prototype.getTemplateFunction,t}(n.CollectionView)}),require.register("views/base/view",function(e,t,i){var n,r,s={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t("lib/view-helper"),r=t("mediator"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.getTemplateFunction=function(){return this.template},t.prototype.mp_request=function(e,t,i,n,s){var o;return o=this,$.ajax({url:t,beforeSend:function(e){return e.setRequestHeader("X-Auth-Token",r.gen_token(t))},type:i,success:function(){return o.publishEvent("tell_user",n)},error:function(e,t,i){return o.publishEvent("tell_user",s||e.responseText||i)}})},t}(Chaplin.View)}),require.register("views/bon-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.delete_action=o(this.delete_action,this),this.save_action=o(this.save_action,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.save_action=function(){var e=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return e.publishEvent("tell_user","Dane biura zostały zmienione "+e.model.get_url()+" zapisany")},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return e.publishEvent("log:info","Dyspozycja usunięcia konta przyjęta. Skontaktujemy się z państwem w celu potwierdzenia.")},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.attach=function(){var e;return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: bon-view afterRender()"),this.publishEvent("disable_buttons",null!=(e=this.can_edit)?e:!1,this.edit_type,!1,!0)},t}(r)}),require.register("views/branch-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: branch-list afterRender()")},t}(r)}),require.register("views/branch-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.back_action=o(this.back_action,this),this.delete_action=o(this.delete_action,this),this.save_action=o(this.save_action,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.save_action=function(){var e=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return null!=s.collections.branches&&s.collections.branches.add(e.model),e.publishEvent("tell_user","Rekord "+e.model.get_url()+" zapisany"),Chaplin.utils.redirectTo({url:"/oddzialy"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return s.collections.branches.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/oddzialy"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/oddzialy"})},t}(r)}),require.register("views/client-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: client list view afterRender()")},t}(r)}),require.register("views/client-public-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: client public list afterRender()")},t}(r)}),require.register("views/client-public-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.back_action=o(this.back_action,this),this.delete_action=o(this.delete_action,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return s.collections.clients_public.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/klienci-wspolni"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/klienci-wspolni"})},t}(r)}),require.register("views/client-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.back_action=o(this.back_action,this),this.attach=o(this.attach,this),this.delete_action=o(this.delete_action,this),this.refresh_form=o(this.refresh_form,this),this.save_action=o(this.save_action,this),this.save_and_add_action=o(this.save_and_add_action,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.save_and_add_action=function(){return t.__super__.save_and_add_action.apply(this,arguments),this.save_action("/klienci/dodaj")},t.prototype.save_action=function(e){var i=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return null!=s.collections.clients&&s.collections.clients.add(i.model),i.publishEvent("tell_user","Rekord "+i.model.get_url()+" zapisany"),Chaplin.utils.redirectTo({url:null!=e?e:"/klienci"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.refresh_form=function(){return Chaplin.utils.redirectTo({url:"/klienci/dodaj"})},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return s.collections.clients.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/klienci"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: clientadd afterRender()")},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/klienci"})},t}(r)}),require.register("views/confirm-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/confirm"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="confirm",t.prototype.attributes={"data-role":"popup","data-dismissible":"false","data-theme":"b"},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:confirm","HeaderView:attach()")},t}(r)}),require.register("views/edit-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/base/view"),s=t("mediator"),o=t("views/templates/upload"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.render=a(this.render,this),this.save_action=a(this.save_action,this),this.get_form=a(this.get_form,this),this.back_action=a(this.back_action,this),this.save_action=a(this.save_action,this),this.delete_action=a(this.delete_action,this),this.form_help=a(this.form_help,this),this.init_uploader=a(this.init_uploader,this),this.init_sortable=a(this.init_sortable,this),this.remove_resources=a(this.remove_resources,this),this.remove_resources_click=a(this.remove_resources_click,this),this.refresh_resource=a(this.refresh_resource,this),this.init_events=a(this.init_events,this),this.resource_preview=a(this.resource_preview,this),this.popup_position=a(this.popup_position,this),this.initialize=a(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.autoRender=!0,t.prototype.containerMethod="html",t.prototype.attributes={"data-role":"content"},t.prototype.id="content",t.prototype.className="ui-content",t.prototype.initialize=function(e){var i,n;return t.__super__.initialize.apply(this,arguments),this.params=e,this.model=this.params.model,this.form_name=this.params.form_name,this.can_edit=this.params.can_edit,this.edit_type=this.params.edit_type,this.listing_type=null!=(i=this.params.listing_type)?i:!1,this.delete_only=null!=(n=this.params.delete_only)?n:!1,this.upload_multiple=!0,this.publishEvent("log:debug","form_name:"+this.form_name+", can_edit:"+this.can_edit+", listing_type:"+this.listing_type+", delete_only:"+this.delete_only+" "),this.subscribeEvent("delete:clicked",this.delete_action),this.subscribeEvent("popupbeforeposition",this.popup_position),this.subscribeEvent("save:clicked",this.save_action),this.subscribeEvent("back:clicked",this.back_action),this.delegate("click","a.form-help",this.form_help),this.delegate("click","[data-role='navbar']:first li",this.refresh_resource),this.delegate("click","[name='resources'] li a:first-child",this.resource_preview)},t.prototype.popup_position=function(){return console.log("popup position fired")},t.prototype.resource_preview=function(e){var t,i,n,r,o,a;return e.preventDefault(),a=e.target.id,r=e.target.dataset.preview,this.publishEvent("log:info",""+a+","+r+", "+e),n=new Image,n.src="true"===r?""+s.upload_url+"/"+a+"/"+s.models.user.get("company_name"):"images/file.png",t="<a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right'>Zamknij</a>",o="<a href='"+s.upload_url+"/"+a+"/"+s.models.user.get("company_name")+"?download=true' class='ui-btn ui-btn-inline'>Zapisz na dysku</a>",i=""+t+n.outerHTML+"<br />"+o,setTimeout(function(){return $("#resource_preview").html(i).popup("open")},1e3)},t.prototype.init_events=function(){return this.editor=this.form.fields.resources.editor,this.editor.on("add",this.refresh_resource),this.delegate("click","[data-action='remove']",this.remove_resources_click)},t.prototype.refresh_resource=function(){var e,t;this.publishEvent("log:debug","refresh_resource"),t=$("#resource_list"),e=$("#resource_list li"),this.publishEvent("log:debug","marked: "+t+e);try{t.listview("refresh"),t.trigger("updatelayout")}catch(i){this.publishEvent("log:warn",i)}return this.publishEvent("log:info","resources empty: "+_.isEmpty(this.form.fields.resources.editor.getValue())),this.upload_multiple!==!1||_.isEmpty(this.form.fields.resources.editor.getValue())?(this.publishEvent("log:info","upload allowed  - reseting button"),$("#upload a:first").removeClass("ui-state-disabled"),$("#upload input").css("display","inline")):(this.publishEvent("log:info","one upload allowed  - removing button "),$("#upload a:first").addClass("ui-state-disabled"),$("#upload input").css("display","none"))},t.prototype.remove_resources_click=function(e){var t,i=this;return t=this,e.preventDefault(),this.uuid=e.target.id,$("#confirm").popup("open"),$("#confirmed").unbind().click(function(){return t.remove_resources(i.uuid)})},t.prototype.remove_resources=function(e){var t,i;return t=this,i=""+s.upload_url+"/"+e,$.ajax({url:i,beforeSend:function(e){return e.setRequestHeader("X-Auth-Token",s.gen_token(i))},type:"DELETE",success:function(){var i,n,r,s,o;for(n=t.form.fields.resources.getValue(),r=[],s=0,o=n.length;o>s;s++)i=n[s],i.uuid===e&&t.form.fields.resources.editor.removeItem(i,n.indexOf(i));return t.refresh_resource()},error:function(e,i,n){return t.publishEvent("tell_user",e.responseJSON.title||n)}})},t.prototype.init_sortable=function(){var e;return e=this,$("#resource_list").sortable({stop:function(){var t,i,n,r,s,o,a,l,u;if(i=[],s=[],r=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/,$(this).children("li").find("a:first").each(function(e,t){return i.push(t.innerHTML.match(r)[0])}),o=e.form.fields.resources.getValue(),o.length>0){for(u=[],a=0,l=o.length;l>a;a++)t=o[a],n=i.indexOf(t.uuid)+1,u.push(t.order=n);return u}}})},t.prototype.init_uploader=function(){var e;return e=this,this.$el.append(o),this.uploader=new qq.FineUploader({element:$("#upload")[0],multiple:e.upload_multiple,request:{endpoint:""+s.upload_url,customHeaders:{"X-Auth-Token":s.gen_token(""+s.upload_url)}},callbacks:{onSubmit:function(t){return e.publishEvent("log:info","download submitted "+t)},onComplete:function(t,i,n){var r,s;return n.success===!0?(s=e.form.fields.resources.getValue().length,r={mime_type:n.mime_type,uuid:n.uuid,thumbnail:n.thumbnail,filename:n.filename,size:n.size,order:s+1},e.form.fields.resources.editor.addItem(r,!0),e.publishEvent("log:info","download complete "+arguments)):(e.publishEvent("log:info","download failed "+arguments),e.publishEvent("tell_user","Plik nie został pomyślnie przesłany na serwer "))}},cors:{expected:!0},validation:{sizeLimit:2048e3}})},t.prototype.form_help=function(e){return this.publishEvent("tell_user",e.target.text)},t.prototype.delete_action=function(){return this.publishEvent("log:info","delete  caught")},t.prototype.save_action=function(){return this.publishEvent("log:info","save_action  caught")},t.prototype.back_action=function(){return this.publishEvent("log:info","back_action  caught")},t.prototype.get_form=function(){return this.publishEvent("log:info","form name: "+this.form_name),window.model=this.model,this.form=new Backbone.Form({model:this.model,template:_.template(localStorage.getObject(this.form_name))}),window.form=this.form,this.form.render()},t.prototype.save_action=function(){return this.publishEvent("log:debug","save_action caugth")},t.prototype.render=function(){return t.__super__.render.apply(this,arguments),this.publishEvent("log:info","view: edit-view beforeRender()"),this.form_name.match("rent|sell")?void 0:(this.get_form(),this.$el.append(this.form.el),this.publishEvent("log:info","view: edit-view RenderEnd()"))},t.prototype.attach=function(){var e;return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: edit-view afterRender()"),this.publishEvent("disable_buttons",null!=(e=this.can_edit)?e:!1,this.edit_type,this.delete_only),this.form_name.match("rent|sell")||_.isObject(this.model.schema.resources)&&(this.publishEvent("log:info","view: attach initate uploader , sortable, events "),this.init_events(),this.init_uploader(),this.init_sortable()),this.publishEvent("jqm_refersh:render")},t}(r)}),require.register("views/export-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.delete_all_for_export=o(this.delete_all_for_export,this),this.select_all_for_export=o(this.select_all_for_export,this),this.set_full_export=o(this.set_full_export,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("click","#set_full_export",this.set_full_export),this.delegate("click","#select_all_for_export",this.select_all_for_export),this.delegate("click","#delete_all_for_export",this.delete_all_for_export),this.module_name="ExportListView"},t.prototype.set_full_export=function(e){var t;return e.preventDefault(),this.model=this.collection_hard.get(e.target.dataset["export"]),t=""+this.model.urlRoot+"/"+e.target.dataset["export"]+"/pelny",this.mp_request(this.model,t,"POST","Wszystkie oferty spełnające kryteria eksportu zostały zaznaczone")},t.prototype.select_all_for_export=function(e){var t;return this.publishEvent("log:info",""+this.module_name+" select_all_for_export id:"+e.target.id+" data:"+e.target.dataset["export"]),e.preventDefault(),this.model=this.collection_hard.get(e.target.dataset["export"]),t=""+this.model.urlRoot+"/"+e.target.dataset["export"]+"/zaznacz",this.mp_request(this.model,t,"POST","Wszystkie oferty spełnające kryteria eksportu zostały zaznaczone")},t.prototype.delete_all_for_export=function(e){var t;return this.publishEvent("log:info",""+this.module_name+" delete_all_for_export id:"+e.target.id+" data:"+e.target.dataset["export"]),e.preventDefault(),this.model=this.collection_hard.get(e.target.dataset["export"]),t=""+this.model.urlRoot+"/"+e.target.dataset["export"]+"/odznacz",this.mp_request(this.model,t,"POST","Wszystkie oferty spełnające kryteria eksportu zostały odznaczone")},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info",""+this.module_name+" afterRender()")},t}(r)}),require.register("views/export-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.back_action=o(this.back_action,this),this.delete_action=o(this.delete_action,this),this.refresh_form=o(this.refresh_form,this),this.save_action=o(this.save_action,this),this.set_export=o(this.set_export,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("change","#export_select",this.set_export)},t.prototype.set_export=function(e){var t,i,n,r,s,o,a;if(this.publishEvent("log:info","set_export called with "+e.target.value),r=localStorage.getObject("portals"),n=r[e.target.value]){for($("[name='name']").val(n.name),$("[name='address_ftp']").val(n.address_ftp),$("[name='login']").val(n.login),$("[name='password']").val(n.password),$("[name='folder_ftp']").val(n.folder_ftp),$("[name='code_offline']").val(n.code_offline),i=$("[name='format_type'] input")[n.format_type],a=$("[name='format_type'] input"),s=0,o=a.length;o>s;s++)t=a[s],$(t).prop("checked",!1).checkboxradio("refresh");return $(i).prop("checked",!0).checkboxradio("refresh")}},t.prototype.save_action=function(e){var i=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return null!=s.collections.exports&&s.collections.exports.add(i.model),i.publishEvent("tell_user","Rekord "+i.model.get_url()+" zapisany"),Chaplin.utils.redirectTo({url:null!=e?e:"/eksporty"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.refresh_form=function(){return Chaplin.utils.redirectTo({url:"/eksporty/dodaj"})},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return s.collections.exports.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/eksporty"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/eksporty"})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: export afterRender()")},t}(r)}),require.register("views/footer-edit-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/footer_edit"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.back=o(this.back,this),this["delete"]=o(this["delete"],this),this.save=o(this.save,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="footer",t.prototype.attributes={"data-role":"footer","data-position":"fixed","data-theme":"b"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("click","#delete-button",this["delete"]),this.delegate("click","#save-button",this.save),this.delegate("click","#back-button",this.back)},t.prototype.save=function(e){return e.preventDefault(),this.publishEvent("save:clicked")},t.prototype["delete"]=function(e){return e.preventDefault(),this.publishEvent("delete:clicked")},t.prototype.back=function(e){return e.preventDefault(),this.publishEvent("back:clicked")},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","FooterEditView:attach()"),this.publishEvent("jqm_footer_refersh:render")},t}(r)}),require.register("views/footer-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/footer_list"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="footer",t.prototype.attributes={"data-role":"footer","data-position":"fixed","data-theme":"b"},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","FooterView:attach"),this.publishEvent("jqm_footer_refersh:render")},t}(r)}),require.register("views/footer-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/footer_base"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="footer",t.prototype.attributes={"data-role":"footer","data-position":"fixed","data-theme":"b"},t.prototype.attach=function(){var e;return t.__super__.attach.apply(this,arguments),e=_.clone(this.el),_.delay(function(){return $("#footer-region").html("").append(e.outerHTML),$("#footer-region").enhanceWithin()},30),this.publishEvent("log:info","FooterView:attach"),this.publishEvent("jqm_footer_refersh:render")},t}(r)}),require.register("views/graphic-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e
};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: client list view afterRender()")},t}(r)}),require.register("views/graphic-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/edit-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.back_action=o(this.back_action,this),this.delete_action=o(this.delete_action,this),this.refresh_form=o(this.refresh_form,this),this.save_action=o(this.save_action,this),this.initialize=o(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.upload_multiple=!1},t.prototype.save_action=function(e){var i=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){return null!=s.collections.graphics&&s.collections.graphics.add(i.model),i.publishEvent("tell_user","Rekord "+i.model.get_url()+" zapisany"),Chaplin.utils.redirectTo({url:null!=e?e:"/grafiki"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.refresh_form=function(){return Chaplin.utils.redirectTo({url:"/grafiki/dodaj"})},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){return s.collections.graphics.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),Chaplin.utils.redirectTo({url:"/grafiki"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),Chaplin.utils.redirectTo({url:"/grafiki"})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: graphic afterRender()"),_.delay(this.refresh_resource,10)},t}(r)}),require.register("views/header-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};o=t("views/templates/header_base"),r=t("views/base/view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.getTemplateData=a(this.getTemplateData,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.template=o,t.prototype.containerMethod="html",t.prototype.id="header",t.prototype.attributes={"data-role":"header","data-theme":"b"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("click","#first-name-placeholder",this.login_screen),this.delegate("click","#info-btn",this.info_screen),this.delegate("click","#viewed-btn",this.viewed_screen),this.delegate("click","#account-status-btn",this.account_status)},t.prototype.login_screen=function(){return s.user={},s.controllers={},s.models={},Chaplin.utils.redirectTo({url:"/login"})},t.prototype.account_status=function(){var e,t;return e=localStorage.getObject("account"),t="<h4>Konto</h4><p>Liczba ofert: <b>"+e.total_listings+"</b><br />Przestrzeń dysku: <b>"+e.disk_usage+"</b><br />Status konta: <b>"+e.status+"</b></p>",$("#info").html(t),$("#info").popup("open",{positionTo:"#account-status-btn",transition:"fade"})},t.prototype.info_screen=function(){var e,t,i,n,r,o,a;for(i="",a=_.last(s.info,10),r=0,o=a.length;o>r;r++)t=a[r],i=""+i+"<li>"+t+"</li>";n="<h4>Info</h4><ul>"+i+"</ul>",$("#info").html(n),e=$("#info");try{e.enhanceWithin()}catch(l){this.publishEvent("log:warn",l)}return $("#info").popup("open",{positionTo:"#info-btn",transition:"fade"})},t.prototype.viewed_screen=function(){var e,t,i,n,r,o,a;for(i="",a=_.last(_.uniq(s.viewed),20),r=0,o=a.length;o>r;r++)t=a[r],i=""+i+"<li>"+t+"</li>";n="<h4>Ostatio oglądane</h4><br /> <ul data-role='listview' >"+i+"</ul>",$("#viewed").html(n),e=$("#viewed");try{e.enhanceWithin()}catch(l){this.publishEvent("log:warn",l)}return $("#viewed").popup("open",{positionTo:"#viewed-btn",transition:"fade"})},t.prototype.getTemplateData=function(){return{disk_usage:localStorage.getItem("disk_usage")}},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","HeaderView:attach()")},t}(r)}),require.register("views/home-page-view",function(e,t,i){var n,r,s,o,a,l=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,h=function(e,t){function i(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};a=t("views/templates/home"),s=t("views/base/view"),n=t("models/listing-collection"),o=t("mediator"),i.exports=r=function(e){function t(){return this.attach=l(this.attach,this),this.getTemplateData=l(this.getTemplateData,this),t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.autoRender=!0,t.prototype.containerMethod="html",t.prototype.attributes={"data-role":"content"},t.prototype.id="content",t.prototype.template=a,t.prototype.className="ui-content",t.prototype.getTemplateData=function(){var e,t,i;return e=new n,t=new n,i=new n,e.set(JSON.parse(localStorage.getObject("latest"))),t.set(JSON.parse(localStorage.getObject("latest_modyfied"))),i.set(JSON.parse(localStorage.getObject("update_needed"))),{latest:e.toJSON(),latest_modyfied:t.toJSON(),update_needed:i.toJSON()}},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","HomeView: attach()"),this.publishEvent("jqm_refersh:render")},t}(s)}),require.register("views/iframe-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/iframe"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.getTemplateData=o(this.getTemplateData,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.autoRender=!0,t.prototype.containerMethod="html",t.prototype.attributes={"data-role":"content"},t.prototype.id="content",t.prototype.template=s,t.prototype.className="ui-content",t.prototype.initialize=function(e){var t;return t={geodz:{url:"http://mapy.geoportal.gov.pl/imap/?gpmap=gp0&actions=acShowWgPlot",title:""},kw:{url:"http://ekw.ms.gov.pl/pdcbdkw/pdcbdkw.html",title:"Księgi wieczyste "},geo:{url:"http://maps.geoportal.gov.pl/webclient/",title:""},calendar:{url:"https://www.google.com/calendar",title:""}},this.url=t[e.template].url,this.title=t[e.template].title},t.prototype.getTemplateData=function(){return{title:this.title,url:this.url,width:$(document.body).width(),height:$(document.body).height()}},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","IFrameView: attach()")},t}(r)}),require.register("views/info-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/info"),r=t("views/base/view"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="info",t.prototype.attributes={"data-role":"popup","data-theme":"b","data-position-to":"window","data-arrow":"true"},t.prototype.className="ui-content",t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","HeaderView:attach()")},t}(r)}),require.register("views/layout",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("mediator"),i.exports=n=function(e){function t(){return this.jqm_table_refresh=s(this.jqm_table_refresh,this),this.jqm_recreate=s(this.jqm_recreate,this),this.jqm_footer_refersh=s(this.jqm_footer_refersh,this),this.jqm_page_refersh=s(this.jqm_page_refersh,this),this.jqm_refersh_alone=s(this.jqm_refersh_alone,this),this.jqm_refersh=s(this.jqm_refersh,this),this.jqm_leftpanel=s(this.jqm_leftpanel,this),this.jqm_init=s(this.jqm_init,this),this.log_error=s(this.log_error,this),this.log_warn=s(this.log_warn,this),this.log_info=s(this.log_info,this),this.log_debug=s(this.log_debug,this),this.disable_buttons=s(this.disable_buttons,this),this.disable_form=s(this.disable_form,this),this.server_error=s(this.server_error,this),this.tell_user=s(this.tell_user,this),this.tell_viewed=s(this.tell_viewed,this),this.schema_change=s(this.schema_change,this),this.jqm_loading_stop=s(this.jqm_loading_stop,this),this.jqm_loading_start=s(this.jqm_loading_start,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.initialize=function(){var e;return t.__super__.initialize.apply(this,arguments),this.log=r.online?console:console,this.log.info("layout init"),e=!0,e&&(this.subscribeEvent("structureController:render",this.jqm_init),this.subscribeEvent("leftpanel:render",this.jqm_leftpanel),this.subscribeEvent("schema_change",this.schema_change),this.subscribeEvent("jqm_refersh:render",this.jqm_refersh),this.subscribeEvent("jqm_page_refersh:render",this.jqm_page_refersh),this.subscribeEvent("jqm_footer_refersh:render",this.jqm_footer_refersh),this.subscribeEvent("loading_start",this.jqm_loading_start),this.subscribeEvent("loading_stop",this.jqm_loading_stop),this.subscribeEvent("disable_buttons",this.disable_buttons),this.subscribeEvent("disable_form",this.disable_form),this.subscribeEvent("table_refresh",this.jqm_table_refresh),this.subscribeEvent("server_error",this.server_error),this.subscribeEvent("tell_user",this.tell_user),this.subscribeEvent("tell_viewed",this.tell_viewed)),this.subscribeEvent("log:debug",this.log_debug),this.subscribeEvent("log:info",this.log_info),this.subscribeEvent("log:warn",this.log_warn),this.subscribeEvent("log:error",this.log_error)},t.prototype.jqm_loading_start=function(){return $.mobile.loading("show")},t.prototype.jqm_loading_stop=function(){return $.mobile.loading("hide")},t.prototype.schema_change=function(){return this.log.info("****************refreshing schema"),r.models.user.fetch()},t.prototype.tell_viewed=function(e){return r.viewed.push(e)},t.prototype.tell_user=function(e){return $("#info").html(e),r.info.push(e),setTimeout(function(){return $("#info").popup("open",{positionTo:"#info-btn",transition:"fade"})},100),setTimeout(function(){return $("#info").popup("close")},4e3)},t.prototype.server_error=function(){return this.log.debug("server error"),$("#info").text("Upss, brak kontaktu z serwerem..."),setTimeout(function(){return $("#info").popup("open",{positionTo:"#info-btn",transition:"fade"})},100),setTimeout(function(){return $("#info").popup("close")},3e3)},t.prototype.disable_form=function(e){return this.log.info("form disable caught"),e?void 0:($("form input:radio").checkboxradio("disable"),$("form :input").textinput({disabled:!0}),$("form [data-role='slider']").slider({disabled:!0}),$("form [data-role='controlgroup'] select").selectmenu("disable"))},t.prototype.disable_buttons=function(e,t,i,n){return this.log.info("form buttons disable caught"),"add"===t&&$("#delete-button").attr("disabled",!0),e||($("#delete-button").attr("disabled",!0),$("#save-button").attr("disabled",!0)),i&&$("#save-button").attr("disabled",!0),n?$("#back-button").attr("disabled",!0):void 0},t.prototype.log_debug=function(e){return this.log.debug(e)},t.prototype.log_info=function(e){return this.log.info(e)},t.prototype.log_warn=function(e){return this.log.warn(e)},t.prototype.log_error=function(e){return this.log.error(e)},t.prototype.jqm_init=function(){return this.log.info("layout: event jqm_init caugth"),$(function(){return $.mobile.initializePage(),$.mobile.loading("hide"),$("#left-panel").panel(),$("body > [data-role='panel'] [data-role='listview']").listview(),$("body > [data-role='panel'] [data-role='collapsible']").collapsible(),$("#info").popup({history:!1})})},t.prototype.jqm_leftpanel=function(){return this.log.info("layout: event jqm_menurender caugth")},t.prototype.jqm_refersh=function(){var e,t,i;return this.log.debug("layout: event jqm_refresh caugth"),i=this,e=function(e){return e()},t=function(e){return e()},e(function(){return $("#content-region").enhanceWithin(),t(function(){return i.publishEvent("jqm_finished_rendering"),i.log.debug("jqm_refresh finished")})})},t.prototype.jqm_refersh_alone=function(){var e,t,i,n;return e=function(e){return e()},t=function(e){return e()},i=function(e){return e()},n=this,e(function(){return n.jqm_loading_start(),n.tell_user("loading"),console.log(1),t(function(){return elf.jqm_refersh(),console.log(2),i(function(){return n.jqm_loading_stop(),console.log(3)})})})},t.prototype.jqm_page_refersh=function(){return this.log.info("layout: event jqm_page_refresh caugth"),$("#page").enhanceWithin(),$.mobile.loading("hide")},t.prototype.jqm_footer_refersh=function(){return this.log.info("layout: event jqm_footer_refresh caugth"),$("#footer-region").enhanceWithin()},t.prototype.jqm_recreate=function(){},t.prototype.jqm_table_refresh=function(){return this.log.info("layout: jqm_table_refresh "),$("#list-table").table("refresh")},t}(Chaplin.Layout)}),require.register("views/left-panel-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/base/view"),o=t("views/templates/left-panel"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.panel_close=a(this.panel_close,this),this.panel_beforeclose=a(this.panel_beforeclose,this),this.panel_open=a(this.panel_open,this),this.panel_beforeopen=a(this.panel_beforeopen,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.attributes={"data-role":"panel","data-position":"left","data-theme":"b"},t.prototype.id="left-panel",t.prototype.containerMethod="append",t.prototype.container="body",t.prototype.template=o,t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("panelbeforeopen",this.panel_beforeopen),this.delegate("panelbeforeclose",this.panel_beforeclose),this.delegate("panelopen",this.panel_open),this.delegate("panelclose",this.panel_close)},t.prototype.panel_beforeopen=function(){return this.publishEvent("log:info","before panel open"),$("#header").unwrap(),$("#content").unwrap(),$("#footer").unwrap()},t.prototype.panel_open=function(){return this.publishEvent("log:info","panel open"),$("#header").wrap("<div id='header-region'></div>"),$("#content").wrap("<div id='content-region'></div>"),$("#footer").wrap("<div id='footer-region'></div>"),this.publishEvent("jqm_refresh:render")},t.prototype.panel_beforeclose=function(){return this.publishEvent("log:info","panel before close")},t.prototype.panel_close=function(){return this.publishEvent("log:info","panel close"),this.publishEvent("jqm_refresh:render")},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","LeftPanelView: attach()")},t}(r)}),require.register("views/list-items-view",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("views/base/view"),r=t("mediator"),i.exports=n=function(e){function t(){return this.attach=s(this.attach,this),this.render=s(this.render,this),this.getTemplateData=s(this.getTemplateData,this),this.initialize=s(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.autoRender=!0,t.prototype.id="view-list",t.prototype.initialize=function(e){return this.template=e.template,this.collection=e.collection},t.prototype.getTemplateData=function(){return{collection:this.collection.toJSON(),agents:localStorage.getObject("agents"),clients:localStorage.getObject("clients"),branches:localStorage.getObject("branches")}},t.prototype.render=function(){return t.__super__.render.apply(this,arguments),this.publishEvent("log:info","subview: sub-view render()")},t.prototype.attach=function(){return $("#view-list").remove(),$("#view-menu").after(this.$el),this.collection.length>1&&$("#list-table").tablesorter({sortList:[[4,0]],headers:{0:{sorter:!1},1:{sorter:!1}}}),this.publishEvent("log:info","subview afterAttach()")},t}(n)}),require.register("views/list-view-collection",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("views/base/collection-view"),s=t("mediator"),i.exports=r=function(e){function i(){return this.attach=o(this.attach,this),this.render=o(this.render,this),this.getTemplateData=o(this.getTemplateData,this),this.selects_refresh=o(this.selects_refresh,this),this.refresh_action=o(this.refresh_action,this),this.filter_apply=o(this.filter_apply,this),this.filter_action=o(this.filter_action,this),this.select_action=o(this.select_action,this),this.select_all_action=o(this.select_all_action,this),this.query_action=o(this.query_action,this),this.open_column_popup=o(this.open_column_popup,this),i.__super__.constructor.apply(this,arguments)}return l(i,e),i.prototype.autoRender=!0,i.prototype.containerMethod="html",i.prototype.attributes={"data-role":"content"},i.prototype.id="content",i.prototype.className="ui-content",i.prototype.initialize=function(e){var n;return i.__super__.initialize.apply(this,arguments),this.params=e,this.filter={},this.collection_hard=this.params.collection,this.collection=_.clone(this.params.collection),this.listing_type=null!=(n=this.params.listing_type)?n:!1,this.template=t("views/templates/"+this.params.template),this.delegate("change","#select-action",this.select_action),this.delegate("change","#all",this.select_all_action),this.delegate("click","#refresh",this.refresh_action),this.delegate("change","[data-query]",this.query_action),this.delegate("change","#view-menu [data-filter]",this.filter_action),this.delegate("click","[href='#list-table-popup']",this.open_column_popup),this.publishEvent("log:debug",this.params),window.collection=this.collection_hard},i.prototype.open_column_popup=function(e){return this.publishEvent("log:info","coumn toggle popup"),e.preventDefault(),$("#list-table-popup").popup("open")},i.prototype.query_action=function(){return this.publishEvent("log:info","query_action called")},i.prototype.select_all_action=function(){var e;return e=$("#list-table>thead input:checkbox ").prop("checked"),$("#list-table>tbody input:checkbox ").prop("checked",e).checkboxradio("refresh")},i.prototype.select_action=function(e){var t,i,n;return i=$("#list-table>tbody input:checked "),console.log(i),n=this,t=function(e){$("#list-table>tbody input:checkbox ").prop("checked",!1).checkboxradio("refresh"),$("#select-action :selected").removeAttr("selected"),e=null},this.publishEvent("log:info","performing action "+e.target.value+" for offers "+i),i.length>0?"usun"===e.target.value?($("#confirm").popup("open"),$("#confirmed").unbind().click(function(){var e,r,s,o;for(s=0,o=i.length;o>s;s++)e=i[s],r=n.collection_hard.get($(e).attr("id")),r.destroy({wait:!0,success:function(){return Chaplin.EventBroker.publishEvent("log:info","Element usunięty id"+r.get("id")),n.collection_hard.remove(r),n.render(),Chaplin.EventBroker.publishEvent("tell_user","Element został usunięty")},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}});return $(this).off("click"),t(i)})):void 0:(this.publishEvent("tell_user","Musisz zaznaczyć przynajmniej jeden element ;)"),t(i))},i.prototype.filter_action=function(e){var t,i,n,r;return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.collection=_.clone(this.collection_hard),i=e.target.dataset.filter,t=e.target.id,this.undelegate("change","#"+t,this.filter_action),"checkbox"===e.target.type?(this.publishEvent("log:info",e.target.type),r=e.target.checked):"select-one"===e.target.type?(this.publishEvent("log:info",e.target.type),r=parseInt(e.target.value)):r=e.target.value,_.isNaN(r)?(this.filter=_.omit(this.filter,i),this.publishEvent("log:info","omiting "+i),console.log(this.filter)):this.filter[i]=r,this.publishEvent("log:debug",i),this.publishEvent("log:debug",r),console.log(this.filter),_.isEmpty(this.filter)?void 0:(n=this.collection_hard.where(this.filter),this.collection.reset(n))},i.prototype.filter_apply=function(){var e;return this.publishEvent("log:debug","filter apply"),obj[this.filter]!==!1?(console.log(obj),this.publishEvent("log:debug","filter apply"),e=this.collection_hard.where(obj),this.collection.reset(e)):(this.publishEvent("log:debug","filter reset"),this.collection=_.clone(this.collection_hard)),this.render()},i.prototype.refresh_action=function(e){var t=this;return e.preventDefault(),this.publishEvent("log:debug","refresh"),this.collection_hard.fetch({data:this.collection_hard.query||{},success:function(){return t.publishEvent("tell_user","Odświeżam listę elementów"),t.collection=_.clone(t.collection_hard),t.render()},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},i.prototype.selects_refresh=function(){var e,t,i,n;if(this.collection.query){i=this.collection.query,n=[];for(e in i)t=i[e],$("[data-query='"+e+"']").val(t),n.push($("[data-query='"+e+"']").selectmenu("refresh"));return n}},i.prototype.getTemplateData=function(){return{collection:this.collection.toJSON(),listing_type:this.listing_type,agents:localStorage.getObject("agents"),clients:localStorage.getObject("clients"),branches:localStorage.getObject("branches")}},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),$("#list-table-popup").remove(),$("#list-table-popup-popup").remove()},i.prototype.attach=function(){return i.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: list-view afterRender()"),this.collection.length>1&&$("#list-table").tablesorter({sortList:[[4,0]],headers:{0:{sorter:!1},1:{sorter:!1}}}),this.publishEvent("jqm_refersh:render"),this.publishEvent("table_refresh"),this.selects_refresh()},i}(n)}),require.register("views/list-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/base/view"),r=t("views/list-items-view"),o=t("mediator"),i.exports=n=function(e){function i(){return this.attach=a(this.attach,this),this.render_subview=a(this.render_subview,this),this.render=a(this.render,this),this.getTemplateData=a(this.getTemplateData,this),this.selects_refresh=a(this.selects_refresh,this),this.refresh_action=a(this.refresh_action,this),this.filter_apply=a(this.filter_apply,this),this.filter_action=a(this.filter_action,this),this.select_action=a(this.select_action,this),this.select_all_action=a(this.select_all_action,this),this.query_action=a(this.query_action,this),this.open_column_popup=a(this.open_column_popup,this),i.__super__.constructor.apply(this,arguments)}return u(i,e),i.prototype.autoRender=!0,i.prototype.containerMethod="html",i.prototype.attributes={"data-role":"content"},i.prototype.id="content",i.prototype.className="ui-content",i.prototype.initialize=function(e){var n;return i.__super__.initialize.apply(this,arguments),this.params=e,this.filter={},this.collection_hard=this.params.collection,this.collection=_.clone(this.params.collection),this.listing_type=null!=(n=this.params.listing_type)?n:!1,this.template=t("views/templates/"+this.params.template),this.sub_template=t("views/templates/"+this.params.template+"_items"),this.delegate("change","#select-action",this.select_action),this.delegate("change","#all",this.select_all_action),this.delegate("click","#refresh",this.refresh_action),this.delegate("change","[data-query]",this.query_action),this.delegate("change","#view-menu [data-filter]",this.filter_action),this.delegate("click","[href='#list-table-popup']",this.open_column_popup),this.publishEvent("log:debug",this.params)},i.prototype.open_column_popup=function(e){return this.publishEvent("log:info","coumn toggle popup"),e.preventDefault(),$("#list-table-popup").popup("open")},i.prototype.query_action=function(){return this.publishEvent("log:info","query_action called"),this.filter={}},i.prototype.select_all_action=function(){var e;return this.publishEvent("log:info","select all action"),e=$("#list-table>thead input:checkbox").prop("checked"),$("#list-table>tbody input:checkbox").prop("checked",e).checkboxradio("refresh")},i.prototype.select_action=function(e){var t,i,n,r,s,a,l,u,h,c,p,d,f,m,g,y,v=this;if(this.publishEvent("log:info","select action"),l=$("#list-table>tbody input:checked"),u=this,i=function(e){$("#list-table>tbody input:checkbox").prop("checked",!1).checkboxradio("refresh"),$("#select-action :selected").removeAttr("selected"),$("#select-action option:first").attr("selected","selected"),$("#select-action").selectmenu("refresh"),e=null,v.publishEvent("jqm_refersh:render")},this.publishEvent("log:info","performing action "+e.target.value+" for offers "+l),!(l.length>0))return this.publishEvent("tell_user","Musisz zaznaczyć przynajmniej jeden element!"),i(l);if("usun"===e.target.value&&($("#confirm").popup("open"),$("#confirmed").unbind().click(function(){var e,t,n,r;for(n=0,r=l.length;r>n;n++)e=l[n],t=u.collection_hard.get($(e).attr("id")),t.destroy({wait:!0,success:function(){return Chaplin.EventBroker.publishEvent("log:info","Element usunięty id"+t.get("id")),u.collection_hard.remove(t),u.render_subview(),Chaplin.EventBroker.publishEvent("tell_user","Element został usunięty")},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}});return $(this).off("click"),u.render_subview(),i(l)})),"zmien_agenta"===e.target.value){h="",g=localStorage.getObject("agents");for(s in g)p=g[s],h=""+h+"<li value='"+s+"'><a id='"+s+"'>"+p+"</a></li>";d="<h4>Wybierz Agenta</h4><br /><ul data-role='listview' id='agent-choose'>"+h+"</ul>",$("#popgeneric").html(d),t=$("#popgeneric");try{t.enhanceWithin()}catch(b){this.publishEvent("log:warn",b)}$("#popgeneric").popup("open",{transition:"fade"}),$("#agent-choose li").unbind().click(function(){var e,t,i,n;for($("#popgeneric").popup("close"),i=0,n=l.length;n>i;i++)e=l[i],t=u.collection_hard.get(e.id),t.set("agent",this.value);return $(this).off("click"),u.render_subview()}),i(l)}if("send-listing-client"===e.target.value){h="",y=localStorage.getObject("clients");for(s in y)p=y[s],h=""+h+"<li value='"+s+"'><a id='"+s+"'>"+p+"</a></li>";d="<h4>Wybierz Klienta</h4><br /><ul data-role='listview' id='client-choose'>"+h+"</ul>";try{$("#popgeneric").html(d).enhanceWithin()}catch(b){this.publishEvent("log:warn",b)}$("#popgeneric").popup("open",{transition:"fade"}),$("#client-choose li").unbind().click(function(){var e,t,i,n,r;for($("#popgeneric").popup("close"),n=0,r=l.length;r>n;n++)e=l[n],t=u.collection_hard.get(e.id),i=""+t.urlRoot+"/"+e.id+"/email/"+this.value+"?private=false",u.mp_request(t,i,"GET","Email wysłany","Email nie został wysłany");return $(this).off("click"),u.render_subview()}),i(l)}if("send-listing-address"===e.target.value){console.log(1),n='<form>\n<label for="email_send" class="ui-hidden-accessible">Email:</label>\n<input name="email_send" id="email_send" placeholder="Wprowadź email" value="" type="text" />\n<button data-icon="mail" id="address_submit">Wyślij</button>\n</form>';try{$("#popgeneric").html(n).enhanceWithin()}catch(b){this.publishEvent("log:warn",b)}$("#popgeneric").popup("open",{transition:"fade"}),$("#address_submit").unbind().click(function(e){var t,i,n,r,s;for(e.preventDefault(),$("#popgeneric").popup("close"),r=0,s=l.length;s>r;r++)t=l[r],i=u.collection_hard.get(t.id),n=""+i.urlRoot+"/"+t.id+"/email/"+$("#email_send").val()+"?private=false",u.mp_request(i,n,"GET","Email wysłany","Email nie został wysłany");return $(this).off("click"),u.render_subview()}),i(l)}if("wydruk-wewnetrzny"===e.target.value||"wydruk-klienta"===e.target.value){for(f=0,m=l.length;m>f;f++)r=l[f],a=this.collection_hard.get(r.id),"wydruk-wewnetrzny"===e.target.value&&(c=""+a.urlRoot+"/"+r.id+"/"+o.models.user.get("company_name")+"?private=true"),"wydruk-klienta"===e.target.value&&(c=""+a.urlRoot+"/"+r.id+"/"+o.models.user.get("company_name")+"?private=false"),window.location=c,$(this).off("click"),u.render_subview();return i(l)}},i.prototype.filter_action=function(e){var t,i,n,r;return this.publishEvent("log:info","filter_action_called"),e.preventDefault(),this.collection=_.clone(this.collection_hard),i=e.target.dataset.filter,t=e.target.id,this.undelegate("change","#"+t,this.filter_action),"checkbox"===e.target.type?(this.publishEvent("log:info",e.target.type),r=e.target.checked):"select-one"===e.target.type?(this.publishEvent("log:info",e.target.type),r=parseInt(e.target.value)):r=e.target.value,_.isNaN(r)?(this.filter=_.omit(this.filter,i),this.publishEvent("log:info","omiting "+i),this.publishEvent("log:info",this.filter)):this.filter[i]=r,this.publishEvent("log:debug",i),this.publishEvent("log:debug",r),_.isEmpty(this.filter)?this.render_subview():(n=this.collection_hard.where(this.filter),this.collection.reset(n),this.render_subview())},i.prototype.filter_apply=function(){var e;return this.publishEvent("log:debug","filter apply"),obj[this.filter]!==!1?(console.log(obj),this.publishEvent("log:debug","filter apply"),e=this.collection_hard.where(obj),this.collection.reset(e)):(this.publishEvent("log:debug","filter reset"),this.collection=_.clone(this.collection_hard)),this.render_subview()},i.prototype.refresh_action=function(e){var t=this;return e.preventDefault(),this.publishEvent("log:debug","refresh"),this.collection_hard.fetch({data:this.collection_hard.query||{},success:function(){return t.publishEvent("tell_user","Odświeżam listę elementów"),t.collection=_.clone(t.collection_hard),t.render_subview()
},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},i.prototype.selects_refresh=function(){var e,t,i,n;if(this.collection.query){i=this.collection.query,n=[];for(e in i)t=i[e],$("[data-query='"+e+"']").val(t),n.push($("[data-query='"+e+"']").selectmenu("refresh"));return n}},i.prototype.getTemplateData=function(){return{listing_type:this.listing_type,agents:localStorage.getObject("agents"),clients:localStorage.getObject("clients"),branches:localStorage.getObject("branches")}},i.prototype.render=function(){return i.__super__.render.apply(this,arguments),$("#list-table-popup").remove(),$("#list-table-popup-popup").remove()},i.prototype.render_subview=function(){return this.publishEvent("log:info","render sub_view"),this.subview("items",new r({template:this.sub_template,collection:this.collection})),this.subview("items").render(),this.publishEvent("jqm_refersh:render")},i.prototype.attach=function(){return i.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: list-view afterRender()"),this.publishEvent("jqm_refersh:render"),this.render_subview(),this.selects_refresh()},i}(s)}),require.register("views/listing-list-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/list-view"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=o(this.attach,this),this.query_action=o(this.query_action,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.query_action=function(e){var i,n=this;return t.__super__.query_action.apply(this,arguments),_.isEmpty(e.target.value)?(this.publishEvent("log:info","removing key "+e.target.dataset.query),this.collection_hard.query_remove(""+e.target.dataset.query)):(i={},i[e.target.dataset.query]=e.target.value,this.collection_hard.query_add(i)),this.publishEvent("log:info",""+e.target.value+","+typeof e.target.value),this.publishEvent("log:info",""+i+","+s.collections.listings.query),this.collection_hard.fetch({data:this.collection_hard.query,beforeSend:function(){return n.publishEvent("tell_user","Ładuje oferty...")},success:function(){return n.collection=_.clone(n.collection_hard),n.render()},error:function(){return n.publishEvent("server_error")}})},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","view: listing list view afterRender()")},t}(r)}),require.register("views/listing-tab-view",function(e,t,i){var n,r,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=t("views/base/view"),r=t("mediator"),i.exports=n=function(e){function t(){return this.attach=s(this.attach,this),this.render=s(this.render,this),this.initialize=s(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.autoRender=!0,t.prototype.className="ui-content",t.prototype.initialize=function(e){return this.template=e.template,this.id=e.id},t.prototype.render=function(){return t.__super__.render.apply(this,arguments),this.publishEvent("log:info","tabview: tab-view render()"),this.$el.append(this.template)},t.prototype.attach=function(){return $(this.container).find("form div:first").append(this.$el),this.publishEvent("log:info","tabview: tab-view afterAttach()")},t}(n)}),require.register("views/listing-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},h=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};s=t("views/edit-view"),r=t("views/listing-tab-view"),o=t("mediator"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.render_subview=a(this.render_subview,this),this.render=a(this.render,this),this.init_openstreet=a(this.init_openstreet,this),this.back_action=a(this.back_action,this),this.delete_action=a(this.delete_action,this),this.save_action=a(this.save_action,this),this.rerender_form=a(this.rerender_form,this),this.change_tab=a(this.change_tab,this),this.initialize=a(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.delegate("filterablebeforefilter","#autocomplete",_.debounce(this.address_search,1500)),this.delegate("click",".address_suggestion",this.fill_address),this.delegate("click","[data-role='navbar'] a",this.change_tab),this.delegate("change","[name='category']",this.rerender_form),this.delegate("click","#copy_address",this.copy_address),this.rendered_tabs=[],this.categories=localStorage.getObject("categories")},t.prototype.change_tab=function(e){var t;return e.preventDefault(),this.publishEvent("log:info","change tab "+e.target.attributes.href.value[1]),t="tab_"+e.target.attributes.href.value[5],this.render_subview(t)},t.prototype.rerender_form=function(e){var t,i,n,r;return r=parseInt(e.target.value),n=this.form_name.substring(0,this.form_name.length-5),i=this.categories[n],i!==r?(t=_.invert(this.categories),this.form_name=""+t[r]+"_form",this.model.schema=localStorage.getObject(""+t[r]+"_schema"),this.rendered_tabs=[],$("#content").empty(),this.render(),this.render_subview()):void 0},t.prototype.save_action=function(e){var i=this;return t.__super__.save_action.apply(this,arguments),this.publishEvent("log:info","commmit form"),_.isUndefined(this.form.commit({validate:!0}))?this.model.save({},{success:function(){var t;return null!=o.collections.listings&&o.collections.listings.add(i.model),i.publishEvent("tell_user","Rekord "+i.model.get_url()+" zapisany"),null!=(null!=(t=o.collections.listings)?t.query:void 0)?Chaplin.utils.redirectTo({url:null!=e?e:"/oferty?"+$.param(o.collections.listings.query)}):Chaplin.utils.redirectTo({url:null!=e?e:"/"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}}):this.publishEvent("tell_user","Błąd w formularzu!")},t.prototype.delete_action=function(){var e=this;return t.__super__.delete_action.apply(this,arguments),this.model.destroy({success:function(){var t,i;return null!=(t=o.collections.listings)&&t.remove(e.model),e.publishEvent("tell_user","Rekord został usunięty"),null!=(null!=(i=o.collections.listings)?i.query:void 0)?Chaplin.utils.redirectTo({url:"undefined"!=typeof url&&null!==url?url:"/oferty?"+$.param(o.collections.listings.query)}):Chaplin.utils.redirectTo({url:"undefined"!=typeof url&&null!==url?url:"/"})},error:function(e,t){return null!=t.responseJSON?Chaplin.EventBroker.publishEvent("tell_user",t.responseJSON.title):Chaplin.EventBroker.publishEvent("tell_user","Brak kontaktu z serwerem")}})},t.prototype.back_action=function(){return t.__super__.back_action.apply(this,arguments),null!=o.collections.listings==!0?Chaplin.utils.redirectTo({url:"/oferty?"+$.param(o.collections.listings.query)}):Chaplin.utils.redirectTo({url:"/"})},t.prototype.copy_address=function(e){return this.publishEvent("log:info","copy address event"),e.preventDefault(),$("[name='internet_postcode']").val($("[name='postcode']").val()),$("[name='internet_street']").val($("[name='street']").val()),$("[name='internet_town']").val($("[name='town']").val()),$("[name='internet_province']").val($("[name='province']").val()),$("[name='internet_town_district']").val($("[name='town_district']").val()),$("[name='internet_lat']").val($("[name='lat']").val()),$("[name='internet_lon']").val($("[name='lon']").val()),$("[name='internet_borough']").val($("[name='borough']").val()),$("[name='internet_county']").val($("[name='county']").val())},t.prototype.address_reset=function(){return this.publishEvent("log:info","address reset"),$("[name='internet_postcode']").val(""),$("[name='postcode']").val(""),$("[name='internet_street']").val(""),$("[name='street']").val(""),$("[name='internet_town']").val(""),$("[name='town']").val(""),$("[name='internet_province']").val(""),$("[name='province']").val(""),$("[name='internet_town_district']").val(""),$("[name='town_district']").val(""),$("[name='internet_lat']").val(""),$("[name='lat']").val(""),$("[name='internet_lon']").val(""),$("[name='lon']").val(""),$("[name='internet_borough']").val(""),$("[name='borough']").val(""),$("[name='internet_county']").val(""),$("[name='county']").val(""),$("[name='number']").val("")},t.prototype.fill_address=function(e){var t,i,n,r,s,o,a,l,u,h,c,p,d;for(this.publishEvent("log:info","fill address event"),this.address_reset(),a=this.response[e.target.value],$("[name='postcode']").val(a.address.postcode),$("[name='street']").val(a.address.road||a.address.pedestrian),$("[name='town']").val(a.address.city||a.address.village),$("[name='province']").val(a.address.state.replace("województwo ","")),$("[name='number']").val(a.address.house_number),$("[name='town_district']").val(a.address.city_district||a.address.suburb),$("[name='lat']").val(a.lat),$("[name='lon']").val(a.lon),r=a.display_name.split(","),p=0,d=r.length;d>p;p++)s=r[p],s.indexOf("powiat")>-1?n=s:s.indexOf("gmina")>-1&&(i=s);return this.publishEvent("log:info","county:"+n+", borough:"+i+", address.county:"+a.address.county+", address.borough:"+a.address.borough),$("[name='borough']").val(i||a.address.borough||a.address.village||a.address.city),$("[name='county']").val(n||a.address.county||""),t=$("ul#autocomplete.ui-listview"),$("ul#autocomplete.ui-listview > li").remove(),t.listview("refresh"),h=new OpenLayers.Projection("EPSG:4326"),l=new OpenLayers.Projection("EPSG:900913"),u=new OpenLayers.LonLat(a.lon,a.lat).transform(h,l),o=this.map.getLayerPxFromLonLat(u),this.marker.moveTo(o),c=14,this.map.setCenter(u,c)},t.prototype.address_search=function(e,t){var i,n,r,s,o;return s=this,n=$("ul#autocomplete.ui-listview"),i=$(t.input),o=i.val(),r="",n.html(""),window.ul=n,o&&o.length>2?(n.html("<li><div class='ui-loader'><span class='ui-icon ui-icon-loading'></span></div></li>"),n.listview("refresh"),$.ajax({url:"http://nominatim.openstreetmap.org/search",dataType:"json",crossDomain:!0,data:{q:i.val(),addressdetails:1,format:"json","accept-language":"pl",countrycodes:"pl"},success:function(e){var t,i,o,a;for(s.publishEvent("log:debug","response from address server "+JSON.stringify(e)),s.response=e,t=0,o=0,a=e.length;a>o;o++)i=e[o],r+="<li class='address_suggestion' value="+t+">"+i.display_name+"</li>",t++;return n.html(r),n.listview("refresh"),n.trigger("updatelayout")},error:function(e){return s.publishEvent("log:error","no response from address server "+e),s.publishEvent("tell_user","Nie można połączyć się z serwerem adresowym")}})):void 0},t.prototype.init_openstreet=function(){return this.publishEvent("log:info","init openstreet map"),this.openstreet()},t.prototype.openstreet=function(){var e,t,i,n,r,s,o,a,l,u,h,c,p,d,f,m;return this.publishEvent("log:debug","opentstreet called"),OpenLayers.ImgPath="img/",$("#openmap").css("height","400px"),p=new OpenLayers.Projection("EPSG:4326"),h=new OpenLayers.Projection("EPSG:900913"),t=this.model.get("lat")||52.05,n=this.model.get("lon")||19.55,m=this.model.get("lat")?15:7,i=new OpenLayers.Layer.OSM,a=new OpenLayers.Layer.Markers("Markers",{projection:p,displayProjection:p}),f=new OpenLayers.Layer.Vector("Editable",{projection:p,displayProjection:p}),s=new OpenLayers.Map("openmap",{controls:[new OpenLayers.Control.PanZoom],units:"km",projection:p,displayProjection:p}),s.addLayers([i,f,a]),s.addControl(new OpenLayers.Control.MousePosition),s.addControl(new OpenLayers.Control.Navigation),s.addControl(new OpenLayers.Control.OverviewMap),s.addControl(new OpenLayers.Control.Attribution),r=new OpenLayers.LonLat(n,t).transform(p,s.getProjectionObject()),s.setCenter(r,m),d=new OpenLayers.Size(21,25),u=new OpenLayers.Pixel(-(d.w/2),-d.h),e=new OpenLayers.Icon("http://www.openlayers.org/dev/img/marker.png",d,u),o=new OpenLayers.Marker(new OpenLayers.LonLat(0,0).transform(p),e),a.addMarker(o),this.map=s,this.marker=o,this.model.get("lon")&&(c=new OpenLayers.LonLat(this.model.get("lon"),this.model.get("lat")).transform(p,h),l=this.map.getLayerPxFromLonLat(c),this.marker.moveTo(l),this.map.setCenter(c,m)),s.events.register("click",s,function(e){var t,i;return i=s.getLayerPxFromViewPortPx(e.xy),r=s.getLonLatFromPixel(e.xy),o.map=s,o.moveTo(i),t=o.lonlat.transform(h,p),$("[name='lat']").val(t.lat),$("[name='lon']").val(t.lon)})},t.prototype.render=function(){var e,i;return t.__super__.render.apply(this,arguments),this.get_form(),i=this.form.template(),e=$(i),e.find(".ui-grid-a").remove(),window.bt=e,this.$el.append(e),this.publishEvent("log:info","view: edit-view RenderEnd()")},t.prototype.render_subview=function(e){var t,i,n;return null==e&&(e="tab_1"),this.publishEvent("log:info","render sub_view "+e),0>h.call(this.rendered_tabs,e)?(t=$(this.form.el).find("#"+e),window.form=this.form,this.subview(e,new r({container:this.el,template:t,id:e})),this.subview(e).render(),"tab_2"===e&&this.init_openstreet(),"tab_6"===e&&(this.init_events(),this.init_uploader(),this.init_sortable()),"tab_1"===e&&(n=this.form_name.substring(0,this.form_name.length-5),i=this.categories[n],$("[name='category']").val(i)),this.publishEvent("jqm_refersh:render"),this.rendered_tabs.push(e)):void 0},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","listing-add attach"),this.render_subview()},t}(s)}),require.register("views/login-view",function(e,t,i){var n,r,s,o,a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,u=function(e,t){function i(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};r=t("views/base/view"),o=t("views/templates/login"),s=t("mediator"),i.exports=n=function(e){function t(){return this.attach=a(this.attach,this),this.login=a(this.login,this),this.open_dialog=a(this.open_dialog,this),this.initialize=a(this.initialize,this),t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.autoRender=!0,t.prototype.template=o,t.prototype.id="login",t.prototype.attributes={"data-role":"popup","data-overlay-theme":"b","data-theme":"b","data-dismissible":"false",style:"max-width:400px;"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.model=s.models.user,this.template=o,this.delegate("click","#login-verification",this.login),this.on("addedToDOM",this.open_dialog)},t.prototype.open_dialog=function(){return this.publishEvent("log:info","opening login popup"),$(function(){return $("#page").enhanceWithin(),$("#login").popup("open"),$("input#user").focus()})},t.prototype.login=function(e){var t,i,n,r,o,a,l=this;return e.preventDefault(),this.publishEvent("log:info","login attempt"),this.user=$("input#user").val(),this.pass=$("input#pass").val(),t=CryptoJS.HmacSHA256(this.model.url,s.app_key),i=t.toString(CryptoJS.enc.Hex),o=CryptoJS.HmacSHA256(this.model.url,this.pass),a=o.toString(CryptoJS.enc.Hex),r=""+s.app+","+i+","+this.user+","+a,n=btoa(r),this.model.fetch({headers:{"X-Auth-Token":n},success:function(){return l.publishEvent("log:info","login SUCCESS"),l.model.set({user_pass:l.pass}),l.model.set({company_name:l.user.split("@")[1]}),l.model.update_db(),$("#first-name-placeholder").text(l.model.get("first_name")||l.model.get("username")),$("#bon-config-link").attr("href","/biura/"+l.model.get("company_id")),$("#agent-config-link").attr("href","/agenci/"+l.model.get("id")),$("#login").popup("close"),l.publishEvent("tell_user","Logowanie zakończone."),Chaplin.utils.redirectTo({url:""})},error:function(e,t){return null!=t.responseJSON?$(".login-error").text(t.responseJSON.title):$(".login-error").text("Brak kontaktu z serwerem"),l.publishEvent("log:info","login FAILED")}})},t.prototype.attach=function(){return this.publishEvent("log:info","view: login afterRender()"),t.__super__.attach.apply(this,arguments)},t}(r)}),require.register("views/popgeneric-view",function(e,t,i){var n,r,s,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/popgeneric"),r=t("views/base/view"),i.exports=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="popgeneric",t.prototype.attributes={"data-role":"popup","data-theme":"b","data-position-to":"window","data-arrow":"true"},t.prototype.className="ui-content",t}(r)}),require.register("views/structure-view",function(e,t,i){var n,r,s,o,a,l=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,h=function(e,t){function i(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/base/view"),a=t("views/templates/base_structure"),o=t("mediator"),n=t("views/footer-view"),i.exports=r=function(e){function t(){return this.attach=l(this.attach,this),t.__super__.constructor.apply(this,arguments)}return h(t,e),t.prototype.container="body",t.prototype.containerMethod="html",t.prototype.id="page",t.prototype.attributes={"data-role":"page"},t.prototype.template=a,t.prototype.regions={page:"#page-region",content:"#content-region",header:"#header-region",footer:"#footer-region",info:"#info-region",viewed:"#viewed-region",login:"#login-region",confirm:"#confirm-region",popgeneric:"#popgeneric-region"},t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","structureView: attach()")},t}(s)}),require.register("views/templates/add_offer",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<h1>dodaj oferte</h1>\n\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/add_offer_footer",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('  <div data-role="navbar" data-iconpos="left">\n            <ul>\n        <li><a href="#" class="ui-btn-active" data-role="button" data-icon="grid">Dane oferty</a></li>\n        <li><a href="#oferta_zdjecia" data-role="button" data-icon="edit" >Zdjęcia oferty</a></li>\n        <li><a href="#oferta_notatki" data-role="button" data-icon="edit" >Ustawienia oferty</a></li>\n        <li><a href="#oferta_ustawienia" data-role="button" data-icon="edit">Informacje wewnętrzne</a></li>\n            </ul>\n          </div><!-- /navbar -->\n\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/agent_form",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("  <form>\n  <div class='ui-grid-a'>\n  <div class='ui-block-a'>\n  <h4>"),i.push(n(this.heading)),i.push('</h4>\n  <div data-fields="first_name"> </div>\n  <div data-fields="surname"> </div>\n  <div data-fields="username"> </div>\n  <div data-fields="password"> </div>\n  <div data-fields="email"> </div>\n  <div data-fields="licence_number"> </div>\n  <div data-fields="phone_primary"> </div>\n  <div data-fields="phone_secondary"> </div>\n  <div data-fields="gg"> </div>\n  <div data-fields="skype"> </div>\n</div>\n  <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n  <h4>Ustawienia</h4>\n  <div data-fields="branch"> </div>\n  <div data-fields="agent_type"> </div>\n  <div data-fields="agent_boss"> </div>\n  '),this.is_admin&&i.push('\n  <div data-fields="is_active"> </div>\n  <div data-fields="is_admin"> </div>\n  '),i.push("\n  <div id='avatar'>\n  <a class=\"ui-btn\">dodaj awatar</a>\n  </div>\n  "),this.can_edit&&(i.push("\n    "),"add"===this.mode&&i.push('\n        <a id=\'agent-add-refresh\' class="ui-btn ui-btn-inline ui-icon-recycle ui-btn-icon-right">Wyczyść</a>\n        <a id="agent-add-save" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Zapisz</a>\n    '),i.push("\n    "),"edit"===this.mode&&(i.push('\n        <a id="agent-edit-update" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Uaktualnij</a>\n        '),this.is_admin&&i.push('\n            <a id="agent-edit-delete" class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-right">Skasuj</a>\n        '),i.push("\n    ")),i.push("\n  ")),i.push("\n</div>\n</div>\n  </form>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/agent_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r;i.push('<div id="view-menu">\n    <form>\n        <fieldset data-role="controlgroup" data-type="horizontal" data-theme="b">\n            <button data-icon="refresh" data-iconpos="notext" id=\'refresh\'>Odśwież</button>\n            <a href=\'/agenci/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left" >Dodaj</a>\n\n            <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n            <select name="select-action" id="select-action">\n                <option selected disabled>Akcja</option>\n                <option value="usun">Usuń</option>\n            </select>\n            <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n            <select name="select-filter" id="select-filter" data-filter=\'agent_type\'>\n                <option selected disabled>Filtr</option>\n                <option value="">Wszyscy</option>\n                <option value="0">Pośrednik</option>\n                <option value="1">Administrator nieruchomości</option>\n                <option value="2">Menadzer</option>\n                <option value="3">Wsparcie IT</option>\n            </select>\n            <label for="branch-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n            <select name="branch-filter" id="branch-filter" data-filter=\'branch\'>\n                <option selected disabled>Oddział</option>\n                <option value="">Wszystkie</option>\n                '),r=this.branches;for(e in r)t=r[e],i.push('\n                <option value="'),i.push(n(e)),i.push('">'),i.push(n(t)),i.push("</option>\n                ");i.push("\n            </select>\n    </fieldset>\n</div>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/agent_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input"  data-column-btn-text="Kolumny" data-column-btn-theme="b" data-column-popup-theme="a">\n     <thead>\n       <tr class=\'th-groups\'>\n         <th width="2%"> <label> <input name="all" id="all" data-mini="true"  type="checkbox"> </label> </th>\n         <th>ID</th>\n         <th>Oddział&nbsp;&nbsp;</th>\n         <th>Imię&nbsp;&nbsp;</th>\n         <th data-priority="2">Nazwisko&nbsp;&nbsp;</th>\n         <th data-priority="2">Login&nbsp;&nbsp;</th>\n         <th data-priority="2">Email&nbsp;&nbsp;</th>\n         <th data-priority="4">Telefon&nbsp;&nbsp;</th>\n         <th data-priority="4">Aktywny&nbsp;&nbsp;</th>\n         <th data-priority="6">Admin&nbsp;&nbsp;</th>\n         <th data-priority="6">Typ&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td width="2%"> <label> <input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true"  type="checkbox"> </label> </td>\n         <td><a href=\'/agenci/'),i.push(n(e.id)),i.push("'>"),i.push(n(e.id)),i.push("</a></td>\n         <td>"),i.push(n(e.branch_func)),i.push("</td>\n         <td><a href='/agenci/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.first_name)),i.push("</a></td>\n         <td><a href='/agenci/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.surname)),i.push("</a></td>\n         <td><a href='/agenci/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.username)),i.push("</a></td>\n         <td>"),i.push(n(e.email)),i.push("</td>\n         <td>"),i.push(n(e.phone)),i.push("</td>\n         <td>"),i.push(n(e.is_active_func)),i.push("</td>\n         <td>"),i.push(n(e.is_admin_func)),i.push("</td>\n         <td>"),i.push(n(e.agent_type_func)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n   </table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/base_structure",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<!-- this is REGIONS ONLY -->\n<div id=\'header-region\' >\n</div><!-- header -->\n\n<div id=\'content-region\'>\n</div><!-- content -->\n\n<div id=\'footer-region\' >\n</div><!-- footer -->\n\n<div id="viewed-region">\n</div><!-- info-region -->\n\n<div id="info-region">\n</div><!-- info-region -->\n\n<div id="login-region">\n</div><!-- info-region -->\n\n<div id="confirm-region">\n</div><!-- info-region -->\n\n<div id="popgeneric-region">\n</div><!-- pop-region -->\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/bon_edit_form",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("  <form>\n  <h4>"),i.push(n(this.heading)),i.push('</h4>\n  <div data-fields="name"> </div>\n  <div data-fields="website"> </div>\n  <div data-fields="province"> </div>\n  <div data-fields="town"> </div>\n  <div data-fields="street"> </div>\n  <div data-fields="postcode"> </div>\n  <div data-fields="nip"> </div>\n  <div data-fields="regon"> </div>\n  <div data-fields="email"> </div>\n  <div data-fields="phone"> </div>\n  '),this.can_edit&&(i.push("\n    "),"edit"===this.mode&&i.push('\n        <a id="bon-edit-update" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Uaktualnij</a>\n        <a id="bon-edit-delete" class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-right">Usuń konto!</a>\n    '),i.push("\n  ")),i.push("\n  </form>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/branch_form",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("  <div class='ui-grid-a'>\n  <div class='ui-block-a'>\n  <form>\n  <h4>"),i.push(n(this.heading)),i.push('</h4>\n  <div data-fields="name"> </div>\n  <div data-fields="slug"> </div>\n  <div data-fields="email"> </div>\n  <div data-fields="phone"> </div>\n  <div data-fields="fax"> </div>\n  <div data-fields="nip"> </div>\n  <div data-fields="regon"> </div>\n</div>\n<div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n  <div data-fields="website"> </div>\n  <div data-fields="province"> </div>\n  <div data-fields="town"> </div>\n  <div data-fields="street"> </div>\n  <div data-fields="postcode"> </div>\n  <div data-fields="is_main"> </div>\n  '),this.is_admin&&(i.push("\n    "),"add"===this.mode&&i.push('\n    <a id="branch-add-refresh" href=\'/oddzialy/dodaj\' class="ui-btn ui-btn-inline ui-icon-recycle ui-btn-icon-right">Wyczyść</a>\n    <a id="branch-add-save" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Dodaj</a>\n    '),i.push("\n    "),"edit"===this.mode&&i.push('\n    <a id="branch-edit-update" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Uaktualnij</a>\n    <a id="branch-edit-delete" class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-right">Skasuj</a>\n    '),i.push("\n  ")),i.push("\n  </form>\n</div>\n</div>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/branch_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<div id="view-menu">\n            <fieldset data-role="controlgroup" data-type="horizontal" data-theme="b">\n                <button data-icon="refresh" data-iconpos="notext" id=\'refresh\'>Odśwież</button>\n                <a href=\'/oddzialy/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left" >Dodaj</a>\n\n                <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n                <select name="select-action" id="select-action">\n                    <option selected disabled>Akcja</option>\n                    <option value="usun">Usuń</option>\n                </select>\n            </fieldset>\n</div>\n')
}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/branch_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input"  data-column-btn-text="Wybierz kolumny" data-column-btn-theme="b" data-column-popup-theme="a">\n     <thead>\n       <tr class=\'th-groups\'>\n         <th> <label> <input name="all" id="all" data-mini="true"  type="checkbox"> </label> </th>\n         <th>ID</th>\n         <th data-priority="2">Nazwa&nbsp;&nbsp;</th>\n         <th data-priority="2">Identyfikator&nbsp;&nbsp;</th>\n         <th data-priority="2">WWW&nbsp;&nbsp;</th>\n         <th data-priority="5">Tel&nbsp;&nbsp;</th>\n         <th data-priority="4">Email&nbsp;&nbsp;</th>\n         <th data-priority="6">Miasto&nbsp;&nbsp;</th>\n         <th data-priority="6">Nip&nbsp;&nbsp;</th>\n         <th data-priority="6">Główny&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n       <tr>\n         <td> <label> <input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true"  type="checkbox"> </label> </td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td><a href='/oddzialy/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.name)),i.push("</a></td>\n         <td><a href='/oddzialy/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.slug)),i.push("</a></td>\n         <td>"),i.push(n(e.website)),i.push("</td>\n         <td>"),i.push(n(e.phone)),i.push("</td>\n         <td>"),i.push(n(e.email)),i.push("</td>\n         <td>"),i.push(n(e.town)),i.push("</td>\n         <td>"),i.push(n(e.nip)),i.push("</td>\n         <td>"),i.push(n(e.is_main_func)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n</table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/client_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<div id="view-menu">\n    <fieldset data-role="controlgroup" data-type="horizontal" data-theme=\'b\'>\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\' >Odśwież</button>\n        <a href=\'/klienci/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left " >Dodaj</a>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option selected disabled>Akcja</option>\n            <option value="usun">Usuń</option>\n            <option value="drukuj" disabled>Drukuj</option>\n            <option value="eksport" disabled>Eksport do pliku</option>\n        </select>\n        <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="select-filter" id="select-filter" data-filter=\'client_type\'>\n            <option selected disabled>Filtr</option>\n            <option value="">Wszyscy</option>\n            <option value="1">Kupujący</option>\n            <option value="2">Sprzedający</option>\n            <option value="3">Najemca</option>\n            <option value="4">Wynajmujący</option>\n        </select>\n    </fieldset>\n</div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/client_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input" data-mini="true"  data-column-btn-text="Kolumny" data-column-btn-theme="b" data-column-popup-theme="a" >\n     <thead>\n       <tr class=\'th-groups\'>\n         <th><label><input name="all" id="all" data-mini="true" type="checkbox"></label></th>\n         <th>ID</th>\n         <th>Agent&nbsp;&nbsp;</th>\n         <th>Imię&nbsp;&nbsp;</th>\n         <th data-priority="2">Nazwisko&nbsp;&nbsp;</th>\n         <th data-priority="2">Email&nbsp;&nbsp;</th>\n         <th data-priority="4">Telefon&nbsp;&nbsp;</th>\n         <th data-priority="5">Firma&nbsp;&nbsp;</th>\n         <th data-priority="6">Adres&nbsp;&nbsp;</th>\n         <th data-priority="6">Budżet&nbsp;&nbsp;</th>\n         <th data-priority="6">Typ&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td><label><input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true" type="checkbox"></label></td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td>"),i.push(n(e.agent_func)),i.push("</td>\n         <td><a href='/klienci/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.first_name)),i.push("</a></td>\n         <td><a href='/klienci/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.surname)),i.push("</a></td>\n         <td>"),i.push(n(e.email)),i.push("</td>\n         <td>"),i.push(n(e.phone)),i.push("</td>\n         <td>"),i.push(n(e.company_name)),i.push("</td>\n         <td>"),i.push(n(e.address)),i.push("</td>\n         <td>"),i.push(n(e.budget)),i.push("</td>\n         <td>"),i.push(n(e.client_type_func)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n   </table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/client_public_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<div id="view-menu">\n    <fieldset data-role="controlgroup" data-type="horizontal" data-theme="b">\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\'>Odśwież</button>\n        <a href=\'/klienci/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left" >Dodaj</a>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option selected disabled>Akcja</option>\n            <option value="usun">Usuń</option>\n            <option value="drukuj" disabled>Drukuj</option>\n            <option value="eksport" disabled>Eksport do pliku</option>\n        </select>\n        <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="select-filter" id="select-filter">\n            <option selected disabled>Filtr</option>\n            <option value="">Wszyscy</option>\n            <option value="1">Kupujący</option>\n            <option value="2">Sprzedający</option>\n            <option value="3">Najemca</option>\n            <option value="4">Wynajmujący</option>\n        </select>\n    </fieldset>\n</div><!-- /grid-b -->\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/client_public_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input" data-mini="true" data-column-btn-text="Kolumny" data-column-btn-theme="b" data-column-popup-theme="a">\n     <thead>\n       <tr class=\'th-groups\'>\n         <th> <label> <input name="all" id="all" data-mini="true"  type="checkbox"> </label> </th>\n         <th>ID</th>\n         <th>Agent&nbsp;&nbsp;</th>\n         <th>Imię&nbsp;&nbsp;</th>\n         <th data-priority="2">Nazwisko&nbsp;&nbsp;</th>\n         <th data-priority="2">Email&nbsp;&nbsp;</th>\n         <th data-priority="4">Telefon&nbsp;&nbsp;</th>\n         <th data-priority="5">Firma&nbsp;&nbsp;</th>\n         <th data-priority="6">Adres&nbsp;&nbsp;</th>\n         <th data-priority="6">Budżet&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td> <label> <input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true"  type="checkbox"> </label> </td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td>"),i.push(n(e.agent_func)),i.push("</td>\n         <td><a href='/klienci-wspolni/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.first_name)),i.push("</a></td>\n         <td><a href='/klienci-wspolni/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.surname)),i.push("</a></td>\n         <td>"),i.push(n(e.email)),i.push("</td>\n         <td>"),i.push(n(e.phone)),i.push("</td>\n         <td>"),i.push(n(e.company_name)),i.push("</td>\n         <td>"),i.push(n(e.address)),i.push("</td>\n         <td>"),i.push(n(e.budget)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n</table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/confirm",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('    <div data-role="header" data-theme="a">\n    <h1>Potwierdz usuwanie</h1>\n    </div>\n    <div role="main" class="ui-content">\n        <h3 class="ui-title">Napewno chcesz usunąć te elementy?</h3>\n    <p>Ta akcja jest nieodwracalna.</p>\n        <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" data-rel="back">Powrót</a>\n        <a href="#" id=\'confirmed\' class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" data-rel="back" data-transition="flow">Potwierdz</a>\n    </div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/export_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r;i.push('<div id="view-menu">\n    <fieldset data-role="controlgroup" data-type="horizontal" data-theme=\'b\'>\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\' >Odśwież</button>\n        <a href=\'/eksporty/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left " >Dodaj</a>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option selected disabled>Akcja</option>\n            <option value="usun">Usuń</option>\n        </select>\n        <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="select-filter" id="select-filter" data-filter=\'branch\'>\n            <option selected disabled>Oddziały</option>\n            <option value="">Wszystkie</option>\n            '),r=this.branches;for(e in r)t=r[e],i.push('\n            <option value="'),i.push(n(e)),i.push('">'),i.push(n(t)),i.push("</option>\n            ");i.push("\n        </select>\n    </fieldset>\n</div>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/export_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input"  data-column-btn-text="Wybierz kolumny" data-column-btn-theme="b" data-column-popup-theme="a" >\n     <thead>\n       <tr class=\'th-groups\'>\n         <th><label><input name="all" id="all" data-mini="true" type="checkbox"></label></th>\n         <th data-priority="6">ID</th>\n         <th>Nazwa&nbsp;&nbsp;</th>\n         <th>Adres ftp&nbsp;&nbsp;</th>\n         <th>Oddział&nbsp;&nbsp;</th>\n         <th data-priority="2">Login&nbsp;&nbsp;</th>\n         <th data-priority="5">Data&nbsp;&nbsp;</th>\n         <th data-priority="5">Limit ofert&nbsp;&nbsp;</th>\n         <th data-priority="5">Aktywny&nbsp;&nbsp;</th>\n         <th><abbr title="Typ następnego eksportu">Rodzaj eksportu</abbr>&nbsp;&nbsp;</th>\n         <th><abbr title="Dodaj wszystkie oferty do tego eksportu">Zaznacz oferty</abbr>&nbsp;&nbsp;</th>\n         <th><abbr title="Usuń wszystkie oferty z tego eksportu">Odznacz oferty</abbr>&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td><label><input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true" type="checkbox"></label></td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td><a href='/eksporty/"),i.push(n(e.id)),i.push("'>"),i.push(e.name),i.push("</a></td>\n         <td><a href='/eksporty/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.address_ftp)),i.push("</a></td>\n         <td><a href='/eksporty/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.branch_func)),i.push("</a></td>\n         <td><a href='/eksporty/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.login)),i.push("</a></td>\n         <td><a href='/eksporty/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.date_created_func)),i.push("</a></td>\n         <td>"),i.push(n(e.limit)),i.push("</td>\n         <td>"),i.push(n(e.is_active_func)),i.push('</td>\n         <th><a href="#" class="ui-btn" id=\'set_full_export\' data-export=\''),i.push(n(e.id)),i.push("'>"),i.push(n(e.next_export_func)),i.push('</a></th>\n         <th><a href="#" class="ui-btn" id=\'select_all_for_export\' data-export=\''),i.push(n(e.id)),i.push("'>Zaznacz oferty</a></th>\n         <th><a href=\"#\" class=\"ui-btn\" id='delete_all_for_export' data-export='"),i.push(n(e.id)),i.push("'>Odznacz oferty</a></th>\n       </tr>\n      ");i.push("\n     </tbody>\n</table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/footer_base",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<h4>Mobilny Pośrednik <a href='pixey.pl'>Pixey.pl</a> &copy;</h4>\n\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/footer_edit",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push(' <div data-role="navbar">\n        <ul>\n            <li><button id="delete-button" class="ui-btn ui-btn-icon-top ui-icon-delete">Usuń</button></li>\n            <li><button id="save-button" class="ui-btn ui-btn-icon-top ui-icon-check" >Zapisz</button></li>\n            <li><button id="back-button" class="ui-btn ui-btn-icon-top ui-icon-back">Wróć</button></li>\n        </ul>\n    </div><!-- /navbar -->\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/footer_empty",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/footer_list",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('            <div style=\'padding:2px 8px 2px 8px\' >\n         <input id="filterTable-input" data-type="search" data-filter-placeholder="Find cars..." data-theme="a" data-filter-theme="a" data-inset="true" />\n            </div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/graphic_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<div id="view-menu">\n    <fieldset data-role="controlgroup" data-type="horizontal" data-theme=\'b\'>\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\' >Odśwież</button>\n        <a href=\'/grafiki/dodaj\' class="ui-btn ui-icon-edit ui-btn-icon-left " >Dodaj</a>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option selected disabled>Akcja</option>\n            <option value="usun">Usuń</option>\n        </select>\n        <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="select-filter" id="select-filter" data-filter=\'image_type\'>\n            <option selected disabled>Filtr</option>\n            <option value="">Wszystko</option>\n            <option value="0">Logo</option>\n            <option value="1">Znak wodny</option>\n        </select>\n    </fieldset>\n</div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/graphic_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input"  data-column-btn-text="Wybierz kolumny" data-column-btn-theme="b" data-column-popup-theme="a" >\n     <thead>\n       <tr class=\'th-groups\'>\n         <th><label><input name="all" id="all" data-mini="true" type="checkbox"></label></th>\n         <th>ID</th>\n         <th>Grafika&nbsp;&nbsp;</th>\n         <th>Oddział&nbsp;&nbsp;</th>\n         <th data-priority="2">Typ grafiki&nbsp;&nbsp;</th>\n         <th data-priority="2">Pozycja&nbsp;&nbsp;</th>\n         <th data-priority="4">Przeźroczystość&nbsp;&nbsp;</th>\n         <th data-priority="5">Aktywna&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td><label><input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true" type="checkbox"></label></td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td>"),i.push(e.thumbnail_func),i.push("</td>\n         <td><a href='/grafiki/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.branch_func)),i.push("</a></td>\n         <td><a href='/grafiki/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.image_type_func)),i.push("</a></td>\n         <td><a href='/grafiki/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.position_func)),i.push("</a></td>\n         <td><a href='/grafiki/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.opacity)),i.push("%</a></td>\n         <td>"),i.push(n(e.is_active_func)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n</table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/header_base",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('    <div data-role="controlgroup" data-type="horizontal" class="ui-mini ui-btn-left">\n        <a href=\'#left-panel\' class=\'ui-btn ui-icon-bars ui-btn-icon-notext\' data-theme="b">Menu</a>\n        <button data-rel="popup" data-transition="pop" data-iconpos="notext" id=\'viewed-btn\' data-position-to="origin" class="ui-btn ui-btn-b ui-icon-eye ui-btn-icon-notext">Ostatnio</button>\n    </div>\n\n    <h1>MP</h1>\n\n    <div data-role="controlgroup" data-type="horizontal" class="ui-mini ui-btn-right">\n        <button data-rel="popup" data-transition="pop" data-iconpos="notext" id=\'account-status-btn\' data-position-to="origin" class="ui-btn ui-btn-b ui-btn-inline ui-icon-shop ui-btn-icon-notext">Konto</button>\n        <button data-rel="popup" data-transition="pop" data-iconpos="notext" id=\'info-btn\' data-position-to="origin" class="ui-btn ui-btn-b ui-btn-inline ui-icon-info ui-btn-icon-notext">Informacja</button>\n        <button id=\'first-name-placeholder\' class="ui-btn ui-btn-b ui-btn-icon-right ui-icon-power"></button>\n    </div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/home",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s,o,a,l,u,h,c;for(i.push('<ul data-role="listview" data-inset="true" data-divider-theme="a">\n<li data-role="list-divider">Ostatio Dodane</li>\n\n      '),u=this.latest,t=0,o=u.length;o>t;t++)e=u[t],i.push('\n            <li><a href="#oferty/'),i.push(n(e.id)),i.push('">\n              '),i.push(e.thumbnail_func),i.push("\n        <h3>"),i.push(n(e.remote_id)),i.push(" "),i.push(n(e.category_func)),i.push("</h3>\n        <p>"),i.push(n(e.town)),i.push(" "),i.push(n(e.street)),i.push(" "),i.push(n(e.number)),i.push("  "),i.push(n(e.cena)),i.push(n(e.waluta_func)),i.push('</p>\n        <p class="ui-li-aside">Ostatnio wprowadzone</p>\n            <span class="ui-li-count">'),i.push(n(e.date_created_func)),i.push("</span>\n            </a>\n            </li>\n      ");for(i.push('\n\n<li data-role="list-divider">Ostatnio Zmodyfikowane</li>\n\n      '),h=this.latest_modyfied,r=0,a=h.length;a>r;r++)e=h[r],i.push('\n            <li><a href="#oferty/'),i.push(n(e.id)),i.push('">\n              '),i.push(e.thumbnail_func),i.push("\n        <h3>"),i.push(n(e.remote_id)),i.push(" "),i.push(n(e.category_func)),i.push("</h3>\n        <p>"),i.push(n(e.town)),i.push(" "),i.push(n(e.street)),i.push(" "),i.push(n(e.number)),i.push(" "),i.push(n(e.cena)),i.push(n(e.waluta_func)),i.push('</p>\n        <p class="ui-li-aside">Ostatnia modyfikacja</p>\n            <span class="ui-li-count">'),i.push(n(e.date_modyfied_func)),i.push("</span>\n            </a>\n            </li>\n      ");for(i.push('\n\n<li data-role="list-divider">Wymagające Odświerzenia</li>\n\n      '),c=this.update_needed,s=0,l=c.length;l>s;s++)e=c[s],i.push('\n            <li><a href="#oferty/'),i.push(n(e.id)),i.push('">\n              '),i.push(e.thumbnail_func),i.push("\n        <h3>"),i.push(n(e.remote_id)),i.push(" "),i.push(n(e.category_func)),i.push(" </h3>\n        <p>"),i.push(n(e.town)),i.push(" "),i.push(n(e.street)),i.push(" "),i.push(n(e.number)),i.push("  "),i.push(n(e.cena)),i.push(n(e.waluta_func)),i.push('</p>\n        <p class="ui-li-aside">Ostatnie odświerzenie</p>\n            <span class="ui-li-count">'),i.push(n(e.date_updated_func)),i.push("</span>\n            </a>\n            </li>\n      ");i.push('\n\n<li data-role="list-divider">Status Eksportów</li>\n<li><a href="#eksporty">OK</a></li>\n</ul>\n')}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/iframe",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<h4>"),i.push(n(this.title)),i.push('</h4>\n<iframe src="'),i.push(n(this.url)),i.push("\" width='"),i.push(n(this.width)),i.push("px' height='"),i.push(n(this.height)),i.push("px'></iframe>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/info",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<p>Hi im info popup</p>\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/left-panel",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<!-- ##################################  PANEL -->\n\n					<ul data-role="listview" >\n						<li data-icon="delete" > <a href="#header" data-rel="close">Zamknij menu</a> </li>\n						<li data-icon="home" > <a href="/" >Początek</a> </li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n    <div data-role="collapsible" data-inset="false"  data-collapsed-icon="eye" data-expanded-icon="arrow-d">\n                    <h4>Przeglądaj oferty</h4>\n                    <ul data-role="listview" >\n                        <li><a href="/oferty?category=flat_rent"    >Mieszkania Wynajem</a></li>\n                        <li><a href="/oferty?category=flat_sell"    >Mieszkania Sprzedaż</a></li>\n                        <li><a href="/oferty?category=house_rent"    >Domy Wynajem</a></li>\n                        <li><a href="/oferty?category=house_sell"    >Domy Sprzedaż</a></li>\n                        <li><a href="/oferty?category=land_rent"    >Grunty Dzierżawa</a></li>\n                        <li><a href="/oferty?category=land_sell"    >Grunty Sprzedaż</a></li>\n                        <li><a href="/oferty?category=commercial_rent"    >Lokale Wynajem</a></li>\n                        <li><a href="/oferty?category=commercial_sell"    >Lokale Sprzedaż</a></li>\n                        <li><a href="/oferty?category=warehouse_rent"    >Hale Wynajem</a></li>\n                        <li><a href="/oferty?category=warehouse_sell"   >Hale Sprzedaż</a></li>\n                        <li><a href="/oferty?category=object_rent"   >Obiekty Wynajem</a></li>\n                        <li><a href="/oferty?category=object_sell"   >Obiekty Sprzedaż</a></li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n\n                <div data-role="collapsible" data-inset="false"  data-collapsed-icon="plus" data-expanded-icon="arrow-d">\n                    <h4>Dodaj ofertę</h4>\n                    <ul data-role="listview">\n                        <li><a href="/oferty/dodaj?type=flat_rent"    >Mieszkania Wynajem</a></li>\n                        <li><a href="/oferty/dodaj?type=flat_sell"    >Mieszkania Sprzedaż</a></li>\n                        <li><a href="/oferty/dodaj?type=house_rent"    >Domy Wynajem</a></li>\n                        <li><a href="/oferty/dodaj?type=house_sell"    >Domy Sprzedaż</a></li>\n                        <li><a href="/oferty/dodaj?type=land_rent"    >Grunty Dzierżawa</a></li>\n                        <li><a href="/oferty/dodaj?type=land_sell"    >Grunty Sprzedaż</a></li>\n                        <li><a href="/oferty/dodaj?type=commercial_rent"    >Lokale Wynajem</a></li>\n                        <li><a href="/oferty/dodaj?type=commercial_sell"    >Lokale Sprzedaż</a></li>\n                        <li><a href="/oferty/dodaj?type=warehouse_rent"    >Hale Wynajem</a></li>\n                        <li><a href="/oferty/dodaj?type=warehouse_sell"   >Hale Sprzedaż</a></li>\n                        <li><a href="/oferty/dodaj?type=object_rent"   >Obiekty Wynajem</a></li>\n                        <li><a href="/oferty/dodaj?type=object_sell"   >Obiekty Sprzedaż</a></li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n                        <!--\n    <div data-role="collapsible" data-inset="false"  data-collapsed-icon="tag" data-expanded-icon="arrow-d">\n                    <h3>Etykiety</h3>\n                    <ul data-role="listview" >\n                        <li ><a href="" >Dodaj Etykietę</a></li>\n                        <li><a href="/oferty?status=4" >Robocze<span class=\'ui-li-count\'>34</span></a> </li>\n                        <li><a href="/oferty?status=3" >Archiwalne<span class=\'ui-li-count\'>34</span></a> </li>\n                        <li><a href="/oferty?status=1" >Nieaktywna<span class=\'ui-li-count\'>34</span></a> </li>\n                        <li><a href="/oferty?status=5" >Sprzedana<span class=\'ui-li-count\'>34</span></a> </li>\n                        <li><a href="/oferty?status=6" >Wynajęta<span class=\'ui-li-count\'>34</span></a> </li>\n                        <li><a href="/oferty?status=7" >Umowa przedstępna<span class=\'ui-li-count\'>34</span></a> </li>\n                    </ul>\n                </div>\n                        -->\n    <div data-role="collapsible" data-inset="false" data-collapsed-icon="phone" data-expanded-icon="arrow-d">\n                    <h3>Kontrahenci</h3>\n                    <ul data-role="listview" >\n                        <li ><a href="/klienci/dodaj" >Dodaj Kontrahenta</a></li>\n                        <li ><a href="/klienci" >Moi</a></li>\n                        <li ><a href="/klienci-wspolni" >Wspólni</a></li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n\n    <div data-role="collapsible" data-inset="false" data-collapsed-icon="gear" data-expanded-icon="arrow-d">\n                    <h3>Ustawienia</h3>\n                    <ul data-role="listview" >\n                        <li ><a id=\'bon-config-link\' href="" >Dane Biura Nieruchomości</a></li>\n                        <li ><a id=\'agent-config-link\' href="" >Dane Profilu</a></li>\n                        <li ><a href="/agenci" >Agenci</a></li>\n                        <li ><a href="/oddzialy" >Oddziały</a></li>\n                        <li ><a href="/grafiki" >Logo/Znaki wodne</a></li>\n                        <!--\n                        <li ><a href="" >Importy</a></li>\n                        <li><a href="" >Portale zewnętrzne</a></li>\n                        -->\n                        <li ><a href="/eksporty" >Eksporty</a></li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n\n   <!--\n   <div data-role="collapsible" data-inset="false" data-collapsed-icon="search" data-expanded-icon="arrow-d">\n                    <h3>Wyszukiwania</h3>\n                    <ul data-role="listview">\n                        <li data-role=\'list-divider\' >Portale Zewnętrzne </li>\n                        <li><a href="http://www.oferty.malopolska.pl/" target="_blank" >OfertyMałopolska</a></li>\n                        <li><a href="http://www.gumtree.pl/" target="_blank" >Gumtree</a></li>\n                        <li><a href="http://www.tablica.pl/" target="_blank" >Tablica</a></li>\n                        <li><a href="http://dom.gratka.pl/" target="_blank" >Gratka</a></li>\n                        <li><a href="http://www.domiporta.pl/" target="_blank" >Domiporta</a></li>\n                        <li><a href="http://alegratka.pl/nieruchomosci/" target="_blank" >AleGratka</a></li>\n                        <li><a href="http://www.krn.pl/" target="_blank" >KRN</a></li>\n                        <li><a href="http://www.morizon.pl/" target="_blank" >Morizon</a></li>\n                        <li><a href="http://www.szybko.pl/" target="_blank" >Szybko</a></li>\n                        <li><a href="http://nieruchomosci.multiple.pl" target="_blank" >Multiple</a></li>\n                        <li><a href="http://oferty.net" target="_blank" >OfertyNet</a></li>\n                        <li><a href="http://otodom.pl" target="_blank" >Otodom</a></li>\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n   -->\n    <div data-role="collapsible" data-inset="false" data-collapsed-icon="location" data-expanded-icon="arrow-d">\n                    <h3>Narzędzia</h3>\n                    <ul data-role="listview" >\n                        <li><a href="https://www.google.com/calendar/" target="_blank" >Kalendarz</a></li>\n                        <li><a href="https://maps.google.com/" target="_blank" >MapyGoogle</a></li>\n                        <li><a href="http://www.openstreetmap.org" target="_blank" >OpenStreet</a></li>\n                        <li><a href="/iframe/kw" >Księgi wieczyste</a></li>\n                        <li><a href="http://maps.geoportal.gov.pl/webclient/" target="_blank" >Geoportal</a></li>\n                        <li><a href="http://mapy.geoportal.gov.pl/imap/?gpmap=gp0&actions=acShowWgPlot" target="_blank" >Wyszukaj działkę</a></li>\n                        <li><a href="http://planmieszkania.pl/" target="_blank">Plan mieszkania</a></li>\n                        <!--\n                        <li><a href="/iframe/calendar">Kalendarz</a></li>\n                        <li><a href="http://ekw.ms.gov.pl/pdcbdkw/pdcbdkw.html" target="_blank" >Księgi wieczyste</a></li>\n                        -->\n                        <li><a href="http://www.nieruchomosci.222.pl/kalkulator_oplat.html" target="_blank">Kalkulator kosztów</a></li>\n                        <!--\n                        <li><a href="http://pfrn.pl/" >PFRN</a></li>\n                        -->\n                        <li data-role=\'list-divider\' > </li>\n                    </ul>\n                </div>\n\n\n<!-- ##################################  PANEL -->\n')
}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<div class="ui-grid-b">\n	<div class="ui-block-a">\n <form>\n    <fieldset data-role="controlgroup" data-type="horizontal">\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\'>Odśwież</button>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option value="">Akcja</option>\n            <option value="1">Drukuj</option>\n            <option value="2">Kopiuj</option>\n            <option value="3">Do roboczych</option>\n            <option value="4">Do archiwalnych</option>\n            <option value="5">Usuń</option>\n            <option value="6">Eksport do pliku</option>\n            <option value="7">Wyślij klientowi</option>\n        </select>\n        <label for="select-filter" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="select-filter" id="select-filter">\n            <option value="">Filtr</option>\n            <option value="user">Moje</option>\n            <option value="bon">Agencji</option>\n            <option>Etykiety ----</option>\n            <option value="">Zielona</option>\n        </select>\n    </fieldset>\n</form>\n	</div>\n\n	<div class="ui-block-b">\n         <input id="filterTable-input" data-type="search" data-filter-placeholder="Szukaj ofert ... " />\n\n\n	</div>\n</div><!-- /grid-b -->\n\n<table data-role="table" id="table-list" data-mode="columntoggle reflow" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input"  data-column-btn-text="Kolumny"  >\n     <thead>\n       <tr>\n         <th> <label> <input name="all" id="all" data-mini="true"  type="checkbox"> </label> </th>\n         <th data-priority="6">Zdjęcie&nbsp;&nbsp;</th>\n         <th>ID</th>\n         <th>Agent&nbsp;&nbsp;</th>\n         <th>Klient&nbsp;&nbsp;</th>\n         <th data-priority="2">Transakcja&nbsp;&nbsp;</th>\n         <th data-priority="2"><abbr title="Powierzchnia w m2">Pow.m2&nbsp;&nbsp;</abbr></th>\n         <th data-priority="3">Pokoje&nbsp;&nbsp;</th>\n         <th data-priority="3"><abbr title="Województwo">Woj.&nbsp;&nbsp;</abbr></th>\n         <th data-priority="4">Miejsce&nbsp;&nbsp;</th>\n         <th data-priority="5">Ulica&nbsp;&nbsp;</th>\n         <th data-priority="6">Cena&nbsp;&nbsp;</th>\n         <th data-priority="6"><abbr title="Ostatnia aktualizacja">Aktual.&nbsp;&nbsp;</abbr></th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.oferta,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n\n       <tr>\n         <td> <label> <input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true"  type="checkbox"> </label> </td>\n         <td><img src="images/test.jpg" /></td>\n         <td>'),i.push(n(e.id)),i.push("</td>\n         <td>"),i.push(n(e.agent_nazwisko)),i.push("</td>\n         <td></td>\n         <td>"),i.push(n(e.typ_transakcji)),i.push("</td>\n         <td>"),i.push(n(e.powierzchnia_calkowita)),i.push("</td>\n         <td>"),i.push(n(e.liczba_pokoi)),i.push("</td>\n         <td>"),i.push(n(e.adres_otrzymany_wojewodztwo)),i.push("</td>\n         <td>"),i.push(n(e.adres_otrzymany_miasto)),i.push("</td>\n         <td>"),i.push(n(e.adres_otrzymany_ulica)),i.push("</td>\n         <td>"),i.push(n(e.cena)),i.push("</td>\n         <td>"),i.push(n(e.data_aktualizacji)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n   </table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/listing_list_view",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s,o;i.push('<div id="view-menu">\n    <fieldset data-role="controlgroup" data-type="horizontal" data-theme=\'b\' data-mini="true">\n        <button data-icon="refresh" data-iconpos="notext" id=\'refresh\' >Odśwież</button>\n        <a href=\'/oferty/dodaj?type='),i.push(n(this.listing_type)),i.push('\' class="ui-btn ui-icon-edit ui-btn-icon-left " >Dodaj</a>\n\n        <label for="select-action" class="ui-hidden-accessible ui-icon-action">Akcja</label>\n        <select name="select-action" id="select-action">\n            <option selected value=\'\'>Akcja</option>\n            <option value="wydruk-wewnetrzny">Wydruk wewnętrzyny</option>\n            <option value="wydruk-klienta">Wydruk dla klienta</option>\n            <option value="zmien_agenta">Zmień Agenta</option>\n            <option value="send-listing-client">Wyślij ofertę klientowi</option>\n            <option value="send-listing-address">Wyślij ofertę ...</option>\n            <option value="usun">Usuń</option>\n            <option value="eksport" disabled>Eksport do pliku</option>\n        </select>\n\n        <label for="status-query" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="status-query" id="status-query" data-query=\'status\'>\n            <option selected disabled>Status</option>\n            <option value="">Wszystkie</option>\n            <option value="1">Aktywne</option>\n            <option value="0">Nieaktywne</option>\n            <option value="2">Archiwalne</option>\n            <option value="3">Robocze</option>\n            <option value="4">Sprzedane</option>\n            <option value="5">Wynajęte</option>\n            <option value="6">Umowa przedwstępna</option>\n            <option value="7">Usunięte</option>\n        </select>\n\n        <label for="agent-query" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="agent-query" id="agent-query" data-query=\'agent\'>\n            <option selected disabled>Agent</option>\n            <option value="">Wszyscy</option>\n            '),r=this.agents;for(e in r)t=r[e],i.push('\n            <option value="'),i.push(n(e)),i.push('">'),i.push(n(t)),i.push("</option>\n            ");i.push('\n        </select>\n        <label for="client-query" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="client-query" id="client-query" data-query=\'client\'>\n            <option selected disabled>Klient</option>\n            <option value="">Wszyscy</option>\n            '),s=this.clients;for(e in s)t=s[e],i.push('\n            <option value="'),i.push(n(e)),i.push('">'),i.push(n(t)),i.push("</option>\n            ");i.push('\n        </select>\n        <label for="branch-query" class="ui-hidden-accessible ui-icon-user">Filtr</label>\n        <select name="branch-query" id="branch-query" data-query=\'branch\'>\n            <option selected disabled>Oddział</option>\n            <option value="">Wszystkie</option>\n            '),o=this.branches;for(e in o)t=o[e],i.push('\n            <option value="'),i.push(n(e)),i.push('">'),i.push(n(t)),i.push("</option>\n            ");i.push('\n        </select>\n\n            <input name="wylacznosc" id="wylacznosc" type="checkbox" data-filter=\'wylacznosc\'>\n                <label for="wylacznosc">Wyłączność</label>\n\n        <input name="radio-choice-b" id="radio-choice-c" value="pierwotny"  type="radio" data-filter=\'rynek_func\'>\n        <label for="radio-choice-c">Pierwotny</label>\n        <input name="radio-choice-b" id="radio-choice-d" value="wtórny" type="radio" data-filter=\'rynek_func\'>\n        <label for="radio-choice-d">Wtórny</label>\n\n    </fieldset>\n</div>\n')}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/listing_list_view_items",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<table data-role="table" id="list-table" data-mode="columntoggle" class="tablesorter ui-responsive ui-shadow table-stroke table-stripe"\ndata-filter="true" data-input="#filterTable-input" data-column-btn-text="Kolumny" data-mini="true" data-column-btn-theme="b" data-column-popup-theme="a" >\n     <thead>\n       <tr class=\'th-groups\'>\n         <th><label><input name="all" id="all" data-mini="true" type="checkbox"></label></th>\n         <th>Zdjęcie&nbsp;&nbsp;</th>\n         <th>ID</th>\n         <th data-priority="3">Agent&nbsp;&nbsp;</th>\n         <th>Adres&nbsp;&nbsp;</th>\n         <th data-priority="2">Klient&nbsp;&nbsp;</th>\n         <th data-priority="2">Cena&nbsp;&nbsp;</th>\n         <th data-priority="5"><abbr title="Powierzchnia całkowita">Pow. cał.</abbr>&nbsp;&nbsp;</th>\n         <th data-priority="4">Pok.&nbsp;&nbsp;</th>\n         <th data-priority="7"><abbr title="Piętro">Pt.</abbr>&nbsp;&nbsp;</th>\n         <th data-priority="6">Status&nbsp;&nbsp;</th>\n         <th data-priority="6">Rynek&nbsp;&nbsp;</th>\n         <th data-priority="6"><abbr title="Wyłączność">Wył.</abbr>&nbsp;&nbsp;</th>\n         <th data-priority="6"><abbr title="Ostatnia modyfikacja">Modyfi.</abbr>&nbsp;&nbsp;</th>\n         <th data-priority="6"><abbr title="Data wprowadzenia">Wprowadz.&nbsp;&nbsp;</th>\n       </tr>\n     </thead>\n     <tbody>\n      '),s=this.collection,t=0,r=s.length;r>t;t++)e=s[t],i.push('\n       <tr>\n         <td><label><input name="'),i.push(n(e.id)),i.push('" id="'),i.push(n(e.id)),i.push('" data-mini="true" type="checkbox"></label></td>\n         <td>'),i.push(e.thumbnail_func),i.push("</td>\n         <td><a href='/oferty/"),i.push(n(e.id)),i.push("'>"),i.push(n(e.remote_id)),i.push("</td>\n         <td>"),i.push(n(e.agent_func)),i.push("</td>\n         <td><a href='/oferty/"),i.push(n(e.id)),i.push("'>\n            "),e.town&&(i.push("\n                "),i.push(n(e.town)),i.push("&nbsp;\n            ")),i.push("\n            "),e.street&&(i.push("\n                "),i.push(n(e.street)),i.push("&nbsp;\n            ")),i.push("\n            "),e.number&&(i.push("\n                "),i.push(n(e.number)),i.push("&nbsp;\n            ")),i.push("\n            "),e.street_district&&(i.push("\n                "),i.push(n(e.street_district)),i.push("&nbsp;\n            ")),i.push("\n            </td>\n         <td>"),i.push(n(e.client_func)),i.push("</td>\n         <td>"),i.push(n(e.cena)),i.push(n(e.waluta_func)),i.push("</td>\n         <td>"),i.push(n(e.powierzchnia_calkowita)),i.push(" m2</td>\n         <td>"),i.push(n(e.liczba_pokoi)),i.push(" pk</td>\n         <td>"),i.push(n(e.pietro)),i.push(" pt</td>\n         <td>"),i.push(n(e.status_func)),i.push("</td>\n         <td>"),i.push(n(e.rynek_func)),i.push("</td>\n         <td>"),i.push(n(e.wylacznosc_func)),i.push("</td>\n         <td>"),i.push(n(e.date_created_func)),i.push("</td>\n         <td>"),i.push(n(e.date_modyfied_func)),i.push('</td>\n         <td style="display:none;" >'),i.push(n(e.tytul)),i.push('</td>\n         <td style="display:none;" >'),i.push(n(e.opis)),i.push("</td>\n       </tr>\n      ");i.push("\n     </tbody>\n   </table>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/login",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('    <div data-role="header" data-theme="a">\n    <h1>Logowianie</h1>\n    </div>\n    <div role="main" class="ui-content">\n    <p class=\'login-error\'></p>\n    <form>\n            <input name="user" id="user" placeholder="Użytkownik" value="" type="text">\n            <input name="pass" id="pass" placeholder="Hasło" value="" type="password">\n            <a href=\'http://mobilnyposrednik.pl/rejestracja\' class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" >Rejestracja</a>&nbsp; &nbsp;\n            <button id="login-verification" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b" >Zaloguj</button>\n    </div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/offerlist",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=function(e){return e&&e.ecoSafe?e:e!==void 0&&null!=e?s(e):""},r=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,r,s;for(i.push('<div class="ui-grid-b">\n	<div class="ui-block-a">\n\n                <div data-role="fieldcontain">\n                    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">\n                            <input type="radio" name="radio-choice1" id="list_view_a" value="on" checked="checked" />\n                            <label for="list_view_a">Lista</label>\n                            <input type="radio" name="radio-choice1" id="list_view_b" value="off" />\n                            <label for="list_view_b">Siatka</label>\n                            <input type="radio" name="radio-choice1" id="list_view_c" value="other" />\n                            <label for="list_view_c">Galeria</label>\n                    </fieldset>\n                </div>\n\n\n	</div>\n	<div class="ui-block-b">\n\n                <div data-role="fieldcontain">\n                    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">\n                            <label for="user">Moje</label>\n                            <input type="radio" name="radio-choice2" id="user" value="user" checked="checked" />\n                            <label for="agency">Agencji</label>\n                            <input type="radio" name="radio-choice2" id="agency" value="agency" />\n                            <label for="all">Wszystke</label>\n                            <input type="radio" name="radio-choice2" id="all" value="other" />\n                    </fieldset>\n                </div>\n\n	</div>\n	<div class="ui-block-c">\n\n        <div data-role="fieldcontain">\n				<label for="select-choice-a" class="select">Oddział:</label>\n				<select name="select-choice-a" id="select-choice-a" >\n					<option>Oddział:</option>\n					<option value=""></option>\n					<option value=""></option>\n					<option value=""></option>\n					<option value=""></option>\n				</select>\n        </div>\n\n\n	</div>\n</div><!-- /grid-b -->\n\n         <ul data-role="listview" data-filter="true" data-filter-placeholder="Szukaj ofert ..." >\n      '),e=r=0,s=this.length;s>r;e=++r)t=this[e],i.push('\n			<li><a href="#'),i.push(n(t.oferta.id)),i.push('">\n				<img src="images/test.jpg" />\n        <h3>'),i.push(n(t.oferta.id)),i.push(" <strong>"),i.push(n(t.oferta.typ.kategoria)),i.push("</strong> / "),i.push(n(t.oferta.typ.typ_transakcji)),i.push("</h3>\n        <p>"),i.push(n(t.oferta.adres.wojewodztwo)),i.push(" "),i.push(n(t.oferta.adres.miasto)),i.push(" "),i.push(n(t.oferta.adres.ulica)),i.push('</p>\n        <p class="ui-li-aside"><strong>'),i.push(n(t.oferta.atrybuty.cena)),i.push('</strong></p>\n			<span class="ui-li-count">'),i.push(n(t.oferta.atrybuty.data_aktualizacji)),i.push("</span>\n			</a>\n			</li>\n      ");i.push("\n		</ul>\n\n\n")}).call(this)}.call(e),e.safe=r,e.escape=s,i.join("")}}),require.register("views/templates/popgeneric",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<p>Hi im popgeneric popup</p>\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/property_form",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<form>\n   	<div data-role="tabs">\n			<div data-role="navbar">\n				<ul>\n			      <li><a  href="#tab1"  data-ajax="false">Oferta</a></li>\n			      <li><a  href="#tab2"  data-ajax="false">Nieruchomość</a></li>\n			      <li><a  href="#tab3"  data-ajax="false">Pomieszczenia</a></li>\n			      <li><a  href="#tab4"  data-ajax="false">Adres</a></li>\n			      <li><a  href="#tab5"  data-ajax="false">Pozostałe</a></li>\n			      <li><a  href="#tab6"  data-ajax="false">Zdjęcia</a></li>\n			    </ul>\n			</div>\n\n            <div id="tab1" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                        <div data-fields="tytul"></div>\n                        <div data-fields="dodatkowy_id"></div>\n                        <div data-fields="powierzchnia_calkowita"></div>\n                        <div data-fields="opis"></div>\n                        <div data-fields="opis_angielski"></div>\n                        <div data-fields="opis_prywatny"></div>\n                        <div data-fields="opis_skrocony"></div>\n                        <div data-fields="prowizja"></div>\n                        <div data-fields="rynek"></div>\n                        <div data-fields="rodzaj_wlasnosci"></div>\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                        <div data-fields="termin_wydania"></div>\n                        <div data-fields="stan_mieszkania"></div>\n                        <div data-fields="czynsz"></div>\n                        <div data-fields="liczba_pokoi"></div>\n                        <div data-fields="klucze"></div>\n                        <div data-fields="cena"></div>\n                        <div data-fields="data_aktualizacji"></div>\n                        <div data-fields="data_wprowadzenia"></div>\n                        <div data-fields="typ_kaucji"></div>\n                        <div data-fields="bez_prowizji"></div>\n                        <div data-fields="rynek_pierwotny"></div>\n                        <div data-fields="inwestycja"></div>\n                        <div data-fields="wylacznosc"></div>\n                        <div data-fields="podstawa_nabycia"></div>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n\n            <div id="tab2" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                        <div data-fields="piwnica"></div>\n                        <div data-fields="rodzaj_budynku"></div>\n                        <div data-fields="material_budynku"></div>\n                        <div data-fields="garaz"></div>\n                        <div data-fields="udogodnienia"></div>\n                        <div data-fields="balkon"></div>\n                        <div data-fields="parking"></div>\n                        <div data-fields="wyposazenie"></div>\n                        <div data-fields="media"></div>\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                        <div data-fields="ilosc_poziomow"></div>\n                        <div data-fields="pietro"></div>\n                        <div data-fields="rok_budowy"></div>\n                        <div data-fields="liczba_pieter"></div>\n                        <div data-fields="przeznaczenie"></div>\n                        <div data-fields="okna"></div>\n                        <div data-fields="ogrzewanie"></div>\n                        <div data-fields="ogrodek"></div>\n                        <div data-fields="komorka"></div>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n\n            <div id="tab3" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                        <div data-fields="liczba_lazienek"></div>\n                        <div data-fields="powierzchnia_wc"></div>\n                        <div data-fields="powierzchnia_piwnicy"></div>\n                        <div data-fields="powierzchnia_balkonu"></div>\n                        <div data-fields="powierzchnia_uzytkowa"></div>\n                        <div data-fields="dwupoziomowe"></div>\n                        <div data-fields="ekspozycja_okien"></div>\n                        <div data-fields="podlogi"></div>\n                        <div data-fields="umeblowanie"></div>\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                        <div data-fields="stan_instalacji"></div>\n                        <div data-fields="sciany_lazienek"></div>\n                        <div data-fields="wyposazenie_kuchni"></div>\n                        <div data-fields="goraca_woda"></div>\n                        <div data-fields="stan_lazienek"></div>\n                        <div data-fields="lazienka"></div>\n                        <div data-fields="powierzchnia_lazienek"></div>\n                        <div data-fields="powierzchnia_kuchni"></div>\n                        <div data-fields="kuchnia"></div>\n                        <div data-fields="liczba_wc"></div>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n\n            <div id="tab4" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                    adres\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n\n            <div id="tab5" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                        <div data-fields="typ_kaucji"></div>\n                        <div data-fields="komunikacja"></div>\n                        <div data-fields="video"></div>\n                        <div data-fields="odleglosc_od_jeziora"></div>\n                        <div data-fields="odleglosc_od_szkoly"></div>\n                        <div data-fields="tereny_rekreacyjne"></div>\n                        <div data-fields="odleglosc_od_centrum"></div>\n                        <div data-fields="odleglosc_od_miasta"></div>\n                        <div data-fields="odleglosc_od_stacji"></div>\n                        <div data-fields="data_podpisania_umowy"></div>\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                        <div data-fields="odleglosc_od_szosy"></div>\n                        <div data-fields="w_poblizu"></div>\n                        <div data-fields="glosnosc"></div>\n                        <div data-fields="uklad_mieszkania"></div>\n                        <div data-fields="zabezpieczenia"></div>\n                        <div data-fields="odleglosc_od_przedszkola"></div>\n                        <div data-fields="dodatkowe_oplaty"></div>\n                        <div data-fields="rodzaj_mieszkania"></div>\n                        <div data-fields="odleglosc_od_przystanku"></div>\n                        <div data-fields="powierzchnia_biurowa"></div>\n                        <div data-fields="adres_wewnetrzny"></div>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n\n            <div id="tab6" class="ui-content">\n                <div class=\'ui-grid-a\'>\n                    <div class=\'ui-block-a\'>\n                    zdjęcia\n                    </div><!-- block-a -->\n                    <div class=\'ui-block-b ui-content\' style=\'padding-left:10px\'>\n                    </div><!-- block-b -->\n                    </div><!-- grid-a -->\n            </div><!-- tab -->\n</div>\n\n\n\n  '),this.is_admin&&(i.push("\n    "),"add"===this.mode&&i.push('\n    <a id="branch-add-refresh" href=\'/oddzialy/dodaj\' class="ui-btn ui-btn-inline ui-icon-recycle ui-btn-icon-right">Wyczyść</a>\n    <a id="branch-add-save" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Dodaj</a>\n    '),i.push("\n    "),"edit"===this.mode&&i.push('\n    <a id="branch-edit-update" class="ui-btn ui-btn-inline ui-icon-check ui-btn-b ui-btn-icon-right" type=\'submit\'>Uaktualnij</a>\n    <a id="branch-edit-delete" class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-right">Skasuj</a>\n    '),i.push("\n  ")),i.push("\n\n</form>\n\n\n\n\n\n\n\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/upload",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push('<script type="text/template" id="qq-template">\n<div class="qq-uploader-selector qq-uploader">\n            <div class="qq-upload-drop-area-selector qq-upload-drop-area" qq-hide-dropzone>\n                <span>Wrzuć pliki na serwer</span>\n            </div>\n            <div class="qq-upload-button-selector qq-upload-button">\n                <a class=\'ui-btn ui-btn-b\'>Dodaj pliki</a>\n            </div>\n            <span class="qq-drop-processing-selector qq-drop-processing">\n                <span>Przetwarzam pliki...</span>\n                <span class="qq-drop-processing-spinner-selector qq-drop-processing-spinner"></span>\n            </span>\n            <ul class="qq-upload-list-selector qq-upload-list" data-role=\'listview\' data-inset=\'true\'>\n\n                <li>\n                  <div class="qq-progress-bar-container-selector">\n                      <div class="qq-progress-bar-selector qq-progress-bar"></div>\n                  </div>\n                  <span class="qq-upload-spinner-selector qq-upload-spinner"></span>\n                    <img class="qq-thumbnail-selector" qq-max-size="100" qq-server-scale>\n                  <span class="qq-edit-filename-icon-selector qq-edit-filename-icon"></span>\n                  <span class="qq-upload-file-selector qq-upload-file"></span>\n                  <input class="qq-edit-filename-selector qq-edit-filename" tabindex="0" type="text">\n                  <span class="qq-upload-size-selector qq-upload-size"></span>\n                  <a class="qq-upload-cancel-selector qq-upload-cancel" href="#">Zaniechaj</a>\n                  <a class="qq-upload-retry-selector qq-upload-retry" href="#">Spróbuj ponownie</a>\n                  <a class="qq-upload-delete-selector qq-upload-delete" href="#">Usuń</a>\n                  <span class="qq-upload-status-text-selector qq-upload-status-text"></span>\n                </li>\n            </ul>\n</div>\n</script>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/templates/viewed",function(e,t,i){i.exports=function(e){e||(e={});var t,i=[],n=e.safe,r=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;(void 0===e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){i.push("<p>Hi im viewed popup</p>\n")}).call(this)}.call(e),e.safe=n,e.escape=r,i.join("")}}),require.register("views/viewed-view",function(e,t,i){var n,r,s,o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=t("views/templates/viewed"),n=t("views/base/view"),i.exports=r=function(e){function t(){return this.attach=o(this.attach,this),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.template=s,t.prototype.containerMethod="html",t.prototype.id="viewed",t.prototype.attributes={"data-role":"popup","data-theme":"b","data-position-to":"window","data-arrow":"true"},t.prototype.className="ui-content",t.prototype.attach=function(){return t.__super__.attach.apply(this,arguments),this.publishEvent("log:info","HeaderView:attach()")},t}(n)});